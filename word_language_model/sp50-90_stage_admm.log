python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 10 --dropout 0.60 --save sp50_epoch10_dropout0.60_lstm.pt --pretrained ptb_pretrained_1500.pt
debug
{'rnn.weight_ih_l0': 0.5, 'rnn.weight_hh_l0': 0.5, 'rnn.weight_ih_l1': 0.5, 'rnn.weight_hh_l1': 0.5}
{'rnn.weight_ih_l0': 0.5, 'rnn.weight_hh_l0': 0.5, 'rnn.weight_ih_l1': 0.5, 'rnn.weight_hh_l1': 0.5}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 56.53 | loss 22.75 | ppl 7621069988.92
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 48.14 | loss  7.24 | ppl  1390.47
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 48.31 | loss  4.33 | ppl    75.71
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 48.13 | loss  3.80 | ppl    44.55
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.23 | loss  3.80 | ppl    44.73
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.32 | loss  3.63 | ppl    37.86
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 67.41s | valid loss  4.43 | valid ppl    83.85
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 56.69 | loss  7.08 | ppl  1189.50
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 48.68 | loss  3.88 | ppl    48.40
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 48.96 | loss  3.63 | ppl    37.54
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 48.98 | loss  3.54 | ppl    34.34
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.80 | loss  3.62 | ppl    37.35
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.86 | loss  3.46 | ppl    31.84
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 68.21s | valid loss  4.44 | valid ppl    84.95
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 57.54 | loss  3.62 | ppl    37.50
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 49.46 | loss  3.58 | ppl    35.94
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 49.32 | loss  3.56 | ppl    35.27
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 49.39 | loss  3.49 | ppl    32.78
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 50.41 | loss  3.57 | ppl    35.45
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.02 | loss  3.41 | ppl    30.32
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 70.02s | valid loss  4.45 | valid ppl    85.74
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 59.04 | loss  3.57 | ppl    35.60
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 51.66 | loss  3.53 | ppl    34.23
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 52.29 | loss  3.51 | ppl    33.58
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 52.44 | loss  3.45 | ppl    31.45
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.58 | loss  3.53 | ppl    34.04
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.67 | loss  3.36 | ppl    28.78
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 72.95s | valid loss  4.46 | valid ppl    86.48
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 2.50 | ms/batch 60.47 | loss  3.53 | ppl    34.28
| epoch   5 |   400/ 1327 batches | lr 2.50 | ms/batch 53.33 | loss  3.49 | ppl    32.76
| epoch   5 |   600/ 1327 batches | lr 2.50 | ms/batch 53.00 | loss  3.46 | ppl    31.91
| epoch   5 |   800/ 1327 batches | lr 2.50 | ms/batch 53.06 | loss  3.39 | ppl    29.68
| epoch   5 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.14 | loss  3.46 | ppl    31.80
| epoch   5 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.79 | loss  3.30 | ppl    27.03
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 74.24s | valid loss  4.46 | valid ppl    86.86
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 2.50 | ms/batch 61.22 | loss  3.47 | ppl    32.29
| epoch   6 |   400/ 1327 batches | lr 2.50 | ms/batch 53.47 | loss  3.45 | ppl    31.37
| epoch   6 |   600/ 1327 batches | lr 2.50 | ms/batch 53.89 | loss  3.42 | ppl    30.61
| epoch   6 |   800/ 1327 batches | lr 2.50 | ms/batch 54.09 | loss  3.35 | ppl    28.42
| epoch   6 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.62 | loss  3.43 | ppl    30.75
| epoch   6 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.00 | loss  3.26 | ppl    26.05
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 75.03s | valid loss  4.48 | valid ppl    87.84
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 61.43 | loss  3.44 | ppl    31.14
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 53.88 | loss  3.41 | ppl    30.20
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 54.13 | loss  3.38 | ppl    29.30
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 54.31 | loss  3.32 | ppl    27.62
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.36 | loss  3.39 | ppl    29.63
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.18 | loss  3.23 | ppl    25.21
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 75.46s | valid loss  4.48 | valid ppl    88.60
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 1.25 | ms/batch 62.19 | loss  3.41 | ppl    30.15
| epoch   8 |   400/ 1327 batches | lr 1.25 | ms/batch 54.26 | loss  3.37 | ppl    29.13
| epoch   8 |   600/ 1327 batches | lr 1.25 | ms/batch 55.29 | loss  3.35 | ppl    28.39
| epoch   8 |   800/ 1327 batches | lr 1.25 | ms/batch 54.58 | loss  3.28 | ppl    26.58
| epoch   8 |  1000/ 1327 batches | lr 1.25 | ms/batch 54.90 | loss  3.34 | ppl    28.34
| epoch   8 |  1200/ 1327 batches | lr 1.25 | ms/batch 55.27 | loss  3.18 | ppl    23.95
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 76.51s | valid loss  4.48 | valid ppl    88.53
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 1.25 | ms/batch 62.98 | loss  3.37 | ppl    28.95
| epoch   9 |   400/ 1327 batches | lr 1.25 | ms/batch 55.38 | loss  3.33 | ppl    27.83
| epoch   9 |   600/ 1327 batches | lr 1.25 | ms/batch 55.82 | loss  3.31 | ppl    27.41
| epoch   9 |   800/ 1327 batches | lr 1.25 | ms/batch 55.55 | loss  3.25 | ppl    25.67
| epoch   9 |  1000/ 1327 batches | lr 1.25 | ms/batch 55.43 | loss  3.31 | ppl    27.45
| epoch   9 |  1200/ 1327 batches | lr 1.25 | ms/batch 55.75 | loss  3.13 | ppl    22.94
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 77.39s | valid loss  4.49 | valid ppl    89.20
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 63.23 | loss  3.33 | ppl    27.81
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 55.40 | loss  3.29 | ppl    26.83
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 55.81 | loss  3.27 | ppl    26.39
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 56.66 | loss  3.20 | ppl    24.57
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.15 | loss  3.27 | ppl    26.38
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 55.59 | loss  3.10 | ppl    22.29
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 77.80s | valid loss  4.50 | valid ppl    90.11
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.49933333333333335
sparsity at layer rnn.weight_hh_l0 is 0.49933333333333335
sparsity at layer rnn.weight_ih_l1 is 0.49933333333333335
sparsity at layer rnn.weight_hh_l1 is 0.49933333333333335
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.3743128435782108
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 47.06 | loss  3.32 | ppl    27.76
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 47.88 | loss  3.35 | ppl    28.39
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 48.00 | loss  3.35 | ppl    28.57
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 48.36 | loss  3.31 | ppl    27.48
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.30 | loss  3.40 | ppl    30.05
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.34 | loss  3.26 | ppl    26.05
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 65.86s | valid loss  4.55 | valid ppl    94.25
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 48.48 | loss  3.32 | ppl    27.70
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 48.46 | loss  3.32 | ppl    27.62
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 48.43 | loss  3.31 | ppl    27.36
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 48.49 | loss  3.27 | ppl    26.22
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.44 | loss  3.36 | ppl    28.67
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.49 | loss  3.21 | ppl    24.88
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 66.40s | valid loss  4.55 | valid ppl    94.26
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 48.75 | loss  3.29 | ppl    26.79
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 48.72 | loss  3.27 | ppl    26.19
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 48.75 | loss  3.26 | ppl    26.10
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 48.57 | loss  3.22 | ppl    24.99
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.46 | loss  3.31 | ppl    27.26
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.56 | loss  3.16 | ppl    23.60
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 66.62s | valid loss  4.57 | valid ppl    96.70
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 48.40 | loss  3.25 | ppl    25.81
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 48.01 | loss  3.21 | ppl    24.77
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 48.46 | loss  3.17 | ppl    23.76
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 48.64 | loss  3.09 | ppl    22.03
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.00 | loss  3.15 | ppl    23.35
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.09 | loss  2.98 | ppl    19.74
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 66.13s | valid loss  4.57 | valid ppl    96.70
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 48.87 | loss  3.12 | ppl    22.73
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 48.63 | loss  3.10 | ppl    22.27
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 48.54 | loss  3.07 | ppl    21.64
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 48.45 | loss  3.01 | ppl    20.25
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 47.98 | loss  3.08 | ppl    21.71
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.51 | loss  2.91 | ppl    18.36
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 66.44s | valid loss  4.60 | valid ppl    99.06
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 1.25 | ms/batch 48.97 | loss  3.07 | ppl    21.61
| epoch   6 |   400/ 1327 batches | lr 1.25 | ms/batch 48.51 | loss  3.06 | ppl    21.26
| epoch   6 |   600/ 1327 batches | lr 1.25 | ms/batch 48.52 | loss  3.03 | ppl    20.64
| epoch   6 |   800/ 1327 batches | lr 1.25 | ms/batch 48.54 | loss  2.96 | ppl    19.22
| epoch   6 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.52 | loss  3.01 | ppl    20.21
| epoch   6 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.49 | loss  2.84 | ppl    17.10
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.61s | valid loss  4.58 | valid ppl    97.23
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 1.25 | ms/batch 48.88 | loss  3.02 | ppl    20.41
| epoch   7 |   400/ 1327 batches | lr 1.25 | ms/batch 48.58 | loss  2.98 | ppl    19.69
| epoch   7 |   600/ 1327 batches | lr 1.25 | ms/batch 48.48 | loss  2.95 | ppl    19.13
| epoch   7 |   800/ 1327 batches | lr 1.25 | ms/batch 48.53 | loss  2.89 | ppl    17.91
| epoch   7 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.64 | loss  2.94 | ppl    18.98
| epoch   7 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.25 | loss  2.77 | ppl    15.91
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 66.43s | valid loss  4.59 | valid ppl    98.88
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 0.31 | ms/batch 48.90 | loss  3.51 | ppl    33.32
| epoch   8 |   400/ 1327 batches | lr 0.31 | ms/batch 48.56 | loss  3.47 | ppl    32.08
| epoch   8 |   600/ 1327 batches | lr 0.31 | ms/batch 48.46 | loss  3.44 | ppl    31.14
| epoch   8 |   800/ 1327 batches | lr 0.31 | ms/batch 48.89 | loss  3.36 | ppl    28.69
| epoch   8 |  1000/ 1327 batches | lr 0.31 | ms/batch 48.67 | loss  3.42 | ppl    30.65
| epoch   8 |  1200/ 1327 batches | lr 0.31 | ms/batch 48.58 | loss  3.25 | ppl    25.84
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 66.63s | valid loss  4.51 | valid ppl    91.25
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 0.31 | ms/batch 48.54 | loss  3.45 | ppl    31.58
| epoch   9 |   400/ 1327 batches | lr 0.31 | ms/batch 48.82 | loss  3.42 | ppl    30.67
| epoch   9 |   600/ 1327 batches | lr 0.31 | ms/batch 48.10 | loss  3.41 | ppl    30.17
| epoch   9 |   800/ 1327 batches | lr 0.31 | ms/batch 48.16 | loss  3.33 | ppl    27.99
| epoch   9 |  1000/ 1327 batches | lr 0.31 | ms/batch 48.21 | loss  3.41 | ppl    30.15
| epoch   9 |  1200/ 1327 batches | lr 0.31 | ms/batch 48.12 | loss  3.23 | ppl    25.38
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.32s | valid loss  4.50 | valid ppl    90.39
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 0.31 | ms/batch 48.85 | loss  3.44 | ppl    31.16
| epoch  10 |   400/ 1327 batches | lr 0.31 | ms/batch 48.45 | loss  3.41 | ppl    30.19
| epoch  10 |   600/ 1327 batches | lr 0.31 | ms/batch 48.36 | loss  3.39 | ppl    29.78
| epoch  10 |   800/ 1327 batches | lr 0.31 | ms/batch 48.12 | loss  3.32 | ppl    27.56
| epoch  10 |  1000/ 1327 batches | lr 0.31 | ms/batch 48.71 | loss  3.39 | ppl    29.74
| epoch  10 |  1200/ 1327 batches | lr 0.31 | ms/batch 48.61 | loss  3.22 | ppl    25.15
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.49s | valid loss  4.50 | valid ppl    90.13
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.49933333333333335
sparsity at layer rnn.weight_hh_l0 is 0.49933333333333335
sparsity at layer rnn.weight_ih_l1 is 0.49933333333333335
sparsity at layer rnn.weight_hh_l1 is 0.49933333333333335
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.3743128435782108
=========================================================================================
| End of training | test loss  4.46 | test ppl    86.15
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 10 --dropout 0.60 --save sp55_epoch10_dropout0.60_lstm.pt --pretrained sp50_epoch10_dropout0.60_lstm.pt
debug
{'rnn.weight_ih_l0': 0.55, 'rnn.weight_hh_l0': 0.55, 'rnn.weight_ih_l1': 0.55, 'rnn.weight_hh_l1': 0.55}
{'rnn.weight_ih_l0': 0.55, 'rnn.weight_hh_l0': 0.55, 'rnn.weight_ih_l1': 0.55, 'rnn.weight_hh_l1': 0.55}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 57.05 | loss  5.63 | ppl   278.78
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 48.66 | loss  4.02 | ppl    55.68
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 48.66 | loss  3.64 | ppl    38.01
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 48.62 | loss  3.48 | ppl    32.44
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.68 | loss  3.54 | ppl    34.33
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 49.76 | loss  3.35 | ppl    28.52
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 68.82s | valid loss  4.52 | valid ppl    92.07
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 58.93 | loss  3.89 | ppl    48.98
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 51.01 | loss  3.49 | ppl    32.72
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 51.75 | loss  3.42 | ppl    30.56
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 52.30 | loss  3.35 | ppl    28.52
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.41 | loss  3.43 | ppl    30.84
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.12 | loss  3.25 | ppl    25.92
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 72.57s | valid loss  4.54 | valid ppl    93.51
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 59.55 | loss  3.43 | ppl    31.01
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 52.63 | loss  3.39 | ppl    29.58
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 52.56 | loss  3.37 | ppl    29.08
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 52.70 | loss  3.30 | ppl    27.15
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.94 | loss  3.38 | ppl    29.29
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.79 | loss  3.21 | ppl    24.75
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 73.61s | valid loss  4.55 | valid ppl    94.65
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 60.40 | loss  3.38 | ppl    29.31
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 52.41 | loss  3.34 | ppl    28.22
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 53.40 | loss  3.32 | ppl    27.63
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 53.06 | loss  3.26 | ppl    26.07
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.53 | loss  3.34 | ppl    28.17
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 53.07 | loss  3.16 | ppl    23.61
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 73.99s | valid loss  4.56 | valid ppl    95.41
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 2.50 | ms/batch 61.46 | loss  3.39 | ppl    29.80
| epoch   5 |   400/ 1327 batches | lr 2.50 | ms/batch 53.21 | loss  3.35 | ppl    28.40
| epoch   5 |   600/ 1327 batches | lr 2.50 | ms/batch 53.66 | loss  3.32 | ppl    27.67
| epoch   5 |   800/ 1327 batches | lr 2.50 | ms/batch 54.23 | loss  3.26 | ppl    25.92
| epoch   5 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.53 | loss  3.32 | ppl    27.61
| epoch   5 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.11 | loss  3.15 | ppl    23.24
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 75.22s | valid loss  4.54 | valid ppl    93.40
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 2.50 | ms/batch 61.21 | loss  3.33 | ppl    28.00
| epoch   6 |   400/ 1327 batches | lr 2.50 | ms/batch 53.88 | loss  3.30 | ppl    27.23
| epoch   6 |   600/ 1327 batches | lr 2.50 | ms/batch 54.25 | loss  3.28 | ppl    26.66
| epoch   6 |   800/ 1327 batches | lr 2.50 | ms/batch 54.61 | loss  3.21 | ppl    24.84
| epoch   6 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.51 | loss  3.29 | ppl    26.80
| epoch   6 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.36 | loss  3.11 | ppl    22.47
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 75.61s | valid loss  4.55 | valid ppl    94.65
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 62.53 | loss  3.29 | ppl    26.92
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 54.40 | loss  3.27 | ppl    26.21
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 54.26 | loss  3.24 | ppl    25.51
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 54.72 | loss  3.18 | ppl    24.16
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.99 | loss  3.26 | ppl    25.96
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.92 | loss  3.08 | ppl    21.78
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 76.42s | valid loss  4.56 | valid ppl    95.32
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 62.91 | loss  3.28 | ppl    26.70
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 55.01 | loss  3.26 | ppl    25.96
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 54.98 | loss  3.24 | ppl    25.47
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 55.27 | loss  3.18 | ppl    23.93
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.82 | loss  3.24 | ppl    25.61
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.66 | loss  3.07 | ppl    21.53
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 77.19s | valid loss  4.56 | valid ppl    95.16
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 62.88 | loss  3.24 | ppl    25.64
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 55.99 | loss  3.21 | ppl    24.90
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 55.31 | loss  3.20 | ppl    24.54
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 56.42 | loss  3.14 | ppl    23.13
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.80 | loss  3.21 | ppl    24.75
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 56.38 | loss  3.03 | ppl    20.63
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 77.92s | valid loss  4.56 | valid ppl    95.90
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 63.64 | loss  3.22 | ppl    24.96
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 56.18 | loss  3.18 | ppl    24.16
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 55.98 | loss  3.17 | ppl    23.73
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 56.95 | loss  3.10 | ppl    22.16
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.52 | loss  3.16 | ppl    23.65
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 55.90 | loss  2.99 | ppl    19.80
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 78.43s | valid loss  4.56 | valid ppl    95.73
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.5493333333333333
sparsity at layer rnn.weight_hh_l0 is 0.5493333333333333
sparsity at layer rnn.weight_ih_l1 is 0.5493333333333333
sparsity at layer rnn.weight_hh_l1 is 0.5493333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.4278296988577361
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 47.96 | loss  2.49 | ppl    12.06
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 48.05 | loss  2.51 | ppl    12.31
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 48.17 | loss  2.52 | ppl    12.43
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 48.17 | loss  2.49 | ppl    12.06
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.12 | loss  2.57 | ppl    13.13
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 47.86 | loss  2.43 | ppl    11.41
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 65.88s | valid loss  4.86 | valid ppl   128.69
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 48.44 | loss  2.49 | ppl    12.12
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 48.40 | loss  2.50 | ppl    12.18
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 48.41 | loss  2.49 | ppl    12.08
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 48.38 | loss  2.46 | ppl    11.75
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.45 | loss  2.55 | ppl    12.75
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.48 | loss  2.41 | ppl    11.15
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 66.34s | valid loss  4.86 | valid ppl   128.85
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 49.37 | loss  2.49 | ppl    12.00
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 48.57 | loss  2.47 | ppl    11.85
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 47.97 | loss  2.47 | ppl    11.86
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 48.40 | loss  2.45 | ppl    11.54
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.45 | loss  2.52 | ppl    12.47
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 49.19 | loss  2.39 | ppl    10.88
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 66.63s | valid loss  4.90 | valid ppl   134.16
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 48.56 | loss  3.14 | ppl    23.10
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 47.86 | loss  3.08 | ppl    21.82
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 47.89 | loss  3.03 | ppl    20.77
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 48.51 | loss  2.96 | ppl    19.25
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.06 | loss  3.01 | ppl    20.27
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.08 | loss  2.84 | ppl    17.08
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.98s | valid loss  4.69 | valid ppl   109.04
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 48.39 | loss  2.97 | ppl    19.49
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 48.51 | loss  2.95 | ppl    19.16
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 48.39 | loss  2.93 | ppl    18.66
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 48.28 | loss  2.86 | ppl    17.54
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 47.91 | loss  2.93 | ppl    18.69
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.37 | loss  2.76 | ppl    15.86
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 66.15s | valid loss  4.71 | valid ppl   111.42
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 48.75 | loss  3.07 | ppl    21.52
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 48.78 | loss  3.05 | ppl    21.06
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 48.42 | loss  3.02 | ppl    20.47
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 48.28 | loss  2.96 | ppl    19.30
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.31 | loss  3.03 | ppl    20.61
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.33 | loss  2.87 | ppl    17.67
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.36s | valid loss  4.64 | valid ppl   103.91
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 48.48 | loss  2.99 | ppl    19.91
| epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 48.47 | loss  2.97 | ppl    19.48
| epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 48.45 | loss  2.94 | ppl    19.00
| epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 48.43 | loss  2.89 | ppl    17.95
| epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.50 | loss  2.96 | ppl    19.32
| epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.46 | loss  2.79 | ppl    16.27
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 66.38s | valid loss  4.66 | valid ppl   105.58
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 1.25 | ms/batch 48.88 | loss  3.49 | ppl    32.94
| epoch   8 |   400/ 1327 batches | lr 1.25 | ms/batch 48.17 | loss  3.46 | ppl    31.77
| epoch   8 |   600/ 1327 batches | lr 1.25 | ms/batch 48.32 | loss  3.43 | ppl    30.88
| epoch   8 |   800/ 1327 batches | lr 1.25 | ms/batch 48.31 | loss  3.36 | ppl    28.74
| epoch   8 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.39 | loss  3.42 | ppl    30.69
| epoch   8 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.28 | loss  3.26 | ppl    26.00
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 66.28s | valid loss  4.54 | valid ppl    94.13
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 1.25 | ms/batch 48.38 | loss  3.42 | ppl    30.71
| epoch   9 |   400/ 1327 batches | lr 1.25 | ms/batch 48.23 | loss  3.40 | ppl    30.06
| epoch   9 |   600/ 1327 batches | lr 1.25 | ms/batch 48.14 | loss  3.38 | ppl    29.51
| epoch   9 |   800/ 1327 batches | lr 1.25 | ms/batch 48.31 | loss  3.32 | ppl    27.73
| epoch   9 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.95 | loss  3.40 | ppl    29.88
| epoch   9 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.48 | loss  3.24 | ppl    25.46
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.27s | valid loss  4.54 | valid ppl    93.61
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 48.37 | loss  3.41 | ppl    30.18
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 48.21 | loss  3.38 | ppl    29.43
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 48.13 | loss  3.37 | ppl    29.04
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 48.49 | loss  3.30 | ppl    27.08
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.63 | loss  3.38 | ppl    29.29
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.62 | loss  3.22 | ppl    25.06
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.34s | valid loss  4.54 | valid ppl    93.50
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.5493333333333333
sparsity at layer rnn.weight_hh_l0 is 0.5493333333333333
sparsity at layer rnn.weight_ih_l1 is 0.5493333333333333
sparsity at layer rnn.weight_hh_l1 is 0.5493333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.4278296988577361
=========================================================================================
| End of training | test loss  4.49 | test ppl    88.90
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 10 --dropout 0.60 --save sp60_epoch10_dropout0.60_lstm.pt --pretrained sp55_epoch10_dropout0.60_lstm.pt
debug
{'rnn.weight_ih_l0': 0.6, 'rnn.weight_hh_l0': 0.6, 'rnn.weight_ih_l1': 0.6, 'rnn.weight_hh_l1': 0.6}
{'rnn.weight_ih_l0': 0.6, 'rnn.weight_hh_l0': 0.6, 'rnn.weight_ih_l1': 0.6, 'rnn.weight_hh_l1': 0.6}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 56.91 | loss  6.46 | ppl   641.42
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 48.71 | loss  4.24 | ppl    69.74
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 48.79 | loss  3.65 | ppl    38.28
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 49.04 | loss  3.42 | ppl    30.48
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.74 | loss  3.44 | ppl    31.24
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 50.35 | loss  3.23 | ppl    25.36
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 69.07s | valid loss  4.59 | valid ppl    98.91
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 58.92 | loss  3.96 | ppl    52.59
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 51.70 | loss  3.42 | ppl    30.54
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 51.91 | loss  3.32 | ppl    27.65
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 52.15 | loss  3.25 | ppl    25.80
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.36 | loss  3.32 | ppl    27.71
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.99 | loss  3.13 | ppl    22.94
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 72.51s | valid loss  4.62 | valid ppl   101.65
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 59.73 | loss  3.34 | ppl    28.11
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 52.26 | loss  3.28 | ppl    26.49
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 52.69 | loss  3.26 | ppl    26.15
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 52.87 | loss  3.20 | ppl    24.57
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.93 | loss  3.28 | ppl    26.48
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.27 | loss  3.10 | ppl    22.10
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 73.56s | valid loss  4.63 | valid ppl   102.76
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 60.48 | loss  3.28 | ppl    26.51
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 52.75 | loss  3.23 | ppl    25.29
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 53.40 | loss  3.22 | ppl    24.96
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 53.35 | loss  3.16 | ppl    23.69
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.27 | loss  3.24 | ppl    25.49
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 53.27 | loss  3.05 | ppl    21.16
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 74.22s | valid loss  4.64 | valid ppl   103.41
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 2.50 | ms/batch 61.60 | loss  3.34 | ppl    28.22
| epoch   5 |   400/ 1327 batches | lr 2.50 | ms/batch 53.28 | loss  3.28 | ppl    26.65
| epoch   5 |   600/ 1327 batches | lr 2.50 | ms/batch 53.66 | loss  3.26 | ppl    26.10
| epoch   5 |   800/ 1327 batches | lr 2.50 | ms/batch 54.03 | loss  3.20 | ppl    24.50
| epoch   5 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.97 | loss  3.26 | ppl    26.10
| epoch   5 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.98 | loss  3.08 | ppl    21.76
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 75.26s | valid loss  4.59 | valid ppl    98.76
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 2.50 | ms/batch 61.47 | loss  3.27 | ppl    26.40
| epoch   6 |   400/ 1327 batches | lr 2.50 | ms/batch 54.21 | loss  3.25 | ppl    25.67
| epoch   6 |   600/ 1327 batches | lr 2.50 | ms/batch 54.12 | loss  3.23 | ppl    25.18
| epoch   6 |   800/ 1327 batches | lr 2.50 | ms/batch 54.76 | loss  3.16 | ppl    23.52
| epoch   6 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.59 | loss  3.23 | ppl    25.40
| epoch   6 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.29 | loss  3.05 | ppl    21.13
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 75.77s | valid loss  4.61 | valid ppl   100.02
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 61.38 | loss  3.24 | ppl    25.47
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 54.11 | loss  3.21 | ppl    24.69
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 54.64 | loss  3.19 | ppl    24.23
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 54.83 | loss  3.14 | ppl    22.99
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.87 | loss  3.21 | ppl    24.66
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.74 | loss  3.03 | ppl    20.61
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 76.17s | valid loss  4.61 | valid ppl   100.67
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 62.23 | loss  3.23 | ppl    25.18
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 54.99 | loss  3.20 | ppl    24.42
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 55.69 | loss  3.18 | ppl    24.10
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 55.22 | loss  3.12 | ppl    22.76
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.75 | loss  3.19 | ppl    24.33
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.53 | loss  3.01 | ppl    20.36
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 77.13s | valid loss  4.61 | valid ppl   100.33
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 63.32 | loss  3.19 | ppl    24.28
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 55.51 | loss  3.16 | ppl    23.52
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 56.07 | loss  3.15 | ppl    23.25
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 56.13 | loss  3.09 | ppl    22.01
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 56.12 | loss  3.16 | ppl    23.58
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 56.14 | loss  2.98 | ppl    19.60
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 78.11s | valid loss  4.62 | valid ppl   101.08
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 63.56 | loss  3.20 | ppl    24.45
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 56.15 | loss  3.16 | ppl    23.62
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 56.10 | loss  3.14 | ppl    23.20
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 56.97 | loss  3.08 | ppl    21.75
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.41 | loss  3.14 | ppl    23.16
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.23 | loss  2.97 | ppl    19.40
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 78.59s | valid loss  4.60 | valid ppl    99.61
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.5993333333333334
sparsity at layer rnn.weight_hh_l0 is 0.5993333333333334
sparsity at layer rnn.weight_ih_l1 is 0.5993333333333334
sparsity at layer rnn.weight_hh_l1 is 0.5993333333333334
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.4856834143706106
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 46.40 | loss  1.91 | ppl     6.75
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 47.69 | loss  1.93 | ppl     6.90
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 47.66 | loss  1.95 | ppl     7.01
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 48.48 | loss  1.93 | ppl     6.92
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.01 | loss  2.02 | ppl     7.50
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.07 | loss  1.89 | ppl     6.61
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 65.37s | valid loss  5.16 | valid ppl   174.55
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 48.70 | loss  1.95 | ppl     7.05
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 48.02 | loss  1.96 | ppl     7.12
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 48.54 | loss  1.96 | ppl     7.09
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 48.44 | loss  1.94 | ppl     6.96
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.34 | loss  2.01 | ppl     7.47
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.28 | loss  1.89 | ppl     6.64
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 66.26s | valid loss  5.17 | valid ppl   175.56
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 49.16 | loss  1.96 | ppl     7.10
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 48.44 | loss  1.96 | ppl     7.07
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 47.89 | loss  1.95 | ppl     7.06
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 48.78 | loss  1.94 | ppl     6.93
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.34 | loss  2.00 | ppl     7.36
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.11 | loss  1.87 | ppl     6.50
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 66.32s | valid loss  5.20 | valid ppl   182.07
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 48.83 | loss  3.11 | ppl    22.38
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 48.28 | loss  3.02 | ppl    20.39
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 48.05 | loss  2.96 | ppl    19.30
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 47.89 | loss  2.88 | ppl    17.85
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 47.94 | loss  2.93 | ppl    18.71
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.02 | loss  2.76 | ppl    15.75
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.94s | valid loss  4.79 | valid ppl   120.35
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 48.72 | loss  2.88 | ppl    17.81
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 48.63 | loss  2.86 | ppl    17.38
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 48.58 | loss  2.84 | ppl    17.09
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 48.55 | loss  2.78 | ppl    16.09
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.16 | loss  2.84 | ppl    17.11
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.44 | loss  2.67 | ppl    14.49
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 66.33s | valid loss  4.81 | valid ppl   122.20
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 48.79 | loss  2.93 | ppl    18.80
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 48.39 | loss  2.91 | ppl    18.38
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 48.18 | loss  2.89 | ppl    17.96
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 48.14 | loss  2.83 | ppl    16.99
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.90 | loss  2.90 | ppl    18.10
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.46 | loss  2.74 | ppl    15.52
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.35s | valid loss  4.75 | valid ppl   115.06
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 48.41 | loss  2.86 | ppl    17.53
| epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 48.59 | loss  2.84 | ppl    17.08
| epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 48.40 | loss  2.82 | ppl    16.72
| epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 48.53 | loss  2.77 | ppl    15.89
| epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.23 | loss  2.84 | ppl    17.07
| epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.21 | loss  2.67 | ppl    14.38
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 66.23s | valid loss  4.76 | valid ppl   117.23
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 1.25 | ms/batch 48.95 | loss  3.50 | ppl    33.10
| epoch   8 |   400/ 1327 batches | lr 1.25 | ms/batch 47.87 | loss  3.46 | ppl    31.71
| epoch   8 |   600/ 1327 batches | lr 1.25 | ms/batch 48.27 | loss  3.43 | ppl    30.77
| epoch   8 |   800/ 1327 batches | lr 1.25 | ms/batch 48.34 | loss  3.35 | ppl    28.64
| epoch   8 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.34 | loss  3.43 | ppl    30.77
| epoch   8 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.96 | loss  3.26 | ppl    25.97
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 66.04s | valid loss  4.59 | valid ppl    98.67
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 1.25 | ms/batch 48.43 | loss  3.41 | ppl    30.33
| epoch   9 |   400/ 1327 batches | lr 1.25 | ms/batch 48.51 | loss  3.40 | ppl    29.88
| epoch   9 |   600/ 1327 batches | lr 1.25 | ms/batch 48.60 | loss  3.38 | ppl    29.36
| epoch   9 |   800/ 1327 batches | lr 1.25 | ms/batch 48.22 | loss  3.32 | ppl    27.66
| epoch   9 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.10 | loss  3.39 | ppl    29.75
| epoch   9 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.17 | loss  3.23 | ppl    25.37
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.18s | valid loss  4.58 | valid ppl    97.51
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 48.82 | loss  3.40 | ppl    29.93
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 48.54 | loss  3.38 | ppl    29.24
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 48.24 | loss  3.36 | ppl    28.88
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 48.26 | loss  3.29 | ppl    26.90
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.91 | loss  3.37 | ppl    29.20
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.25 | loss  3.22 | ppl    24.99
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.33s | valid loss  4.58 | valid ppl    97.21
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.5993333333333334
sparsity at layer rnn.weight_hh_l0 is 0.5993333333333334
sparsity at layer rnn.weight_ih_l1 is 0.5993333333333334
sparsity at layer rnn.weight_hh_l1 is 0.5993333333333334
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.4856834143706106
=========================================================================================
| End of training | test loss  4.52 | test ppl    92.23
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 10 --dropout 0.60 --save sp65_epoch10_dropout0.60_lstm.pt --pretrained sp60_epoch10_dropout0.60_lstm.pt
debug
{'rnn.weight_ih_l0': 0.65, 'rnn.weight_hh_l0': 0.65, 'rnn.weight_ih_l1': 0.65, 'rnn.weight_hh_l1': 0.65}
{'rnn.weight_ih_l0': 0.65, 'rnn.weight_hh_l0': 0.65, 'rnn.weight_ih_l1': 0.65, 'rnn.weight_hh_l1': 0.65}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 56.88 | loss  9.02 | ppl  8238.29
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 48.74 | loss  5.12 | ppl   166.82
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 48.59 | loss  3.94 | ppl    51.18
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 48.73 | loss  3.51 | ppl    33.48
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.98 | loss  3.46 | ppl    31.80
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 49.91 | loss  3.22 | ppl    25.10
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 68.95s | valid loss  4.64 | valid ppl   103.48
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 58.86 | loss  4.37 | ppl    79.30
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 51.57 | loss  3.48 | ppl    32.44
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 52.07 | loss  3.30 | ppl    27.24
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 52.01 | loss  3.22 | ppl    25.12
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.23 | loss  3.28 | ppl    26.69
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 53.15 | loss  3.08 | ppl    21.78
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 72.74s | valid loss  4.68 | valid ppl   107.89
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 60.29 | loss  3.32 | ppl    27.71
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 52.33 | loss  3.24 | ppl    25.56
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 52.57 | loss  3.23 | ppl    25.26
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 52.70 | loss  3.17 | ppl    23.81
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.47 | loss  3.24 | ppl    25.59
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.97 | loss  3.05 | ppl    21.06
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 73.75s | valid loss  4.69 | valid ppl   108.87
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 60.17 | loss  3.25 | ppl    25.78
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 53.16 | loss  3.19 | ppl    24.34
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 53.36 | loss  3.18 | ppl    24.07
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 53.11 | loss  3.13 | ppl    22.96
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 53.16 | loss  3.20 | ppl    24.63
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 53.82 | loss  3.01 | ppl    20.23
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 74.45s | valid loss  4.69 | valid ppl   109.27
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 2.50 | ms/batch 59.94 | loss  3.35 | ppl    28.49
| epoch   5 |   400/ 1327 batches | lr 2.50 | ms/batch 53.60 | loss  3.28 | ppl    26.55
| epoch   5 |   600/ 1327 batches | lr 2.50 | ms/batch 53.60 | loss  3.26 | ppl    26.12
| epoch   5 |   800/ 1327 batches | lr 2.50 | ms/batch 53.64 | loss  3.20 | ppl    24.54
| epoch   5 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.78 | loss  3.26 | ppl    26.01
| epoch   5 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.27 | loss  3.07 | ppl    21.57
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 75.02s | valid loss  4.63 | valid ppl   102.61
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 2.50 | ms/batch 60.82 | loss  3.27 | ppl    26.41
| epoch   6 |   400/ 1327 batches | lr 2.50 | ms/batch 54.00 | loss  3.24 | ppl    25.63
| epoch   6 |   600/ 1327 batches | lr 2.50 | ms/batch 54.12 | loss  3.23 | ppl    25.18
| epoch   6 |   800/ 1327 batches | lr 2.50 | ms/batch 54.89 | loss  3.16 | ppl    23.54
| epoch   6 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.86 | loss  3.23 | ppl    25.35
| epoch   6 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.86 | loss  3.05 | ppl    21.03
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 75.87s | valid loss  4.64 | valid ppl   103.31
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 60.83 | loss  3.24 | ppl    25.52
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 54.95 | loss  3.21 | ppl    24.75
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 54.47 | loss  3.19 | ppl    24.27
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 54.94 | loss  3.14 | ppl    23.05
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.84 | loss  3.21 | ppl    24.69
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.83 | loss  3.03 | ppl    20.61
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 76.23s | valid loss  4.64 | valid ppl   103.83
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 62.29 | loss  3.22 | ppl    25.14
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 55.08 | loss  3.19 | ppl    24.38
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 55.73 | loss  3.18 | ppl    24.02
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 55.59 | loss  3.13 | ppl    22.80
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.64 | loss  3.19 | ppl    24.35
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.53 | loss  3.01 | ppl    20.33
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 77.36s | valid loss  4.64 | valid ppl   103.58
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 62.91 | loss  3.19 | ppl    24.26
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 54.86 | loss  3.16 | ppl    23.61
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 55.59 | loss  3.15 | ppl    23.29
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 56.54 | loss  3.10 | ppl    22.10
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 56.09 | loss  3.17 | ppl    23.71
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 56.06 | loss  2.98 | ppl    19.66
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 77.88s | valid loss  4.65 | valid ppl   104.48
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 63.86 | loss  3.22 | ppl    25.09
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 56.03 | loss  3.19 | ppl    24.24
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 56.31 | loss  3.17 | ppl    23.81
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 56.92 | loss  3.10 | ppl    22.28
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.63 | loss  3.17 | ppl    23.76
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.40 | loss  2.99 | ppl    19.93
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 78.75s | valid loss  4.62 | valid ppl   101.83
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.6493333333333333
sparsity at layer rnn.weight_hh_l0 is 0.6493333333333333
sparsity at layer rnn.weight_ih_l1 is 0.6493333333333333
sparsity at layer rnn.weight_hh_l1 is 0.6493333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.5484234234234233
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 46.75 | loss  1.57 | ppl     4.81
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 47.60 | loss  1.60 | ppl     4.94
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 47.66 | loss  1.62 | ppl     5.07
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 47.72 | loss  1.62 | ppl     5.03
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.20 | loss  1.69 | ppl     5.43
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.48 | loss  1.58 | ppl     4.87
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 65.46s | valid loss  5.39 | valid ppl   219.77
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 48.42 | loss  1.65 | ppl     5.18
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 48.24 | loss  1.66 | ppl     5.27
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 48.08 | loss  1.66 | ppl     5.24
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 48.18 | loss  1.64 | ppl     5.15
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.61 | loss  1.70 | ppl     5.50
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.28 | loss  1.60 | ppl     4.94
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 66.18s | valid loss  5.40 | valid ppl   220.70
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 48.65 | loss  1.66 | ppl     5.26
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 48.49 | loss  1.65 | ppl     5.22
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 48.46 | loss  1.66 | ppl     5.24
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 48.47 | loss  1.64 | ppl     5.16
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.22 | loss  1.69 | ppl     5.42
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.00 | loss  1.57 | ppl     4.81
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 66.23s | valid loss  5.41 | valid ppl   224.15
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 48.54 | loss  3.11 | ppl    22.46
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 48.05 | loss  2.99 | ppl    19.85
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 48.08 | loss  2.93 | ppl    18.66
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 48.10 | loss  2.84 | ppl    17.20
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.08 | loss  2.89 | ppl    17.91
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.16 | loss  2.71 | ppl    15.06
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 65.84s | valid loss  4.88 | valid ppl   130.99
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 48.31 | loss  2.83 | ppl    16.92
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 47.95 | loss  2.80 | ppl    16.49
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 48.40 | loss  2.78 | ppl    16.17
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 48.69 | loss  2.73 | ppl    15.26
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.31 | loss  2.79 | ppl    16.30
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.38 | loss  2.62 | ppl    13.79
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 66.12s | valid loss  4.87 | valid ppl   130.73
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 48.43 | loss  2.85 | ppl    17.34
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 48.58 | loss  2.83 | ppl    16.95
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 48.57 | loss  2.81 | ppl    16.57
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 48.42 | loss  2.75 | ppl    15.71
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.24 | loss  2.82 | ppl    16.74
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.38 | loss  2.66 | ppl    14.36
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.28s | valid loss  4.83 | valid ppl   124.76
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 48.62 | loss  2.79 | ppl    16.20
| epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 48.24 | loss  2.76 | ppl    15.81
| epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 48.09 | loss  2.74 | ppl    15.48
| epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 48.20 | loss  2.69 | ppl    14.78
| epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.10 | loss  2.76 | ppl    15.82
| epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.83 | loss  2.59 | ppl    13.37
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 66.16s | valid loss  4.84 | valid ppl   126.56
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch 48.77 | loss  3.48 | ppl    32.31
| epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch 48.31 | loss  3.43 | ppl    30.88
| epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch 48.06 | loss  3.41 | ppl    30.36
| epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch 48.02 | loss  3.34 | ppl    28.34
| epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch 47.67 | loss  3.43 | ppl    30.90
| epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.47 | loss  3.26 | ppl    26.13
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 66.01s | valid loss  4.61 | valid ppl   100.66
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 5.00 | ms/batch 48.36 | loss  3.38 | ppl    29.47
| epoch   9 |   400/ 1327 batches | lr 5.00 | ms/batch 48.55 | loss  3.37 | ppl    29.16
| epoch   9 |   600/ 1327 batches | lr 5.00 | ms/batch 47.92 | loss  3.36 | ppl    28.82
| epoch   9 |   800/ 1327 batches | lr 5.00 | ms/batch 47.98 | loss  3.31 | ppl    27.25
| epoch   9 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.64 | loss  3.39 | ppl    29.53
| epoch   9 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.34 | loss  3.23 | ppl    25.25
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.13s | valid loss  4.60 | valid ppl    99.88
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 5.00 | ms/batch 48.42 | loss  3.36 | ppl    28.83
| epoch  10 |   400/ 1327 batches | lr 5.00 | ms/batch 48.33 | loss  3.35 | ppl    28.37
| epoch  10 |   600/ 1327 batches | lr 5.00 | ms/batch 48.41 | loss  3.34 | ppl    28.15
| epoch  10 |   800/ 1327 batches | lr 5.00 | ms/batch 48.20 | loss  3.27 | ppl    26.29
| epoch  10 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.16 | loss  3.36 | ppl    28.78
| epoch  10 |  1200/ 1327 batches | lr 5.00 | ms/batch 47.97 | loss  3.20 | ppl    24.62
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 65.95s | valid loss  4.60 | valid ppl    99.96
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.6493333333333333
sparsity at layer rnn.weight_hh_l0 is 0.6493333333333333
sparsity at layer rnn.weight_ih_l1 is 0.6493333333333333
sparsity at layer rnn.weight_hh_l1 is 0.6493333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.5484234234234233
=========================================================================================
| End of training | test loss  4.55 | test ppl    94.89
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 20 --dropout 0.55 --save sp70_epoch20_dropout0.55_lstm.pt --pretrained sp65_epoch10_dropout0.60_lstm.pt
debug
{'rnn.weight_ih_l0': 0.7, 'rnn.weight_hh_l0': 0.7, 'rnn.weight_ih_l1': 0.7, 'rnn.weight_hh_l1': 0.7}
{'rnn.weight_ih_l0': 0.7, 'rnn.weight_hh_l0': 0.7, 'rnn.weight_ih_l1': 0.7, 'rnn.weight_hh_l1': 0.7}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 56.34 | loss 13.60 | ppl 808531.14
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 49.09 | loss  6.65 | ppl   769.44
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 48.66 | loss  4.44 | ppl    85.07
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 48.58 | loss  3.69 | ppl    40.09
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.58 | loss  3.53 | ppl    34.09
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 49.71 | loss  3.25 | ppl    25.86
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 68.80s | valid loss  4.65 | valid ppl   104.22
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 58.16 | loss  5.11 | ppl   165.74
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 51.68 | loss  3.60 | ppl    36.68
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 51.63 | loss  3.31 | ppl    27.41
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 52.03 | loss  3.21 | ppl    24.75
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.33 | loss  3.26 | ppl    25.97
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.21 | loss  3.05 | ppl    21.02
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 72.50s | valid loss  4.71 | valid ppl   110.66
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 58.74 | loss  3.31 | ppl    27.43
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 52.61 | loss  3.22 | ppl    24.92
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 52.88 | loss  3.20 | ppl    24.52
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 52.77 | loss  3.14 | ppl    23.19
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.93 | loss  3.21 | ppl    24.81
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.81 | loss  3.01 | ppl    20.30
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 73.65s | valid loss  4.72 | valid ppl   111.87
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 59.89 | loss  3.23 | ppl    25.40
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 52.85 | loss  3.17 | ppl    23.83
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 53.11 | loss  3.15 | ppl    23.45
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 53.49 | loss  3.11 | ppl    22.36
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 53.42 | loss  3.18 | ppl    24.03
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 53.14 | loss  2.98 | ppl    19.72
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 74.11s | valid loss  4.72 | valid ppl   112.13
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 2.50 | ms/batch 59.68 | loss  3.36 | ppl    28.70
| epoch   5 |   400/ 1327 batches | lr 2.50 | ms/batch 54.11 | loss  3.28 | ppl    26.51
| epoch   5 |   600/ 1327 batches | lr 2.50 | ms/batch 54.00 | loss  3.25 | ppl    25.86
| epoch   5 |   800/ 1327 batches | lr 2.50 | ms/batch 53.51 | loss  3.20 | ppl    24.44
| epoch   5 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.20 | loss  3.26 | ppl    25.95
| epoch   5 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.97 | loss  3.07 | ppl    21.49
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 75.09s | valid loss  4.65 | valid ppl   104.76
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 2.50 | ms/batch 60.79 | loss  3.27 | ppl    26.42
| epoch   6 |   400/ 1327 batches | lr 2.50 | ms/batch 53.79 | loss  3.24 | ppl    25.59
| epoch   6 |   600/ 1327 batches | lr 2.50 | ms/batch 54.52 | loss  3.22 | ppl    25.03
| epoch   6 |   800/ 1327 batches | lr 2.50 | ms/batch 54.39 | loss  3.16 | ppl    23.49
| epoch   6 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.34 | loss  3.23 | ppl    25.36
| epoch   6 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.42 | loss  3.04 | ppl    20.99
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 75.68s | valid loss  4.66 | valid ppl   105.46
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 61.60 | loss  3.24 | ppl    25.59
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 54.06 | loss  3.21 | ppl    24.79
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 53.91 | loss  3.19 | ppl    24.28
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 54.99 | loss  3.14 | ppl    23.03
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.08 | loss  3.21 | ppl    24.72
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.83 | loss  3.03 | ppl    20.62
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 76.15s | valid loss  4.66 | valid ppl   105.56
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 62.40 | loss  3.22 | ppl    25.14
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 54.83 | loss  3.19 | ppl    24.36
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 55.53 | loss  3.18 | ppl    23.99
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 55.66 | loss  3.13 | ppl    22.80
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.55 | loss  3.20 | ppl    24.46
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.16 | loss  3.01 | ppl    20.36
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 77.16s | valid loss  4.66 | valid ppl   105.51
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 62.92 | loss  3.19 | ppl    24.33
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 54.71 | loss  3.17 | ppl    23.72
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 56.48 | loss  3.15 | ppl    23.42
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 56.29 | loss  3.10 | ppl    22.24
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 56.09 | loss  3.17 | ppl    23.85
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 56.14 | loss  2.98 | ppl    19.71
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 78.02s | valid loss  4.66 | valid ppl   106.06
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 62.94 | loss  3.24 | ppl    25.62
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 55.80 | loss  3.21 | ppl    24.84
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 56.78 | loss  3.19 | ppl    24.27
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 56.50 | loss  3.12 | ppl    22.72
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.63 | loss  3.19 | ppl    24.28
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.56 | loss  3.01 | ppl    20.36
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 78.48s | valid loss  4.64 | valid ppl   103.07
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 63.81 | loss  1.65 | ppl     5.20
| epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 56.44 | loss  1.67 | ppl     5.33
| epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 56.61 | loss  1.66 | ppl     5.28
| epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 56.28 | loss  1.63 | ppl     5.12
| epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.27 | loss  1.67 | ppl     5.31
| epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.31 | loss  1.53 | ppl     4.63
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 79.05s | valid loss  5.12 | valid ppl   167.90
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 64.35 | loss  1.63 | ppl     5.08
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 57.39 | loss  1.61 | ppl     5.00
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 57.63 | loss  1.58 | ppl     4.85
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 57.64 | loss  1.54 | ppl     4.66
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.87 | loss  1.57 | ppl     4.79
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.66 | loss  1.43 | ppl     4.19
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 80.10s | valid loss  5.21 | valid ppl   183.10
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 65.04 | loss  1.51 | ppl     4.52
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 57.69 | loss  1.47 | ppl     4.35
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 57.65 | loss  1.44 | ppl     4.22
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 58.84 | loss  1.40 | ppl     4.05
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.69 | loss  1.41 | ppl     4.10
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.05 | loss  1.27 | ppl     3.55
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 80.96s | valid loss  5.30 | valid ppl   200.34
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 0.62 | ms/batch 65.04 | loss  2.76 | ppl    15.72
| epoch  14 |   400/ 1327 batches | lr 0.62 | ms/batch 58.31 | loss  2.67 | ppl    14.51
| epoch  14 |   600/ 1327 batches | lr 0.62 | ms/batch 58.48 | loss  2.62 | ppl    13.70
| epoch  14 |   800/ 1327 batches | lr 0.62 | ms/batch 58.56 | loss  2.54 | ppl    12.71
| epoch  14 |  1000/ 1327 batches | lr 0.62 | ms/batch 58.36 | loss  2.58 | ppl    13.21
| epoch  14 |  1200/ 1327 batches | lr 0.62 | ms/batch 58.42 | loss  2.41 | ppl    11.10
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 81.30s | valid loss  4.97 | valid ppl   143.87
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 0.62 | ms/batch 64.96 | loss  2.55 | ppl    12.80
| epoch  15 |   400/ 1327 batches | lr 0.62 | ms/batch 58.66 | loss  2.53 | ppl    12.62
| epoch  15 |   600/ 1327 batches | lr 0.62 | ms/batch 58.97 | loss  2.51 | ppl    12.28
| epoch  15 |   800/ 1327 batches | lr 0.62 | ms/batch 58.54 | loss  2.45 | ppl    11.59
| epoch  15 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.16 | loss  2.51 | ppl    12.29
| epoch  15 |  1200/ 1327 batches | lr 0.62 | ms/batch 59.16 | loss  2.34 | ppl    10.36
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 81.67s | valid loss  4.95 | valid ppl   140.88
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 0.62 | ms/batch 66.54 | loss  2.57 | ppl    13.05
| epoch  16 |   400/ 1327 batches | lr 0.62 | ms/batch 59.37 | loss  2.55 | ppl    12.86
| epoch  16 |   600/ 1327 batches | lr 0.62 | ms/batch 59.63 | loss  2.52 | ppl    12.48
| epoch  16 |   800/ 1327 batches | lr 0.62 | ms/batch 59.54 | loss  2.47 | ppl    11.83
| epoch  16 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.94 | loss  2.53 | ppl    12.51
| epoch  16 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.07 | loss  2.37 | ppl    10.65
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 82.88s | valid loss  4.91 | valid ppl   136.04
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 0.62 | ms/batch 66.52 | loss  2.51 | ppl    12.36
| epoch  17 |   400/ 1327 batches | lr 0.62 | ms/batch 59.24 | loss  2.50 | ppl    12.15
| epoch  17 |   600/ 1327 batches | lr 0.62 | ms/batch 59.50 | loss  2.47 | ppl    11.79
| epoch  17 |   800/ 1327 batches | lr 0.62 | ms/batch 60.35 | loss  2.42 | ppl    11.23
| epoch  17 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.31 | loss  2.48 | ppl    11.96
| epoch  17 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.19 | loss  2.31 | ppl    10.03
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 83.27s | valid loss  4.92 | valid ppl   136.81
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.62 | ms/batch 67.91 | loss  3.08 | ppl    21.71
| epoch  18 |   400/ 1327 batches | lr 0.62 | ms/batch 60.83 | loss  3.05 | ppl    21.12
| epoch  18 |   600/ 1327 batches | lr 0.62 | ms/batch 63.32 | loss  3.03 | ppl    20.62
| epoch  18 |   800/ 1327 batches | lr 0.62 | ms/batch 60.49 | loss  2.96 | ppl    19.24
| epoch  18 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.42 | loss  3.03 | ppl    20.80
| epoch  18 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.61 | loss  2.86 | ppl    17.41
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 84.74s | valid loss  4.78 | valid ppl   118.84
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.62 | ms/batch 67.65 | loss  3.02 | ppl    20.41
| epoch  19 |   400/ 1327 batches | lr 0.62 | ms/batch 60.40 | loss  3.00 | ppl    20.15
| epoch  19 |   600/ 1327 batches | lr 0.62 | ms/batch 60.42 | loss  2.99 | ppl    19.80
| epoch  19 |   800/ 1327 batches | lr 0.62 | ms/batch 61.25 | loss  2.92 | ppl    18.62
| epoch  19 |  1000/ 1327 batches | lr 0.62 | ms/batch 61.17 | loss  2.99 | ppl    19.94
| epoch  19 |  1200/ 1327 batches | lr 0.62 | ms/batch 61.02 | loss  2.83 | ppl    16.92
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 84.57s | valid loss  4.76 | valid ppl   117.05
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.62 | ms/batch 67.92 | loss  3.41 | ppl    30.40
| epoch  20 |   400/ 1327 batches | lr 0.62 | ms/batch 61.25 | loss  3.39 | ppl    29.56
| epoch  20 |   600/ 1327 batches | lr 0.62 | ms/batch 61.29 | loss  3.37 | ppl    29.05
| epoch  20 |   800/ 1327 batches | lr 0.62 | ms/batch 61.43 | loss  3.30 | ppl    27.02
| epoch  20 |  1000/ 1327 batches | lr 0.62 | ms/batch 61.99 | loss  3.37 | ppl    29.17
| epoch  20 |  1200/ 1327 batches | lr 0.62 | ms/batch 62.22 | loss  3.21 | ppl    24.69
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 85.54s | valid loss  4.66 | valid ppl   105.43
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.6993333333333334
sparsity at layer rnn.weight_hh_l0 is 0.6993333333333334
sparsity at layer rnn.weight_ih_l1 is 0.6993333333333334
sparsity at layer rnn.weight_hh_l1 is 0.6993333333333334
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.6166960611405057
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 46.22 | loss  3.60 | ppl    36.55
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 46.96 | loss  3.63 | ppl    37.84
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 47.73 | loss  3.65 | ppl    38.35
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 47.79 | loss  3.60 | ppl    36.77
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 47.60 | loss  3.71 | ppl    40.74
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 47.61 | loss  3.56 | ppl    35.06
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 64.85s | valid loss  4.53 | valid ppl    92.45
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 48.60 | loss  3.64 | ppl    37.94
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 48.38 | loss  3.63 | ppl    37.74
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 48.25 | loss  3.64 | ppl    37.93
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 48.03 | loss  3.59 | ppl    36.36
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 47.98 | loss  3.68 | ppl    39.78
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.21 | loss  3.53 | ppl    34.24
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 65.99s | valid loss  4.52 | valid ppl    92.14
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 48.36 | loss  3.64 | ppl    37.95
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 48.28 | loss  3.63 | ppl    37.84
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 48.31 | loss  3.64 | ppl    37.92
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 48.35 | loss  3.59 | ppl    36.41
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.14 | loss  3.68 | ppl    39.58
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 47.95 | loss  3.53 | ppl    34.22
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 66.03s | valid loss  4.53 | valid ppl    92.39
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 48.93 | loss  3.62 | ppl    37.31
| epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 48.30 | loss  3.62 | ppl    37.17
| epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 48.29 | loss  3.61 | ppl    37.02
| epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 48.10 | loss  3.56 | ppl    35.32
| epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.25 | loss  3.66 | ppl    38.96
| epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.19 | loss  3.50 | ppl    33.15
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 66.12s | valid loss  4.52 | valid ppl    92.28
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 48.37 | loss  3.59 | ppl    36.07
| epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 48.15 | loss  3.59 | ppl    36.17
| epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 48.25 | loss  3.59 | ppl    36.07
| epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 48.11 | loss  3.54 | ppl    34.52
| epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.20 | loss  3.63 | ppl    37.78
| epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.06 | loss  3.48 | ppl    32.52
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.87s | valid loss  4.52 | valid ppl    91.79
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 48.24 | loss  3.57 | ppl    35.65
| epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 48.48 | loss  3.58 | ppl    35.78
| epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 48.22 | loss  3.57 | ppl    35.58
| epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 48.15 | loss  3.52 | ppl    33.70
| epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 47.82 | loss  3.61 | ppl    37.10
| epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.38 | loss  3.46 | ppl    31.81
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.00s | valid loss  4.54 | valid ppl    93.24
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 48.89 | loss  3.53 | ppl    34.25
| epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 48.62 | loss  3.49 | ppl    32.79
| epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 48.19 | loss  3.46 | ppl    31.89
| epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 48.26 | loss  3.39 | ppl    29.52
| epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.18 | loss  3.46 | ppl    31.69
| epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.23 | loss  3.28 | ppl    26.52
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 66.21s | valid loss  4.55 | valid ppl    94.57
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch 48.24 | loss  3.45 | ppl    31.41
| epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch 48.05 | loss  3.43 | ppl    30.80
| epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch 47.80 | loss  3.41 | ppl    30.17
| epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch 47.49 | loss  3.35 | ppl    28.45
| epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch 47.41 | loss  3.42 | ppl    30.66
| epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.22 | loss  3.25 | ppl    25.81
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.54s | valid loss  4.56 | valid ppl    95.44
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 1.25 | ms/batch 48.65 | loss  3.44 | ppl    31.09
| epoch   9 |   400/ 1327 batches | lr 1.25 | ms/batch 48.03 | loss  3.42 | ppl    30.43
| epoch   9 |   600/ 1327 batches | lr 1.25 | ms/batch 48.50 | loss  3.39 | ppl    29.68
| epoch   9 |   800/ 1327 batches | lr 1.25 | ms/batch 48.25 | loss  3.32 | ppl    27.62
| epoch   9 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.31 | loss  3.39 | ppl    29.71
| epoch   9 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.26 | loss  3.21 | ppl    24.80
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.15s | valid loss  4.54 | valid ppl    93.53
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 48.46 | loss  3.41 | ppl    30.24
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 48.12 | loss  3.39 | ppl    29.80
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 48.25 | loss  3.37 | ppl    29.01
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 48.06 | loss  3.31 | ppl    27.40
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.14 | loss  3.38 | ppl    29.27
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.38 | loss  3.21 | ppl    24.76
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.00s | valid loss  4.54 | valid ppl    93.61
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 48.62 | loss  3.40 | ppl    29.88
| epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 48.34 | loss  3.38 | ppl    29.38
| epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 48.33 | loss  3.36 | ppl    28.70
| epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 47.99 | loss  3.30 | ppl    27.05
| epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.44 | loss  3.37 | ppl    29.11
| epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.34 | loss  3.21 | ppl    24.71
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.15s | valid loss  4.54 | valid ppl    93.81
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 0.31 | ms/batch 48.82 | loss  3.40 | ppl    29.99
| epoch  12 |   400/ 1327 batches | lr 0.31 | ms/batch 47.95 | loss  3.39 | ppl    29.79
| epoch  12 |   600/ 1327 batches | lr 0.31 | ms/batch 48.03 | loss  3.38 | ppl    29.24
| epoch  12 |   800/ 1327 batches | lr 0.31 | ms/batch 48.07 | loss  3.30 | ppl    27.09
| epoch  12 |  1000/ 1327 batches | lr 0.31 | ms/batch 48.05 | loss  3.37 | ppl    29.14
| epoch  12 |  1200/ 1327 batches | lr 0.31 | ms/batch 48.29 | loss  3.20 | ppl    24.54
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.96s | valid loss  4.52 | valid ppl    92.00
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 0.31 | ms/batch 48.30 | loss  3.39 | ppl    29.78
| epoch  13 |   400/ 1327 batches | lr 0.31 | ms/batch 48.18 | loss  3.38 | ppl    29.28
| epoch  13 |   600/ 1327 batches | lr 0.31 | ms/batch 48.13 | loss  3.36 | ppl    28.65
| epoch  13 |   800/ 1327 batches | lr 0.31 | ms/batch 48.00 | loss  3.29 | ppl    26.83
| epoch  13 |  1000/ 1327 batches | lr 0.31 | ms/batch 47.58 | loss  3.37 | ppl    29.00
| epoch  13 |  1200/ 1327 batches | lr 0.31 | ms/batch 48.18 | loss  3.19 | ppl    24.31
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 65.80s | valid loss  4.52 | valid ppl    91.90
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 0.31 | ms/batch 48.52 | loss  3.39 | ppl    29.71
| epoch  14 |   400/ 1327 batches | lr 0.31 | ms/batch 48.24 | loss  3.38 | ppl    29.25
| epoch  14 |   600/ 1327 batches | lr 0.31 | ms/batch 48.11 | loss  3.35 | ppl    28.59
| epoch  14 |   800/ 1327 batches | lr 0.31 | ms/batch 48.24 | loss  3.29 | ppl    26.79
| epoch  14 |  1000/ 1327 batches | lr 0.31 | ms/batch 48.43 | loss  3.36 | ppl    28.93
| epoch  14 |  1200/ 1327 batches | lr 0.31 | ms/batch 48.23 | loss  3.19 | ppl    24.24
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 66.07s | valid loss  4.52 | valid ppl    91.84
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 0.31 | ms/batch 48.25 | loss  3.38 | ppl    29.52
| epoch  15 |   400/ 1327 batches | lr 0.31 | ms/batch 47.79 | loss  3.37 | ppl    29.12
| epoch  15 |   600/ 1327 batches | lr 0.31 | ms/batch 47.80 | loss  3.35 | ppl    28.63
| epoch  15 |   800/ 1327 batches | lr 0.31 | ms/batch 47.76 | loss  3.29 | ppl    26.77
| epoch  15 |  1000/ 1327 batches | lr 0.31 | ms/batch 47.72 | loss  3.36 | ppl    28.72
| epoch  15 |  1200/ 1327 batches | lr 0.31 | ms/batch 47.49 | loss  3.19 | ppl    24.33
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.35s | valid loss  4.52 | valid ppl    91.96
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 0.31 | ms/batch 49.22 | loss  3.39 | ppl    29.67
| epoch  16 |   400/ 1327 batches | lr 0.31 | ms/batch 48.87 | loss  3.36 | ppl    28.88
| epoch  16 |   600/ 1327 batches | lr 0.31 | ms/batch 48.21 | loss  3.35 | ppl    28.36
| epoch  16 |   800/ 1327 batches | lr 0.31 | ms/batch 48.15 | loss  3.28 | ppl    26.53
| epoch  16 |  1000/ 1327 batches | lr 0.31 | ms/batch 48.12 | loss  3.35 | ppl    28.57
| epoch  16 |  1200/ 1327 batches | lr 0.31 | ms/batch 48.25 | loss  3.19 | ppl    24.30
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 66.27s | valid loss  4.52 | valid ppl    92.00
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 0.08 | ms/batch 49.11 | loss  3.38 | ppl    29.49
| epoch  17 |   400/ 1327 batches | lr 0.08 | ms/batch 48.47 | loss  3.37 | ppl    29.07
| epoch  17 |   600/ 1327 batches | lr 0.08 | ms/batch 48.24 | loss  3.36 | ppl    28.69
| epoch  17 |   800/ 1327 batches | lr 0.08 | ms/batch 48.07 | loss  3.28 | ppl    26.67
| epoch  17 |  1000/ 1327 batches | lr 0.08 | ms/batch 48.29 | loss  3.36 | ppl    28.78
| epoch  17 |  1200/ 1327 batches | lr 0.08 | ms/batch 48.17 | loss  3.19 | ppl    24.23
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 66.24s | valid loss  4.52 | valid ppl    91.59
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.08 | ms/batch 48.38 | loss  3.38 | ppl    29.43
| epoch  18 |   400/ 1327 batches | lr 0.08 | ms/batch 48.19 | loss  3.37 | ppl    29.15
| epoch  18 |   600/ 1327 batches | lr 0.08 | ms/batch 48.10 | loss  3.35 | ppl    28.52
| epoch  18 |   800/ 1327 batches | lr 0.08 | ms/batch 47.62 | loss  3.28 | ppl    26.55
| epoch  18 |  1000/ 1327 batches | lr 0.08 | ms/batch 47.89 | loss  3.36 | ppl    28.66
| epoch  18 |  1200/ 1327 batches | lr 0.08 | ms/batch 48.07 | loss  3.19 | ppl    24.19
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 65.84s | valid loss  4.52 | valid ppl    91.43
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.08 | ms/batch 48.43 | loss  3.39 | ppl    29.54
| epoch  19 |   400/ 1327 batches | lr 0.08 | ms/batch 48.14 | loss  3.37 | ppl    29.21
| epoch  19 |   600/ 1327 batches | lr 0.08 | ms/batch 48.16 | loss  3.35 | ppl    28.44
| epoch  19 |   800/ 1327 batches | lr 0.08 | ms/batch 48.09 | loss  3.29 | ppl    26.78
| epoch  19 |  1000/ 1327 batches | lr 0.08 | ms/batch 47.79 | loss  3.36 | ppl    28.68
| epoch  19 |  1200/ 1327 batches | lr 0.08 | ms/batch 48.57 | loss  3.19 | ppl    24.28
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.99s | valid loss  4.51 | valid ppl    91.35
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.08 | ms/batch 48.24 | loss  3.38 | ppl    29.36
| epoch  20 |   400/ 1327 batches | lr 0.08 | ms/batch 48.10 | loss  3.36 | ppl    28.90
| epoch  20 |   600/ 1327 batches | lr 0.08 | ms/batch 48.32 | loss  3.36 | ppl    28.67
| epoch  20 |   800/ 1327 batches | lr 0.08 | ms/batch 47.95 | loss  3.28 | ppl    26.55
| epoch  20 |  1000/ 1327 batches | lr 0.08 | ms/batch 47.71 | loss  3.36 | ppl    28.75
| epoch  20 |  1200/ 1327 batches | lr 0.08 | ms/batch 47.94 | loss  3.19 | ppl    24.28
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 65.83s | valid loss  4.51 | valid ppl    91.30
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.6993333333333334
sparsity at layer rnn.weight_hh_l0 is 0.6993333333333334
sparsity at layer rnn.weight_ih_l1 is 0.6993333333333334
sparsity at layer rnn.weight_hh_l1 is 0.6993333333333334
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.6166960611405057
=========================================================================================
| End of training | test loss  4.47 | test ppl    87.17
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 20 --dropout 0.55 --save sp72_epoch20_dropout0.55_lstm.pt --pretrained sp70_epoch20_dropout0.55_lstm.pt
debug
{'rnn.weight_ih_l0': 0.72, 'rnn.weight_hh_l0': 0.72, 'rnn.weight_ih_l1': 0.72, 'rnn.weight_hh_l1': 0.72}
{'rnn.weight_ih_l0': 0.72, 'rnn.weight_hh_l0': 0.72, 'rnn.weight_ih_l1': 0.72, 'rnn.weight_hh_l1': 0.72}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 56.26 | loss  4.82 | ppl   123.78
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 49.27 | loss  3.56 | ppl    35.18
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 48.55 | loss  3.24 | ppl    25.58
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 49.58 | loss  3.10 | ppl    22.15
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 49.58 | loss  3.14 | ppl    23.07
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 49.94 | loss  2.93 | ppl    18.77
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 69.18s | valid loss  4.68 | valid ppl   107.54
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 58.15 | loss  3.49 | ppl    32.93
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 51.65 | loss  3.13 | ppl    22.99
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 51.73 | loss  3.07 | ppl    21.49
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 52.48 | loss  3.00 | ppl    20.17
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.29 | loss  3.07 | ppl    21.49
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.92 | loss  2.87 | ppl    17.58
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 72.55s | valid loss  4.71 | valid ppl   110.67
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 59.13 | loss  3.11 | ppl    22.50
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 52.64 | loss  3.04 | ppl    20.95
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 52.78 | loss  3.03 | ppl    20.64
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 52.90 | loss  2.97 | ppl    19.44
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 53.04 | loss  3.04 | ppl    20.84
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 53.06 | loss  2.85 | ppl    17.21
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 73.71s | valid loss  4.72 | valid ppl   111.70
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 60.11 | loss  3.07 | ppl    21.45
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 52.63 | loss  3.00 | ppl    20.18
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 53.10 | loss  2.99 | ppl    19.90
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 53.27 | loss  2.94 | ppl    18.88
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 53.21 | loss  3.01 | ppl    20.25
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 53.57 | loss  2.82 | ppl    16.75
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 74.25s | valid loss  4.72 | valid ppl   112.06
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 2.50 | ms/batch 60.81 | loss  3.16 | ppl    23.60
| epoch   5 |   400/ 1327 batches | lr 2.50 | ms/batch 53.52 | loss  3.09 | ppl    21.96
| epoch   5 |   600/ 1327 batches | lr 2.50 | ms/batch 53.11 | loss  3.06 | ppl    21.37
| epoch   5 |   800/ 1327 batches | lr 2.50 | ms/batch 54.49 | loss  3.01 | ppl    20.19
| epoch   5 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.15 | loss  3.07 | ppl    21.44
| epoch   5 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.52 | loss  2.88 | ppl    17.83
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 75.06s | valid loss  4.67 | valid ppl   106.95
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 2.50 | ms/batch 61.24 | loss  3.10 | ppl    22.14
| epoch   6 |   400/ 1327 batches | lr 2.50 | ms/batch 54.24 | loss  3.06 | ppl    21.41
| epoch   6 |   600/ 1327 batches | lr 2.50 | ms/batch 54.58 | loss  3.04 | ppl    20.84
| epoch   6 |   800/ 1327 batches | lr 2.50 | ms/batch 54.72 | loss  2.98 | ppl    19.69
| epoch   6 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.31 | loss  3.05 | ppl    21.04
| epoch   6 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.30 | loss  2.87 | ppl    17.56
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 76.02s | valid loss  4.68 | valid ppl   107.75
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 61.73 | loss  3.07 | ppl    21.53
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 54.19 | loss  3.04 | ppl    20.84
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 54.56 | loss  3.01 | ppl    20.39
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 54.52 | loss  2.96 | ppl    19.38
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.71 | loss  3.03 | ppl    20.73
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.83 | loss  2.85 | ppl    17.32
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 76.23s | valid loss  4.68 | valid ppl   108.19
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 62.59 | loss  3.06 | ppl    21.26
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 55.48 | loss  3.03 | ppl    20.69
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 55.48 | loss  3.01 | ppl    20.31
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 55.46 | loss  2.95 | ppl    19.17
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.43 | loss  3.02 | ppl    20.56
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.54 | loss  2.84 | ppl    17.19
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 77.45s | valid loss  4.68 | valid ppl   108.05
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 61.92 | loss  3.04 | ppl    20.81
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 55.45 | loss  3.01 | ppl    20.23
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 55.97 | loss  2.99 | ppl    19.91
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 56.08 | loss  2.94 | ppl    18.89
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.98 | loss  3.01 | ppl    20.25
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 56.66 | loss  2.82 | ppl    16.77
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 78.02s | valid loss  4.69 | valid ppl   108.70
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 63.28 | loss  3.08 | ppl    21.85
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 56.40 | loss  3.05 | ppl    21.21
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 56.24 | loss  3.03 | ppl    20.68
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 56.39 | loss  2.96 | ppl    19.34
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.69 | loss  3.03 | ppl    20.66
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.64 | loss  2.85 | ppl    17.34
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 78.74s | valid loss  4.66 | valid ppl   105.47
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 63.50 | loss  2.14 | ppl     8.46
| epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 57.04 | loss  2.16 | ppl     8.67
| epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 56.93 | loss  2.16 | ppl     8.68
| epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 56.56 | loss  2.12 | ppl     8.36
| epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.15 | loss  2.17 | ppl     8.78
| epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.16 | loss  2.02 | ppl     7.57
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 79.20s | valid loss  4.92 | valid ppl   137.63
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 62.03 | loss  2.19 | ppl     8.92
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 57.18 | loss  2.18 | ppl     8.80
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 57.58 | loss  2.15 | ppl     8.60
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 57.85 | loss  2.11 | ppl     8.25
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.79 | loss  2.16 | ppl     8.69
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.76 | loss  2.02 | ppl     7.52
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 79.67s | valid loss  4.96 | valid ppl   142.51
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 65.43 | loss  2.17 | ppl     8.76
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 57.91 | loss  2.15 | ppl     8.56
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 57.30 | loss  2.13 | ppl     8.43
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 58.21 | loss  2.09 | ppl     8.07
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.72 | loss  2.13 | ppl     8.42
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.61 | loss  1.98 | ppl     7.23
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 81.04s | valid loss  4.99 | valid ppl   146.34
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 0.62 | ms/batch 65.11 | loss  2.86 | ppl    17.53
| epoch  14 |   400/ 1327 batches | lr 0.62 | ms/batch 58.02 | loss  2.81 | ppl    16.63
| epoch  14 |   600/ 1327 batches | lr 0.62 | ms/batch 58.09 | loss  2.77 | ppl    16.03
| epoch  14 |   800/ 1327 batches | lr 0.62 | ms/batch 59.16 | loss  2.71 | ppl    15.00
| epoch  14 |  1000/ 1327 batches | lr 0.62 | ms/batch 58.72 | loss  2.76 | ppl    15.73
| epoch  14 |  1200/ 1327 batches | lr 0.62 | ms/batch 58.68 | loss  2.58 | ppl    13.26
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 81.30s | valid loss  4.80 | valid ppl   121.92
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 0.62 | ms/batch 65.53 | loss  2.76 | ppl    15.85
| epoch  15 |   400/ 1327 batches | lr 0.62 | ms/batch 59.12 | loss  2.75 | ppl    15.57
| epoch  15 |   600/ 1327 batches | lr 0.62 | ms/batch 58.89 | loss  2.73 | ppl    15.26
| epoch  15 |   800/ 1327 batches | lr 0.62 | ms/batch 58.33 | loss  2.66 | ppl    14.30
| epoch  15 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.09 | loss  2.72 | ppl    15.23
| epoch  15 |  1200/ 1327 batches | lr 0.62 | ms/batch 59.90 | loss  2.55 | ppl    12.85
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 82.04s | valid loss  4.79 | valid ppl   119.80
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 0.62 | ms/batch 66.67 | loss  2.78 | ppl    16.10
| epoch  16 |   400/ 1327 batches | lr 0.62 | ms/batch 59.40 | loss  2.77 | ppl    15.89
| epoch  16 |   600/ 1327 batches | lr 0.62 | ms/batch 59.93 | loss  2.74 | ppl    15.50
| epoch  16 |   800/ 1327 batches | lr 0.62 | ms/batch 59.87 | loss  2.68 | ppl    14.61
| epoch  16 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.84 | loss  2.74 | ppl    15.53
| epoch  16 |  1200/ 1327 batches | lr 0.62 | ms/batch 59.78 | loss  2.57 | ppl    13.11
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 83.25s | valid loss  4.76 | valid ppl   117.08
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 0.62 | ms/batch 66.59 | loss  2.75 | ppl    15.66
| epoch  17 |   400/ 1327 batches | lr 0.62 | ms/batch 59.51 | loss  2.73 | ppl    15.39
| epoch  17 |   600/ 1327 batches | lr 0.62 | ms/batch 59.44 | loss  2.72 | ppl    15.14
| epoch  17 |   800/ 1327 batches | lr 0.62 | ms/batch 60.36 | loss  2.66 | ppl    14.28
| epoch  17 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.37 | loss  2.72 | ppl    15.16
| epoch  17 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.59 | loss  2.54 | ppl    12.69
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 83.39s | valid loss  4.77 | valid ppl   117.37
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.62 | ms/batch 67.66 | loss  3.10 | ppl    22.16
| epoch  18 |   400/ 1327 batches | lr 0.62 | ms/batch 60.70 | loss  3.07 | ppl    21.60
| epoch  18 |   600/ 1327 batches | lr 0.62 | ms/batch 60.90 | loss  3.05 | ppl    21.07
| epoch  18 |   800/ 1327 batches | lr 0.62 | ms/batch 60.65 | loss  2.98 | ppl    19.77
| epoch  18 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.50 | loss  3.05 | ppl    21.10
| epoch  18 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.80 | loss  2.88 | ppl    17.75
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 84.29s | valid loss  4.69 | valid ppl   108.96
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.62 | ms/batch 67.83 | loss  3.06 | ppl    21.28
| epoch  19 |   400/ 1327 batches | lr 0.62 | ms/batch 60.91 | loss  3.04 | ppl    21.00
| epoch  19 |   600/ 1327 batches | lr 0.62 | ms/batch 60.63 | loss  3.03 | ppl    20.63
| epoch  19 |   800/ 1327 batches | lr 0.62 | ms/batch 61.47 | loss  2.97 | ppl    19.40
| epoch  19 |  1000/ 1327 batches | lr 0.62 | ms/batch 61.38 | loss  3.03 | ppl    20.76
| epoch  19 |  1200/ 1327 batches | lr 0.62 | ms/batch 61.42 | loss  2.86 | ppl    17.55
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 85.00s | valid loss  4.68 | valid ppl   107.97
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.62 | ms/batch 67.97 | loss  3.19 | ppl    24.38
| epoch  20 |   400/ 1327 batches | lr 0.62 | ms/batch 61.49 | loss  3.18 | ppl    24.05
| epoch  20 |   600/ 1327 batches | lr 0.62 | ms/batch 61.80 | loss  3.16 | ppl    23.55
| epoch  20 |   800/ 1327 batches | lr 0.62 | ms/batch 61.84 | loss  3.09 | ppl    21.99
| epoch  20 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.37 | loss  3.16 | ppl    23.58
| epoch  20 |  1200/ 1327 batches | lr 0.62 | ms/batch 62.06 | loss  2.99 | ppl    19.90
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 85.72s | valid loss  4.65 | valid ppl   104.15
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.7193333333333334
sparsity at layer rnn.weight_hh_l0 is 0.7193333333333334
sparsity at layer rnn.weight_ih_l1 is 0.7193333333333334
sparsity at layer rnn.weight_hh_l1 is 0.7193333333333334
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.6457211250748056
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 46.41 | loss  2.86 | ppl    17.54
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 47.23 | loss  2.91 | ppl    18.43
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 48.31 | loss  2.93 | ppl    18.70
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 47.64 | loss  2.90 | ppl    18.19
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 47.65 | loss  3.00 | ppl    20.11
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.16 | loss  2.85 | ppl    17.24
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 65.14s | valid loss  4.75 | valid ppl   115.59
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 48.64 | loss  2.94 | ppl    18.93
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 48.40 | loss  2.94 | ppl    18.89
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 48.42 | loss  2.94 | ppl    19.00
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 48.13 | loss  2.91 | ppl    18.38
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.20 | loss  3.00 | ppl    20.02
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.05 | loss  2.85 | ppl    17.27
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 66.14s | valid loss  4.76 | valid ppl   116.35
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 49.18 | loss  2.96 | ppl    19.25
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 48.25 | loss  2.96 | ppl    19.20
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 48.16 | loss  2.96 | ppl    19.31
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 48.12 | loss  2.93 | ppl    18.70
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 47.87 | loss  3.02 | ppl    20.44
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.21 | loss  2.86 | ppl    17.54
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 66.12s | valid loss  4.76 | valid ppl   116.92
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 49.04 | loss  2.97 | ppl    19.44
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 48.31 | loss  2.93 | ppl    18.67
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 48.29 | loss  2.90 | ppl    18.17
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 48.31 | loss  2.83 | ppl    16.95
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.45 | loss  2.90 | ppl    18.24
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.17 | loss  2.71 | ppl    15.06
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 66.21s | valid loss  4.76 | valid ppl   116.30
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 48.46 | loss  2.87 | ppl    17.66
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 48.13 | loss  2.84 | ppl    17.16
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 48.09 | loss  2.82 | ppl    16.86
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 48.04 | loss  2.78 | ppl    16.08
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.09 | loss  2.84 | ppl    17.14
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 47.99 | loss  2.67 | ppl    14.49
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 65.78s | valid loss  4.77 | valid ppl   118.49
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 48.89 | loss  2.82 | ppl    16.76
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 48.41 | loss  2.80 | ppl    16.45
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 48.00 | loss  2.78 | ppl    16.11
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 47.99 | loss  2.72 | ppl    15.25
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.67 | loss  2.80 | ppl    16.45
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.10 | loss  2.63 | ppl    13.83
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.13s | valid loss  4.79 | valid ppl   120.30
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 1.25 | ms/batch 48.90 | loss  3.26 | ppl    26.15
| epoch   7 |   400/ 1327 batches | lr 1.25 | ms/batch 48.51 | loss  3.24 | ppl    25.51
| epoch   7 |   600/ 1327 batches | lr 1.25 | ms/batch 48.55 | loss  3.20 | ppl    24.58
| epoch   7 |   800/ 1327 batches | lr 1.25 | ms/batch 48.29 | loss  3.13 | ppl    22.84
| epoch   7 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.28 | loss  3.21 | ppl    24.66
| epoch   7 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.49 | loss  3.03 | ppl    20.76
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 66.32s | valid loss  4.66 | valid ppl   106.14
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 1.25 | ms/batch 47.97 | loss  3.20 | ppl    24.65
| epoch   8 |   400/ 1327 batches | lr 1.25 | ms/batch 47.86 | loss  3.19 | ppl    24.40
| epoch   8 |   600/ 1327 batches | lr 1.25 | ms/batch 47.96 | loss  3.17 | ppl    23.82
| epoch   8 |   800/ 1327 batches | lr 1.25 | ms/batch 47.70 | loss  3.11 | ppl    22.50
| epoch   8 |  1000/ 1327 batches | lr 1.25 | ms/batch 47.33 | loss  3.19 | ppl    24.18
| epoch   8 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.91 | loss  3.02 | ppl    20.46
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.43s | valid loss  4.66 | valid ppl   105.70
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 1.25 | ms/batch 48.37 | loss  3.33 | ppl    28.02
| epoch   9 |   400/ 1327 batches | lr 1.25 | ms/batch 48.21 | loss  3.32 | ppl    27.55
| epoch   9 |   600/ 1327 batches | lr 1.25 | ms/batch 48.15 | loss  3.29 | ppl    26.95
| epoch   9 |   800/ 1327 batches | lr 1.25 | ms/batch 48.62 | loss  3.23 | ppl    25.32
| epoch   9 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.25 | loss  3.31 | ppl    27.45
| epoch   9 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.19 | loss  3.14 | ppl    23.09
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.08s | valid loss  4.62 | valid ppl   101.19
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 48.37 | loss  3.31 | ppl    27.30
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 48.27 | loss  3.30 | ppl    27.13
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 48.38 | loss  3.28 | ppl    26.58
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 48.24 | loss  3.23 | ppl    25.22
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.43 | loss  3.30 | ppl    27.14
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.05 | loss  3.14 | ppl    23.04
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.03s | valid loss  4.61 | valid ppl   100.83
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 48.44 | loss  3.30 | ppl    27.12
| epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 48.35 | loss  3.29 | ppl    26.97
| epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 48.68 | loss  3.27 | ppl    26.36
| epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 48.25 | loss  3.22 | ppl    24.93
| epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.11 | loss  3.29 | ppl    26.88
| epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.95 | loss  3.14 | ppl    23.00
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.10s | valid loss  4.61 | valid ppl   100.54
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 48.35 | loss  3.33 | ppl    27.92
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 47.84 | loss  3.32 | ppl    27.60
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 48.63 | loss  3.30 | ppl    27.20
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 48.05 | loss  3.24 | ppl    25.48
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.01 | loss  3.32 | ppl    27.78
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.91 | loss  3.17 | ppl    23.70
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.88s | valid loss  4.60 | valid ppl    99.44
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 48.62 | loss  3.32 | ppl    27.66
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 48.28 | loss  3.30 | ppl    27.24
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 48.25 | loss  3.29 | ppl    26.78
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 47.79 | loss  3.23 | ppl    25.23
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.37 | loss  3.32 | ppl    27.54
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.36 | loss  3.15 | ppl    23.26
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 66.10s | valid loss  4.60 | valid ppl    99.48
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 49.00 | loss  3.31 | ppl    27.49
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 48.33 | loss  3.31 | ppl    27.28
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 48.35 | loss  3.28 | ppl    26.66
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 48.30 | loss  3.23 | ppl    25.16
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.28 | loss  3.31 | ppl    27.25
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.67 | loss  3.14 | ppl    23.09
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 66.29s | valid loss  4.60 | valid ppl    99.25
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 48.35 | loss  3.31 | ppl    27.29
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 47.78 | loss  3.30 | ppl    27.07
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 47.88 | loss  3.28 | ppl    26.56
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 47.97 | loss  3.22 | ppl    25.06
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 47.55 | loss  3.30 | ppl    27.02
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.42 | loss  3.14 | ppl    23.09
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 65.45s | valid loss  4.60 | valid ppl    99.54
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 0.31 | ms/batch 49.30 | loss  3.32 | ppl    27.58
| epoch  16 |   400/ 1327 batches | lr 0.31 | ms/batch 48.43 | loss  3.30 | ppl    27.18
| epoch  16 |   600/ 1327 batches | lr 0.31 | ms/batch 48.50 | loss  3.29 | ppl    26.91
| epoch  16 |   800/ 1327 batches | lr 0.31 | ms/batch 48.43 | loss  3.23 | ppl    25.16
| epoch  16 |  1000/ 1327 batches | lr 0.31 | ms/batch 48.36 | loss  3.30 | ppl    27.07
| epoch  16 |  1200/ 1327 batches | lr 0.31 | ms/batch 47.99 | loss  3.13 | ppl    22.87
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 66.32s | valid loss  4.58 | valid ppl    97.54
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 0.31 | ms/batch 48.75 | loss  3.31 | ppl    27.51
| epoch  17 |   400/ 1327 batches | lr 0.31 | ms/batch 48.67 | loss  3.30 | ppl    27.23
| epoch  17 |   600/ 1327 batches | lr 0.31 | ms/batch 48.51 | loss  3.30 | ppl    27.05
| epoch  17 |   800/ 1327 batches | lr 0.31 | ms/batch 48.10 | loss  3.22 | ppl    25.14
| epoch  17 |  1000/ 1327 batches | lr 0.31 | ms/batch 48.05 | loss  3.30 | ppl    27.16
| epoch  17 |  1200/ 1327 batches | lr 0.31 | ms/batch 48.07 | loss  3.14 | ppl    23.11
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 66.20s | valid loss  4.58 | valid ppl    97.13
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.31 | ms/batch 48.63 | loss  3.31 | ppl    27.47
| epoch  18 |   400/ 1327 batches | lr 0.31 | ms/batch 48.21 | loss  3.31 | ppl    27.28
| epoch  18 |   600/ 1327 batches | lr 0.31 | ms/batch 47.94 | loss  3.28 | ppl    26.70
| epoch  18 |   800/ 1327 batches | lr 0.31 | ms/batch 48.17 | loss  3.22 | ppl    25.08
| epoch  18 |  1000/ 1327 batches | lr 0.31 | ms/batch 48.39 | loss  3.30 | ppl    27.12
| epoch  18 |  1200/ 1327 batches | lr 0.31 | ms/batch 48.41 | loss  3.14 | ppl    23.15
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 66.10s | valid loss  4.58 | valid ppl    97.04
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.31 | ms/batch 48.45 | loss  3.31 | ppl    27.47
| epoch  19 |   400/ 1327 batches | lr 0.31 | ms/batch 48.15 | loss  3.31 | ppl    27.26
| epoch  19 |   600/ 1327 batches | lr 0.31 | ms/batch 48.12 | loss  3.28 | ppl    26.62
| epoch  19 |   800/ 1327 batches | lr 0.31 | ms/batch 47.89 | loss  3.23 | ppl    25.19
| epoch  19 |  1000/ 1327 batches | lr 0.31 | ms/batch 47.85 | loss  3.30 | ppl    27.15
| epoch  19 |  1200/ 1327 batches | lr 0.31 | ms/batch 47.91 | loss  3.14 | ppl    23.18
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 65.88s | valid loss  4.58 | valid ppl    97.03
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.31 | ms/batch 48.61 | loss  3.31 | ppl    27.26
| epoch  20 |   400/ 1327 batches | lr 0.31 | ms/batch 48.26 | loss  3.29 | ppl    26.86
| epoch  20 |   600/ 1327 batches | lr 0.31 | ms/batch 48.20 | loss  3.29 | ppl    26.72
| epoch  20 |   800/ 1327 batches | lr 0.31 | ms/batch 48.42 | loss  3.22 | ppl    24.94
| epoch  20 |  1000/ 1327 batches | lr 0.31 | ms/batch 47.61 | loss  3.30 | ppl    27.20
| epoch  20 |  1200/ 1327 batches | lr 0.31 | ms/batch 48.09 | loss  3.14 | ppl    23.08
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 66.04s | valid loss  4.57 | valid ppl    96.97
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.7193333333333334
sparsity at layer rnn.weight_hh_l0 is 0.7193333333333334
sparsity at layer rnn.weight_ih_l1 is 0.7193333333333334
sparsity at layer rnn.weight_hh_l1 is 0.7193333333333334
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.6457211250748056
=========================================================================================
| End of training | test loss  4.52 | test ppl    92.14
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 20 --dropout 0.55 --save sp74_epoch20_dropout0.55_lstm.pt --pretrained sp72_epoch20_dropout0.55_lstm.pt
debug
{'rnn.weight_ih_l0': 0.74, 'rnn.weight_hh_l0': 0.74, 'rnn.weight_ih_l1': 0.74, 'rnn.weight_hh_l1': 0.74}
{'rnn.weight_ih_l0': 0.74, 'rnn.weight_hh_l0': 0.74, 'rnn.weight_ih_l1': 0.74, 'rnn.weight_hh_l1': 0.74}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 56.30 | loss  5.75 | ppl   312.73
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 48.61 | loss  3.80 | ppl    44.60
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 48.81 | loss  3.25 | ppl    25.72
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 48.56 | loss  3.03 | ppl    20.77
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.90 | loss  3.05 | ppl    21.13
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 50.27 | loss  2.83 | ppl    16.89
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 68.93s | valid loss  4.76 | valid ppl   116.96
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 58.26 | loss  3.58 | ppl    35.87
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 51.60 | loss  3.07 | ppl    21.58
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 52.54 | loss  2.97 | ppl    19.47
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 52.39 | loss  2.90 | ppl    18.18
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.06 | loss  2.96 | ppl    19.35
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.87 | loss  2.76 | ppl    15.75
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 72.67s | valid loss  4.80 | valid ppl   121.27
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 60.12 | loss  3.02 | ppl    20.47
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 52.40 | loss  2.94 | ppl    18.86
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 52.58 | loss  2.92 | ppl    18.56
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 53.34 | loss  2.87 | ppl    17.58
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 53.18 | loss  2.94 | ppl    18.89
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.93 | loss  2.74 | ppl    15.53
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 73.90s | valid loss  4.80 | valid ppl   121.79
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 60.10 | loss  2.97 | ppl    19.45
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 53.31 | loss  2.91 | ppl    18.29
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 53.55 | loss  2.89 | ppl    18.04
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 53.52 | loss  2.84 | ppl    17.14
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.70 | loss  2.91 | ppl    18.44
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.45 | loss  2.72 | ppl    15.11
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 74.28s | valid loss  4.81 | valid ppl   122.92
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 2.50 | ms/batch 61.46 | loss  3.10 | ppl    22.27
| epoch   5 |   400/ 1327 batches | lr 2.50 | ms/batch 53.28 | loss  3.02 | ppl    20.58
| epoch   5 |   600/ 1327 batches | lr 2.50 | ms/batch 54.51 | loss  3.00 | ppl    19.99
| epoch   5 |   800/ 1327 batches | lr 2.50 | ms/batch 53.96 | loss  2.94 | ppl    18.88
| epoch   5 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.97 | loss  3.00 | ppl    20.04
| epoch   5 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.95 | loss  2.81 | ppl    16.68
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 75.34s | valid loss  4.74 | valid ppl   114.19
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 2.50 | ms/batch 60.85 | loss  3.03 | ppl    20.69
| epoch   6 |   400/ 1327 batches | lr 2.50 | ms/batch 54.26 | loss  3.00 | ppl    20.06
| epoch   6 |   600/ 1327 batches | lr 2.50 | ms/batch 54.44 | loss  2.97 | ppl    19.53
| epoch   6 |   800/ 1327 batches | lr 2.50 | ms/batch 54.48 | loss  2.92 | ppl    18.51
| epoch   6 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.53 | loss  2.98 | ppl    19.78
| epoch   6 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.63 | loss  2.80 | ppl    16.42
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 75.93s | valid loss  4.75 | valid ppl   115.14
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 61.07 | loss  3.00 | ppl    20.13
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 54.60 | loss  2.97 | ppl    19.54
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 54.58 | loss  2.95 | ppl    19.14
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 54.62 | loss  2.90 | ppl    18.24
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.81 | loss  2.97 | ppl    19.48
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.04 | loss  2.79 | ppl    16.28
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 76.37s | valid loss  4.75 | valid ppl   115.21
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 62.72 | loss  2.99 | ppl    19.86
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 55.35 | loss  2.97 | ppl    19.40
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 55.72 | loss  2.95 | ppl    19.09
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 55.57 | loss  2.89 | ppl    18.03
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.49 | loss  2.96 | ppl    19.33
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.56 | loss  2.78 | ppl    16.17
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 77.46s | valid loss  4.75 | valid ppl   115.04
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 62.12 | loss  2.97 | ppl    19.51
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 55.55 | loss  2.95 | ppl    19.03
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 55.70 | loss  2.93 | ppl    18.78
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 56.80 | loss  2.88 | ppl    17.80
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 56.42 | loss  2.95 | ppl    19.05
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 56.26 | loss  2.76 | ppl    15.82
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 78.02s | valid loss  4.75 | valid ppl   115.10
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 63.42 | loss  3.04 | ppl    20.87
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 56.47 | loss  3.01 | ppl    20.29
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 56.02 | loss  2.99 | ppl    19.85
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 57.22 | loss  2.92 | ppl    18.61
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.53 | loss  2.99 | ppl    19.87
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.35 | loss  2.81 | ppl    16.65
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 78.74s | valid loss  4.71 | valid ppl   110.97
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 63.88 | loss  2.21 | ppl     9.14
| epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 56.25 | loss  2.24 | ppl     9.38
| epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 56.70 | loss  2.24 | ppl     9.36
| epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 56.72 | loss  2.20 | ppl     9.02
| epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.04 | loss  2.25 | ppl     9.50
| epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.70 | loss  2.10 | ppl     8.16
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 79.20s | valid loss  4.93 | valid ppl   137.89
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 64.77 | loss  2.27 | ppl     9.65
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 57.08 | loss  2.25 | ppl     9.52
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 58.08 | loss  2.23 | ppl     9.34
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 57.78 | loss  2.19 | ppl     8.96
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.76 | loss  2.25 | ppl     9.48
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.79 | loss  2.10 | ppl     8.15
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 80.34s | valid loss  4.96 | valid ppl   142.25
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 64.70 | loss  2.26 | ppl     9.56
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 57.68 | loss  2.24 | ppl     9.36
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 58.54 | loss  2.22 | ppl     9.24
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 58.02 | loss  2.18 | ppl     8.83
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.72 | loss  2.23 | ppl     9.27
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.52 | loss  2.07 | ppl     7.94
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 81.00s | valid loss  4.98 | valid ppl   145.26
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 0.62 | ms/batch 65.50 | loss  2.86 | ppl    17.41
| epoch  14 |   400/ 1327 batches | lr 0.62 | ms/batch 58.43 | loss  2.81 | ppl    16.64
| epoch  14 |   600/ 1327 batches | lr 0.62 | ms/batch 58.49 | loss  2.78 | ppl    16.15
| epoch  14 |   800/ 1327 batches | lr 0.62 | ms/batch 58.43 | loss  2.72 | ppl    15.14
| epoch  14 |  1000/ 1327 batches | lr 0.62 | ms/batch 58.40 | loss  2.77 | ppl    15.93
| epoch  14 |  1200/ 1327 batches | lr 0.62 | ms/batch 58.47 | loss  2.60 | ppl    13.43
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 81.38s | valid loss  4.82 | valid ppl   124.45
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 0.62 | ms/batch 66.04 | loss  2.77 | ppl    15.99
| epoch  15 |   400/ 1327 batches | lr 0.62 | ms/batch 58.54 | loss  2.76 | ppl    15.78
| epoch  15 |   600/ 1327 batches | lr 0.62 | ms/batch 58.65 | loss  2.74 | ppl    15.53
| epoch  15 |   800/ 1327 batches | lr 0.62 | ms/batch 59.73 | loss  2.68 | ppl    14.55
| epoch  15 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.18 | loss  2.74 | ppl    15.54
| epoch  15 |  1200/ 1327 batches | lr 0.62 | ms/batch 59.54 | loss  2.57 | ppl    13.11
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 82.28s | valid loss  4.81 | valid ppl   122.42
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 0.62 | ms/batch 66.31 | loss  2.79 | ppl    16.26
| epoch  16 |   400/ 1327 batches | lr 0.62 | ms/batch 59.64 | loss  2.78 | ppl    16.10
| epoch  16 |   600/ 1327 batches | lr 0.62 | ms/batch 59.97 | loss  2.76 | ppl    15.75
| epoch  16 |   800/ 1327 batches | lr 0.62 | ms/batch 59.90 | loss  2.70 | ppl    14.88
| epoch  16 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.91 | loss  2.76 | ppl    15.82
| epoch  16 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.02 | loss  2.59 | ppl    13.35
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 83.15s | valid loss  4.79 | valid ppl   120.09
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 0.62 | ms/batch 66.03 | loss  2.77 | ppl    15.88
| epoch  17 |   400/ 1327 batches | lr 0.62 | ms/batch 59.47 | loss  2.75 | ppl    15.64
| epoch  17 |   600/ 1327 batches | lr 0.62 | ms/batch 60.73 | loss  2.74 | ppl    15.41
| epoch  17 |   800/ 1327 batches | lr 0.62 | ms/batch 60.46 | loss  2.68 | ppl    14.56
| epoch  17 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.45 | loss  2.74 | ppl    15.50
| epoch  17 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.36 | loss  2.56 | ppl    13.00
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 83.53s | valid loss  4.79 | valid ppl   120.02
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.62 | ms/batch 67.47 | loss  3.07 | ppl    21.56
| epoch  18 |   400/ 1327 batches | lr 0.62 | ms/batch 60.41 | loss  3.05 | ppl    21.12
| epoch  18 |   600/ 1327 batches | lr 0.62 | ms/batch 60.65 | loss  3.03 | ppl    20.73
| epoch  18 |   800/ 1327 batches | lr 0.62 | ms/batch 60.63 | loss  2.97 | ppl    19.45
| epoch  18 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.67 | loss  3.03 | ppl    20.76
| epoch  18 |  1200/ 1327 batches | lr 0.62 | ms/batch 61.25 | loss  2.86 | ppl    17.49
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 84.33s | valid loss  4.73 | valid ppl   112.79
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.62 | ms/batch 67.47 | loss  3.04 | ppl    20.88
| epoch  19 |   400/ 1327 batches | lr 0.62 | ms/batch 60.74 | loss  3.03 | ppl    20.68
| epoch  19 |   600/ 1327 batches | lr 0.62 | ms/batch 61.09 | loss  3.01 | ppl    20.32
| epoch  19 |   800/ 1327 batches | lr 0.62 | ms/batch 61.60 | loss  2.95 | ppl    19.12
| epoch  19 |  1000/ 1327 batches | lr 0.62 | ms/batch 61.68 | loss  3.02 | ppl    20.49
| epoch  19 |  1200/ 1327 batches | lr 0.62 | ms/batch 61.52 | loss  2.85 | ppl    17.29
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 84.95s | valid loss  4.72 | valid ppl   111.73
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.62 | ms/batch 69.04 | loss  3.15 | ppl    23.30
| epoch  20 |   400/ 1327 batches | lr 0.62 | ms/batch 61.45 | loss  3.14 | ppl    23.09
| epoch  20 |   600/ 1327 batches | lr 0.62 | ms/batch 61.97 | loss  3.12 | ppl    22.63
| epoch  20 |   800/ 1327 batches | lr 0.62 | ms/batch 61.93 | loss  3.06 | ppl    21.24
| epoch  20 |  1000/ 1327 batches | lr 0.62 | ms/batch 61.97 | loss  3.12 | ppl    22.74
| epoch  20 |  1200/ 1327 batches | lr 0.62 | ms/batch 61.79 | loss  2.95 | ppl    19.18
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 85.85s | valid loss  4.69 | valid ppl   108.46
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.7393333333333333
sparsity at layer rnn.weight_hh_l0 is 0.7393333333333333
sparsity at layer rnn.weight_ih_l1 is 0.7393333333333333
sparsity at layer rnn.weight_hh_l1 is 0.7393333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.675807434491164
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 46.79 | loss  2.26 | ppl     9.57
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 47.30 | loss  2.31 | ppl    10.07
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 47.75 | loss  2.33 | ppl    10.24
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 47.62 | loss  2.31 | ppl    10.11
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.39 | loss  2.41 | ppl    11.13
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.14 | loss  2.27 | ppl     9.65
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 65.29s | valid loss  5.04 | valid ppl   153.75
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 48.69 | loss  2.36 | ppl    10.61
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 48.25 | loss  2.37 | ppl    10.65
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 48.37 | loss  2.38 | ppl    10.77
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 48.44 | loss  2.35 | ppl    10.53
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.41 | loss  2.43 | ppl    11.36
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.43 | loss  2.30 | ppl     9.94
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 66.26s | valid loss  5.04 | valid ppl   153.90
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 48.83 | loss  2.40 | ppl    11.04
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 48.52 | loss  2.40 | ppl    11.03
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 48.29 | loss  2.41 | ppl    11.12
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 48.25 | loss  2.39 | ppl    10.94
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 48.65 | loss  2.47 | ppl    11.87
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 48.58 | loss  2.33 | ppl    10.32
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 66.40s | valid loss  5.05 | valid ppl   156.13
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 48.62 | loss  2.96 | ppl    19.22
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 48.46 | loss  2.90 | ppl    18.09
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 48.59 | loss  2.86 | ppl    17.52
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 48.41 | loss  2.79 | ppl    16.28
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.33 | loss  2.86 | ppl    17.44
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.26 | loss  2.68 | ppl    14.54
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 66.24s | valid loss  4.85 | valid ppl   127.81
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 48.37 | loss  2.83 | ppl    16.91
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 48.59 | loss  2.80 | ppl    16.40
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 48.33 | loss  2.78 | ppl    16.13
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 48.36 | loss  2.73 | ppl    15.37
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 47.85 | loss  2.80 | ppl    16.45
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.12 | loss  2.63 | ppl    13.94
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 66.02s | valid loss  4.86 | valid ppl   128.52
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 49.05 | loss  2.77 | ppl    15.97
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 48.61 | loss  2.76 | ppl    15.79
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 48.52 | loss  2.74 | ppl    15.44
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 48.26 | loss  2.69 | ppl    14.67
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.35 | loss  2.76 | ppl    15.85
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 48.25 | loss  2.59 | ppl    13.33
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 66.35s | valid loss  4.87 | valid ppl   130.16
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 1.25 | ms/batch 49.03 | loss  3.28 | ppl    26.56
| epoch   7 |   400/ 1327 batches | lr 1.25 | ms/batch 48.80 | loss  3.26 | ppl    26.01
| epoch   7 |   600/ 1327 batches | lr 1.25 | ms/batch 48.51 | loss  3.22 | ppl    25.08
| epoch   7 |   800/ 1327 batches | lr 1.25 | ms/batch 48.52 | loss  3.15 | ppl    23.26
| epoch   7 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.52 | loss  3.23 | ppl    25.16
| epoch   7 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.48 | loss  3.05 | ppl    21.21
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 66.51s | valid loss  4.71 | valid ppl   110.66
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 1.25 | ms/batch 48.35 | loss  3.22 | ppl    24.94
| epoch   8 |   400/ 1327 batches | lr 1.25 | ms/batch 47.90 | loss  3.21 | ppl    24.79
| epoch   8 |   600/ 1327 batches | lr 1.25 | ms/batch 47.58 | loss  3.19 | ppl    24.25
| epoch   8 |   800/ 1327 batches | lr 1.25 | ms/batch 47.98 | loss  3.13 | ppl    22.83
| epoch   8 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.14 | loss  3.21 | ppl    24.66
| epoch   8 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.05 | loss  3.04 | ppl    20.87
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 65.70s | valid loss  4.70 | valid ppl   109.55
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 1.25 | ms/batch 48.81 | loss  3.31 | ppl    27.47
| epoch   9 |   400/ 1327 batches | lr 1.25 | ms/batch 48.47 | loss  3.30 | ppl    27.07
| epoch   9 |   600/ 1327 batches | lr 1.25 | ms/batch 48.32 | loss  3.28 | ppl    26.56
| epoch   9 |   800/ 1327 batches | lr 1.25 | ms/batch 48.09 | loss  3.22 | ppl    25.01
| epoch   9 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.14 | loss  3.30 | ppl    27.10
| epoch   9 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.33 | loss  3.13 | ppl    22.89
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 66.18s | valid loss  4.66 | valid ppl   105.52
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 48.60 | loss  3.28 | ppl    26.70
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 48.32 | loss  3.28 | ppl    26.67
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 48.38 | loss  3.27 | ppl    26.20
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 48.11 | loss  3.21 | ppl    24.87
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.10 | loss  3.28 | ppl    26.70
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.31 | loss  3.13 | ppl    22.82
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 66.09s | valid loss  4.65 | valid ppl   105.03
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 48.08 | loss  3.28 | ppl    26.56
| epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 48.17 | loss  3.27 | ppl    26.44
| epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 48.09 | loss  3.25 | ppl    25.91
| epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 49.14 | loss  3.20 | ppl    24.49
| epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.48 | loss  3.28 | ppl    26.47
| epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 48.29 | loss  3.12 | ppl    22.70
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 66.18s | valid loss  4.65 | valid ppl   104.62
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 48.58 | loss  3.30 | ppl    27.12
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 48.40 | loss  3.29 | ppl    26.84
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 48.31 | loss  3.28 | ppl    26.52
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 48.25 | loss  3.22 | ppl    24.90
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 48.14 | loss  3.30 | ppl    27.13
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.03 | loss  3.15 | ppl    23.22
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 65.71s | valid loss  4.64 | valid ppl   103.61
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 47.86 | loss  3.29 | ppl    26.87
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 47.53 | loss  3.28 | ppl    26.51
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 47.19 | loss  3.26 | ppl    26.15
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 47.25 | loss  3.20 | ppl    24.63
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 47.22 | loss  3.29 | ppl    26.89
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.21 | loss  3.12 | ppl    22.75
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 64.77s | valid loss  4.64 | valid ppl   103.59
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 47.93 | loss  3.28 | ppl    26.66
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 47.63 | loss  3.28 | ppl    26.51
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 47.26 | loss  3.26 | ppl    26.00
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 47.18 | loss  3.20 | ppl    24.52
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 47.20 | loss  3.28 | ppl    26.61
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.16 | loss  3.12 | ppl    22.56
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 64.76s | valid loss  4.64 | valid ppl   103.39
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 46.66 | loss  3.28 | ppl    26.49
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 46.76 | loss  3.27 | ppl    26.33
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 46.75 | loss  3.25 | ppl    25.88
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 46.84 | loss  3.20 | ppl    24.42
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.81 | loss  3.27 | ppl    26.33
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.83 | loss  3.12 | ppl    22.55
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 63.97s | valid loss  4.64 | valid ppl   103.55
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 47.25 | loss  3.31 | ppl    27.41
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 46.94 | loss  3.29 | ppl    26.83
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 46.93 | loss  3.28 | ppl    26.68
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 46.98 | loss  3.22 | ppl    24.97
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 47.92 | loss  3.30 | ppl    27.04
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.21 | loss  3.15 | ppl    23.27
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 64.59s | valid loss  4.63 | valid ppl   102.32
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 47.13 | loss  3.30 | ppl    27.09
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 47.11 | loss  3.29 | ppl    26.93
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 47.27 | loss  3.29 | ppl    26.78
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 47.26 | loss  3.22 | ppl    24.95
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 47.05 | loss  3.30 | ppl    27.11
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.99 | loss  3.15 | ppl    23.28
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.42s | valid loss  4.62 | valid ppl   101.87
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 1.25 | ms/batch 47.31 | loss  3.30 | ppl    27.06
| epoch  18 |   400/ 1327 batches | lr 1.25 | ms/batch 46.94 | loss  3.29 | ppl    26.97
| epoch  18 |   600/ 1327 batches | lr 1.25 | ms/batch 47.19 | loss  3.27 | ppl    26.42
| epoch  18 |   800/ 1327 batches | lr 1.25 | ms/batch 47.04 | loss  3.21 | ppl    24.84
| epoch  18 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.97 | loss  3.29 | ppl    26.96
| epoch  18 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.40 | loss  3.14 | ppl    23.22
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 64.48s | valid loss  4.62 | valid ppl   101.93
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.31 | ms/batch 47.51 | loss  3.30 | ppl    27.17
| epoch  19 |   400/ 1327 batches | lr 0.31 | ms/batch 47.22 | loss  3.31 | ppl    27.35
| epoch  19 |   600/ 1327 batches | lr 0.31 | ms/batch 47.22 | loss  3.28 | ppl    26.70
| epoch  19 |   800/ 1327 batches | lr 0.31 | ms/batch 46.99 | loss  3.23 | ppl    25.27
| epoch  19 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.94 | loss  3.30 | ppl    27.12
| epoch  19 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.91 | loss  3.13 | ppl    22.97
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 64.41s | valid loss  4.60 | valid ppl    99.94
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.31 | ms/batch 47.17 | loss  3.30 | ppl    27.01
| epoch  20 |   400/ 1327 batches | lr 0.31 | ms/batch 46.85 | loss  3.29 | ppl    26.77
| epoch  20 |   600/ 1327 batches | lr 0.31 | ms/batch 46.81 | loss  3.28 | ppl    26.67
| epoch  20 |   800/ 1327 batches | lr 0.31 | ms/batch 46.84 | loss  3.21 | ppl    24.85
| epoch  20 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.93 | loss  3.30 | ppl    26.98
| epoch  20 |  1200/ 1327 batches | lr 0.31 | ms/batch 47.01 | loss  3.13 | ppl    22.94
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 64.18s | valid loss  4.60 | valid ppl    99.69
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.7393333333333333
sparsity at layer rnn.weight_hh_l0 is 0.7393333333333333
sparsity at layer rnn.weight_ih_l1 is 0.7393333333333333
sparsity at layer rnn.weight_hh_l1 is 0.7393333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.675807434491164
=========================================================================================
| End of training | test loss  4.55 | test ppl    94.66
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 20 --dropout 0.55 --save sp76_epoch20_dropout0.55_lstm.pt --pretrained sp74_epoch20_dropout0.55_lstm.pt
debug
{'rnn.weight_ih_l0': 0.76, 'rnn.weight_hh_l0': 0.76, 'rnn.weight_ih_l1': 0.76, 'rnn.weight_hh_l1': 0.76}
{'rnn.weight_ih_l0': 0.76, 'rnn.weight_hh_l0': 0.76, 'rnn.weight_ih_l1': 0.76, 'rnn.weight_hh_l1': 0.76}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 51.46 | loss  7.08 | ppl  1185.28
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 46.99 | loss  4.24 | ppl    69.74
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 46.99 | loss  3.39 | ppl    29.69
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 48.43 | loss  3.07 | ppl    21.63
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 49.74 | loss  3.05 | ppl    21.15
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 49.88 | loss  2.82 | ppl    16.77
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 67.24s | valid loss  4.80 | valid ppl   122.08
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 54.77 | loss  3.79 | ppl    44.36
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 50.13 | loss  3.10 | ppl    22.16
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 50.50 | loss  2.95 | ppl    19.19
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 51.26 | loss  2.88 | ppl    17.75
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.21 | loss  2.93 | ppl    18.76
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.25 | loss  2.72 | ppl    15.22
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 70.53s | valid loss  4.85 | valid ppl   128.28
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 55.88 | loss  3.00 | ppl    20.10
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 51.79 | loss  2.91 | ppl    18.32
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 51.51 | loss  2.89 | ppl    18.00
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 51.52 | loss  2.84 | ppl    17.09
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.44 | loss  2.91 | ppl    18.32
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.52 | loss  2.71 | ppl    15.02
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 71.64s | valid loss  4.86 | valid ppl   128.57
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 56.13 | loss  2.95 | ppl    19.02
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 51.55 | loss  2.88 | ppl    17.73
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 51.99 | loss  2.87 | ppl    17.56
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 52.49 | loss  2.81 | ppl    16.69
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.23 | loss  2.89 | ppl    17.93
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.82 | loss  2.68 | ppl    14.65
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 72.14s | valid loss  4.87 | valid ppl   129.99
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 2.50 | ms/batch 56.67 | loss  3.11 | ppl    22.34
| epoch   5 |   400/ 1327 batches | lr 2.50 | ms/batch 51.85 | loss  3.02 | ppl    20.49
| epoch   5 |   600/ 1327 batches | lr 2.50 | ms/batch 51.99 | loss  2.99 | ppl    19.86
| epoch   5 |   800/ 1327 batches | lr 2.50 | ms/batch 52.11 | loss  2.93 | ppl    18.76
| epoch   5 |  1000/ 1327 batches | lr 2.50 | ms/batch 52.93 | loss  2.99 | ppl    19.85
| epoch   5 |  1200/ 1327 batches | lr 2.50 | ms/batch 52.92 | loss  2.81 | ppl    16.57
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 72.64s | valid loss  4.77 | valid ppl   118.01
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 2.50 | ms/batch 57.13 | loss  3.02 | ppl    20.57
| epoch   6 |   400/ 1327 batches | lr 2.50 | ms/batch 52.42 | loss  2.99 | ppl    19.93
| epoch   6 |   600/ 1327 batches | lr 2.50 | ms/batch 52.78 | loss  2.97 | ppl    19.42
| epoch   6 |   800/ 1327 batches | lr 2.50 | ms/batch 52.72 | loss  2.91 | ppl    18.37
| epoch   6 |  1000/ 1327 batches | lr 2.50 | ms/batch 52.78 | loss  2.98 | ppl    19.70
| epoch   6 |  1200/ 1327 batches | lr 2.50 | ms/batch 52.80 | loss  2.79 | ppl    16.30
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 73.27s | valid loss  4.78 | valid ppl   119.05
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 57.32 | loss  3.00 | ppl    19.99
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 52.88 | loss  2.97 | ppl    19.41
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 52.86 | loss  2.95 | ppl    19.07
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 52.83 | loss  2.90 | ppl    18.11
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.54 | loss  2.96 | ppl    19.32
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.58 | loss  2.78 | ppl    16.19
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 73.72s | valid loss  4.78 | valid ppl   118.85
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 57.45 | loss  2.98 | ppl    19.77
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 53.67 | loss  2.96 | ppl    19.27
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 53.60 | loss  2.94 | ppl    18.98
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 53.74 | loss  2.89 | ppl    17.97
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.74 | loss  2.96 | ppl    19.26
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.68 | loss  2.78 | ppl    16.08
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 74.59s | valid loss  4.78 | valid ppl   119.08
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 58.81 | loss  2.96 | ppl    19.35
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 54.94 | loss  2.94 | ppl    18.92
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 54.58 | loss  2.93 | ppl    18.73
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 54.53 | loss  2.87 | ppl    17.71
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.63 | loss  2.94 | ppl    19.00
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.70 | loss  2.76 | ppl    15.75
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 75.78s | valid loss  4.78 | valid ppl   119.01
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 2.50 | ms/batch 59.57 | loss  3.03 | ppl    20.78
| epoch  10 |   400/ 1327 batches | lr 2.50 | ms/batch 54.86 | loss  3.01 | ppl    20.29
| epoch  10 |   600/ 1327 batches | lr 2.50 | ms/batch 54.85 | loss  3.00 | ppl    20.02
| epoch  10 |   800/ 1327 batches | lr 2.50 | ms/batch 54.88 | loss  2.94 | ppl    18.88
| epoch  10 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.81 | loss  3.01 | ppl    20.20
| epoch  10 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.41 | loss  2.83 | ppl    16.95
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 76.31s | valid loss  4.75 | valid ppl   115.29
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 2.50 | ms/batch 59.35 | loss  2.31 | ppl    10.12
| epoch  11 |   400/ 1327 batches | lr 2.50 | ms/batch 54.53 | loss  2.33 | ppl    10.33
| epoch  11 |   600/ 1327 batches | lr 2.50 | ms/batch 55.79 | loss  2.34 | ppl    10.33
| epoch  11 |   800/ 1327 batches | lr 2.50 | ms/batch 55.71 | loss  2.30 | ppl     9.97
| epoch  11 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.71 | loss  2.35 | ppl    10.53
| epoch  11 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.69 | loss  2.20 | ppl     9.03
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 76.73s | valid loss  4.96 | valid ppl   142.31
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 60.37 | loss  2.38 | ppl    10.82
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 55.89 | loss  2.36 | ppl    10.63
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 56.03 | loss  2.34 | ppl    10.40
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 56.17 | loss  2.30 | ppl     9.98
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 55.99 | loss  2.36 | ppl    10.55
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 55.92 | loss  2.20 | ppl     9.07
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 77.51s | valid loss  4.96 | valid ppl   142.07
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 60.53 | loss  2.37 | ppl    10.72
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 56.39 | loss  2.35 | ppl    10.51
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 56.19 | loss  2.34 | ppl    10.37
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 56.32 | loss  2.29 | ppl     9.91
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.20 | loss  2.34 | ppl    10.43
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.90 | loss  2.19 | ppl     8.91
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 78.00s | valid loss  4.97 | valid ppl   143.38
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 60.80 | loss  2.88 | ppl    17.90
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 56.45 | loss  2.84 | ppl    17.14
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 57.28 | loss  2.82 | ppl    16.73
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 56.95 | loss  2.76 | ppl    15.82
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.82 | loss  2.82 | ppl    16.72
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.89 | loss  2.65 | ppl    14.15
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 78.62s | valid loss  4.83 | valid ppl   124.70
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 61.38 | loss  2.82 | ppl    16.69
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 57.02 | loss  2.80 | ppl    16.49
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 57.12 | loss  2.79 | ppl    16.21
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 57.10 | loss  2.72 | ppl    15.25
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.68 | loss  2.79 | ppl    16.36
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.32 | loss  2.63 | ppl    13.85
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 79.37s | valid loss  4.82 | valid ppl   123.51
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 62.06 | loss  2.83 | ppl    16.96
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 57.11 | loss  2.82 | ppl    16.79
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 58.56 | loss  2.80 | ppl    16.42
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 58.28 | loss  2.75 | ppl    15.57
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.31 | loss  2.81 | ppl    16.63
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.25 | loss  2.65 | ppl    14.10
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 80.21s | valid loss  4.80 | valid ppl   121.44
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 62.82 | loss  2.82 | ppl    16.70
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 58.27 | loss  2.80 | ppl    16.38
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 58.79 | loss  2.78 | ppl    16.18
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 58.53 | loss  2.73 | ppl    15.30
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.69 | loss  2.80 | ppl    16.38
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.54 | loss  2.62 | ppl    13.76
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 81.04s | valid loss  4.80 | valid ppl   121.78
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.62 | ms/batch 63.67 | loss  3.09 | ppl    22.08
| epoch  18 |   400/ 1327 batches | lr 0.62 | ms/batch 58.64 | loss  3.08 | ppl    21.66
| epoch  18 |   600/ 1327 batches | lr 0.62 | ms/batch 59.03 | loss  3.06 | ppl    21.25
| epoch  18 |   800/ 1327 batches | lr 0.62 | ms/batch 59.33 | loss  2.99 | ppl    19.89
| epoch  18 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.08 | loss  3.05 | ppl    21.20
| epoch  18 |  1200/ 1327 batches | lr 0.62 | ms/batch 58.96 | loss  2.88 | ppl    17.89
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 81.56s | valid loss  4.74 | valid ppl   113.94
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.62 | ms/batch 64.05 | loss  3.06 | ppl    21.31
| epoch  19 |   400/ 1327 batches | lr 0.62 | ms/batch 58.90 | loss  3.05 | ppl    21.12
| epoch  19 |   600/ 1327 batches | lr 0.62 | ms/batch 59.68 | loss  3.04 | ppl    20.85
| epoch  19 |   800/ 1327 batches | lr 0.62 | ms/batch 59.72 | loss  2.98 | ppl    19.63
| epoch  19 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.85 | loss  3.05 | ppl    21.07
| epoch  19 |  1200/ 1327 batches | lr 0.62 | ms/batch 59.94 | loss  2.88 | ppl    17.74
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 82.36s | valid loss  4.73 | valid ppl   112.94
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.62 | ms/batch 64.24 | loss  3.15 | ppl    23.34
| epoch  20 |   400/ 1327 batches | lr 0.62 | ms/batch 60.24 | loss  3.14 | ppl    23.19
| epoch  20 |   600/ 1327 batches | lr 0.62 | ms/batch 60.23 | loss  3.13 | ppl    22.79
| epoch  20 |   800/ 1327 batches | lr 0.62 | ms/batch 60.28 | loss  3.06 | ppl    21.37
| epoch  20 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.24 | loss  3.13 | ppl    22.92
| epoch  20 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.27 | loss  2.96 | ppl    19.32
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 83.24s | valid loss  4.70 | valid ppl   110.34
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.7593333333333333
sparsity at layer rnn.weight_hh_l0 is 0.7593333333333333
sparsity at layer rnn.weight_ih_l1 is 0.7593333333333333
sparsity at layer rnn.weight_hh_l1 is 0.7593333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.7070142768466792
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 45.80 | loss  1.91 | ppl     6.73
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 45.75 | loss  1.95 | ppl     7.03
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 46.52 | loss  1.97 | ppl     7.16
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 46.63 | loss  1.96 | ppl     7.12
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.61 | loss  2.06 | ppl     7.83
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.61 | loss  1.92 | ppl     6.85
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 63.39s | valid loss  5.27 | valid ppl   193.68
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 47.04 | loss  2.02 | ppl     7.52
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 46.91 | loss  2.02 | ppl     7.57
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 46.86 | loss  2.04 | ppl     7.68
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 46.69 | loss  2.02 | ppl     7.56
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.64 | loss  2.09 | ppl     8.09
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.65 | loss  1.97 | ppl     7.17
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.97s | valid loss  5.27 | valid ppl   195.30
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 47.60 | loss  2.07 | ppl     7.91
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 47.31 | loss  2.06 | ppl     7.88
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 47.09 | loss  2.07 | ppl     7.93
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 46.88 | loss  2.06 | ppl     7.82
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.68 | loss  2.14 | ppl     8.48
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 47.25 | loss  2.00 | ppl     7.41
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 64.40s | valid loss  5.27 | valid ppl   195.31
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 47.06 | loss  2.96 | ppl    19.35
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 46.73 | loss  2.88 | ppl    17.87
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 46.79 | loss  2.84 | ppl    17.17
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 46.93 | loss  2.77 | ppl    15.93
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.89 | loss  2.84 | ppl    17.07
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.87 | loss  2.65 | ppl    14.16
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 64.21s | valid loss  4.92 | valid ppl   137.13
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 46.92 | loss  2.80 | ppl    16.37
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 46.94 | loss  2.76 | ppl    15.88
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 46.84 | loss  2.75 | ppl    15.66
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 46.42 | loss  2.70 | ppl    14.92
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.81 | loss  2.77 | ppl    15.96
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.75 | loss  2.61 | ppl    13.58
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 63.92s | valid loss  4.92 | valid ppl   136.91
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 47.00 | loss  2.74 | ppl    15.46
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 47.15 | loss  2.73 | ppl    15.33
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 46.90 | loss  2.71 | ppl    14.98
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 46.81 | loss  2.66 | ppl    14.26
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.87 | loss  2.73 | ppl    15.40
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.79 | loss  2.57 | ppl    13.00
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 64.16s | valid loss  4.93 | valid ppl   138.50
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 47.72 | loss  3.26 | ppl    26.10
| epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 47.16 | loss  3.23 | ppl    25.37
| epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 47.01 | loss  3.21 | ppl    24.81
| epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 47.04 | loss  3.15 | ppl    23.33
| epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 47.11 | loss  3.24 | ppl    25.53
| epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 47.07 | loss  3.07 | ppl    21.47
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.47s | valid loss  4.73 | valid ppl   113.78
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch 46.33 | loss  3.20 | ppl    24.62
| epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch 47.18 | loss  3.19 | ppl    24.38
| epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch 46.62 | loss  3.18 | ppl    24.03
| epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch 46.47 | loss  3.13 | ppl    22.79
| epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.66 | loss  3.21 | ppl    24.84
| epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.83 | loss  3.04 | ppl    20.95
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 63.85s | valid loss  4.73 | valid ppl   113.13
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 5.00 | ms/batch 46.67 | loss  3.27 | ppl    26.32
| epoch   9 |   400/ 1327 batches | lr 5.00 | ms/batch 47.15 | loss  3.25 | ppl    25.89
| epoch   9 |   600/ 1327 batches | lr 5.00 | ms/batch 46.97 | loss  3.24 | ppl    25.59
| epoch   9 |   800/ 1327 batches | lr 5.00 | ms/batch 46.86 | loss  3.19 | ppl    24.25
| epoch   9 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.72 | loss  3.28 | ppl    26.50
| epoch   9 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.67 | loss  3.11 | ppl    22.41
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 64.02s | valid loss  4.70 | valid ppl   109.53
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 5.00 | ms/batch 47.30 | loss  3.24 | ppl    25.54
| epoch  10 |   400/ 1327 batches | lr 5.00 | ms/batch 46.52 | loss  3.24 | ppl    25.48
| epoch  10 |   600/ 1327 batches | lr 5.00 | ms/batch 46.91 | loss  3.23 | ppl    25.17
| epoch  10 |   800/ 1327 batches | lr 5.00 | ms/batch 46.83 | loss  3.18 | ppl    23.99
| epoch  10 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.83 | loss  3.26 | ppl    26.00
| epoch  10 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.91 | loss  3.10 | ppl    22.18
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 64.09s | valid loss  4.69 | valid ppl   108.81
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 5.00 | ms/batch 46.74 | loss  3.23 | ppl    25.21
| epoch  11 |   400/ 1327 batches | lr 5.00 | ms/batch 46.78 | loss  3.22 | ppl    25.05
| epoch  11 |   600/ 1327 batches | lr 5.00 | ms/batch 46.85 | loss  3.21 | ppl    24.70
| epoch  11 |   800/ 1327 batches | lr 5.00 | ms/batch 47.14 | loss  3.16 | ppl    23.54
| epoch  11 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.79 | loss  3.24 | ppl    25.58
| epoch  11 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.77 | loss  3.09 | ppl    21.87
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 64.04s | valid loss  4.69 | valid ppl   109.31
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 47.25 | loss  3.25 | ppl    25.84
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 47.05 | loss  3.24 | ppl    25.59
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 46.95 | loss  3.22 | ppl    25.10
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 46.66 | loss  3.16 | ppl    23.50
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.77 | loss  3.24 | ppl    25.49
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.77 | loss  3.08 | ppl    21.74
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 64.11s | valid loss  4.66 | valid ppl   105.89
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 47.36 | loss  3.23 | ppl    25.19
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 46.78 | loss  3.21 | ppl    24.84
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 46.81 | loss  3.20 | ppl    24.53
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 46.70 | loss  3.14 | ppl    23.21
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.89 | loss  3.23 | ppl    25.22
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.30 | loss  3.06 | ppl    21.30
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 64.21s | valid loss  4.66 | valid ppl   106.02
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 47.74 | loss  3.22 | ppl    24.97
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 46.95 | loss  3.21 | ppl    24.80
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 46.93 | loss  3.19 | ppl    24.38
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 47.06 | loss  3.14 | ppl    23.11
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.94 | loss  3.22 | ppl    24.95
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.97 | loss  3.05 | ppl    21.20
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 64.44s | valid loss  4.67 | valid ppl   106.20
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 0.31 | ms/batch 46.91 | loss  3.22 | ppl    25.00
| epoch  15 |   400/ 1327 batches | lr 0.31 | ms/batch 46.88 | loss  3.22 | ppl    25.08
| epoch  15 |   600/ 1327 batches | lr 0.31 | ms/batch 46.81 | loss  3.21 | ppl    24.74
| epoch  15 |   800/ 1327 batches | lr 0.31 | ms/batch 46.66 | loss  3.15 | ppl    23.37
| epoch  15 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.86 | loss  3.22 | ppl    25.05
| epoch  15 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.85 | loss  3.05 | ppl    21.09
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 64.00s | valid loss  4.64 | valid ppl   104.05
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 0.31 | ms/batch 46.77 | loss  3.25 | ppl    25.76
| epoch  16 |   400/ 1327 batches | lr 0.31 | ms/batch 46.68 | loss  3.23 | ppl    25.22
| epoch  16 |   600/ 1327 batches | lr 0.31 | ms/batch 47.16 | loss  3.23 | ppl    25.17
| epoch  16 |   800/ 1327 batches | lr 0.31 | ms/batch 46.88 | loss  3.16 | ppl    23.57
| epoch  16 |  1000/ 1327 batches | lr 0.31 | ms/batch 47.01 | loss  3.24 | ppl    25.42
| epoch  16 |  1200/ 1327 batches | lr 0.31 | ms/batch 47.02 | loss  3.08 | ppl    21.73
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 64.19s | valid loss  4.64 | valid ppl   103.31
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 0.31 | ms/batch 46.87 | loss  3.24 | ppl    25.57
| epoch  17 |   400/ 1327 batches | lr 0.31 | ms/batch 46.67 | loss  3.23 | ppl    25.34
| epoch  17 |   600/ 1327 batches | lr 0.31 | ms/batch 46.70 | loss  3.23 | ppl    25.34
| epoch  17 |   800/ 1327 batches | lr 0.31 | ms/batch 46.69 | loss  3.16 | ppl    23.62
| epoch  17 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.56 | loss  3.24 | ppl    25.63
| epoch  17 |  1200/ 1327 batches | lr 0.31 | ms/batch 47.23 | loss  3.08 | ppl    21.77
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.02s | valid loss  4.64 | valid ppl   103.06
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.31 | ms/batch 47.21 | loss  3.24 | ppl    25.66
| epoch  18 |   400/ 1327 batches | lr 0.31 | ms/batch 46.78 | loss  3.23 | ppl    25.40
| epoch  18 |   600/ 1327 batches | lr 0.31 | ms/batch 46.48 | loss  3.22 | ppl    25.05
| epoch  18 |   800/ 1327 batches | lr 0.31 | ms/batch 47.20 | loss  3.16 | ppl    23.56
| epoch  18 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.70 | loss  3.24 | ppl    25.57
| epoch  18 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.47 | loss  3.08 | ppl    21.86
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 64.02s | valid loss  4.63 | valid ppl   102.94
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.31 | ms/batch 46.53 | loss  3.28 | ppl    26.46
| epoch  19 |   400/ 1327 batches | lr 0.31 | ms/batch 46.76 | loss  3.27 | ppl    26.26
| epoch  19 |   600/ 1327 batches | lr 0.31 | ms/batch 46.80 | loss  3.25 | ppl    25.77
| epoch  19 |   800/ 1327 batches | lr 0.31 | ms/batch 46.80 | loss  3.20 | ppl    24.47
| epoch  19 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.84 | loss  3.27 | ppl    26.38
| epoch  19 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.62 | loss  3.11 | ppl    22.49
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.88s | valid loss  4.63 | valid ppl   102.24
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.31 | ms/batch 47.42 | loss  3.27 | ppl    26.23
| epoch  20 |   400/ 1327 batches | lr 0.31 | ms/batch 46.74 | loss  3.25 | ppl    25.86
| epoch  20 |   600/ 1327 batches | lr 0.31 | ms/batch 47.32 | loss  3.25 | ppl    25.84
| epoch  20 |   800/ 1327 batches | lr 0.31 | ms/batch 46.87 | loss  3.19 | ppl    24.23
| epoch  20 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.84 | loss  3.27 | ppl    26.34
| epoch  20 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.83 | loss  3.11 | ppl    22.33
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 64.23s | valid loss  4.63 | valid ppl   102.10
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.7593333333333333
sparsity at layer rnn.weight_hh_l0 is 0.7593333333333333
sparsity at layer rnn.weight_ih_l1 is 0.7593333333333333
sparsity at layer rnn.weight_hh_l1 is 0.7593333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.7070142768466792
=========================================================================================
| End of training | test loss  4.57 | test ppl    96.67
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 20 --dropout 0.55 --save sp78_epoch20_dropout0.55_lstm.pt --pretrained sp76_epoch20_dropout0.55_lstm.pt
debug
{'rnn.weight_ih_l0': 0.78, 'rnn.weight_hh_l0': 0.78, 'rnn.weight_ih_l1': 0.78, 'rnn.weight_hh_l1': 0.78}
{'rnn.weight_ih_l0': 0.78, 'rnn.weight_hh_l0': 0.78, 'rnn.weight_ih_l1': 0.78, 'rnn.weight_hh_l1': 0.78}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 51.44 | loss  8.76 | ppl  6365.63
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 46.73 | loss  4.80 | ppl   120.98
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 46.79 | loss  3.57 | ppl    35.36
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 47.34 | loss  3.13 | ppl    22.88
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 49.05 | loss  3.07 | ppl    21.48
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 49.62 | loss  2.82 | ppl    16.81
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 66.79s | valid loss  4.82 | valid ppl   124.41
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 54.18 | loss  4.06 | ppl    57.87
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 50.76 | loss  3.14 | ppl    23.00
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 50.78 | loss  2.94 | ppl    18.92
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 50.70 | loss  2.85 | ppl    17.35
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 50.57 | loss  2.91 | ppl    18.36
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.01 | loss  2.70 | ppl    14.84
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 70.30s | valid loss  4.88 | valid ppl   131.55
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 55.10 | loss  2.98 | ppl    19.74
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 51.42 | loss  2.88 | ppl    17.85
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 51.52 | loss  2.87 | ppl    17.55
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 51.40 | loss  2.82 | ppl    16.71
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.11 | loss  2.88 | ppl    17.87
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.25 | loss  2.68 | ppl    14.65
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 71.24s | valid loss  4.88 | valid ppl   132.21
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 56.11 | loss  2.92 | ppl    18.61
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 51.59 | loss  2.85 | ppl    17.28
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 51.61 | loss  2.84 | ppl    17.12
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 51.79 | loss  2.79 | ppl    16.33
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.53 | loss  2.86 | ppl    17.52
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.70 | loss  2.66 | ppl    14.34
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 71.69s | valid loss  4.90 | valid ppl   133.79
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 2.50 | ms/batch 56.80 | loss  3.10 | ppl    22.11
| epoch   5 |   400/ 1327 batches | lr 2.50 | ms/batch 52.00 | loss  3.00 | ppl    20.18
| epoch   5 |   600/ 1327 batches | lr 2.50 | ms/batch 51.87 | loss  2.97 | ppl    19.55
| epoch   5 |   800/ 1327 batches | lr 2.50 | ms/batch 53.23 | loss  2.92 | ppl    18.52
| epoch   5 |  1000/ 1327 batches | lr 2.50 | ms/batch 52.64 | loss  2.97 | ppl    19.55
| epoch   5 |  1200/ 1327 batches | lr 2.50 | ms/batch 52.40 | loss  2.79 | ppl    16.36
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 72.68s | valid loss  4.79 | valid ppl   120.59
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 2.50 | ms/batch 56.35 | loss  3.01 | ppl    20.26
| epoch   6 |   400/ 1327 batches | lr 2.50 | ms/batch 52.69 | loss  2.98 | ppl    19.60
| epoch   6 |   600/ 1327 batches | lr 2.50 | ms/batch 53.14 | loss  2.95 | ppl    19.13
| epoch   6 |   800/ 1327 batches | lr 2.50 | ms/batch 53.07 | loss  2.90 | ppl    18.12
| epoch   6 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.06 | loss  2.96 | ppl    19.37
| epoch   6 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.21 | loss  2.78 | ppl    16.07
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 73.28s | valid loss  4.80 | valid ppl   121.66
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 56.43 | loss  2.98 | ppl    19.72
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 52.96 | loss  2.95 | ppl    19.17
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 53.15 | loss  2.93 | ppl    18.79
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 53.30 | loss  2.88 | ppl    17.89
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.24 | loss  2.95 | ppl    19.09
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.36 | loss  2.78 | ppl    16.05
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 73.45s | valid loss  4.80 | valid ppl   121.63
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 57.44 | loss  2.97 | ppl    19.45
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 53.50 | loss  2.94 | ppl    19.00
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 54.48 | loss  2.93 | ppl    18.69
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 54.20 | loss  2.88 | ppl    17.76
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.03 | loss  2.94 | ppl    18.96
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.05 | loss  2.76 | ppl    15.87
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 74.71s | valid loss  4.80 | valid ppl   121.36
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 57.88 | loss  2.95 | ppl    19.08
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 53.67 | loss  2.92 | ppl    18.63
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 54.91 | loss  2.92 | ppl    18.50
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 54.72 | loss  2.86 | ppl    17.51
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.28 | loss  2.93 | ppl    18.75
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.05 | loss  2.75 | ppl    15.63
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 75.21s | valid loss  4.80 | valid ppl   121.41
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 2.50 | ms/batch 59.20 | loss  3.00 | ppl    20.18
| epoch  10 |   400/ 1327 batches | lr 2.50 | ms/batch 54.81 | loss  2.98 | ppl    19.67
| epoch  10 |   600/ 1327 batches | lr 2.50 | ms/batch 54.69 | loss  2.97 | ppl    19.46
| epoch  10 |   800/ 1327 batches | lr 2.50 | ms/batch 55.02 | loss  2.91 | ppl    18.36
| epoch  10 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.35 | loss  2.98 | ppl    19.62
| epoch  10 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.18 | loss  2.80 | ppl    16.53
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 76.19s | valid loss  4.78 | valid ppl   118.73
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 2.50 | ms/batch 58.72 | loss  2.38 | ppl    10.82
| epoch  11 |   400/ 1327 batches | lr 2.50 | ms/batch 55.25 | loss  2.40 | ppl    10.98
| epoch  11 |   600/ 1327 batches | lr 2.50 | ms/batch 54.85 | loss  2.40 | ppl    10.99
| epoch  11 |   800/ 1327 batches | lr 2.50 | ms/batch 55.74 | loss  2.36 | ppl    10.61
| epoch  11 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.48 | loss  2.42 | ppl    11.21
| epoch  11 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.44 | loss  2.27 | ppl     9.65
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 76.47s | valid loss  4.96 | valid ppl   142.14
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 60.37 | loss  2.47 | ppl    11.83
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 55.64 | loss  2.45 | ppl    11.59
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 56.01 | loss  2.43 | ppl    11.35
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 55.99 | loss  2.39 | ppl    10.88
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 55.49 | loss  2.45 | ppl    11.55
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.47 | loss  2.29 | ppl     9.91
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 77.47s | valid loss  4.94 | valid ppl   139.13
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 60.29 | loss  2.46 | ppl    11.71
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 56.06 | loss  2.44 | ppl    11.50
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 56.92 | loss  2.43 | ppl    11.35
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 56.46 | loss  2.39 | ppl    10.89
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.20 | loss  2.44 | ppl    11.47
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.98 | loss  2.28 | ppl     9.81
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 78.10s | valid loss  4.94 | valid ppl   140.24
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 60.81 | loss  2.90 | ppl    18.10
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 56.17 | loss  2.86 | ppl    17.39
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 56.88 | loss  2.84 | ppl    17.03
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 57.04 | loss  2.78 | ppl    16.15
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.99 | loss  2.84 | ppl    17.10
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.79 | loss  2.67 | ppl    14.46
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 78.41s | valid loss  4.83 | valid ppl   125.34
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 61.03 | loss  2.84 | ppl    17.05
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 57.40 | loss  2.82 | ppl    16.85
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 57.45 | loss  2.81 | ppl    16.57
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 57.16 | loss  2.75 | ppl    15.64
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.21 | loss  2.82 | ppl    16.74
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.30 | loss  2.65 | ppl    14.21
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 79.33s | valid loss  4.82 | valid ppl   124.16
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 61.70 | loss  2.85 | ppl    17.33
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 57.51 | loss  2.84 | ppl    17.12
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 58.50 | loss  2.82 | ppl    16.79
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 57.94 | loss  2.77 | ppl    15.96
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.82 | loss  2.84 | ppl    17.05
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.83 | loss  2.67 | ppl    14.41
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 80.04s | valid loss  4.81 | valid ppl   122.26
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 61.90 | loss  2.84 | ppl    17.11
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 58.57 | loss  2.82 | ppl    16.78
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 58.44 | loss  2.81 | ppl    16.57
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 58.45 | loss  2.75 | ppl    15.71
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.46 | loss  2.82 | ppl    16.82
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.36 | loss  2.65 | ppl    14.13
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 80.85s | valid loss  4.81 | valid ppl   122.72
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.62 | ms/batch 63.31 | loss  3.10 | ppl    22.19
| epoch  18 |   400/ 1327 batches | lr 0.62 | ms/batch 58.24 | loss  3.08 | ppl    21.76
| epoch  18 |   600/ 1327 batches | lr 0.62 | ms/batch 58.57 | loss  3.06 | ppl    21.34
| epoch  18 |   800/ 1327 batches | lr 0.62 | ms/batch 59.46 | loss  3.00 | ppl    20.08
| epoch  18 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.21 | loss  3.06 | ppl    21.36
| epoch  18 |  1200/ 1327 batches | lr 0.62 | ms/batch 59.28 | loss  2.89 | ppl    18.07
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 81.53s | valid loss  4.74 | valid ppl   114.98
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.62 | ms/batch 63.28 | loss  3.07 | ppl    21.50
| epoch  19 |   400/ 1327 batches | lr 0.62 | ms/batch 59.46 | loss  3.06 | ppl    21.23
| epoch  19 |   600/ 1327 batches | lr 0.62 | ms/batch 58.99 | loss  3.05 | ppl    21.03
| epoch  19 |   800/ 1327 batches | lr 0.62 | ms/batch 60.02 | loss  2.99 | ppl    19.81
| epoch  19 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.33 | loss  3.06 | ppl    21.25
| epoch  19 |  1200/ 1327 batches | lr 0.62 | ms/batch 59.81 | loss  2.89 | ppl    17.94
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 82.14s | valid loss  4.74 | valid ppl   113.98
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.62 | ms/batch 63.74 | loss  3.14 | ppl    23.19
| epoch  20 |   400/ 1327 batches | lr 0.62 | ms/batch 59.47 | loss  3.13 | ppl    22.96
| epoch  20 |   600/ 1327 batches | lr 0.62 | ms/batch 59.79 | loss  3.12 | ppl    22.60
| epoch  20 |   800/ 1327 batches | lr 0.62 | ms/batch 60.65 | loss  3.06 | ppl    21.35
| epoch  20 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.45 | loss  3.12 | ppl    22.72
| epoch  20 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.38 | loss  2.96 | ppl    19.25
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 82.88s | valid loss  4.72 | valid ppl   111.62
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.7793333333333333
sparsity at layer rnn.weight_hh_l0 is 0.7793333333333333
sparsity at layer rnn.weight_ih_l1 is 0.7793333333333333
sparsity at layer rnn.weight_hh_l1 is 0.7793333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.739405439595193
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 45.70 | loss  1.75 | ppl     5.75
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 46.09 | loss  1.80 | ppl     6.02
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 46.39 | loss  1.81 | ppl     6.13
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 46.55 | loss  1.81 | ppl     6.09
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.45 | loss  1.90 | ppl     6.67
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.41 | loss  1.77 | ppl     5.90
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 63.30s | valid loss  5.40 | valid ppl   220.57
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 46.77 | loss  1.86 | ppl     6.45
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 47.12 | loss  1.87 | ppl     6.48
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 46.83 | loss  1.88 | ppl     6.56
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 46.47 | loss  1.87 | ppl     6.47
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 47.02 | loss  1.94 | ppl     6.93
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.99 | loss  1.82 | ppl     6.17
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 64.08s | valid loss  5.42 | valid ppl   225.02
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 47.18 | loss  1.91 | ppl     6.78
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 46.82 | loss  1.91 | ppl     6.74
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 46.96 | loss  1.91 | ppl     6.76
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 46.83 | loss  1.90 | ppl     6.66
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.58 | loss  1.97 | ppl     7.19
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.54 | loss  1.85 | ppl     6.33
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 63.98s | valid loss  5.42 | valid ppl   225.47
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 47.54 | loss  2.97 | ppl    19.52
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 47.11 | loss  2.87 | ppl    17.64
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 46.93 | loss  2.83 | ppl    16.92
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 46.81 | loss  2.75 | ppl    15.68
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.66 | loss  2.82 | ppl    16.83
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.96 | loss  2.64 | ppl    13.98
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 64.24s | valid loss  4.97 | valid ppl   143.46
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 46.33 | loss  2.78 | ppl    16.09
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 46.45 | loss  2.74 | ppl    15.56
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 46.43 | loss  2.73 | ppl    15.32
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 46.53 | loss  2.68 | ppl    14.59
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.38 | loss  2.75 | ppl    15.67
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.84 | loss  2.59 | ppl    13.30
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 63.59s | valid loss  4.96 | valid ppl   142.01
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 47.26 | loss  2.72 | ppl    15.15
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 46.87 | loss  2.71 | ppl    15.02
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 46.56 | loss  2.69 | ppl    14.71
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 46.71 | loss  2.64 | ppl    14.01
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.66 | loss  2.71 | ppl    15.07
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.65 | loss  2.55 | ppl    12.81
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 63.96s | valid loss  4.96 | valid ppl   143.28
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 47.43 | loss  3.11 | ppl    22.38
| epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 46.85 | loss  3.09 | ppl    21.92
| epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 46.89 | loss  3.07 | ppl    21.50
| epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 46.83 | loss  3.01 | ppl    20.33
| epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.89 | loss  3.10 | ppl    22.14
| epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.81 | loss  2.93 | ppl    18.70
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.16s | valid loss  4.81 | valid ppl   122.93
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch 46.17 | loss  3.06 | ppl    21.39
| epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch 46.07 | loss  3.06 | ppl    21.23
| epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch 46.70 | loss  3.04 | ppl    20.88
| epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch 46.63 | loss  2.99 | ppl    19.90
| epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.53 | loss  3.08 | ppl    21.68
| epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.54 | loss  2.91 | ppl    18.27
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 63.49s | valid loss  4.81 | valid ppl   122.60
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 5.00 | ms/batch 46.84 | loss  3.12 | ppl    22.62
| epoch   9 |   400/ 1327 batches | lr 5.00 | ms/batch 46.85 | loss  3.10 | ppl    22.27
| epoch   9 |   600/ 1327 batches | lr 5.00 | ms/batch 46.41 | loss  3.09 | ppl    21.99
| epoch   9 |   800/ 1327 batches | lr 5.00 | ms/batch 46.45 | loss  3.04 | ppl    20.86
| epoch   9 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.80 | loss  3.13 | ppl    22.81
| epoch   9 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.92 | loss  2.96 | ppl    19.28
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 63.86s | valid loss  4.78 | valid ppl   119.56
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 5.00 | ms/batch 46.52 | loss  3.09 | ppl    22.05
| epoch  10 |   400/ 1327 batches | lr 5.00 | ms/batch 46.79 | loss  3.09 | ppl    21.98
| epoch  10 |   600/ 1327 batches | lr 5.00 | ms/batch 46.88 | loss  3.08 | ppl    21.69
| epoch  10 |   800/ 1327 batches | lr 5.00 | ms/batch 46.75 | loss  3.03 | ppl    20.69
| epoch  10 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.78 | loss  3.11 | ppl    22.46
| epoch  10 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.34 | loss  2.95 | ppl    19.11
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 63.80s | valid loss  4.78 | valid ppl   118.51
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 5.00 | ms/batch 47.06 | loss  3.08 | ppl    21.75
| epoch  11 |   400/ 1327 batches | lr 5.00 | ms/batch 46.86 | loss  3.07 | ppl    21.61
| epoch  11 |   600/ 1327 batches | lr 5.00 | ms/batch 46.57 | loss  3.06 | ppl    21.34
| epoch  11 |   800/ 1327 batches | lr 5.00 | ms/batch 46.23 | loss  3.01 | ppl    20.34
| epoch  11 |  1000/ 1327 batches | lr 5.00 | ms/batch 47.33 | loss  3.09 | ppl    22.06
| epoch  11 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.97 | loss  2.94 | ppl    18.91
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 64.05s | valid loss  4.78 | valid ppl   119.23
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 47.03 | loss  3.24 | ppl    25.64
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 46.41 | loss  3.23 | ppl    25.37
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 46.57 | loss  3.21 | ppl    24.77
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 46.84 | loss  3.14 | ppl    23.22
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.52 | loss  3.22 | ppl    25.14
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.70 | loss  3.07 | ppl    21.50
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 63.79s | valid loss  4.71 | valid ppl   110.62
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 46.80 | loss  3.21 | ppl    24.78
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 46.73 | loss  3.20 | ppl    24.51
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 46.69 | loss  3.19 | ppl    24.17
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 46.67 | loss  3.13 | ppl    22.92
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.59 | loss  3.21 | ppl    24.87
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.69 | loss  3.05 | ppl    21.04
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 63.82s | valid loss  4.70 | valid ppl   109.96
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 47.00 | loss  3.20 | ppl    24.51
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 46.93 | loss  3.20 | ppl    24.44
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 46.82 | loss  3.18 | ppl    23.99
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 46.90 | loss  3.13 | ppl    22.76
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.72 | loss  3.20 | ppl    24.57
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.85 | loss  3.04 | ppl    20.97
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 64.05s | valid loss  4.70 | valid ppl   109.69
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 46.65 | loss  3.23 | ppl    25.21
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 46.17 | loss  3.22 | ppl    25.01
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 46.28 | loss  3.21 | ppl    24.72
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 46.36 | loss  3.15 | ppl    23.39
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.34 | loss  3.23 | ppl    25.19
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.75 | loss  3.07 | ppl    21.61
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 63.48s | valid loss  4.69 | valid ppl   108.64
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 47.00 | loss  3.24 | ppl    25.59
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 46.97 | loss  3.23 | ppl    25.16
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 46.69 | loss  3.22 | ppl    25.03
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 46.61 | loss  3.16 | ppl    23.58
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.58 | loss  3.23 | ppl    25.34
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.46 | loss  3.09 | ppl    21.99
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.88s | valid loss  4.68 | valid ppl   107.63
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 47.25 | loss  3.23 | ppl    25.31
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 46.89 | loss  3.23 | ppl    25.25
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 46.67 | loss  3.22 | ppl    25.12
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 46.60 | loss  3.16 | ppl    23.50
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 47.16 | loss  3.24 | ppl    25.45
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.72 | loss  3.09 | ppl    21.93
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.08s | valid loss  4.67 | valid ppl   107.12
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 1.25 | ms/batch 47.04 | loss  3.23 | ppl    25.28
| epoch  18 |   400/ 1327 batches | lr 1.25 | ms/batch 46.89 | loss  3.23 | ppl    25.16
| epoch  18 |   600/ 1327 batches | lr 1.25 | ms/batch 46.88 | loss  3.21 | ppl    24.84
| epoch  18 |   800/ 1327 batches | lr 1.25 | ms/batch 46.83 | loss  3.15 | ppl    23.37
| epoch  18 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.89 | loss  3.23 | ppl    25.33
| epoch  18 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.57 | loss  3.09 | ppl    21.93
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 64.00s | valid loss  4.67 | valid ppl   107.03
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 1.25 | ms/batch 46.87 | loss  3.25 | ppl    25.79
| epoch  19 |   400/ 1327 batches | lr 1.25 | ms/batch 46.87 | loss  3.25 | ppl    25.75
| epoch  19 |   600/ 1327 batches | lr 1.25 | ms/batch 46.67 | loss  3.23 | ppl    25.31
| epoch  19 |   800/ 1327 batches | lr 1.25 | ms/batch 46.62 | loss  3.18 | ppl    23.95
| epoch  19 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.38 | loss  3.25 | ppl    25.83
| epoch  19 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.48 | loss  3.10 | ppl    22.27
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.73s | valid loss  4.67 | valid ppl   106.29
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 1.25 | ms/batch 47.04 | loss  3.24 | ppl    25.54
| epoch  20 |   400/ 1327 batches | lr 1.25 | ms/batch 46.97 | loss  3.23 | ppl    25.31
| epoch  20 |   600/ 1327 batches | lr 1.25 | ms/batch 46.61 | loss  3.23 | ppl    25.22
| epoch  20 |   800/ 1327 batches | lr 1.25 | ms/batch 46.76 | loss  3.16 | ppl    23.68
| epoch  20 |  1000/ 1327 batches | lr 1.25 | ms/batch 47.05 | loss  3.25 | ppl    25.73
| epoch  20 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.00 | loss  3.09 | ppl    22.05
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 64.13s | valid loss  4.67 | valid ppl   106.47
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.7793333333333333
sparsity at layer rnn.weight_hh_l0 is 0.7793333333333333
sparsity at layer rnn.weight_ih_l1 is 0.7793333333333333
sparsity at layer rnn.weight_hh_l1 is 0.7793333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.739405439595193
=========================================================================================
| End of training | test loss  4.61 | test ppl   100.46
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 40 --dropout 0.50 --save sp80_epoch40_dropout0.50_lstm.pt --pretrained sp78_epoch20_dropout0.55_lstm.pt
debug
{'rnn.weight_ih_l0': 0.8, 'rnn.weight_hh_l0': 0.8, 'rnn.weight_ih_l1': 0.8, 'rnn.weight_hh_l1': 0.8}
{'rnn.weight_ih_l0': 0.8, 'rnn.weight_hh_l0': 0.8, 'rnn.weight_ih_l1': 0.8, 'rnn.weight_hh_l1': 0.8}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 51.47 | loss 11.30 | ppl 80592.81
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 46.97 | loss  5.69 | ppl   295.67
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 47.60 | loss  3.89 | ppl    48.70
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 48.71 | loss  3.26 | ppl    25.94
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 49.71 | loss  3.12 | ppl    22.71
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 49.82 | loss  2.86 | ppl    17.50
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 67.36s | valid loss  4.83 | valid ppl   124.73
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 54.56 | loss  4.47 | ppl    87.02
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 49.99 | loss  3.22 | ppl    25.06
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 49.95 | loss  2.95 | ppl    19.18
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 50.40 | loss  2.85 | ppl    17.26
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 50.40 | loss  2.90 | ppl    18.21
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 50.30 | loss  2.69 | ppl    14.75
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 69.81s | valid loss  4.89 | valid ppl   133.40
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 55.65 | loss  2.98 | ppl    19.75
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 51.02 | loss  2.87 | ppl    17.69
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 51.01 | loss  2.86 | ppl    17.38
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 51.25 | loss  2.80 | ppl    16.52
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.63 | loss  2.87 | ppl    17.68
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.53 | loss  2.68 | ppl    14.53
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 71.14s | valid loss  4.91 | valid ppl   135.28
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 55.45 | loss  2.92 | ppl    18.53
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 51.01 | loss  2.84 | ppl    17.14
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 51.53 | loss  2.83 | ppl    16.91
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 51.80 | loss  2.79 | ppl    16.24
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.92 | loss  2.85 | ppl    17.37
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.95 | loss  2.66 | ppl    14.24
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 71.56s | valid loss  4.91 | valid ppl   136.01
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 2.50 | ms/batch 56.14 | loss  3.09 | ppl    22.08
| epoch   5 |   400/ 1327 batches | lr 2.50 | ms/batch 51.98 | loss  3.00 | ppl    20.17
| epoch   5 |   600/ 1327 batches | lr 2.50 | ms/batch 51.87 | loss  2.97 | ppl    19.53
| epoch   5 |   800/ 1327 batches | lr 2.50 | ms/batch 51.54 | loss  2.92 | ppl    18.49
| epoch   5 |  1000/ 1327 batches | lr 2.50 | ms/batch 52.20 | loss  2.97 | ppl    19.53
| epoch   5 |  1200/ 1327 batches | lr 2.50 | ms/batch 52.63 | loss  2.79 | ppl    16.36
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 72.21s | valid loss  4.81 | valid ppl   122.78
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 2.50 | ms/batch 56.43 | loss  3.01 | ppl    20.28
| epoch   6 |   400/ 1327 batches | lr 2.50 | ms/batch 52.29 | loss  2.97 | ppl    19.57
| epoch   6 |   600/ 1327 batches | lr 2.50 | ms/batch 52.47 | loss  2.95 | ppl    19.15
| epoch   6 |   800/ 1327 batches | lr 2.50 | ms/batch 53.55 | loss  2.90 | ppl    18.13
| epoch   6 |  1000/ 1327 batches | lr 2.50 | ms/batch 52.95 | loss  2.96 | ppl    19.35
| epoch   6 |  1200/ 1327 batches | lr 2.50 | ms/batch 52.94 | loss  2.78 | ppl    16.13
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 73.09s | valid loss  4.81 | valid ppl   123.16
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 56.86 | loss  2.98 | ppl    19.72
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 53.39 | loss  2.95 | ppl    19.15
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 53.19 | loss  2.93 | ppl    18.76
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 53.23 | loss  2.89 | ppl    17.93
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.26 | loss  2.95 | ppl    19.07
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.22 | loss  2.78 | ppl    16.06
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 73.67s | valid loss  4.81 | valid ppl   123.27
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 57.68 | loss  2.97 | ppl    19.41
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 53.57 | loss  2.94 | ppl    18.94
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 53.78 | loss  2.93 | ppl    18.67
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 53.96 | loss  2.88 | ppl    17.77
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.11 | loss  2.94 | ppl    18.98
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.08 | loss  2.77 | ppl    15.91
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 74.60s | valid loss  4.81 | valid ppl   123.04
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 57.94 | loss  2.95 | ppl    19.05
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 54.41 | loss  2.92 | ppl    18.62
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 54.31 | loss  2.92 | ppl    18.52
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 54.36 | loss  2.87 | ppl    17.57
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.29 | loss  2.93 | ppl    18.76
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.58 | loss  2.75 | ppl    15.66
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 75.20s | valid loss  4.81 | valid ppl   122.97
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 2.50 | ms/batch 58.79 | loss  2.99 | ppl    19.98
| epoch  10 |   400/ 1327 batches | lr 2.50 | ms/batch 54.50 | loss  2.97 | ppl    19.48
| epoch  10 |   600/ 1327 batches | lr 2.50 | ms/batch 54.52 | loss  2.96 | ppl    19.26
| epoch  10 |   800/ 1327 batches | lr 2.50 | ms/batch 54.40 | loss  2.90 | ppl    18.24
| epoch  10 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.55 | loss  2.97 | ppl    19.46
| epoch  10 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.83 | loss  2.80 | ppl    16.38
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 75.54s | valid loss  4.80 | valid ppl   120.99
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 2.50 | ms/batch 59.06 | loss  2.45 | ppl    11.56
| epoch  11 |   400/ 1327 batches | lr 2.50 | ms/batch 54.83 | loss  2.46 | ppl    11.68
| epoch  11 |   600/ 1327 batches | lr 2.50 | ms/batch 55.13 | loss  2.46 | ppl    11.69
| epoch  11 |   800/ 1327 batches | lr 2.50 | ms/batch 55.92 | loss  2.42 | ppl    11.27
| epoch  11 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.29 | loss  2.48 | ppl    11.95
| epoch  11 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.17 | loss  2.33 | ppl    10.28
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 76.35s | valid loss  4.95 | valid ppl   141.19
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 59.74 | loss  2.55 | ppl    12.77
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 55.16 | loss  2.53 | ppl    12.54
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 55.68 | loss  2.50 | ppl    12.24
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 56.33 | loss  2.46 | ppl    11.72
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.39 | loss  2.52 | ppl    12.49
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.12 | loss  2.37 | ppl    10.70
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 77.30s | valid loss  4.92 | valid ppl   137.49
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 60.51 | loss  2.54 | ppl    12.65
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 56.15 | loss  2.52 | ppl    12.48
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 56.13 | loss  2.51 | ppl    12.28
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 56.29 | loss  2.47 | ppl    11.78
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.92 | loss  2.52 | ppl    12.41
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.73 | loss  2.37 | ppl    10.66
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 78.03s | valid loss  4.93 | valid ppl   137.74
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 60.78 | loss  2.92 | ppl    18.48
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 56.15 | loss  2.88 | ppl    17.77
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 57.00 | loss  2.86 | ppl    17.47
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 56.74 | loss  2.81 | ppl    16.59
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.72 | loss  2.87 | ppl    17.58
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.71 | loss  2.70 | ppl    14.85
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 78.32s | valid loss  4.83 | valid ppl   125.47
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 61.19 | loss  2.86 | ppl    17.53
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 57.03 | loss  2.85 | ppl    17.35
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 57.15 | loss  2.84 | ppl    17.11
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 57.07 | loss  2.78 | ppl    16.17
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.06 | loss  2.85 | ppl    17.25
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.66 | loss  2.69 | ppl    14.69
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 79.36s | valid loss  4.82 | valid ppl   124.43
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 61.64 | loss  2.88 | ppl    17.80
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 57.24 | loss  2.87 | ppl    17.59
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 57.61 | loss  2.85 | ppl    17.27
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 58.42 | loss  2.80 | ppl    16.43
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.96 | loss  2.87 | ppl    17.59
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.97 | loss  2.70 | ppl    14.85
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 79.83s | valid loss  4.81 | valid ppl   122.71
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 61.99 | loss  2.87 | ppl    17.63
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 58.29 | loss  2.85 | ppl    17.26
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 58.52 | loss  2.84 | ppl    17.11
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 58.12 | loss  2.79 | ppl    16.26
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.20 | loss  2.85 | ppl    17.37
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.90 | loss  2.68 | ppl    14.58
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 80.60s | valid loss  4.81 | valid ppl   122.95
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.62 | ms/batch 62.79 | loss  3.11 | ppl    22.44
| epoch  18 |   400/ 1327 batches | lr 0.62 | ms/batch 58.34 | loss  3.09 | ppl    22.06
| epoch  18 |   600/ 1327 batches | lr 0.62 | ms/batch 58.27 | loss  3.08 | ppl    21.67
| epoch  18 |   800/ 1327 batches | lr 0.62 | ms/batch 59.01 | loss  3.02 | ppl    20.39
| epoch  18 |  1000/ 1327 batches | lr 0.62 | ms/batch 58.96 | loss  3.08 | ppl    21.68
| epoch  18 |  1200/ 1327 batches | lr 0.62 | ms/batch 58.76 | loss  2.91 | ppl    18.41
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 81.17s | valid loss  4.75 | valid ppl   115.75
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.62 | ms/batch 63.12 | loss  3.08 | ppl    21.81
| epoch  19 |   400/ 1327 batches | lr 0.62 | ms/batch 58.86 | loss  3.07 | ppl    21.49
| epoch  19 |   600/ 1327 batches | lr 0.62 | ms/batch 59.58 | loss  3.06 | ppl    21.37
| epoch  19 |   800/ 1327 batches | lr 0.62 | ms/batch 59.43 | loss  3.00 | ppl    20.15
| epoch  19 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.32 | loss  3.07 | ppl    21.65
| epoch  19 |  1200/ 1327 batches | lr 0.62 | ms/batch 59.95 | loss  2.91 | ppl    18.29
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 81.99s | valid loss  4.74 | valid ppl   114.81
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.62 | ms/batch 63.73 | loss  3.15 | ppl    23.24
| epoch  20 |   400/ 1327 batches | lr 0.62 | ms/batch 59.48 | loss  3.13 | ppl    22.99
| epoch  20 |   600/ 1327 batches | lr 0.62 | ms/batch 59.98 | loss  3.12 | ppl    22.64
| epoch  20 |   800/ 1327 batches | lr 0.62 | ms/batch 60.06 | loss  3.07 | ppl    21.49
| epoch  20 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.07 | loss  3.13 | ppl    22.85
| epoch  20 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.15 | loss  2.96 | ppl    19.39
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 82.56s | valid loss  4.73 | valid ppl   112.78
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 0.62 | ms/batch 64.12 | loss  1.80 | ppl     6.03
| epoch  21 |   400/ 1327 batches | lr 0.62 | ms/batch 59.65 | loss  1.84 | ppl     6.30
| epoch  21 |   600/ 1327 batches | lr 0.62 | ms/batch 59.99 | loss  1.83 | ppl     6.22
| epoch  21 |   800/ 1327 batches | lr 0.62 | ms/batch 59.56 | loss  1.79 | ppl     5.98
| epoch  21 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.35 | loss  1.84 | ppl     6.29
| epoch  21 |  1200/ 1327 batches | lr 0.62 | ms/batch 59.76 | loss  1.70 | ppl     5.49
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 82.76s | valid loss  5.06 | valid ppl   157.09
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 0.62 | ms/batch 65.26 | loss  1.81 | ppl     6.11
| epoch  22 |   400/ 1327 batches | lr 0.62 | ms/batch 60.52 | loss  1.80 | ppl     6.06
| epoch  22 |   600/ 1327 batches | lr 0.62 | ms/batch 61.00 | loss  1.79 | ppl     6.00
| epoch  22 |   800/ 1327 batches | lr 0.62 | ms/batch 61.17 | loss  1.75 | ppl     5.74
| epoch  22 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.87 | loss  1.79 | ppl     5.96
| epoch  22 |  1200/ 1327 batches | lr 0.62 | ms/batch 61.30 | loss  1.66 | ppl     5.24
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 84.10s | valid loss  5.13 | valid ppl   169.36
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 0.62 | ms/batch 65.57 | loss  1.75 | ppl     5.77
| epoch  23 |   400/ 1327 batches | lr 0.62 | ms/batch 60.80 | loss  1.74 | ppl     5.70
| epoch  23 |   600/ 1327 batches | lr 0.62 | ms/batch 61.45 | loss  1.72 | ppl     5.60
| epoch  23 |   800/ 1327 batches | lr 0.62 | ms/batch 61.93 | loss  1.67 | ppl     5.33
| epoch  23 |  1000/ 1327 batches | lr 0.62 | ms/batch 61.50 | loss  1.71 | ppl     5.54
| epoch  23 |  1200/ 1327 batches | lr 0.62 | ms/batch 61.80 | loss  1.58 | ppl     4.87
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 84.82s | valid loss  5.19 | valid ppl   179.36
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.31 | ms/batch 65.87 | loss  2.65 | ppl    14.21
| epoch  24 |   400/ 1327 batches | lr 0.31 | ms/batch 61.70 | loss  2.62 | ppl    13.72
| epoch  24 |   600/ 1327 batches | lr 0.31 | ms/batch 61.56 | loss  2.59 | ppl    13.36
| epoch  24 |   800/ 1327 batches | lr 0.31 | ms/batch 61.81 | loss  2.52 | ppl    12.44
| epoch  24 |  1000/ 1327 batches | lr 0.31 | ms/batch 61.65 | loss  2.58 | ppl    13.21
| epoch  24 |  1200/ 1327 batches | lr 0.31 | ms/batch 61.89 | loss  2.40 | ppl    10.99
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 85.05s | valid loss  5.01 | valid ppl   149.65
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.31 | ms/batch 66.01 | loss  2.55 | ppl    12.85
| epoch  25 |   400/ 1327 batches | lr 0.31 | ms/batch 61.96 | loss  2.53 | ppl    12.59
| epoch  25 |   600/ 1327 batches | lr 0.31 | ms/batch 62.30 | loss  2.52 | ppl    12.45
| epoch  25 |   800/ 1327 batches | lr 0.31 | ms/batch 62.42 | loss  2.47 | ppl    11.87
| epoch  25 |  1000/ 1327 batches | lr 0.31 | ms/batch 62.37 | loss  2.53 | ppl    12.57
| epoch  25 |  1200/ 1327 batches | lr 0.31 | ms/batch 62.44 | loss  2.37 | ppl    10.66
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 85.63s | valid loss  4.99 | valid ppl   146.65
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.31 | ms/batch 66.85 | loss  2.51 | ppl    12.36
| epoch  26 |   400/ 1327 batches | lr 0.31 | ms/batch 62.77 | loss  2.51 | ppl    12.28
| epoch  26 |   600/ 1327 batches | lr 0.31 | ms/batch 62.51 | loss  2.49 | ppl    12.03
| epoch  26 |   800/ 1327 batches | lr 0.31 | ms/batch 63.16 | loss  2.44 | ppl    11.48
| epoch  26 |  1000/ 1327 batches | lr 0.31 | ms/batch 63.32 | loss  2.50 | ppl    12.17
| epoch  26 |  1200/ 1327 batches | lr 0.31 | ms/batch 63.47 | loss  2.33 | ppl    10.32
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 86.76s | valid loss  4.97 | valid ppl   144.57
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.31 | ms/batch 67.11 | loss  2.82 | ppl    16.85
| epoch  27 |   400/ 1327 batches | lr 0.31 | ms/batch 64.22 | loss  2.81 | ppl    16.57
| epoch  27 |   600/ 1327 batches | lr 0.31 | ms/batch 62.88 | loss  2.79 | ppl    16.36
| epoch  27 |   800/ 1327 batches | lr 0.31 | ms/batch 63.41 | loss  2.74 | ppl    15.46
| epoch  27 |  1000/ 1327 batches | lr 0.31 | ms/batch 63.30 | loss  2.81 | ppl    16.59
| epoch  27 |  1200/ 1327 batches | lr 0.31 | ms/batch 63.64 | loss  2.63 | ppl    13.90
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 87.23s | valid loss  4.91 | valid ppl   135.23
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.31 | ms/batch 67.73 | loss  2.79 | ppl    16.34
| epoch  28 |   400/ 1327 batches | lr 0.31 | ms/batch 63.79 | loss  2.78 | ppl    16.14
| epoch  28 |   600/ 1327 batches | lr 0.31 | ms/batch 64.14 | loss  2.77 | ppl    15.96
| epoch  28 |   800/ 1327 batches | lr 0.31 | ms/batch 64.19 | loss  2.72 | ppl    15.18
| epoch  28 |  1000/ 1327 batches | lr 0.31 | ms/batch 64.14 | loss  2.79 | ppl    16.33
| epoch  28 |  1200/ 1327 batches | lr 0.31 | ms/batch 64.10 | loss  2.62 | ppl    13.67
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 88.22s | valid loss  4.89 | valid ppl   133.30
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.31 | ms/batch 68.17 | loss  2.84 | ppl    17.18
| epoch  29 |   400/ 1327 batches | lr 0.31 | ms/batch 64.19 | loss  2.82 | ppl    16.81
| epoch  29 |   600/ 1327 batches | lr 0.31 | ms/batch 64.48 | loss  2.81 | ppl    16.67
| epoch  29 |   800/ 1327 batches | lr 0.31 | ms/batch 64.56 | loss  2.76 | ppl    15.81
| epoch  29 |  1000/ 1327 batches | lr 0.31 | ms/batch 64.42 | loss  2.84 | ppl    17.09
| epoch  29 |  1200/ 1327 batches | lr 0.31 | ms/batch 64.74 | loss  2.66 | ppl    14.23
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 88.59s | valid loss  4.87 | valid ppl   130.73
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.31 | ms/batch 69.19 | loss  2.82 | ppl    16.77
| epoch  30 |   400/ 1327 batches | lr 0.31 | ms/batch 65.08 | loss  2.81 | ppl    16.65
| epoch  30 |   600/ 1327 batches | lr 0.31 | ms/batch 65.50 | loss  2.80 | ppl    16.41
| epoch  30 |   800/ 1327 batches | lr 0.31 | ms/batch 65.43 | loss  2.75 | ppl    15.70
| epoch  30 |  1000/ 1327 batches | lr 0.31 | ms/batch 65.58 | loss  2.82 | ppl    16.80
| epoch  30 |  1200/ 1327 batches | lr 0.31 | ms/batch 65.47 | loss  2.65 | ppl    14.10
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 89.80s | valid loss  4.87 | valid ppl   129.96
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.31 | ms/batch 69.72 | loss  2.81 | ppl    16.53
| epoch  31 |   400/ 1327 batches | lr 0.31 | ms/batch 65.38 | loss  2.80 | ppl    16.43
| epoch  31 |   600/ 1327 batches | lr 0.31 | ms/batch 65.84 | loss  2.78 | ppl    16.15
| epoch  31 |   800/ 1327 batches | lr 0.31 | ms/batch 66.12 | loss  2.74 | ppl    15.42
| epoch  31 |  1000/ 1327 batches | lr 0.31 | ms/batch 65.79 | loss  2.80 | ppl    16.50
| epoch  31 |  1200/ 1327 batches | lr 0.31 | ms/batch 65.89 | loss  2.64 | ppl    14.00
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 90.29s | valid loss  4.86 | valid ppl   129.54
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.31 | ms/batch 69.85 | loss  3.15 | ppl    23.28
| epoch  32 |   400/ 1327 batches | lr 0.31 | ms/batch 66.29 | loss  3.13 | ppl    22.89
| epoch  32 |   600/ 1327 batches | lr 0.31 | ms/batch 65.84 | loss  3.11 | ppl    22.53
| epoch  32 |   800/ 1327 batches | lr 0.31 | ms/batch 66.01 | loss  3.05 | ppl    21.19
| epoch  32 |  1000/ 1327 batches | lr 0.31 | ms/batch 66.12 | loss  3.14 | ppl    23.03
| epoch  32 |  1200/ 1327 batches | lr 0.31 | ms/batch 66.05 | loss  2.96 | ppl    19.36
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 90.78s | valid loss  4.80 | valid ppl   121.38
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.31 | ms/batch 70.43 | loss  3.12 | ppl    22.75
| epoch  33 |   400/ 1327 batches | lr 0.31 | ms/batch 66.52 | loss  3.11 | ppl    22.47
| epoch  33 |   600/ 1327 batches | lr 0.31 | ms/batch 66.83 | loss  3.10 | ppl    22.23
| epoch  33 |   800/ 1327 batches | lr 0.31 | ms/batch 66.85 | loss  3.05 | ppl    21.02
| epoch  33 |  1000/ 1327 batches | lr 0.31 | ms/batch 67.23 | loss  3.13 | ppl    22.88
| epoch  33 |  1200/ 1327 batches | lr 0.31 | ms/batch 66.76 | loss  2.94 | ppl    18.98
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 91.74s | valid loss  4.78 | valid ppl   119.22
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.31 | ms/batch 71.27 | loss  3.12 | ppl    22.66
| epoch  34 |   400/ 1327 batches | lr 0.31 | ms/batch 67.55 | loss  3.11 | ppl    22.50
| epoch  34 |   600/ 1327 batches | lr 0.31 | ms/batch 67.76 | loss  3.09 | ppl    22.08
| epoch  34 |   800/ 1327 batches | lr 0.31 | ms/batch 67.64 | loss  3.05 | ppl    21.01
| epoch  34 |  1000/ 1327 batches | lr 0.31 | ms/batch 67.75 | loss  3.12 | ppl    22.66
| epoch  34 |  1200/ 1327 batches | lr 0.31 | ms/batch 67.38 | loss  2.94 | ppl    18.99
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 92.77s | valid loss  4.77 | valid ppl   117.71
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.31 | ms/batch 71.67 | loss  3.15 | ppl    23.23
| epoch  35 |   400/ 1327 batches | lr 0.31 | ms/batch 67.25 | loss  3.13 | ppl    22.91
| epoch  35 |   600/ 1327 batches | lr 0.31 | ms/batch 67.90 | loss  3.12 | ppl    22.69
| epoch  35 |   800/ 1327 batches | lr 0.31 | ms/batch 67.92 | loss  3.07 | ppl    21.51
| epoch  35 |  1000/ 1327 batches | lr 0.31 | ms/batch 67.92 | loss  3.14 | ppl    23.18
| epoch  35 |  1200/ 1327 batches | lr 0.31 | ms/batch 67.78 | loss  2.97 | ppl    19.50
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 92.92s | valid loss  4.76 | valid ppl   116.38
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.31 | ms/batch 72.52 | loss  3.16 | ppl    23.66
| epoch  36 |   400/ 1327 batches | lr 0.31 | ms/batch 68.50 | loss  3.14 | ppl    23.07
| epoch  36 |   600/ 1327 batches | lr 0.31 | ms/batch 68.82 | loss  3.14 | ppl    23.01
| epoch  36 |   800/ 1327 batches | lr 0.31 | ms/batch 68.66 | loss  3.08 | ppl    21.70
| epoch  36 |  1000/ 1327 batches | lr 0.31 | ms/batch 68.79 | loss  3.15 | ppl    23.32
| epoch  36 |  1200/ 1327 batches | lr 0.31 | ms/batch 68.60 | loss  2.99 | ppl    19.82
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 94.08s | valid loss  4.75 | valid ppl   115.09
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.31 | ms/batch 73.11 | loss  3.16 | ppl    23.48
| epoch  37 |   400/ 1327 batches | lr 0.31 | ms/batch 68.62 | loss  3.15 | ppl    23.23
| epoch  37 |   600/ 1327 batches | lr 0.31 | ms/batch 69.01 | loss  3.14 | ppl    23.18
| epoch  37 |   800/ 1327 batches | lr 0.31 | ms/batch 68.90 | loss  3.08 | ppl    21.74
| epoch  37 |  1000/ 1327 batches | lr 0.31 | ms/batch 68.88 | loss  3.16 | ppl    23.47
| epoch  37 |  1200/ 1327 batches | lr 0.31 | ms/batch 69.10 | loss  2.99 | ppl    19.84
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 94.45s | valid loss  4.74 | valid ppl   114.32
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.31 | ms/batch 73.52 | loss  3.16 | ppl    23.46
| epoch  38 |   400/ 1327 batches | lr 0.31 | ms/batch 68.77 | loss  3.15 | ppl    23.33
| epoch  38 |   600/ 1327 batches | lr 0.31 | ms/batch 69.70 | loss  3.14 | ppl    23.06
| epoch  38 |   800/ 1327 batches | lr 0.31 | ms/batch 69.80 | loss  3.08 | ppl    21.68
| epoch  38 |  1000/ 1327 batches | lr 0.31 | ms/batch 69.86 | loss  3.15 | ppl    23.42
| epoch  38 |  1200/ 1327 batches | lr 0.31 | ms/batch 69.94 | loss  2.99 | ppl    19.90
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 95.42s | valid loss  4.73 | valid ppl   113.74
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.31 | ms/batch 73.41 | loss  3.18 | ppl    24.03
| epoch  39 |   400/ 1327 batches | lr 0.31 | ms/batch 69.96 | loss  3.17 | ppl    23.87
| epoch  39 |   600/ 1327 batches | lr 0.31 | ms/batch 69.85 | loss  3.16 | ppl    23.49
| epoch  39 |   800/ 1327 batches | lr 0.31 | ms/batch 70.31 | loss  3.10 | ppl    22.17
| epoch  39 |  1000/ 1327 batches | lr 0.31 | ms/batch 70.36 | loss  3.17 | ppl    23.92
| epoch  39 |  1200/ 1327 batches | lr 0.31 | ms/batch 70.01 | loss  3.01 | ppl    20.24
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 95.92s | valid loss  4.73 | valid ppl   112.87
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.31 | ms/batch 74.46 | loss  3.25 | ppl    25.83
| epoch  40 |   400/ 1327 batches | lr 0.31 | ms/batch 70.93 | loss  3.24 | ppl    25.44
| epoch  40 |   600/ 1327 batches | lr 0.31 | ms/batch 70.79 | loss  3.23 | ppl    25.39
| epoch  40 |   800/ 1327 batches | lr 0.31 | ms/batch 70.99 | loss  3.17 | ppl    23.80
| epoch  40 |  1000/ 1327 batches | lr 0.31 | ms/batch 70.52 | loss  3.25 | ppl    25.80
| epoch  40 |  1200/ 1327 batches | lr 0.31 | ms/batch 70.60 | loss  3.08 | ppl    21.72
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 96.97s | valid loss  4.71 | valid ppl   110.75
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.7993333333333333
sparsity at layer rnn.weight_hh_l0 is 0.7993333333333333
sparsity at layer rnn.weight_ih_l1 is 0.7993333333333333
sparsity at layer rnn.weight_hh_l1 is 0.7993333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.7730496453900708
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 45.59 | loss  3.31 | ppl    27.48
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 46.11 | loss  3.36 | ppl    28.87
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 46.26 | loss  3.38 | ppl    29.42
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 46.33 | loss  3.34 | ppl    28.33
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.92 | loss  3.45 | ppl    31.54
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.82 | loss  3.30 | ppl    27.11
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 63.45s | valid loss  4.66 | valid ppl   105.36
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 46.71 | loss  3.38 | ppl    29.45
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 46.46 | loss  3.39 | ppl    29.60
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 46.29 | loss  3.39 | ppl    29.57
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 46.74 | loss  3.35 | ppl    28.56
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.67 | loss  3.45 | ppl    31.45
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.68 | loss  3.28 | ppl    26.71
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.71s | valid loss  4.66 | valid ppl   105.31
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 46.53 | loss  3.38 | ppl    29.37
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 46.72 | loss  3.38 | ppl    29.44
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 46.66 | loss  3.38 | ppl    29.50
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 46.76 | loss  3.34 | ppl    28.23
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.78 | loss  3.43 | ppl    30.82
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.86 | loss  3.28 | ppl    26.58
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 63.86s | valid loss  4.65 | valid ppl   104.12
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 46.81 | loss  3.38 | ppl    29.27
| epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 46.67 | loss  3.38 | ppl    29.25
| epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 46.82 | loss  3.37 | ppl    29.07
| epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 46.75 | loss  3.33 | ppl    27.90
| epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.97 | loss  3.41 | ppl    30.37
| epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.85 | loss  3.27 | ppl    26.30
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 63.99s | valid loss  4.64 | valid ppl   103.88
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 47.03 | loss  3.36 | ppl    28.91
| epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 46.63 | loss  3.36 | ppl    28.76
| epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 46.55 | loss  3.35 | ppl    28.63
| epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 46.81 | loss  3.32 | ppl    27.58
| epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.80 | loss  3.40 | ppl    29.91
| epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.73 | loss  3.25 | ppl    25.78
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 63.95s | valid loss  4.65 | valid ppl   104.58
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 47.48 | loss  3.35 | ppl    28.38
| epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 46.95 | loss  3.35 | ppl    28.41
| epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 46.52 | loss  3.34 | ppl    28.21
| epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 46.21 | loss  3.30 | ppl    27.04
| epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.46 | loss  3.39 | ppl    29.61
| epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.89 | loss  3.24 | ppl    25.49
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 63.89s | valid loss  4.66 | valid ppl   105.67
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 47.54 | loss  3.32 | ppl    27.57
| epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 46.89 | loss  3.27 | ppl    26.35
| epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 46.76 | loss  3.24 | ppl    25.50
| epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 46.74 | loss  3.18 | ppl    23.95
| epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.65 | loss  3.24 | ppl    25.42
| epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.57 | loss  3.07 | ppl    21.59
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.02s | valid loss  4.67 | valid ppl   106.68
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch 47.68 | loss  3.24 | ppl    25.59
| epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch 46.90 | loss  3.22 | ppl    25.05
| epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch 47.09 | loss  3.20 | ppl    24.49
| epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch 47.03 | loss  3.14 | ppl    23.17
| epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.58 | loss  3.21 | ppl    24.83
| epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.45 | loss  3.04 | ppl    20.97
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 64.15s | valid loss  4.67 | valid ppl   106.74
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 1.25 | ms/batch 47.36 | loss  3.22 | ppl    25.11
| epoch   9 |   400/ 1327 batches | lr 1.25 | ms/batch 46.72 | loss  3.20 | ppl    24.65
| epoch   9 |   600/ 1327 batches | lr 1.25 | ms/batch 46.80 | loss  3.18 | ppl    24.11
| epoch   9 |   800/ 1327 batches | lr 1.25 | ms/batch 46.54 | loss  3.12 | ppl    22.64
| epoch   9 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.12 | loss  3.17 | ppl    23.84
| epoch   9 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.31 | loss  3.01 | ppl    20.31
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 63.85s | valid loss  4.65 | valid ppl   104.84
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 47.09 | loss  3.20 | ppl    24.53
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 46.92 | loss  3.19 | ppl    24.23
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 46.61 | loss  3.17 | ppl    23.86
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 46.69 | loss  3.11 | ppl    22.34
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.82 | loss  3.17 | ppl    23.86
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.90 | loss  3.01 | ppl    20.25
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 64.03s | valid loss  4.66 | valid ppl   105.25
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 47.30 | loss  3.19 | ppl    24.26
| epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 47.00 | loss  3.17 | ppl    23.87
| epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 46.94 | loss  3.16 | ppl    23.59
| epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 46.91 | loss  3.09 | ppl    22.09
| epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.65 | loss  3.17 | ppl    23.72
| epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.03 | loss  3.00 | ppl    20.18
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 64.20s | valid loss  4.66 | valid ppl   105.14
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 47.09 | loss  3.18 | ppl    24.04
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 46.71 | loss  3.16 | ppl    23.54
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 46.94 | loss  3.15 | ppl    23.42
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 46.85 | loss  3.10 | ppl    22.12
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.77 | loss  3.15 | ppl    23.40
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.01 | loss  3.00 | ppl    20.13
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 64.12s | valid loss  4.66 | valid ppl   105.68
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 0.31 | ms/batch 47.06 | loss  3.19 | ppl    24.18
| epoch  13 |   400/ 1327 batches | lr 0.31 | ms/batch 46.74 | loss  3.18 | ppl    24.02
| epoch  13 |   600/ 1327 batches | lr 0.31 | ms/batch 46.79 | loss  3.17 | ppl    23.73
| epoch  13 |   800/ 1327 batches | lr 0.31 | ms/batch 46.48 | loss  3.11 | ppl    22.37
| epoch  13 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.40 | loss  3.17 | ppl    23.75
| epoch  13 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.29 | loss  2.99 | ppl    19.95
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 63.73s | valid loss  4.63 | valid ppl   102.94
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 0.31 | ms/batch 47.13 | loss  3.18 | ppl    23.93
| epoch  14 |   400/ 1327 batches | lr 0.31 | ms/batch 47.15 | loss  3.17 | ppl    23.84
| epoch  14 |   600/ 1327 batches | lr 0.31 | ms/batch 47.20 | loss  3.16 | ppl    23.46
| epoch  14 |   800/ 1327 batches | lr 0.31 | ms/batch 46.93 | loss  3.09 | ppl    22.00
| epoch  14 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.89 | loss  3.16 | ppl    23.54
| epoch  14 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.83 | loss  3.00 | ppl    20.01
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 64.24s | valid loss  4.63 | valid ppl   102.79
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 0.31 | ms/batch 47.18 | loss  3.18 | ppl    24.12
| epoch  15 |   400/ 1327 batches | lr 0.31 | ms/batch 46.55 | loss  3.16 | ppl    23.61
| epoch  15 |   600/ 1327 batches | lr 0.31 | ms/batch 47.19 | loss  3.15 | ppl    23.27
| epoch  15 |   800/ 1327 batches | lr 0.31 | ms/batch 46.64 | loss  3.09 | ppl    21.98
| epoch  15 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.60 | loss  3.16 | ppl    23.66
| epoch  15 |  1200/ 1327 batches | lr 0.31 | ms/batch 47.03 | loss  2.99 | ppl    19.85
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 64.10s | valid loss  4.63 | valid ppl   102.73
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 0.31 | ms/batch 46.60 | loss  3.18 | ppl    23.98
| epoch  16 |   400/ 1327 batches | lr 0.31 | ms/batch 46.34 | loss  3.16 | ppl    23.63
| epoch  16 |   600/ 1327 batches | lr 0.31 | ms/batch 46.31 | loss  3.14 | ppl    23.15
| epoch  16 |   800/ 1327 batches | lr 0.31 | ms/batch 46.30 | loss  3.09 | ppl    22.09
| epoch  16 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.42 | loss  3.16 | ppl    23.54
| epoch  16 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.65 | loss  2.99 | ppl    19.83
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.51s | valid loss  4.63 | valid ppl   102.80
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 0.31 | ms/batch 47.67 | loss  3.17 | ppl    23.86
| epoch  17 |   400/ 1327 batches | lr 0.31 | ms/batch 47.00 | loss  3.16 | ppl    23.60
| epoch  17 |   600/ 1327 batches | lr 0.31 | ms/batch 46.94 | loss  3.15 | ppl    23.24
| epoch  17 |   800/ 1327 batches | lr 0.31 | ms/batch 46.73 | loss  3.08 | ppl    21.87
| epoch  17 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.83 | loss  3.16 | ppl    23.56
| epoch  17 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.79 | loss  2.99 | ppl    19.82
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.32s | valid loss  4.63 | valid ppl   102.85
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.08 | ms/batch 47.39 | loss  3.17 | ppl    23.89
| epoch  18 |   400/ 1327 batches | lr 0.08 | ms/batch 46.79 | loss  3.17 | ppl    23.69
| epoch  18 |   600/ 1327 batches | lr 0.08 | ms/batch 46.83 | loss  3.15 | ppl    23.44
| epoch  18 |   800/ 1327 batches | lr 0.08 | ms/batch 46.76 | loss  3.10 | ppl    22.17
| epoch  18 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.75 | loss  3.15 | ppl    23.41
| epoch  18 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.97 | loss  2.99 | ppl    19.79
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 64.14s | valid loss  4.63 | valid ppl   102.29
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.08 | ms/batch 46.96 | loss  3.18 | ppl    24.03
| epoch  19 |   400/ 1327 batches | lr 0.08 | ms/batch 46.94 | loss  3.17 | ppl    23.86
| epoch  19 |   600/ 1327 batches | lr 0.08 | ms/batch 46.84 | loss  3.16 | ppl    23.60
| epoch  19 |   800/ 1327 batches | lr 0.08 | ms/batch 46.81 | loss  3.09 | ppl    21.98
| epoch  19 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.78 | loss  3.17 | ppl    23.74
| epoch  19 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.74 | loss  2.98 | ppl    19.77
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 64.02s | valid loss  4.63 | valid ppl   102.05
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.08 | ms/batch 46.65 | loss  3.18 | ppl    24.12
| epoch  20 |   400/ 1327 batches | lr 0.08 | ms/batch 46.64 | loss  3.16 | ppl    23.66
| epoch  20 |   600/ 1327 batches | lr 0.08 | ms/batch 46.85 | loss  3.15 | ppl    23.34
| epoch  20 |   800/ 1327 batches | lr 0.08 | ms/batch 46.77 | loss  3.09 | ppl    21.92
| epoch  20 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.65 | loss  3.17 | ppl    23.76
| epoch  20 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.79 | loss  2.99 | ppl    19.87
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 63.89s | valid loss  4.62 | valid ppl   101.92
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 0.08 | ms/batch 46.95 | loss  3.18 | ppl    24.09
| epoch  21 |   400/ 1327 batches | lr 0.08 | ms/batch 46.62 | loss  3.17 | ppl    23.69
| epoch  21 |   600/ 1327 batches | lr 0.08 | ms/batch 46.96 | loss  3.15 | ppl    23.25
| epoch  21 |   800/ 1327 batches | lr 0.08 | ms/batch 46.83 | loss  3.09 | ppl    21.90
| epoch  21 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.72 | loss  3.17 | ppl    23.78
| epoch  21 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.66 | loss  2.99 | ppl    19.88
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 63.95s | valid loss  4.62 | valid ppl   101.86
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 0.08 | ms/batch 47.18 | loss  3.18 | ppl    24.01
| epoch  22 |   400/ 1327 batches | lr 0.08 | ms/batch 46.90 | loss  3.16 | ppl    23.57
| epoch  22 |   600/ 1327 batches | lr 0.08 | ms/batch 46.76 | loss  3.15 | ppl    23.33
| epoch  22 |   800/ 1327 batches | lr 0.08 | ms/batch 46.77 | loss  3.09 | ppl    22.08
| epoch  22 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.62 | loss  3.16 | ppl    23.59
| epoch  22 |  1200/ 1327 batches | lr 0.08 | ms/batch 47.30 | loss  2.99 | ppl    19.91
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 64.15s | valid loss  4.62 | valid ppl   101.80
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 0.08 | ms/batch 46.54 | loss  3.17 | ppl    23.82
| epoch  23 |   400/ 1327 batches | lr 0.08 | ms/batch 46.45 | loss  3.16 | ppl    23.68
| epoch  23 |   600/ 1327 batches | lr 0.08 | ms/batch 46.59 | loss  3.15 | ppl    23.34
| epoch  23 |   800/ 1327 batches | lr 0.08 | ms/batch 46.18 | loss  3.08 | ppl    21.85
| epoch  23 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.40 | loss  3.16 | ppl    23.65
| epoch  23 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.55 | loss  2.99 | ppl    19.93
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 63.53s | valid loss  4.62 | valid ppl   101.81
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.08 | ms/batch 47.57 | loss  3.18 | ppl    23.98
| epoch  24 |   400/ 1327 batches | lr 0.08 | ms/batch 46.91 | loss  3.16 | ppl    23.52
| epoch  24 |   600/ 1327 batches | lr 0.08 | ms/batch 46.69 | loss  3.15 | ppl    23.24
| epoch  24 |   800/ 1327 batches | lr 0.08 | ms/batch 46.69 | loss  3.09 | ppl    21.92
| epoch  24 |  1000/ 1327 batches | lr 0.08 | ms/batch 47.40 | loss  3.16 | ppl    23.57
| epoch  24 |  1200/ 1327 batches | lr 0.08 | ms/batch 47.05 | loss  2.98 | ppl    19.70
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 64.30s | valid loss  4.62 | valid ppl   101.80
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.08 | ms/batch 46.97 | loss  3.18 | ppl    23.97
| epoch  25 |   400/ 1327 batches | lr 0.08 | ms/batch 46.94 | loss  3.15 | ppl    23.40
| epoch  25 |   600/ 1327 batches | lr 0.08 | ms/batch 46.74 | loss  3.15 | ppl    23.29
| epoch  25 |   800/ 1327 batches | lr 0.08 | ms/batch 46.64 | loss  3.08 | ppl    21.87
| epoch  25 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.58 | loss  3.16 | ppl    23.66
| epoch  25 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.39 | loss  2.99 | ppl    19.80
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 64.00s | valid loss  4.62 | valid ppl   101.84
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.02 | ms/batch 47.49 | loss  3.17 | ppl    23.92
| epoch  26 |   400/ 1327 batches | lr 0.02 | ms/batch 47.01 | loss  3.16 | ppl    23.62
| epoch  26 |   600/ 1327 batches | lr 0.02 | ms/batch 46.89 | loss  3.15 | ppl    23.35
| epoch  26 |   800/ 1327 batches | lr 0.02 | ms/batch 46.65 | loss  3.09 | ppl    21.92
| epoch  26 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.72 | loss  3.16 | ppl    23.61
| epoch  26 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.74 | loss  2.98 | ppl    19.76
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 64.12s | valid loss  4.62 | valid ppl   101.81
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.02 | ms/batch 47.18 | loss  3.17 | ppl    23.87
| epoch  27 |   400/ 1327 batches | lr 0.02 | ms/batch 46.93 | loss  3.16 | ppl    23.51
| epoch  27 |   600/ 1327 batches | lr 0.02 | ms/batch 46.54 | loss  3.15 | ppl    23.37
| epoch  27 |   800/ 1327 batches | lr 0.02 | ms/batch 46.55 | loss  3.09 | ppl    21.93
| epoch  27 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.64 | loss  3.16 | ppl    23.58
| epoch  27 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.54 | loss  2.99 | ppl    19.90
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 63.88s | valid loss  4.62 | valid ppl   101.78
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.02 | ms/batch 46.97 | loss  3.18 | ppl    23.96
| epoch  28 |   400/ 1327 batches | lr 0.02 | ms/batch 47.00 | loss  3.16 | ppl    23.59
| epoch  28 |   600/ 1327 batches | lr 0.02 | ms/batch 46.84 | loss  3.15 | ppl    23.23
| epoch  28 |   800/ 1327 batches | lr 0.02 | ms/batch 46.80 | loss  3.09 | ppl    21.89
| epoch  28 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.96 | loss  3.16 | ppl    23.53
| epoch  28 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.95 | loss  2.99 | ppl    19.86
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 64.13s | valid loss  4.62 | valid ppl   101.76
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.02 | ms/batch 47.04 | loss  3.18 | ppl    23.95
| epoch  29 |   400/ 1327 batches | lr 0.02 | ms/batch 46.91 | loss  3.16 | ppl    23.47
| epoch  29 |   600/ 1327 batches | lr 0.02 | ms/batch 46.93 | loss  3.14 | ppl    23.17
| epoch  29 |   800/ 1327 batches | lr 0.02 | ms/batch 47.01 | loss  3.09 | ppl    21.97
| epoch  29 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.99 | loss  3.15 | ppl    23.45
| epoch  29 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.71 | loss  2.99 | ppl    19.95
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 64.19s | valid loss  4.62 | valid ppl   101.73
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.02 | ms/batch 46.48 | loss  3.17 | ppl    23.92
| epoch  30 |   400/ 1327 batches | lr 0.02 | ms/batch 46.54 | loss  3.15 | ppl    23.44
| epoch  30 |   600/ 1327 batches | lr 0.02 | ms/batch 46.10 | loss  3.15 | ppl    23.27
| epoch  30 |   800/ 1327 batches | lr 0.02 | ms/batch 46.11 | loss  3.09 | ppl    22.04
| epoch  30 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.70 | loss  3.16 | ppl    23.51
| epoch  30 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.70 | loss  2.99 | ppl    19.90
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 63.53s | valid loss  4.62 | valid ppl   101.72
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.02 | ms/batch 47.18 | loss  3.17 | ppl    23.80
| epoch  31 |   400/ 1327 batches | lr 0.02 | ms/batch 47.22 | loss  3.16 | ppl    23.48
| epoch  31 |   600/ 1327 batches | lr 0.02 | ms/batch 46.81 | loss  3.15 | ppl    23.23
| epoch  31 |   800/ 1327 batches | lr 0.02 | ms/batch 46.89 | loss  3.09 | ppl    21.91
| epoch  31 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.89 | loss  3.16 | ppl    23.50
| epoch  31 |  1200/ 1327 batches | lr 0.02 | ms/batch 47.08 | loss  2.99 | ppl    19.86
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 64.25s | valid loss  4.62 | valid ppl   101.71
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.02 | ms/batch 47.04 | loss  3.17 | ppl    23.74
| epoch  32 |   400/ 1327 batches | lr 0.02 | ms/batch 47.05 | loss  3.16 | ppl    23.50
| epoch  32 |   600/ 1327 batches | lr 0.02 | ms/batch 46.72 | loss  3.14 | ppl    23.22
| epoch  32 |   800/ 1327 batches | lr 0.02 | ms/batch 46.78 | loss  3.09 | ppl    21.90
| epoch  32 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.96 | loss  3.16 | ppl    23.53
| epoch  32 |  1200/ 1327 batches | lr 0.02 | ms/batch 47.18 | loss  2.99 | ppl    19.83
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 64.19s | valid loss  4.62 | valid ppl   101.70
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.02 | ms/batch 47.17 | loss  3.17 | ppl    23.90
| epoch  33 |   400/ 1327 batches | lr 0.02 | ms/batch 47.11 | loss  3.15 | ppl    23.43
| epoch  33 |   600/ 1327 batches | lr 0.02 | ms/batch 46.75 | loss  3.14 | ppl    23.15
| epoch  33 |   800/ 1327 batches | lr 0.02 | ms/batch 46.91 | loss  3.09 | ppl    21.95
| epoch  33 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.90 | loss  3.17 | ppl    23.70
| epoch  33 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.84 | loss  2.99 | ppl    19.83
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 64.17s | valid loss  4.62 | valid ppl   101.70
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.02 | ms/batch 46.80 | loss  3.17 | ppl    23.90
| epoch  34 |   400/ 1327 batches | lr 0.02 | ms/batch 46.78 | loss  3.15 | ppl    23.38
| epoch  34 |   600/ 1327 batches | lr 0.02 | ms/batch 46.57 | loss  3.15 | ppl    23.28
| epoch  34 |   800/ 1327 batches | lr 0.02 | ms/batch 46.65 | loss  3.08 | ppl    21.82
| epoch  34 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.69 | loss  3.16 | ppl    23.64
| epoch  34 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.60 | loss  2.99 | ppl    19.88
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 63.82s | valid loss  4.62 | valid ppl   101.70
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.00 | ms/batch 47.88 | loss  3.17 | ppl    23.79
| epoch  35 |   400/ 1327 batches | lr 0.00 | ms/batch 47.22 | loss  3.15 | ppl    23.37
| epoch  35 |   600/ 1327 batches | lr 0.00 | ms/batch 46.86 | loss  3.15 | ppl    23.26
| epoch  35 |   800/ 1327 batches | lr 0.00 | ms/batch 46.76 | loss  3.09 | ppl    21.90
| epoch  35 |  1000/ 1327 batches | lr 0.00 | ms/batch 46.96 | loss  3.16 | ppl    23.51
| epoch  35 |  1200/ 1327 batches | lr 0.00 | ms/batch 46.88 | loss  2.98 | ppl    19.78
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 64.36s | valid loss  4.62 | valid ppl   101.70
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.00 | ms/batch 47.16 | loss  3.17 | ppl    23.88
| epoch  36 |   400/ 1327 batches | lr 0.00 | ms/batch 47.02 | loss  3.15 | ppl    23.43
| epoch  36 |   600/ 1327 batches | lr 0.00 | ms/batch 47.05 | loss  3.15 | ppl    23.25
| epoch  36 |   800/ 1327 batches | lr 0.00 | ms/batch 46.97 | loss  3.08 | ppl    21.77
| epoch  36 |  1000/ 1327 batches | lr 0.00 | ms/batch 46.99 | loss  3.16 | ppl    23.52
| epoch  36 |  1200/ 1327 batches | lr 0.00 | ms/batch 47.00 | loss  2.98 | ppl    19.74
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 64.27s | valid loss  4.62 | valid ppl   101.69
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.00 | ms/batch 46.70 | loss  3.17 | ppl    23.88
| epoch  37 |   400/ 1327 batches | lr 0.00 | ms/batch 46.50 | loss  3.15 | ppl    23.41
| epoch  37 |   600/ 1327 batches | lr 0.00 | ms/batch 46.48 | loss  3.14 | ppl    23.16
| epoch  37 |   800/ 1327 batches | lr 0.00 | ms/batch 46.46 | loss  3.08 | ppl    21.84
| epoch  37 |  1000/ 1327 batches | lr 0.00 | ms/batch 46.94 | loss  3.16 | ppl    23.48
| epoch  37 |  1200/ 1327 batches | lr 0.00 | ms/batch 46.51 | loss  2.99 | ppl    19.83
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 63.77s | valid loss  4.62 | valid ppl   101.69
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.00 | ms/batch 47.13 | loss  3.17 | ppl    23.88
| epoch  38 |   400/ 1327 batches | lr 0.00 | ms/batch 46.86 | loss  3.16 | ppl    23.63
| epoch  38 |   600/ 1327 batches | lr 0.00 | ms/batch 46.91 | loss  3.15 | ppl    23.25
| epoch  38 |   800/ 1327 batches | lr 0.00 | ms/batch 46.94 | loss  3.09 | ppl    21.97
| epoch  38 |  1000/ 1327 batches | lr 0.00 | ms/batch 47.03 | loss  3.16 | ppl    23.46
| epoch  38 |  1200/ 1327 batches | lr 0.00 | ms/batch 46.81 | loss  2.99 | ppl    19.85
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 64.24s | valid loss  4.62 | valid ppl   101.69
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.00 | ms/batch 47.07 | loss  3.17 | ppl    23.90
| epoch  39 |   400/ 1327 batches | lr 0.00 | ms/batch 46.84 | loss  3.16 | ppl    23.47
| epoch  39 |   600/ 1327 batches | lr 0.00 | ms/batch 46.73 | loss  3.15 | ppl    23.22
| epoch  39 |   800/ 1327 batches | lr 0.00 | ms/batch 46.75 | loss  3.08 | ppl    21.85
| epoch  39 |  1000/ 1327 batches | lr 0.00 | ms/batch 47.00 | loss  3.16 | ppl    23.54
| epoch  39 |  1200/ 1327 batches | lr 0.00 | ms/batch 46.94 | loss  2.99 | ppl    19.88
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 64.09s | valid loss  4.62 | valid ppl   101.69
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.00 | ms/batch 47.15 | loss  3.18 | ppl    23.93
| epoch  40 |   400/ 1327 batches | lr 0.00 | ms/batch 46.91 | loss  3.15 | ppl    23.41
| epoch  40 |   600/ 1327 batches | lr 0.00 | ms/batch 46.91 | loss  3.15 | ppl    23.22
| epoch  40 |   800/ 1327 batches | lr 0.00 | ms/batch 46.88 | loss  3.09 | ppl    21.88
| epoch  40 |  1000/ 1327 batches | lr 0.00 | ms/batch 46.86 | loss  3.16 | ppl    23.54
| epoch  40 |  1200/ 1327 batches | lr 0.00 | ms/batch 46.90 | loss  2.98 | ppl    19.76
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 64.14s | valid loss  4.62 | valid ppl   101.69
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.7993333333333333
sparsity at layer rnn.weight_hh_l0 is 0.7993333333333333
sparsity at layer rnn.weight_ih_l1 is 0.7993333333333333
sparsity at layer rnn.weight_hh_l1 is 0.7993333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.7730496453900708
=========================================================================================
| End of training | test loss  4.57 | test ppl    96.44
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 40 --dropout 0.50 --save sp82_epoch40_dropout0.50_lstm.pt --pretrained sp80_epoch40_dropout0.50_lstm.pt
debug
{'rnn.weight_ih_l0': 0.82, 'rnn.weight_hh_l0': 0.82, 'rnn.weight_ih_l1': 0.82, 'rnn.weight_hh_l1': 0.82}
{'rnn.weight_ih_l0': 0.82, 'rnn.weight_hh_l0': 0.82, 'rnn.weight_ih_l1': 0.82, 'rnn.weight_hh_l1': 0.82}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 51.26 | loss 10.31 | ppl 29922.64
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 46.83 | loss  5.03 | ppl   152.52
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 46.93 | loss  3.54 | ppl    34.53
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 47.92 | loss  3.08 | ppl    21.72
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 48.82 | loss  3.02 | ppl    20.54
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 50.19 | loss  2.80 | ppl    16.37
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 67.22s | valid loss  4.79 | valid ppl   120.30
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 54.67 | loss  4.33 | ppl    76.27
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 50.22 | loss  3.11 | ppl    22.44
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 50.62 | loss  2.89 | ppl    18.06
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 50.55 | loss  2.81 | ppl    16.63
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 50.99 | loss  2.86 | ppl    17.49
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 50.95 | loss  2.67 | ppl    14.45
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 70.49s | valid loss  4.84 | valid ppl   125.84
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 55.68 | loss  2.94 | ppl    18.92
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 51.27 | loss  2.84 | ppl    17.13
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 51.24 | loss  2.82 | ppl    16.83
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 51.42 | loss  2.77 | ppl    16.01
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.17 | loss  2.84 | ppl    17.10
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.91 | loss  2.65 | ppl    14.19
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 71.57s | valid loss  4.85 | valid ppl   127.80
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 56.10 | loss  2.88 | ppl    17.88
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 51.69 | loss  2.81 | ppl    16.69
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 51.70 | loss  2.80 | ppl    16.42
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 51.66 | loss  2.75 | ppl    15.70
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.13 | loss  2.82 | ppl    16.70
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.98 | loss  2.63 | ppl    13.88
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 71.95s | valid loss  4.85 | valid ppl   128.15
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 2.50 | ms/batch 56.79 | loss  3.01 | ppl    20.32
| epoch   5 |   400/ 1327 batches | lr 2.50 | ms/batch 52.02 | loss  2.93 | ppl    18.66
| epoch   5 |   600/ 1327 batches | lr 2.50 | ms/batch 52.15 | loss  2.90 | ppl    18.17
| epoch   5 |   800/ 1327 batches | lr 2.50 | ms/batch 52.73 | loss  2.84 | ppl    17.18
| epoch   5 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.01 | loss  2.90 | ppl    18.14
| epoch   5 |  1200/ 1327 batches | lr 2.50 | ms/batch 52.89 | loss  2.72 | ppl    15.23
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 72.87s | valid loss  4.79 | valid ppl   119.88
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 2.50 | ms/batch 56.31 | loss  2.94 | ppl    18.91
| epoch   6 |   400/ 1327 batches | lr 2.50 | ms/batch 52.31 | loss  2.90 | ppl    18.20
| epoch   6 |   600/ 1327 batches | lr 2.50 | ms/batch 52.93 | loss  2.88 | ppl    17.76
| epoch   6 |   800/ 1327 batches | lr 2.50 | ms/batch 52.79 | loss  2.83 | ppl    16.91
| epoch   6 |  1000/ 1327 batches | lr 2.50 | ms/batch 52.82 | loss  2.89 | ppl    17.97
| epoch   6 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.04 | loss  2.71 | ppl    15.04
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 73.14s | valid loss  4.80 | valid ppl   121.24
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 57.56 | loss  2.92 | ppl    18.53
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 53.15 | loss  2.89 | ppl    17.91
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 53.05 | loss  2.86 | ppl    17.49
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 53.07 | loss  2.82 | ppl    16.74
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 52.95 | loss  2.88 | ppl    17.81
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.29 | loss  2.71 | ppl    14.98
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 73.86s | valid loss  4.80 | valid ppl   121.18
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 58.19 | loss  2.91 | ppl    18.27
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 54.05 | loss  2.87 | ppl    17.71
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 54.43 | loss  2.86 | ppl    17.49
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 54.25 | loss  2.81 | ppl    16.62
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.24 | loss  2.88 | ppl    17.74
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.25 | loss  2.70 | ppl    14.85
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 75.12s | valid loss  4.80 | valid ppl   121.18
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 58.10 | loss  2.89 | ppl    17.99
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 54.27 | loss  2.86 | ppl    17.51
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 54.80 | loss  2.85 | ppl    17.36
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 54.94 | loss  2.80 | ppl    16.48
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.61 | loss  2.87 | ppl    17.56
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.46 | loss  2.69 | ppl    14.68
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 75.64s | valid loss  4.80 | valid ppl   121.26
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 2.50 | ms/batch 59.30 | loss  2.92 | ppl    18.51
| epoch  10 |   400/ 1327 batches | lr 2.50 | ms/batch 55.05 | loss  2.89 | ppl    17.96
| epoch  10 |   600/ 1327 batches | lr 2.50 | ms/batch 55.64 | loss  2.88 | ppl    17.73
| epoch  10 |   800/ 1327 batches | lr 2.50 | ms/batch 55.22 | loss  2.83 | ppl    16.86
| epoch  10 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.22 | loss  2.89 | ppl    17.91
| epoch  10 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.37 | loss  2.71 | ppl    15.09
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 76.41s | valid loss  4.79 | valid ppl   119.89
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 2.50 | ms/batch 59.32 | loss  2.50 | ppl    12.21
| epoch  11 |   400/ 1327 batches | lr 2.50 | ms/batch 54.65 | loss  2.51 | ppl    12.25
| epoch  11 |   600/ 1327 batches | lr 2.50 | ms/batch 56.03 | loss  2.50 | ppl    12.21
| epoch  11 |   800/ 1327 batches | lr 2.50 | ms/batch 55.91 | loss  2.46 | ppl    11.74
| epoch  11 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.58 | loss  2.52 | ppl    12.41
| epoch  11 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.43 | loss  2.37 | ppl    10.67
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 76.78s | valid loss  4.90 | valid ppl   134.67
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 60.41 | loss  2.59 | ppl    13.34
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 55.71 | loss  2.57 | ppl    13.07
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 55.73 | loss  2.55 | ppl    12.75
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 55.96 | loss  2.50 | ppl    12.23
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.13 | loss  2.56 | ppl    12.95
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.48 | loss  2.41 | ppl    11.09
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 77.59s | valid loss  4.88 | valid ppl   130.99
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 60.78 | loss  2.58 | ppl    13.26
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 56.43 | loss  2.57 | ppl    13.02
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 56.53 | loss  2.55 | ppl    12.86
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 57.05 | loss  2.51 | ppl    12.28
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.78 | loss  2.56 | ppl    12.98
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.83 | loss  2.41 | ppl    11.11
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 78.42s | valid loss  4.88 | valid ppl   131.13
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 60.51 | loss  2.87 | ppl    17.55
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 57.12 | loss  2.83 | ppl    16.96
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 56.82 | loss  2.81 | ppl    16.61
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 56.78 | loss  2.76 | ppl    15.86
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.92 | loss  2.82 | ppl    16.70
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.57 | loss  2.65 | ppl    14.14
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 78.89s | valid loss  4.81 | valid ppl   122.62
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 61.57 | loss  2.83 | ppl    16.98
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 57.10 | loss  2.82 | ppl    16.71
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 58.10 | loss  2.80 | ppl    16.39
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 57.91 | loss  2.74 | ppl    15.51
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.83 | loss  2.81 | ppl    16.54
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.73 | loss  2.64 | ppl    14.02
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 79.77s | valid loss  4.80 | valid ppl   122.05
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 61.80 | loss  2.84 | ppl    17.18
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 57.99 | loss  2.82 | ppl    16.86
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 58.44 | loss  2.81 | ppl    16.62
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 58.33 | loss  2.76 | ppl    15.76
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.25 | loss  2.82 | ppl    16.79
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.32 | loss  2.65 | ppl    14.20
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 80.47s | valid loss  4.80 | valid ppl   121.05
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 62.61 | loss  2.84 | ppl    17.07
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 58.69 | loss  2.81 | ppl    16.62
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 58.80 | loss  2.80 | ppl    16.40
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 58.50 | loss  2.75 | ppl    15.60
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 59.20 | loss  2.81 | ppl    16.68
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 59.18 | loss  2.64 | ppl    13.98
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 81.16s | valid loss  4.80 | valid ppl   121.23
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.62 | ms/batch 63.37 | loss  3.03 | ppl    20.76
| epoch  18 |   400/ 1327 batches | lr 0.62 | ms/batch 58.43 | loss  3.01 | ppl    20.25
| epoch  18 |   600/ 1327 batches | lr 0.62 | ms/batch 59.23 | loss  2.99 | ppl    19.88
| epoch  18 |   800/ 1327 batches | lr 0.62 | ms/batch 58.79 | loss  2.93 | ppl    18.75
| epoch  18 |  1000/ 1327 batches | lr 0.62 | ms/batch 59.19 | loss  2.99 | ppl    19.86
| epoch  18 |  1200/ 1327 batches | lr 0.62 | ms/batch 59.47 | loss  2.82 | ppl    16.82
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 81.65s | valid loss  4.75 | valid ppl   115.09
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.62 | ms/batch 63.80 | loss  3.01 | ppl    20.23
| epoch  19 |   400/ 1327 batches | lr 0.62 | ms/batch 59.26 | loss  2.99 | ppl    19.90
| epoch  19 |   600/ 1327 batches | lr 0.62 | ms/batch 59.73 | loss  2.98 | ppl    19.60
| epoch  19 |   800/ 1327 batches | lr 0.62 | ms/batch 60.10 | loss  2.92 | ppl    18.59
| epoch  19 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.09 | loss  2.99 | ppl    19.87
| epoch  19 |  1200/ 1327 batches | lr 0.62 | ms/batch 59.58 | loss  2.82 | ppl    16.74
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 82.66s | valid loss  4.74 | valid ppl   114.51
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.62 | ms/batch 63.98 | loss  3.05 | ppl    21.18
| epoch  20 |   400/ 1327 batches | lr 0.62 | ms/batch 60.47 | loss  3.03 | ppl    20.78
| epoch  20 |   600/ 1327 batches | lr 0.62 | ms/batch 60.30 | loss  3.02 | ppl    20.49
| epoch  20 |   800/ 1327 batches | lr 0.62 | ms/batch 60.14 | loss  2.96 | ppl    19.37
| epoch  20 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.25 | loss  3.02 | ppl    20.57
| epoch  20 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.25 | loss  2.86 | ppl    17.48
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 83.31s | valid loss  4.73 | valid ppl   113.13
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 0.62 | ms/batch 64.20 | loss  2.26 | ppl     9.61
| epoch  21 |   400/ 1327 batches | lr 0.62 | ms/batch 60.45 | loss  2.29 | ppl     9.90
| epoch  21 |   600/ 1327 batches | lr 0.62 | ms/batch 60.40 | loss  2.28 | ppl     9.80
| epoch  21 |   800/ 1327 batches | lr 0.62 | ms/batch 60.44 | loss  2.24 | ppl     9.38
| epoch  21 |  1000/ 1327 batches | lr 0.62 | ms/batch 60.59 | loss  2.30 | ppl     9.99
| epoch  21 |  1200/ 1327 batches | lr 0.62 | ms/batch 60.60 | loss  2.15 | ppl     8.61
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 83.42s | valid loss  4.90 | valid ppl   134.26
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 0.62 | ms/batch 65.51 | loss  2.31 | ppl    10.05
| epoch  22 |   400/ 1327 batches | lr 0.62 | ms/batch 61.31 | loss  2.29 | ppl     9.90
| epoch  22 |   600/ 1327 batches | lr 0.62 | ms/batch 61.50 | loss  2.29 | ppl     9.85
| epoch  22 |   800/ 1327 batches | lr 0.62 | ms/batch 61.61 | loss  2.24 | ppl     9.42
| epoch  22 |  1000/ 1327 batches | lr 0.62 | ms/batch 61.61 | loss  2.29 | ppl     9.89
| epoch  22 |  1200/ 1327 batches | lr 0.62 | ms/batch 61.25 | loss  2.15 | ppl     8.56
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 84.94s | valid loss  4.94 | valid ppl   139.08
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 0.62 | ms/batch 65.67 | loss  2.31 | ppl    10.04
| epoch  23 |   400/ 1327 batches | lr 0.62 | ms/batch 61.67 | loss  2.29 | ppl     9.89
| epoch  23 |   600/ 1327 batches | lr 0.62 | ms/batch 61.67 | loss  2.28 | ppl     9.82
| epoch  23 |   800/ 1327 batches | lr 0.62 | ms/batch 61.94 | loss  2.24 | ppl     9.35
| epoch  23 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.17 | loss  2.29 | ppl     9.84
| epoch  23 |  1200/ 1327 batches | lr 0.62 | ms/batch 62.19 | loss  2.14 | ppl     8.53
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 85.26s | valid loss  4.96 | valid ppl   141.96
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.31 | ms/batch 66.61 | loss  2.81 | ppl    16.54
| epoch  24 |   400/ 1327 batches | lr 0.31 | ms/batch 62.94 | loss  2.77 | ppl    15.98
| epoch  24 |   600/ 1327 batches | lr 0.31 | ms/batch 62.24 | loss  2.75 | ppl    15.72
| epoch  24 |   800/ 1327 batches | lr 0.31 | ms/batch 62.70 | loss  2.69 | ppl    14.75
| epoch  24 |  1000/ 1327 batches | lr 0.31 | ms/batch 62.53 | loss  2.76 | ppl    15.76
| epoch  24 |  1200/ 1327 batches | lr 0.31 | ms/batch 62.33 | loss  2.57 | ppl    13.10
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 86.22s | valid loss  4.86 | valid ppl   128.41
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.31 | ms/batch 66.69 | loss  2.75 | ppl    15.72
| epoch  25 |   400/ 1327 batches | lr 0.31 | ms/batch 62.57 | loss  2.73 | ppl    15.37
| epoch  25 |   600/ 1327 batches | lr 0.31 | ms/batch 63.11 | loss  2.72 | ppl    15.15
| epoch  25 |   800/ 1327 batches | lr 0.31 | ms/batch 63.17 | loss  2.67 | ppl    14.45
| epoch  25 |  1000/ 1327 batches | lr 0.31 | ms/batch 62.72 | loss  2.73 | ppl    15.32
| epoch  25 |  1200/ 1327 batches | lr 0.31 | ms/batch 63.52 | loss  2.56 | ppl    12.91
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 86.77s | valid loss  4.84 | valid ppl   126.77
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.31 | ms/batch 67.16 | loss  2.74 | ppl    15.44
| epoch  26 |   400/ 1327 batches | lr 0.31 | ms/batch 63.50 | loss  2.73 | ppl    15.27
| epoch  26 |   600/ 1327 batches | lr 0.31 | ms/batch 63.54 | loss  2.70 | ppl    14.91
| epoch  26 |   800/ 1327 batches | lr 0.31 | ms/batch 63.46 | loss  2.65 | ppl    14.21
| epoch  26 |  1000/ 1327 batches | lr 0.31 | ms/batch 63.88 | loss  2.72 | ppl    15.15
| epoch  26 |  1200/ 1327 batches | lr 0.31 | ms/batch 63.89 | loss  2.54 | ppl    12.71
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 87.74s | valid loss  4.83 | valid ppl   125.46
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.31 | ms/batch 67.20 | loss  2.93 | ppl    18.71
| epoch  27 |   400/ 1327 batches | lr 0.31 | ms/batch 63.94 | loss  2.91 | ppl    18.36
| epoch  27 |   600/ 1327 batches | lr 0.31 | ms/batch 64.27 | loss  2.90 | ppl    18.14
| epoch  27 |   800/ 1327 batches | lr 0.31 | ms/batch 64.27 | loss  2.84 | ppl    17.17
| epoch  27 |  1000/ 1327 batches | lr 0.31 | ms/batch 63.93 | loss  2.91 | ppl    18.27
| epoch  27 |  1200/ 1327 batches | lr 0.31 | ms/batch 64.34 | loss  2.73 | ppl    15.33
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 88.09s | valid loss  4.80 | valid ppl   121.10
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.31 | ms/batch 67.91 | loss  2.91 | ppl    18.43
| epoch  28 |   400/ 1327 batches | lr 0.31 | ms/batch 64.19 | loss  2.90 | ppl    18.15
| epoch  28 |   600/ 1327 batches | lr 0.31 | ms/batch 64.31 | loss  2.88 | ppl    17.80
| epoch  28 |   800/ 1327 batches | lr 0.31 | ms/batch 64.61 | loss  2.84 | ppl    17.04
| epoch  28 |  1000/ 1327 batches | lr 0.31 | ms/batch 64.54 | loss  2.91 | ppl    18.27
| epoch  28 |  1200/ 1327 batches | lr 0.31 | ms/batch 64.30 | loss  2.72 | ppl    15.23
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 88.43s | valid loss  4.79 | valid ppl   119.89
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.31 | ms/batch 68.87 | loss  2.95 | ppl    19.07
| epoch  29 |   400/ 1327 batches | lr 0.31 | ms/batch 65.00 | loss  2.93 | ppl    18.74
| epoch  29 |   600/ 1327 batches | lr 0.31 | ms/batch 65.04 | loss  2.92 | ppl    18.51
| epoch  29 |   800/ 1327 batches | lr 0.31 | ms/batch 65.04 | loss  2.86 | ppl    17.46
| epoch  29 |  1000/ 1327 batches | lr 0.31 | ms/batch 65.52 | loss  2.94 | ppl    18.88
| epoch  29 |  1200/ 1327 batches | lr 0.31 | ms/batch 65.11 | loss  2.75 | ppl    15.72
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 89.49s | valid loss  4.77 | valid ppl   118.34
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.31 | ms/batch 69.76 | loss  2.94 | ppl    18.87
| epoch  30 |   400/ 1327 batches | lr 0.31 | ms/batch 65.39 | loss  2.93 | ppl    18.67
| epoch  30 |   600/ 1327 batches | lr 0.31 | ms/batch 65.68 | loss  2.91 | ppl    18.37
| epoch  30 |   800/ 1327 batches | lr 0.31 | ms/batch 65.99 | loss  2.86 | ppl    17.51
| epoch  30 |  1000/ 1327 batches | lr 0.31 | ms/batch 65.77 | loss  2.93 | ppl    18.71
| epoch  30 |  1200/ 1327 batches | lr 0.31 | ms/batch 65.53 | loss  2.75 | ppl    15.65
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 90.39s | valid loss  4.77 | valid ppl   117.87
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.31 | ms/batch 69.86 | loss  2.94 | ppl    18.83
| epoch  31 |   400/ 1327 batches | lr 0.31 | ms/batch 65.74 | loss  2.92 | ppl    18.62
| epoch  31 |   600/ 1327 batches | lr 0.31 | ms/batch 66.47 | loss  2.90 | ppl    18.22
| epoch  31 |   800/ 1327 batches | lr 0.31 | ms/batch 66.39 | loss  2.85 | ppl    17.32
| epoch  31 |  1000/ 1327 batches | lr 0.31 | ms/batch 66.24 | loss  2.92 | ppl    18.54
| epoch  31 |  1200/ 1327 batches | lr 0.31 | ms/batch 66.10 | loss  2.75 | ppl    15.67
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 90.93s | valid loss  4.77 | valid ppl   117.60
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.31 | ms/batch 70.49 | loss  3.08 | ppl    21.70
| epoch  32 |   400/ 1327 batches | lr 0.31 | ms/batch 66.49 | loss  3.06 | ppl    21.34
| epoch  32 |   600/ 1327 batches | lr 0.31 | ms/batch 66.70 | loss  3.05 | ppl    21.05
| epoch  32 |   800/ 1327 batches | lr 0.31 | ms/batch 66.28 | loss  2.99 | ppl    19.79
| epoch  32 |  1000/ 1327 batches | lr 0.31 | ms/batch 66.63 | loss  3.06 | ppl    21.38
| epoch  32 |  1200/ 1327 batches | lr 0.31 | ms/batch 66.82 | loss  2.89 | ppl    17.97
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 91.40s | valid loss  4.74 | valid ppl   114.45
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.31 | ms/batch 71.53 | loss  3.06 | ppl    21.41
| epoch  33 |   400/ 1327 batches | lr 0.31 | ms/batch 66.80 | loss  3.05 | ppl    21.18
| epoch  33 |   600/ 1327 batches | lr 0.31 | ms/batch 67.42 | loss  3.04 | ppl    20.88
| epoch  33 |   800/ 1327 batches | lr 0.31 | ms/batch 67.42 | loss  2.98 | ppl    19.77
| epoch  33 |  1000/ 1327 batches | lr 0.31 | ms/batch 67.49 | loss  3.06 | ppl    21.29
| epoch  33 |  1200/ 1327 batches | lr 0.31 | ms/batch 66.98 | loss  2.88 | ppl    17.76
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 92.38s | valid loss  4.73 | valid ppl   113.61
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.31 | ms/batch 71.79 | loss  3.07 | ppl    21.49
| epoch  34 |   400/ 1327 batches | lr 0.31 | ms/batch 67.34 | loss  3.06 | ppl    21.26
| epoch  34 |   600/ 1327 batches | lr 0.31 | ms/batch 67.74 | loss  3.03 | ppl    20.80
| epoch  34 |   800/ 1327 batches | lr 0.31 | ms/batch 67.97 | loss  2.99 | ppl    19.81
| epoch  34 |  1000/ 1327 batches | lr 0.31 | ms/batch 67.76 | loss  3.05 | ppl    21.20
| epoch  34 |  1200/ 1327 batches | lr 0.31 | ms/batch 67.74 | loss  2.87 | ppl    17.67
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 93.16s | valid loss  4.73 | valid ppl   112.98
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.31 | ms/batch 71.84 | loss  3.08 | ppl    21.74
| epoch  35 |   400/ 1327 batches | lr 0.31 | ms/batch 67.85 | loss  3.06 | ppl    21.38
| epoch  35 |   600/ 1327 batches | lr 0.31 | ms/batch 68.34 | loss  3.05 | ppl    21.09
| epoch  35 |   800/ 1327 batches | lr 0.31 | ms/batch 67.95 | loss  3.00 | ppl    20.03
| epoch  35 |  1000/ 1327 batches | lr 0.31 | ms/batch 67.96 | loss  3.07 | ppl    21.45
| epoch  35 |  1200/ 1327 batches | lr 0.31 | ms/batch 67.75 | loss  2.89 | ppl    18.00
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 93.28s | valid loss  4.72 | valid ppl   112.32
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.31 | ms/batch 72.91 | loss  3.09 | ppl    21.98
| epoch  36 |   400/ 1327 batches | lr 0.31 | ms/batch 68.65 | loss  3.07 | ppl    21.45
| epoch  36 |   600/ 1327 batches | lr 0.31 | ms/batch 68.84 | loss  3.05 | ppl    21.20
| epoch  36 |   800/ 1327 batches | lr 0.31 | ms/batch 68.89 | loss  3.00 | ppl    20.06
| epoch  36 |  1000/ 1327 batches | lr 0.31 | ms/batch 68.82 | loss  3.07 | ppl    21.44
| epoch  36 |  1200/ 1327 batches | lr 0.31 | ms/batch 68.83 | loss  2.90 | ppl    18.14
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 94.39s | valid loss  4.72 | valid ppl   111.78
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.31 | ms/batch 73.43 | loss  3.08 | ppl    21.85
| epoch  37 |   400/ 1327 batches | lr 0.31 | ms/batch 68.93 | loss  3.07 | ppl    21.52
| epoch  37 |   600/ 1327 batches | lr 0.31 | ms/batch 69.73 | loss  3.06 | ppl    21.37
| epoch  37 |   800/ 1327 batches | lr 0.31 | ms/batch 69.84 | loss  3.00 | ppl    20.12
| epoch  37 |  1000/ 1327 batches | lr 0.31 | ms/batch 69.43 | loss  3.07 | ppl    21.64
| epoch  37 |  1200/ 1327 batches | lr 0.31 | ms/batch 69.25 | loss  2.90 | ppl    18.22
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 95.23s | valid loss  4.71 | valid ppl   111.29
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.31 | ms/batch 74.16 | loss  3.09 | ppl    21.87
| epoch  38 |   400/ 1327 batches | lr 0.31 | ms/batch 69.82 | loss  3.08 | ppl    21.65
| epoch  38 |   600/ 1327 batches | lr 0.31 | ms/batch 70.31 | loss  3.06 | ppl    21.37
| epoch  38 |   800/ 1327 batches | lr 0.31 | ms/batch 70.02 | loss  3.00 | ppl    20.14
| epoch  38 |  1000/ 1327 batches | lr 0.31 | ms/batch 69.83 | loss  3.07 | ppl    21.58
| epoch  38 |  1200/ 1327 batches | lr 0.31 | ms/batch 70.20 | loss  2.90 | ppl    18.22
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 95.99s | valid loss  4.71 | valid ppl   111.04
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.31 | ms/batch 73.97 | loss  3.10 | ppl    22.14
| epoch  39 |   400/ 1327 batches | lr 0.31 | ms/batch 70.17 | loss  3.09 | ppl    21.92
| epoch  39 |   600/ 1327 batches | lr 0.31 | ms/batch 70.62 | loss  3.07 | ppl    21.55
| epoch  39 |   800/ 1327 batches | lr 0.31 | ms/batch 70.39 | loss  3.02 | ppl    20.44
| epoch  39 |  1000/ 1327 batches | lr 0.31 | ms/batch 70.65 | loss  3.09 | ppl    21.87
| epoch  39 |  1200/ 1327 batches | lr 0.31 | ms/batch 70.18 | loss  2.91 | ppl    18.40
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 96.40s | valid loss  4.71 | valid ppl   110.68
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.31 | ms/batch 75.04 | loss  3.12 | ppl    22.74
| epoch  40 |   400/ 1327 batches | lr 0.31 | ms/batch 70.92 | loss  3.11 | ppl    22.33
| epoch  40 |   600/ 1327 batches | lr 0.31 | ms/batch 71.67 | loss  3.10 | ppl    22.24
| epoch  40 |   800/ 1327 batches | lr 0.31 | ms/batch 71.51 | loss  3.03 | ppl    20.80
| epoch  40 |  1000/ 1327 batches | lr 0.31 | ms/batch 71.38 | loss  3.11 | ppl    22.44
| epoch  40 |  1200/ 1327 batches | lr 0.31 | ms/batch 71.04 | loss  2.93 | ppl    18.77
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 97.55s | valid loss  4.70 | valid ppl   110.02
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.8193333333333334
sparsity at layer rnn.weight_hh_l0 is 0.8193333333333334
sparsity at layer rnn.weight_ih_l1 is 0.8193333333333334
sparsity at layer rnn.weight_hh_l1 is 0.8193333333333334
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.8080210387902695
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 45.42 | loss  2.75 | ppl    15.62
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 45.99 | loss  2.79 | ppl    16.35
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 46.30 | loss  2.82 | ppl    16.72
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 46.77 | loss  2.78 | ppl    16.15
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 47.20 | loss  2.88 | ppl    17.84
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 47.07 | loss  2.73 | ppl    15.37
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 63.56s | valid loss  4.86 | valid ppl   129.54
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 46.69 | loss  2.83 | ppl    16.90
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 46.32 | loss  2.83 | ppl    17.00
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 46.39 | loss  2.83 | ppl    16.90
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 46.44 | loss  2.80 | ppl    16.51
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.36 | loss  2.89 | ppl    18.07
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.83 | loss  2.73 | ppl    15.39
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.65s | valid loss  4.88 | valid ppl   131.61
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 47.41 | loss  2.84 | ppl    17.07
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 47.17 | loss  2.84 | ppl    17.03
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 47.09 | loss  2.84 | ppl    17.05
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 46.87 | loss  2.81 | ppl    16.53
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.89 | loss  2.89 | ppl    17.97
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.71 | loss  2.74 | ppl    15.47
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 64.22s | valid loss  4.86 | valid ppl   129.54
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 46.96 | loss  2.84 | ppl    17.19
| epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 46.95 | loss  2.84 | ppl    17.16
| epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 46.75 | loss  2.84 | ppl    17.06
| epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 46.70 | loss  2.81 | ppl    16.53
| epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.69 | loss  2.89 | ppl    17.91
| epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.73 | loss  2.74 | ppl    15.52
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 64.01s | valid loss  4.87 | valid ppl   129.98
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 47.57 | loss  2.84 | ppl    17.17
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 47.10 | loss  2.80 | ppl    16.48
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 47.00 | loss  2.77 | ppl    15.93
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 46.75 | loss  2.72 | ppl    15.14
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.82 | loss  2.77 | ppl    16.00
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.85 | loss  2.60 | ppl    13.49
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 64.24s | valid loss  4.88 | valid ppl   131.29
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 46.78 | loss  2.75 | ppl    15.71
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 46.57 | loss  2.74 | ppl    15.44
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 46.62 | loss  2.71 | ppl    15.03
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 46.68 | loss  2.66 | ppl    14.32
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.67 | loss  2.73 | ppl    15.28
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.73 | loss  2.57 | ppl    13.00
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 63.84s | valid loss  4.90 | valid ppl   133.75
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 1.25 | ms/batch 47.72 | loss  3.13 | ppl    22.88
| epoch   7 |   400/ 1327 batches | lr 1.25 | ms/batch 47.20 | loss  3.10 | ppl    22.22
| epoch   7 |   600/ 1327 batches | lr 1.25 | ms/batch 46.72 | loss  3.07 | ppl    21.50
| epoch   7 |   800/ 1327 batches | lr 1.25 | ms/batch 46.78 | loss  3.01 | ppl    20.23
| epoch   7 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.79 | loss  3.06 | ppl    21.39
| epoch   7 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.78 | loss  2.91 | ppl    18.27
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.22s | valid loss  4.77 | valid ppl   118.30
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 1.25 | ms/batch 46.96 | loss  3.09 | ppl    21.94
| epoch   8 |   400/ 1327 batches | lr 1.25 | ms/batch 47.28 | loss  3.06 | ppl    21.37
| epoch   8 |   600/ 1327 batches | lr 1.25 | ms/batch 46.94 | loss  3.04 | ppl    20.98
| epoch   8 |   800/ 1327 batches | lr 1.25 | ms/batch 46.97 | loss  2.98 | ppl    19.78
| epoch   8 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.97 | loss  3.05 | ppl    21.17
| epoch   8 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.85 | loss  2.89 | ppl    18.03
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 64.22s | valid loss  4.76 | valid ppl   117.12
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 1.25 | ms/batch 46.74 | loss  3.18 | ppl    23.93
| epoch   9 |   400/ 1327 batches | lr 1.25 | ms/batch 46.40 | loss  3.16 | ppl    23.52
| epoch   9 |   600/ 1327 batches | lr 1.25 | ms/batch 46.46 | loss  3.14 | ppl    23.11
| epoch   9 |   800/ 1327 batches | lr 1.25 | ms/batch 46.41 | loss  3.08 | ppl    21.84
| epoch   9 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.50 | loss  3.14 | ppl    23.17
| epoch   9 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.50 | loss  2.99 | ppl    19.87
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 63.60s | valid loss  4.73 | valid ppl   112.94
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 46.80 | loss  3.16 | ppl    23.55
| epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 47.05 | loss  3.15 | ppl    23.44
| epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 46.88 | loss  3.14 | ppl    23.10
| epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 46.93 | loss  3.08 | ppl    21.70
| epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.96 | loss  3.14 | ppl    23.18
| epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.69 | loss  2.99 | ppl    19.81
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 64.07s | valid loss  4.72 | valid ppl   112.41
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 47.15 | loss  3.15 | ppl    23.36
| epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 46.89 | loss  3.14 | ppl    23.11
| epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 46.88 | loss  3.13 | ppl    22.80
| epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 46.95 | loss  3.06 | ppl    21.36
| epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.88 | loss  3.14 | ppl    23.05
| epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.92 | loss  2.98 | ppl    19.68
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 64.16s | valid loss  4.72 | valid ppl   111.99
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 46.43 | loss  3.14 | ppl    23.21
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 46.97 | loss  3.13 | ppl    22.76
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 47.15 | loss  3.12 | ppl    22.65
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 46.80 | loss  3.06 | ppl    21.41
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.77 | loss  3.13 | ppl    22.77
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.70 | loss  2.98 | ppl    19.64
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 63.98s | valid loss  4.72 | valid ppl   111.97
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 47.00 | loss  3.17 | ppl    23.83
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 46.70 | loss  3.15 | ppl    23.37
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 46.56 | loss  3.14 | ppl    23.10
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 46.78 | loss  3.09 | ppl    21.87
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.74 | loss  3.16 | ppl    23.46
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.74 | loss  3.00 | ppl    20.06
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 63.91s | valid loss  4.70 | valid ppl   110.37
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 46.60 | loss  3.15 | ppl    23.38
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 46.76 | loss  3.15 | ppl    23.27
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 47.14 | loss  3.13 | ppl    22.94
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 46.75 | loss  3.07 | ppl    21.62
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.76 | loss  3.14 | ppl    23.19
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.79 | loss  3.00 | ppl    20.00
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 63.99s | valid loss  4.70 | valid ppl   110.46
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 47.20 | loss  3.15 | ppl    23.40
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 47.05 | loss  3.14 | ppl    23.06
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 47.03 | loss  3.13 | ppl    22.80
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 46.75 | loss  3.07 | ppl    21.57
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.73 | loss  3.14 | ppl    23.20
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.72 | loss  2.98 | ppl    19.71
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 64.16s | valid loss  4.70 | valid ppl   110.42
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 46.63 | loss  3.15 | ppl    23.27
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 46.63 | loss  3.14 | ppl    23.02
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 46.63 | loss  3.12 | ppl    22.62
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 46.66 | loss  3.07 | ppl    21.64
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.58 | loss  3.14 | ppl    23.00
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.59 | loss  2.98 | ppl    19.64
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.76s | valid loss  4.71 | valid ppl   110.64
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 0.31 | ms/batch 47.20 | loss  3.15 | ppl    23.39
| epoch  17 |   400/ 1327 batches | lr 0.31 | ms/batch 47.02 | loss  3.15 | ppl    23.37
| epoch  17 |   600/ 1327 batches | lr 0.31 | ms/batch 46.77 | loss  3.14 | ppl    23.10
| epoch  17 |   800/ 1327 batches | lr 0.31 | ms/batch 46.63 | loss  3.08 | ppl    21.81
| epoch  17 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.49 | loss  3.15 | ppl    23.30
| epoch  17 |  1200/ 1327 batches | lr 0.31 | ms/batch 47.21 | loss  2.97 | ppl    19.53
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.07s | valid loss  4.68 | valid ppl   108.00
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.31 | ms/batch 47.13 | loss  3.16 | ppl    23.53
| epoch  18 |   400/ 1327 batches | lr 0.31 | ms/batch 47.11 | loss  3.15 | ppl    23.29
| epoch  18 |   600/ 1327 batches | lr 0.31 | ms/batch 46.90 | loss  3.13 | ppl    22.95
| epoch  18 |   800/ 1327 batches | lr 0.31 | ms/batch 46.80 | loss  3.08 | ppl    21.78
| epoch  18 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.76 | loss  3.14 | ppl    23.04
| epoch  18 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.69 | loss  2.98 | ppl    19.76
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 64.10s | valid loss  4.68 | valid ppl   107.62
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.31 | ms/batch 46.76 | loss  3.16 | ppl    23.59
| epoch  19 |   400/ 1327 batches | lr 0.31 | ms/batch 47.15 | loss  3.15 | ppl    23.34
| epoch  19 |   600/ 1327 batches | lr 0.31 | ms/batch 46.63 | loss  3.14 | ppl    23.15
| epoch  19 |   800/ 1327 batches | lr 0.31 | ms/batch 46.85 | loss  3.08 | ppl    21.66
| epoch  19 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.77 | loss  3.15 | ppl    23.36
| epoch  19 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.56 | loss  2.98 | ppl    19.75
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.95s | valid loss  4.68 | valid ppl   107.42
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.31 | ms/batch 46.69 | loss  3.16 | ppl    23.58
| epoch  20 |   400/ 1327 batches | lr 0.31 | ms/batch 46.76 | loss  3.14 | ppl    23.16
| epoch  20 |   600/ 1327 batches | lr 0.31 | ms/batch 46.79 | loss  3.13 | ppl    22.86
| epoch  20 |   800/ 1327 batches | lr 0.31 | ms/batch 46.89 | loss  3.07 | ppl    21.58
| epoch  20 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.54 | loss  3.16 | ppl    23.49
| epoch  20 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.26 | loss  2.98 | ppl    19.74
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 63.75s | valid loss  4.68 | valid ppl   107.44
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 0.31 | ms/batch 47.42 | loss  3.16 | ppl    23.52
| epoch  21 |   400/ 1327 batches | lr 0.31 | ms/batch 47.23 | loss  3.14 | ppl    23.13
| epoch  21 |   600/ 1327 batches | lr 0.31 | ms/batch 46.83 | loss  3.12 | ppl    22.73
| epoch  21 |   800/ 1327 batches | lr 0.31 | ms/batch 46.78 | loss  3.07 | ppl    21.57
| epoch  21 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.87 | loss  3.15 | ppl    23.42
| epoch  21 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.86 | loss  2.98 | ppl    19.75
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 64.21s | valid loss  4.68 | valid ppl   107.32
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 0.31 | ms/batch 47.00 | loss  3.16 | ppl    23.47
| epoch  22 |   400/ 1327 batches | lr 0.31 | ms/batch 46.81 | loss  3.14 | ppl    23.06
| epoch  22 |   600/ 1327 batches | lr 0.31 | ms/batch 47.10 | loss  3.13 | ppl    22.79
| epoch  22 |   800/ 1327 batches | lr 0.31 | ms/batch 46.75 | loss  3.08 | ppl    21.72
| epoch  22 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.81 | loss  3.15 | ppl    23.26
| epoch  22 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.90 | loss  2.98 | ppl    19.73
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 64.09s | valid loss  4.68 | valid ppl   107.33
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 0.08 | ms/batch 46.94 | loss  3.15 | ppl    23.37
| epoch  23 |   400/ 1327 batches | lr 0.08 | ms/batch 46.70 | loss  3.15 | ppl    23.41
| epoch  23 |   600/ 1327 batches | lr 0.08 | ms/batch 46.41 | loss  3.14 | ppl    23.13
| epoch  23 |   800/ 1327 batches | lr 0.08 | ms/batch 46.31 | loss  3.07 | ppl    21.64
| epoch  23 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.61 | loss  3.15 | ppl    23.38
| epoch  23 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.77 | loss  2.98 | ppl    19.70
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 63.76s | valid loss  4.67 | valid ppl   106.78
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.08 | ms/batch 47.12 | loss  3.16 | ppl    23.52
| epoch  24 |   400/ 1327 batches | lr 0.08 | ms/batch 46.50 | loss  3.14 | ppl    23.20
| epoch  24 |   600/ 1327 batches | lr 0.08 | ms/batch 46.61 | loss  3.13 | ppl    22.94
| epoch  24 |   800/ 1327 batches | lr 0.08 | ms/batch 46.81 | loss  3.08 | ppl    21.70
| epoch  24 |  1000/ 1327 batches | lr 0.08 | ms/batch 47.27 | loss  3.15 | ppl    23.29
| epoch  24 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.96 | loss  2.97 | ppl    19.55
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 64.10s | valid loss  4.67 | valid ppl   106.51
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.08 | ms/batch 46.56 | loss  3.16 | ppl    23.53
| epoch  25 |   400/ 1327 batches | lr 0.08 | ms/batch 47.07 | loss  3.14 | ppl    23.07
| epoch  25 |   600/ 1327 batches | lr 0.08 | ms/batch 46.90 | loss  3.13 | ppl    22.92
| epoch  25 |   800/ 1327 batches | lr 0.08 | ms/batch 46.95 | loss  3.07 | ppl    21.54
| epoch  25 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.79 | loss  3.15 | ppl    23.42
| epoch  25 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.61 | loss  2.98 | ppl    19.59
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 64.02s | valid loss  4.67 | valid ppl   106.47
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.08 | ms/batch 46.94 | loss  3.16 | ppl    23.49
| epoch  26 |   400/ 1327 batches | lr 0.08 | ms/batch 46.57 | loss  3.14 | ppl    23.19
| epoch  26 |   600/ 1327 batches | lr 0.08 | ms/batch 47.18 | loss  3.14 | ppl    23.00
| epoch  26 |   800/ 1327 batches | lr 0.08 | ms/batch 47.01 | loss  3.07 | ppl    21.64
| epoch  26 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.93 | loss  3.15 | ppl    23.37
| epoch  26 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.94 | loss  2.98 | ppl    19.66
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 64.17s | valid loss  4.67 | valid ppl   106.37
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.08 | ms/batch 46.86 | loss  3.15 | ppl    23.36
| epoch  27 |   400/ 1327 batches | lr 0.08 | ms/batch 46.80 | loss  3.14 | ppl    23.09
| epoch  27 |   600/ 1327 batches | lr 0.08 | ms/batch 46.45 | loss  3.14 | ppl    23.03
| epoch  27 |   800/ 1327 batches | lr 0.08 | ms/batch 46.33 | loss  3.08 | ppl    21.65
| epoch  27 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.77 | loss  3.15 | ppl    23.34
| epoch  27 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.84 | loss  2.99 | ppl    19.88
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 63.84s | valid loss  4.67 | valid ppl   106.33
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.08 | ms/batch 47.08 | loss  3.16 | ppl    23.48
| epoch  28 |   400/ 1327 batches | lr 0.08 | ms/batch 46.96 | loss  3.14 | ppl    23.18
| epoch  28 |   600/ 1327 batches | lr 0.08 | ms/batch 46.76 | loss  3.13 | ppl    22.84
| epoch  28 |   800/ 1327 batches | lr 0.08 | ms/batch 46.86 | loss  3.07 | ppl    21.58
| epoch  28 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.87 | loss  3.15 | ppl    23.27
| epoch  28 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.94 | loss  2.98 | ppl    19.74
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 64.13s | valid loss  4.67 | valid ppl   106.34
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.08 | ms/batch 47.34 | loss  3.15 | ppl    23.45
| epoch  29 |   400/ 1327 batches | lr 0.08 | ms/batch 46.93 | loss  3.14 | ppl    23.00
| epoch  29 |   600/ 1327 batches | lr 0.08 | ms/batch 46.89 | loss  3.12 | ppl    22.75
| epoch  29 |   800/ 1327 batches | lr 0.08 | ms/batch 46.86 | loss  3.08 | ppl    21.67
| epoch  29 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.76 | loss  3.15 | ppl    23.22
| epoch  29 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.69 | loss  2.99 | ppl    19.86
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 64.18s | valid loss  4.67 | valid ppl   106.30
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.08 | ms/batch 46.86 | loss  3.15 | ppl    23.41
| epoch  30 |   400/ 1327 batches | lr 0.08 | ms/batch 46.46 | loss  3.13 | ppl    22.97
| epoch  30 |   600/ 1327 batches | lr 0.08 | ms/batch 46.55 | loss  3.13 | ppl    22.90
| epoch  30 |   800/ 1327 batches | lr 0.08 | ms/batch 46.48 | loss  3.08 | ppl    21.68
| epoch  30 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.65 | loss  3.15 | ppl    23.25
| epoch  30 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.93 | loss  2.98 | ppl    19.75
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 63.81s | valid loss  4.67 | valid ppl   106.27
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.08 | ms/batch 47.08 | loss  3.15 | ppl    23.30
| epoch  31 |   400/ 1327 batches | lr 0.08 | ms/batch 47.26 | loss  3.14 | ppl    23.09
| epoch  31 |   600/ 1327 batches | lr 0.08 | ms/batch 47.02 | loss  3.13 | ppl    22.79
| epoch  31 |   800/ 1327 batches | lr 0.08 | ms/batch 46.84 | loss  3.07 | ppl    21.55
| epoch  31 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.86 | loss  3.15 | ppl    23.23
| epoch  31 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.85 | loss  2.98 | ppl    19.74
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 64.23s | valid loss  4.67 | valid ppl   106.24
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.08 | ms/batch 46.99 | loss  3.14 | ppl    23.18
| epoch  32 |   400/ 1327 batches | lr 0.08 | ms/batch 46.55 | loss  3.14 | ppl    23.06
| epoch  32 |   600/ 1327 batches | lr 0.08 | ms/batch 46.68 | loss  3.13 | ppl    22.83
| epoch  32 |   800/ 1327 batches | lr 0.08 | ms/batch 47.04 | loss  3.07 | ppl    21.63
| epoch  32 |  1000/ 1327 batches | lr 0.08 | ms/batch 47.04 | loss  3.14 | ppl    23.22
| epoch  32 |  1200/ 1327 batches | lr 0.08 | ms/batch 47.09 | loss  2.98 | ppl    19.74
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 64.08s | valid loss  4.67 | valid ppl   106.25
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.02 | ms/batch 47.19 | loss  3.15 | ppl    23.43
| epoch  33 |   400/ 1327 batches | lr 0.02 | ms/batch 47.06 | loss  3.14 | ppl    23.09
| epoch  33 |   600/ 1327 batches | lr 0.02 | ms/batch 46.84 | loss  3.13 | ppl    22.83
| epoch  33 |   800/ 1327 batches | lr 0.02 | ms/batch 46.51 | loss  3.08 | ppl    21.66
| epoch  33 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.65 | loss  3.15 | ppl    23.41
| epoch  33 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.82 | loss  2.98 | ppl    19.72
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 64.04s | valid loss  4.67 | valid ppl   106.22
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.02 | ms/batch 46.88 | loss  3.15 | ppl    23.37
| epoch  34 |   400/ 1327 batches | lr 0.02 | ms/batch 46.87 | loss  3.13 | ppl    22.91
| epoch  34 |   600/ 1327 batches | lr 0.02 | ms/batch 46.77 | loss  3.13 | ppl    22.94
| epoch  34 |   800/ 1327 batches | lr 0.02 | ms/batch 46.76 | loss  3.07 | ppl    21.53
| epoch  34 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.76 | loss  3.15 | ppl    23.36
| epoch  34 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.64 | loss  2.98 | ppl    19.74
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 63.95s | valid loss  4.67 | valid ppl   106.20
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.02 | ms/batch 47.32 | loss  3.15 | ppl    23.35
| epoch  35 |   400/ 1327 batches | lr 0.02 | ms/batch 46.91 | loss  3.14 | ppl    23.01
| epoch  35 |   600/ 1327 batches | lr 0.02 | ms/batch 46.38 | loss  3.13 | ppl    22.97
| epoch  35 |   800/ 1327 batches | lr 0.02 | ms/batch 46.99 | loss  3.07 | ppl    21.62
| epoch  35 |  1000/ 1327 batches | lr 0.02 | ms/batch 47.14 | loss  3.15 | ppl    23.30
| epoch  35 |  1200/ 1327 batches | lr 0.02 | ms/batch 47.00 | loss  2.98 | ppl    19.65
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 64.16s | valid loss  4.67 | valid ppl   106.18
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.02 | ms/batch 46.80 | loss  3.15 | ppl    23.41
| epoch  36 |   400/ 1327 batches | lr 0.02 | ms/batch 46.77 | loss  3.14 | ppl    22.99
| epoch  36 |   600/ 1327 batches | lr 0.02 | ms/batch 46.59 | loss  3.13 | ppl    22.86
| epoch  36 |   800/ 1327 batches | lr 0.02 | ms/batch 46.76 | loss  3.07 | ppl    21.50
| epoch  36 |  1000/ 1327 batches | lr 0.02 | ms/batch 47.08 | loss  3.15 | ppl    23.26
| epoch  36 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.82 | loss  2.98 | ppl    19.65
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 64.01s | valid loss  4.66 | valid ppl   106.16
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.02 | ms/batch 46.61 | loss  3.15 | ppl    23.39
| epoch  37 |   400/ 1327 batches | lr 0.02 | ms/batch 46.63 | loss  3.13 | ppl    22.97
| epoch  37 |   600/ 1327 batches | lr 0.02 | ms/batch 46.27 | loss  3.13 | ppl    22.78
| epoch  37 |   800/ 1327 batches | lr 0.02 | ms/batch 46.34 | loss  3.07 | ppl    21.60
| epoch  37 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.50 | loss  3.15 | ppl    23.23
| epoch  37 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.43 | loss  2.98 | ppl    19.73
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 63.54s | valid loss  4.66 | valid ppl   106.15
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.02 | ms/batch 47.04 | loss  3.15 | ppl    23.45
| epoch  38 |   400/ 1327 batches | lr 0.02 | ms/batch 47.14 | loss  3.14 | ppl    23.16
| epoch  38 |   600/ 1327 batches | lr 0.02 | ms/batch 47.07 | loss  3.13 | ppl    22.84
| epoch  38 |   800/ 1327 batches | lr 0.02 | ms/batch 46.95 | loss  3.08 | ppl    21.67
| epoch  38 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.87 | loss  3.15 | ppl    23.25
| epoch  38 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.85 | loss  2.98 | ppl    19.69
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 64.22s | valid loss  4.66 | valid ppl   106.12
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.02 | ms/batch 46.90 | loss  3.15 | ppl    23.39
| epoch  39 |   400/ 1327 batches | lr 0.02 | ms/batch 46.86 | loss  3.13 | ppl    22.98
| epoch  39 |   600/ 1327 batches | lr 0.02 | ms/batch 46.64 | loss  3.13 | ppl    22.83
| epoch  39 |   800/ 1327 batches | lr 0.02 | ms/batch 46.64 | loss  3.07 | ppl    21.53
| epoch  39 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.62 | loss  3.15 | ppl    23.25
| epoch  39 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.81 | loss  2.98 | ppl    19.78
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 63.92s | valid loss  4.66 | valid ppl   106.11
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.02 | ms/batch 47.14 | loss  3.15 | ppl    23.37
| epoch  40 |   400/ 1327 batches | lr 0.02 | ms/batch 46.80 | loss  3.14 | ppl    23.03
| epoch  40 |   600/ 1327 batches | lr 0.02 | ms/batch 46.86 | loss  3.13 | ppl    22.79
| epoch  40 |   800/ 1327 batches | lr 0.02 | ms/batch 46.92 | loss  3.07 | ppl    21.54
| epoch  40 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.92 | loss  3.15 | ppl    23.28
| epoch  40 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.84 | loss  2.98 | ppl    19.63
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 64.13s | valid loss  4.66 | valid ppl   106.11
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.8193333333333334
sparsity at layer rnn.weight_hh_l0 is 0.8193333333333334
sparsity at layer rnn.weight_ih_l1 is 0.8193333333333334
sparsity at layer rnn.weight_hh_l1 is 0.8193333333333334
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.8080210387902695
=========================================================================================
| End of training | test loss  4.61 | test ppl   100.06
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 40 --dropout 0.50 --save sp84_epoch40_dropout0.50_lstm.pt --pretrained sp82_epoch40_dropout0.50_lstm.pt
debug
{'rnn.weight_ih_l0': 0.84, 'rnn.weight_hh_l0': 0.84, 'rnn.weight_ih_l1': 0.84, 'rnn.weight_hh_l1': 0.84}
{'rnn.weight_ih_l0': 0.84, 'rnn.weight_hh_l0': 0.84, 'rnn.weight_ih_l1': 0.84, 'rnn.weight_hh_l1': 0.84}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 51.25 | loss 14.75 | ppl 2542574.18
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 47.11 | loss  6.58 | ppl   720.74
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 47.08 | loss  4.09 | ppl    59.70
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 48.40 | loss  3.30 | ppl    27.06
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 49.41 | loss  3.12 | ppl    22.72
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 49.99 | loss  2.87 | ppl    17.57
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 67.28s | valid loss  4.82 | valid ppl   124.16
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 54.78 | loss  5.06 | ppl   158.14
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 50.18 | loss  3.26 | ppl    26.17
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 50.45 | loss  2.92 | ppl    18.56
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 51.06 | loss  2.81 | ppl    16.69
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.18 | loss  2.86 | ppl    17.50
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.10 | loss  2.67 | ppl    14.43
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 70.71s | valid loss  4.88 | valid ppl   131.52
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 55.49 | loss  2.95 | ppl    19.03
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 51.40 | loss  2.83 | ppl    17.00
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 51.71 | loss  2.81 | ppl    16.63
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 51.67 | loss  2.77 | ppl    15.89
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.70 | loss  2.83 | ppl    16.94
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.73 | loss  2.64 | ppl    14.08
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 71.64s | valid loss  4.90 | valid ppl   134.08
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 55.91 | loss  2.88 | ppl    17.82
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 51.78 | loss  2.80 | ppl    16.51
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 51.79 | loss  2.79 | ppl    16.25
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 52.07 | loss  2.75 | ppl    15.60
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.16 | loss  2.81 | ppl    16.61
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.15 | loss  2.63 | ppl    13.85
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 72.22s | valid loss  4.89 | valid ppl   133.59
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 56.69 | loss  3.00 | ppl    20.05
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 52.43 | loss  2.93 | ppl    18.78
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 52.56 | loss  2.92 | ppl    18.55
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 52.50 | loss  2.88 | ppl    17.73
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.52 | loss  2.93 | ppl    18.80
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.83 | loss  2.76 | ppl    15.85
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 73.16s | valid loss  4.83 | valid ppl   125.66
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 57.17 | loss  2.96 | ppl    19.29
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 52.67 | loss  2.92 | ppl    18.58
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 52.75 | loss  2.91 | ppl    18.27
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 52.70 | loss  2.86 | ppl    17.48
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.78 | loss  2.92 | ppl    18.60
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 53.92 | loss  2.75 | ppl    15.66
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 73.54s | valid loss  4.84 | valid ppl   126.23
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 57.34 | loss  2.96 | ppl    19.24
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 52.77 | loss  2.90 | ppl    18.15
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 52.82 | loss  2.87 | ppl    17.66
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 53.40 | loss  2.83 | ppl    16.87
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.65 | loss  2.89 | ppl    17.92
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.39 | loss  2.72 | ppl    15.11
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 73.69s | valid loss  4.83 | valid ppl   124.99
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 57.61 | loss  2.92 | ppl    18.46
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 53.48 | loss  2.88 | ppl    17.81
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 54.20 | loss  2.87 | ppl    17.57
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 54.16 | loss  2.82 | ppl    16.75
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.23 | loss  2.88 | ppl    17.90
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.21 | loss  2.71 | ppl    15.01
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 74.77s | valid loss  4.83 | valid ppl   125.20
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 58.54 | loss  2.89 | ppl    18.07
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 53.92 | loss  2.87 | ppl    17.62
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 54.99 | loss  2.86 | ppl    17.45
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 55.22 | loss  2.81 | ppl    16.61
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.18 | loss  2.87 | ppl    17.69
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.09 | loss  2.70 | ppl    14.83
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 75.86s | valid loss  4.83 | valid ppl   125.28
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 2.50 | ms/batch 59.30 | loss  2.91 | ppl    18.44
| epoch  10 |   400/ 1327 batches | lr 2.50 | ms/batch 54.71 | loss  2.89 | ppl    18.00
| epoch  10 |   600/ 1327 batches | lr 2.50 | ms/batch 55.66 | loss  2.87 | ppl    17.68
| epoch  10 |   800/ 1327 batches | lr 2.50 | ms/batch 55.63 | loss  2.83 | ppl    16.98
| epoch  10 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.67 | loss  2.89 | ppl    17.95
| epoch  10 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.61 | loss  2.72 | ppl    15.20
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 76.64s | valid loss  4.82 | valid ppl   124.21
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 2.50 | ms/batch 59.28 | loss  2.55 | ppl    12.84
| epoch  11 |   400/ 1327 batches | lr 2.50 | ms/batch 54.70 | loss  2.56 | ppl    12.92
| epoch  11 |   600/ 1327 batches | lr 2.50 | ms/batch 55.34 | loss  2.55 | ppl    12.84
| epoch  11 |   800/ 1327 batches | lr 2.50 | ms/batch 56.17 | loss  2.51 | ppl    12.36
| epoch  11 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.83 | loss  2.57 | ppl    13.06
| epoch  11 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.54 | loss  2.41 | ppl    11.19
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 76.69s | valid loss  4.92 | valid ppl   136.92
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 60.55 | loss  2.65 | ppl    14.14
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 56.29 | loss  2.62 | ppl    13.78
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 56.29 | loss  2.61 | ppl    13.54
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 56.19 | loss  2.56 | ppl    12.94
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.40 | loss  2.62 | ppl    13.76
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.14 | loss  2.47 | ppl    11.79
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 77.86s | valid loss  4.89 | valid ppl   132.52
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 60.81 | loss  2.64 | ppl    14.02
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 56.40 | loss  2.62 | ppl    13.80
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 57.13 | loss  2.61 | ppl    13.64
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 57.19 | loss  2.57 | ppl    13.05
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.10 | loss  2.62 | ppl    13.75
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.11 | loss  2.47 | ppl    11.82
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 78.65s | valid loss  4.89 | valid ppl   132.71
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 61.17 | loss  2.89 | ppl    17.94
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 56.97 | loss  2.85 | ppl    17.30
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 56.69 | loss  2.83 | ppl    17.02
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 57.76 | loss  2.79 | ppl    16.23
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.52 | loss  2.84 | ppl    17.10
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.39 | loss  2.68 | ppl    14.57
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 79.13s | valid loss  4.83 | valid ppl   125.70
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 61.35 | loss  2.86 | ppl    17.39
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 56.95 | loss  2.84 | ppl    17.14
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 57.37 | loss  2.82 | ppl    16.84
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 58.24 | loss  2.77 | ppl    15.96
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.00 | loss  2.84 | ppl    17.08
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.77 | loss  2.67 | ppl    14.44
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 79.63s | valid loss  4.83 | valid ppl   125.02
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 62.02 | loss  2.87 | ppl    17.59
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 57.75 | loss  2.85 | ppl    17.23
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 58.16 | loss  2.84 | ppl    17.03
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 58.38 | loss  2.79 | ppl    16.24
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.39 | loss  2.85 | ppl    17.23
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.40 | loss  2.68 | ppl    14.63
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 80.59s | valid loss  4.82 | valid ppl   124.11
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 62.81 | loss  2.86 | ppl    17.48
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 58.10 | loss  2.84 | ppl    17.09
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 58.82 | loss  2.83 | ppl    16.88
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 58.78 | loss  2.78 | ppl    16.11
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.74 | loss  2.84 | ppl    17.15
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.87 | loss  2.67 | ppl    14.40
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 81.19s | valid loss  4.82 | valid ppl   123.95
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 1.25 | ms/batch 62.45 | loss  3.03 | ppl    20.80
| epoch  18 |   400/ 1327 batches | lr 1.25 | ms/batch 58.75 | loss  3.01 | ppl    20.29
| epoch  18 |   600/ 1327 batches | lr 1.25 | ms/batch 58.81 | loss  3.00 | ppl    20.09
| epoch  18 |   800/ 1327 batches | lr 1.25 | ms/batch 59.63 | loss  2.95 | ppl    19.01
| epoch  18 |  1000/ 1327 batches | lr 1.25 | ms/batch 59.53 | loss  3.01 | ppl    20.21
| epoch  18 |  1200/ 1327 batches | lr 1.25 | ms/batch 59.36 | loss  2.84 | ppl    17.19
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 81.78s | valid loss  4.78 | valid ppl   119.03
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 1.25 | ms/batch 63.20 | loss  3.02 | ppl    20.43
| epoch  19 |   400/ 1327 batches | lr 1.25 | ms/batch 59.65 | loss  3.00 | ppl    20.05
| epoch  19 |   600/ 1327 batches | lr 1.25 | ms/batch 59.98 | loss  2.99 | ppl    19.86
| epoch  19 |   800/ 1327 batches | lr 1.25 | ms/batch 60.06 | loss  2.94 | ppl    18.85
| epoch  19 |  1000/ 1327 batches | lr 1.25 | ms/batch 60.05 | loss  3.00 | ppl    20.13
| epoch  19 |  1200/ 1327 batches | lr 1.25 | ms/batch 60.26 | loss  2.84 | ppl    17.06
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 82.54s | valid loss  4.77 | valid ppl   118.38
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 1.25 | ms/batch 64.29 | loss  3.06 | ppl    21.24
| epoch  20 |   400/ 1327 batches | lr 1.25 | ms/batch 60.10 | loss  3.04 | ppl    20.86
| epoch  20 |   600/ 1327 batches | lr 1.25 | ms/batch 60.41 | loss  3.02 | ppl    20.57
| epoch  20 |   800/ 1327 batches | lr 1.25 | ms/batch 60.46 | loss  2.97 | ppl    19.56
| epoch  20 |  1000/ 1327 batches | lr 1.25 | ms/batch 60.42 | loss  3.04 | ppl    20.80
| epoch  20 |  1200/ 1327 batches | lr 1.25 | ms/batch 60.47 | loss  2.87 | ppl    17.72
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 83.42s | valid loss  4.76 | valid ppl   117.10
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 1.25 | ms/batch 64.54 | loss  2.42 | ppl    11.28
| epoch  21 |   400/ 1327 batches | lr 1.25 | ms/batch 60.45 | loss  2.44 | ppl    11.50
| epoch  21 |   600/ 1327 batches | lr 1.25 | ms/batch 60.63 | loss  2.43 | ppl    11.36
| epoch  21 |   800/ 1327 batches | lr 1.25 | ms/batch 60.51 | loss  2.39 | ppl    10.88
| epoch  21 |  1000/ 1327 batches | lr 1.25 | ms/batch 60.85 | loss  2.45 | ppl    11.62
| epoch  21 |  1200/ 1327 batches | lr 1.25 | ms/batch 61.03 | loss  2.30 | ppl    10.01
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 83.74s | valid loss  4.92 | valid ppl   137.09
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 0.62 | ms/batch 65.21 | loss  2.47 | ppl    11.83
| epoch  22 |   400/ 1327 batches | lr 0.62 | ms/batch 60.74 | loss  2.45 | ppl    11.61
| epoch  22 |   600/ 1327 batches | lr 0.62 | ms/batch 60.80 | loss  2.45 | ppl    11.56
| epoch  22 |   800/ 1327 batches | lr 0.62 | ms/batch 61.23 | loss  2.40 | ppl    11.06
| epoch  22 |  1000/ 1327 batches | lr 0.62 | ms/batch 61.42 | loss  2.45 | ppl    11.62
| epoch  22 |  1200/ 1327 batches | lr 0.62 | ms/batch 62.26 | loss  2.30 | ppl    10.01
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 84.51s | valid loss  4.92 | valid ppl   137.18
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 0.62 | ms/batch 65.72 | loss  2.47 | ppl    11.82
| epoch  23 |   400/ 1327 batches | lr 0.62 | ms/batch 61.23 | loss  2.46 | ppl    11.69
| epoch  23 |   600/ 1327 batches | lr 0.62 | ms/batch 61.74 | loss  2.45 | ppl    11.59
| epoch  23 |   800/ 1327 batches | lr 0.62 | ms/batch 62.30 | loss  2.40 | ppl    11.07
| epoch  23 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.38 | loss  2.46 | ppl    11.67
| epoch  23 |  1200/ 1327 batches | lr 0.62 | ms/batch 62.31 | loss  2.31 | ppl    10.04
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 85.44s | valid loss  4.93 | valid ppl   138.31
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.62 | ms/batch 66.54 | loss  2.86 | ppl    17.42
| epoch  24 |   400/ 1327 batches | lr 0.62 | ms/batch 62.49 | loss  2.82 | ppl    16.76
| epoch  24 |   600/ 1327 batches | lr 0.62 | ms/batch 62.54 | loss  2.81 | ppl    16.65
| epoch  24 |   800/ 1327 batches | lr 0.62 | ms/batch 62.53 | loss  2.75 | ppl    15.68
| epoch  24 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.78 | loss  2.82 | ppl    16.78
| epoch  24 |  1200/ 1327 batches | lr 0.62 | ms/batch 62.69 | loss  2.64 | ppl    14.07
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 86.24s | valid loss  4.85 | valid ppl   127.31
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.62 | ms/batch 66.45 | loss  2.82 | ppl    16.75
| epoch  25 |   400/ 1327 batches | lr 0.62 | ms/batch 62.32 | loss  2.79 | ppl    16.34
| epoch  25 |   600/ 1327 batches | lr 0.62 | ms/batch 63.31 | loss  2.78 | ppl    16.18
| epoch  25 |   800/ 1327 batches | lr 0.62 | ms/batch 62.98 | loss  2.74 | ppl    15.46
| epoch  25 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.95 | loss  2.80 | ppl    16.42
| epoch  25 |  1200/ 1327 batches | lr 0.62 | ms/batch 63.36 | loss  2.64 | ppl    13.98
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 86.57s | valid loss  4.84 | valid ppl   126.31
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.62 | ms/batch 66.96 | loss  2.80 | ppl    16.51
| epoch  26 |   400/ 1327 batches | lr 0.62 | ms/batch 63.07 | loss  2.79 | ppl    16.30
| epoch  26 |   600/ 1327 batches | lr 0.62 | ms/batch 63.94 | loss  2.77 | ppl    15.99
| epoch  26 |   800/ 1327 batches | lr 0.62 | ms/batch 63.96 | loss  2.73 | ppl    15.28
| epoch  26 |  1000/ 1327 batches | lr 0.62 | ms/batch 63.69 | loss  2.80 | ppl    16.37
| epoch  26 |  1200/ 1327 batches | lr 0.62 | ms/batch 63.83 | loss  2.62 | ppl    13.78
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 87.52s | valid loss  4.83 | valid ppl   125.79
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.62 | ms/batch 67.74 | loss  2.96 | ppl    19.39
| epoch  27 |   400/ 1327 batches | lr 0.62 | ms/batch 63.41 | loss  2.94 | ppl    19.00
| epoch  27 |   600/ 1327 batches | lr 0.62 | ms/batch 64.27 | loss  2.93 | ppl    18.81
| epoch  27 |   800/ 1327 batches | lr 0.62 | ms/batch 64.19 | loss  2.88 | ppl    17.89
| epoch  27 |  1000/ 1327 batches | lr 0.62 | ms/batch 64.31 | loss  2.94 | ppl    19.00
| epoch  27 |  1200/ 1327 batches | lr 0.62 | ms/batch 64.13 | loss  2.78 | ppl    16.08
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 88.03s | valid loss  4.80 | valid ppl   121.91
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.62 | ms/batch 68.14 | loss  2.95 | ppl    19.14
| epoch  28 |   400/ 1327 batches | lr 0.62 | ms/batch 64.21 | loss  2.94 | ppl    18.89
| epoch  28 |   600/ 1327 batches | lr 0.62 | ms/batch 64.22 | loss  2.92 | ppl    18.52
| epoch  28 |   800/ 1327 batches | lr 0.62 | ms/batch 64.82 | loss  2.88 | ppl    17.80
| epoch  28 |  1000/ 1327 batches | lr 0.62 | ms/batch 64.65 | loss  2.95 | ppl    19.05
| epoch  28 |  1200/ 1327 batches | lr 0.62 | ms/batch 64.72 | loss  2.77 | ppl    16.00
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 88.62s | valid loss  4.80 | valid ppl   120.98
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.62 | ms/batch 68.56 | loss  2.98 | ppl    19.63
| epoch  29 |   400/ 1327 batches | lr 0.62 | ms/batch 64.86 | loss  2.96 | ppl    19.38
| epoch  29 |   600/ 1327 batches | lr 0.62 | ms/batch 64.99 | loss  2.96 | ppl    19.20
| epoch  29 |   800/ 1327 batches | lr 0.62 | ms/batch 64.92 | loss  2.90 | ppl    18.17
| epoch  29 |  1000/ 1327 batches | lr 0.62 | ms/batch 64.84 | loss  2.98 | ppl    19.64
| epoch  29 |  1200/ 1327 batches | lr 0.62 | ms/batch 65.44 | loss  2.80 | ppl    16.45
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 89.29s | valid loss  4.79 | valid ppl   119.78
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.62 | ms/batch 69.41 | loss  2.98 | ppl    19.61
| epoch  30 |   400/ 1327 batches | lr 0.62 | ms/batch 65.60 | loss  2.96 | ppl    19.33
| epoch  30 |   600/ 1327 batches | lr 0.62 | ms/batch 65.56 | loss  2.95 | ppl    19.07
| epoch  30 |   800/ 1327 batches | lr 0.62 | ms/batch 65.58 | loss  2.90 | ppl    18.25
| epoch  30 |  1000/ 1327 batches | lr 0.62 | ms/batch 65.55 | loss  2.97 | ppl    19.46
| epoch  30 |  1200/ 1327 batches | lr 0.62 | ms/batch 66.09 | loss  2.80 | ppl    16.38
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 90.22s | valid loss  4.78 | valid ppl   119.54
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.62 | ms/batch 69.91 | loss  2.97 | ppl    19.52
| epoch  31 |   400/ 1327 batches | lr 0.62 | ms/batch 66.28 | loss  2.96 | ppl    19.34
| epoch  31 |   600/ 1327 batches | lr 0.62 | ms/batch 66.26 | loss  2.94 | ppl    18.99
| epoch  31 |   800/ 1327 batches | lr 0.62 | ms/batch 66.74 | loss  2.90 | ppl    18.08
| epoch  31 |  1000/ 1327 batches | lr 0.62 | ms/batch 66.52 | loss  2.96 | ppl    19.35
| epoch  31 |  1200/ 1327 batches | lr 0.62 | ms/batch 66.31 | loss  2.80 | ppl    16.44
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 91.20s | valid loss  4.78 | valid ppl   119.30
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.62 | ms/batch 70.25 | loss  3.08 | ppl    21.70
| epoch  32 |   400/ 1327 batches | lr 0.62 | ms/batch 66.63 | loss  3.06 | ppl    21.37
| epoch  32 |   600/ 1327 batches | lr 0.62 | ms/batch 66.92 | loss  3.05 | ppl    21.20
| epoch  32 |   800/ 1327 batches | lr 0.62 | ms/batch 66.97 | loss  2.99 | ppl    19.94
| epoch  32 |  1000/ 1327 batches | lr 0.62 | ms/batch 66.83 | loss  3.07 | ppl    21.53
| epoch  32 |  1200/ 1327 batches | lr 0.62 | ms/batch 67.19 | loss  2.90 | ppl    18.25
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 91.76s | valid loss  4.76 | valid ppl   116.37
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.62 | ms/batch 70.99 | loss  3.07 | ppl    21.45
| epoch  33 |   400/ 1327 batches | lr 0.62 | ms/batch 66.92 | loss  3.05 | ppl    21.21
| epoch  33 |   600/ 1327 batches | lr 0.62 | ms/batch 67.80 | loss  3.04 | ppl    21.01
| epoch  33 |   800/ 1327 batches | lr 0.62 | ms/batch 67.36 | loss  3.00 | ppl    20.01
| epoch  33 |  1000/ 1327 batches | lr 0.62 | ms/batch 67.62 | loss  3.07 | ppl    21.50
| epoch  33 |  1200/ 1327 batches | lr 0.62 | ms/batch 67.70 | loss  2.89 | ppl    18.07
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 92.62s | valid loss  4.75 | valid ppl   115.82
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.62 | ms/batch 71.37 | loss  3.07 | ppl    21.60
| epoch  34 |   400/ 1327 batches | lr 0.62 | ms/batch 67.81 | loss  3.06 | ppl    21.38
| epoch  34 |   600/ 1327 batches | lr 0.62 | ms/batch 68.21 | loss  3.04 | ppl    20.96
| epoch  34 |   800/ 1327 batches | lr 0.62 | ms/batch 67.89 | loss  3.00 | ppl    20.01
| epoch  34 |  1000/ 1327 batches | lr 0.62 | ms/batch 68.29 | loss  3.07 | ppl    21.48
| epoch  34 |  1200/ 1327 batches | lr 0.62 | ms/batch 67.87 | loss  2.89 | ppl    17.96
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 93.22s | valid loss  4.75 | valid ppl   115.57
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.62 | ms/batch 72.44 | loss  3.08 | ppl    21.78
| epoch  35 |   400/ 1327 batches | lr 0.62 | ms/batch 67.46 | loss  3.07 | ppl    21.47
| epoch  35 |   600/ 1327 batches | lr 0.62 | ms/batch 67.97 | loss  3.05 | ppl    21.19
| epoch  35 |   800/ 1327 batches | lr 0.62 | ms/batch 68.64 | loss  3.00 | ppl    20.15
| epoch  35 |  1000/ 1327 batches | lr 0.62 | ms/batch 68.30 | loss  3.07 | ppl    21.60
| epoch  35 |  1200/ 1327 batches | lr 0.62 | ms/batch 68.30 | loss  2.90 | ppl    18.18
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 93.67s | valid loss  4.75 | valid ppl   115.20
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.62 | ms/batch 72.61 | loss  3.09 | ppl    21.94
| epoch  36 |   400/ 1327 batches | lr 0.62 | ms/batch 68.87 | loss  3.07 | ppl    21.49
| epoch  36 |   600/ 1327 batches | lr 0.62 | ms/batch 68.80 | loss  3.06 | ppl    21.25
| epoch  36 |   800/ 1327 batches | lr 0.62 | ms/batch 69.13 | loss  3.01 | ppl    20.22
| epoch  36 |  1000/ 1327 batches | lr 0.62 | ms/batch 69.15 | loss  3.07 | ppl    21.62
| epoch  36 |  1200/ 1327 batches | lr 0.62 | ms/batch 68.97 | loss  2.91 | ppl    18.34
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 94.56s | valid loss  4.74 | valid ppl   114.72
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.62 | ms/batch 73.08 | loss  3.08 | ppl    21.78
| epoch  37 |   400/ 1327 batches | lr 0.62 | ms/batch 69.05 | loss  3.07 | ppl    21.53
| epoch  37 |   600/ 1327 batches | lr 0.62 | ms/batch 69.60 | loss  3.06 | ppl    21.43
| epoch  37 |   800/ 1327 batches | lr 0.62 | ms/batch 69.89 | loss  3.01 | ppl    20.25
| epoch  37 |  1000/ 1327 batches | lr 0.62 | ms/batch 69.65 | loss  3.08 | ppl    21.70
| epoch  37 |  1200/ 1327 batches | lr 0.62 | ms/batch 69.72 | loss  2.91 | ppl    18.39
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 95.37s | valid loss  4.74 | valid ppl   114.26
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.62 | ms/batch 73.65 | loss  3.09 | ppl    21.87
| epoch  38 |   400/ 1327 batches | lr 0.62 | ms/batch 69.60 | loss  3.08 | ppl    21.72
| epoch  38 |   600/ 1327 batches | lr 0.62 | ms/batch 69.90 | loss  3.06 | ppl    21.36
| epoch  38 |   800/ 1327 batches | lr 0.62 | ms/batch 69.92 | loss  3.01 | ppl    20.29
| epoch  38 |  1000/ 1327 batches | lr 0.62 | ms/batch 69.82 | loss  3.08 | ppl    21.74
| epoch  38 |  1200/ 1327 batches | lr 0.62 | ms/batch 69.95 | loss  2.91 | ppl    18.42
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 95.79s | valid loss  4.74 | valid ppl   114.02
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.62 | ms/batch 74.41 | loss  3.09 | ppl    22.07
| epoch  39 |   400/ 1327 batches | lr 0.62 | ms/batch 69.69 | loss  3.09 | ppl    21.92
| epoch  39 |   600/ 1327 batches | lr 0.62 | ms/batch 70.25 | loss  3.07 | ppl    21.54
| epoch  39 |   800/ 1327 batches | lr 0.62 | ms/batch 70.04 | loss  3.02 | ppl    20.51
| epoch  39 |  1000/ 1327 batches | lr 0.62 | ms/batch 70.92 | loss  3.09 | ppl    21.88
| epoch  39 |  1200/ 1327 batches | lr 0.62 | ms/batch 70.38 | loss  2.92 | ppl    18.53
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 96.42s | valid loss  4.73 | valid ppl   113.78
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.62 | ms/batch 74.95 | loss  3.11 | ppl    22.49
| epoch  40 |   400/ 1327 batches | lr 0.62 | ms/batch 70.38 | loss  3.09 | ppl    22.07
| epoch  40 |   600/ 1327 batches | lr 0.62 | ms/batch 71.48 | loss  3.10 | ppl    22.14
| epoch  40 |   800/ 1327 batches | lr 0.62 | ms/batch 70.71 | loss  3.03 | ppl    20.77
| epoch  40 |  1000/ 1327 batches | lr 0.62 | ms/batch 71.91 | loss  3.11 | ppl    22.34
| epoch  40 |  1200/ 1327 batches | lr 0.62 | ms/batch 71.14 | loss  2.94 | ppl    18.83
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 97.44s | valid loss  4.73 | valid ppl   113.40
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.8393333333333334
sparsity at layer rnn.weight_hh_l0 is 0.8393333333333334
sparsity at layer rnn.weight_ih_l1 is 0.8393333333333334
sparsity at layer rnn.weight_hh_l1 is 0.8393333333333334
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.8443997317236753
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 45.57 | loss  2.39 | ppl    10.87
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 46.28 | loss  2.42 | ppl    11.29
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 46.44 | loss  2.44 | ppl    11.49
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 46.44 | loss  2.42 | ppl    11.23
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 47.00 | loss  2.51 | ppl    12.32
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.94 | loss  2.37 | ppl    10.67
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 63.58s | valid loss  5.07 | valid ppl   158.98
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 46.68 | loss  2.46 | ppl    11.70
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 46.24 | loss  2.46 | ppl    11.76
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 46.31 | loss  2.46 | ppl    11.68
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 46.27 | loss  2.44 | ppl    11.48
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.69 | loss  2.53 | ppl    12.53
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.84 | loss  2.37 | ppl    10.74
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.57s | valid loss  5.08 | valid ppl   161.28
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 47.59 | loss  2.48 | ppl    11.89
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 46.91 | loss  2.47 | ppl    11.85
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 46.88 | loss  2.47 | ppl    11.82
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 46.84 | loss  2.45 | ppl    11.58
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.38 | loss  2.53 | ppl    12.54
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 47.14 | loss  2.38 | ppl    10.82
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 64.16s | valid loss  5.08 | valid ppl   161.47
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 47.71 | loss  2.50 | ppl    12.14
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 46.82 | loss  2.46 | ppl    11.73
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 46.76 | loss  2.43 | ppl    11.37
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 46.82 | loss  2.38 | ppl    10.83
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.78 | loss  2.43 | ppl    11.37
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 47.27 | loss  2.27 | ppl     9.72
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 64.25s | valid loss  5.07 | valid ppl   158.84
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 46.85 | loss  2.80 | ppl    16.37
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 46.86 | loss  2.76 | ppl    15.82
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 46.69 | loss  2.73 | ppl    15.37
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 46.68 | loss  2.69 | ppl    14.74
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.66 | loss  2.75 | ppl    15.66
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.72 | loss  2.59 | ppl    13.34
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 63.88s | valid loss  4.95 | valid ppl   140.87
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 46.99 | loss  2.73 | ppl    15.36
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 46.89 | loss  2.72 | ppl    15.13
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 46.86 | loss  2.69 | ppl    14.78
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 46.89 | loss  2.65 | ppl    14.15
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.84 | loss  2.72 | ppl    15.15
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.77 | loss  2.56 | ppl    12.95
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 64.06s | valid loss  4.96 | valid ppl   142.31
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 47.28 | loss  3.11 | ppl    22.52
| epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 47.03 | loss  3.08 | ppl    21.75
| epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 47.04 | loss  3.06 | ppl    21.40
| epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 46.99 | loss  3.01 | ppl    20.38
| epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.84 | loss  3.08 | ppl    21.81
| epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.66 | loss  2.93 | ppl    18.76
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.15s | valid loss  4.82 | valid ppl   123.38
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch 47.14 | loss  3.08 | ppl    21.66
| epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch 46.82 | loss  3.06 | ppl    21.31
| epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch 46.82 | loss  3.04 | ppl    21.01
| epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch 46.92 | loss  2.99 | ppl    19.95
| epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.84 | loss  3.07 | ppl    21.56
| epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch 47.02 | loss  2.91 | ppl    18.40
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 64.17s | valid loss  4.80 | valid ppl   121.68
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 5.00 | ms/batch 46.87 | loss  3.13 | ppl    22.83
| epoch   9 |   400/ 1327 batches | lr 5.00 | ms/batch 46.59 | loss  3.12 | ppl    22.59
| epoch   9 |   600/ 1327 batches | lr 5.00 | ms/batch 46.70 | loss  3.11 | ppl    22.38
| epoch   9 |   800/ 1327 batches | lr 5.00 | ms/batch 46.81 | loss  3.06 | ppl    21.29
| epoch   9 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.30 | loss  3.13 | ppl    22.85
| epoch   9 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.61 | loss  2.98 | ppl    19.63
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 63.81s | valid loss  4.77 | valid ppl   118.37
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 5.00 | ms/batch 46.89 | loss  3.12 | ppl    22.55
| epoch  10 |   400/ 1327 batches | lr 5.00 | ms/batch 47.37 | loss  3.11 | ppl    22.49
| epoch  10 |   600/ 1327 batches | lr 5.00 | ms/batch 46.72 | loss  3.10 | ppl    22.23
| epoch  10 |   800/ 1327 batches | lr 5.00 | ms/batch 46.76 | loss  3.05 | ppl    21.03
| epoch  10 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.77 | loss  3.12 | ppl    22.69
| epoch  10 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.82 | loss  2.96 | ppl    19.39
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 64.11s | valid loss  4.78 | valid ppl   118.76
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 47.51 | loss  3.12 | ppl    22.57
| epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 47.19 | loss  3.11 | ppl    22.40
| epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 46.86 | loss  3.09 | ppl    21.92
| epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 46.72 | loss  3.02 | ppl    20.53
| epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.71 | loss  3.10 | ppl    22.14
| epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.70 | loss  2.94 | ppl    18.92
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 64.15s | valid loss  4.75 | valid ppl   115.29
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 47.19 | loss  3.10 | ppl    22.17
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 47.00 | loss  3.08 | ppl    21.74
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 46.90 | loss  3.08 | ppl    21.66
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 46.96 | loss  3.02 | ppl    20.51
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.79 | loss  3.09 | ppl    21.88
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 47.15 | loss  2.94 | ppl    18.90
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 64.18s | valid loss  4.75 | valid ppl   115.41
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 47.29 | loss  3.12 | ppl    22.55
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 46.85 | loss  3.09 | ppl    22.09
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 46.59 | loss  3.09 | ppl    21.87
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 46.49 | loss  3.04 | ppl    20.81
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.62 | loss  3.10 | ppl    22.28
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.91 | loss  2.95 | ppl    19.11
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 64.01s | valid loss  4.74 | valid ppl   114.41
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 46.91 | loss  3.10 | ppl    22.14
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 46.91 | loss  3.09 | ppl    21.97
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 46.93 | loss  3.08 | ppl    21.70
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 47.00 | loss  3.03 | ppl    20.61
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.89 | loss  3.10 | ppl    22.12
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.87 | loss  2.95 | ppl    19.07
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 64.14s | valid loss  4.74 | valid ppl   114.76
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 0.31 | ms/batch 47.24 | loss  3.11 | ppl    22.41
| epoch  15 |   400/ 1327 batches | lr 0.31 | ms/batch 47.08 | loss  3.10 | ppl    22.28
| epoch  15 |   600/ 1327 batches | lr 0.31 | ms/batch 46.93 | loss  3.09 | ppl    22.03
| epoch  15 |   800/ 1327 batches | lr 0.31 | ms/batch 46.94 | loss  3.04 | ppl    20.86
| epoch  15 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.84 | loss  3.11 | ppl    22.48
| epoch  15 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.91 | loss  2.93 | ppl    18.78
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 64.22s | valid loss  4.72 | valid ppl   111.95
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 0.31 | ms/batch 46.78 | loss  3.11 | ppl    22.40
| epoch  16 |   400/ 1327 batches | lr 0.31 | ms/batch 46.53 | loss  3.10 | ppl    22.12
| epoch  16 |   600/ 1327 batches | lr 0.31 | ms/batch 46.45 | loss  3.08 | ppl    21.86
| epoch  16 |   800/ 1327 batches | lr 0.31 | ms/batch 46.43 | loss  3.04 | ppl    20.86
| epoch  16 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.43 | loss  3.11 | ppl    22.37
| epoch  16 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.80 | loss  2.94 | ppl    18.86
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.71s | valid loss  4.72 | valid ppl   111.68
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 0.31 | ms/batch 47.13 | loss  3.13 | ppl    22.97
| epoch  17 |   400/ 1327 batches | lr 0.31 | ms/batch 46.80 | loss  3.12 | ppl    22.72
| epoch  17 |   600/ 1327 batches | lr 0.31 | ms/batch 46.85 | loss  3.12 | ppl    22.55
| epoch  17 |   800/ 1327 batches | lr 0.31 | ms/batch 46.62 | loss  3.06 | ppl    21.27
| epoch  17 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.97 | loss  3.13 | ppl    22.94
| epoch  17 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.92 | loss  2.97 | ppl    19.41
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 64.11s | valid loss  4.71 | valid ppl   111.01
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 0.31 | ms/batch 47.03 | loss  3.13 | ppl    22.98
| epoch  18 |   400/ 1327 batches | lr 0.31 | ms/batch 46.81 | loss  3.12 | ppl    22.70
| epoch  18 |   600/ 1327 batches | lr 0.31 | ms/batch 46.79 | loss  3.11 | ppl    22.43
| epoch  18 |   800/ 1327 batches | lr 0.31 | ms/batch 46.57 | loss  3.06 | ppl    21.41
| epoch  18 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.58 | loss  3.12 | ppl    22.76
| epoch  18 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.78 | loss  2.97 | ppl    19.49
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 63.91s | valid loss  4.71 | valid ppl   110.82
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.31 | ms/batch 46.91 | loss  3.14 | ppl    23.07
| epoch  19 |   400/ 1327 batches | lr 0.31 | ms/batch 46.97 | loss  3.13 | ppl    22.80
| epoch  19 |   600/ 1327 batches | lr 0.31 | ms/batch 46.80 | loss  3.12 | ppl    22.67
| epoch  19 |   800/ 1327 batches | lr 0.31 | ms/batch 46.93 | loss  3.06 | ppl    21.34
| epoch  19 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.60 | loss  3.14 | ppl    23.02
| epoch  19 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.65 | loss  2.97 | ppl    19.49
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.98s | valid loss  4.71 | valid ppl   110.58
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.31 | ms/batch 46.59 | loss  3.14 | ppl    23.05
| epoch  20 |   400/ 1327 batches | lr 0.31 | ms/batch 46.89 | loss  3.12 | ppl    22.66
| epoch  20 |   600/ 1327 batches | lr 0.31 | ms/batch 46.63 | loss  3.11 | ppl    22.46
| epoch  20 |   800/ 1327 batches | lr 0.31 | ms/batch 46.67 | loss  3.05 | ppl    21.21
| epoch  20 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.61 | loss  3.14 | ppl    23.09
| epoch  20 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.32 | loss  2.97 | ppl    19.43
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 63.80s | valid loss  4.71 | valid ppl   110.51
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 0.31 | ms/batch 46.91 | loss  3.13 | ppl    22.92
| epoch  21 |   400/ 1327 batches | lr 0.31 | ms/batch 46.73 | loss  3.12 | ppl    22.64
| epoch  21 |   600/ 1327 batches | lr 0.31 | ms/batch 46.76 | loss  3.11 | ppl    22.34
| epoch  21 |   800/ 1327 batches | lr 0.31 | ms/batch 46.78 | loss  3.06 | ppl    21.24
| epoch  21 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.69 | loss  3.14 | ppl    23.15
| epoch  21 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.80 | loss  2.97 | ppl    19.46
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 63.95s | valid loss  4.70 | valid ppl   110.41
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 0.31 | ms/batch 46.48 | loss  3.13 | ppl    22.96
| epoch  22 |   400/ 1327 batches | lr 0.31 | ms/batch 47.12 | loss  3.12 | ppl    22.62
| epoch  22 |   600/ 1327 batches | lr 0.31 | ms/batch 46.73 | loss  3.11 | ppl    22.37
| epoch  22 |   800/ 1327 batches | lr 0.31 | ms/batch 46.73 | loss  3.06 | ppl    21.26
| epoch  22 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.74 | loss  3.13 | ppl    22.94
| epoch  22 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.59 | loss  2.97 | ppl    19.46
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 63.96s | valid loss  4.70 | valid ppl   110.45
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 0.31 | ms/batch 47.00 | loss  3.13 | ppl    22.96
| epoch  23 |   400/ 1327 batches | lr 0.31 | ms/batch 46.78 | loss  3.13 | ppl    22.87
| epoch  23 |   600/ 1327 batches | lr 0.31 | ms/batch 46.63 | loss  3.12 | ppl    22.64
| epoch  23 |   800/ 1327 batches | lr 0.31 | ms/batch 46.34 | loss  3.06 | ppl    21.24
| epoch  23 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.41 | loss  3.14 | ppl    23.02
| epoch  23 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.69 | loss  2.98 | ppl    19.59
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 63.76s | valid loss  4.70 | valid ppl   110.30
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.31 | ms/batch 46.92 | loss  3.14 | ppl    23.09
| epoch  24 |   400/ 1327 batches | lr 0.31 | ms/batch 46.68 | loss  3.12 | ppl    22.70
| epoch  24 |   600/ 1327 batches | lr 0.31 | ms/batch 46.67 | loss  3.11 | ppl    22.41
| epoch  24 |   800/ 1327 batches | lr 0.31 | ms/batch 46.72 | loss  3.06 | ppl    21.34
| epoch  24 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.93 | loss  3.13 | ppl    22.93
| epoch  24 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.95 | loss  2.97 | ppl    19.44
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 63.96s | valid loss  4.70 | valid ppl   110.14
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.31 | ms/batch 46.68 | loss  3.14 | ppl    23.01
| epoch  25 |   400/ 1327 batches | lr 0.31 | ms/batch 46.94 | loss  3.12 | ppl    22.56
| epoch  25 |   600/ 1327 batches | lr 0.31 | ms/batch 46.78 | loss  3.11 | ppl    22.46
| epoch  25 |   800/ 1327 batches | lr 0.31 | ms/batch 46.73 | loss  3.05 | ppl    21.21
| epoch  25 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.77 | loss  3.14 | ppl    23.02
| epoch  25 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.85 | loss  2.97 | ppl    19.42
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 63.96s | valid loss  4.70 | valid ppl   110.26
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.08 | ms/batch 47.44 | loss  3.14 | ppl    23.09
| epoch  26 |   400/ 1327 batches | lr 0.08 | ms/batch 46.91 | loss  3.13 | ppl    22.91
| epoch  26 |   600/ 1327 batches | lr 0.08 | ms/batch 46.81 | loss  3.12 | ppl    22.74
| epoch  26 |   800/ 1327 batches | lr 0.08 | ms/batch 46.94 | loss  3.07 | ppl    21.44
| epoch  26 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.81 | loss  3.14 | ppl    23.20
| epoch  26 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.78 | loss  2.97 | ppl    19.45
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 64.13s | valid loss  4.70 | valid ppl   109.60
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.08 | ms/batch 46.43 | loss  3.13 | ppl    22.98
| epoch  27 |   400/ 1327 batches | lr 0.08 | ms/batch 46.16 | loss  3.13 | ppl    22.78
| epoch  27 |   600/ 1327 batches | lr 0.08 | ms/batch 46.28 | loss  3.12 | ppl    22.68
| epoch  27 |   800/ 1327 batches | lr 0.08 | ms/batch 46.87 | loss  3.06 | ppl    21.39
| epoch  27 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.47 | loss  3.14 | ppl    23.09
| epoch  27 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.69 | loss  2.98 | ppl    19.66
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 63.56s | valid loss  4.69 | valid ppl   109.34
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.08 | ms/batch 46.73 | loss  3.14 | ppl    23.02
| epoch  28 |   400/ 1327 batches | lr 0.08 | ms/batch 46.70 | loss  3.13 | ppl    22.82
| epoch  28 |   600/ 1327 batches | lr 0.08 | ms/batch 46.82 | loss  3.12 | ppl    22.57
| epoch  28 |   800/ 1327 batches | lr 0.08 | ms/batch 46.67 | loss  3.06 | ppl    21.33
| epoch  28 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.62 | loss  3.14 | ppl    23.03
| epoch  28 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.71 | loss  2.97 | ppl    19.50
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 63.88s | valid loss  4.69 | valid ppl   109.24
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.08 | ms/batch 46.83 | loss  3.13 | ppl    22.96
| epoch  29 |   400/ 1327 batches | lr 0.08 | ms/batch 47.04 | loss  3.12 | ppl    22.64
| epoch  29 |   600/ 1327 batches | lr 0.08 | ms/batch 46.80 | loss  3.11 | ppl    22.38
| epoch  29 |   800/ 1327 batches | lr 0.08 | ms/batch 46.91 | loss  3.06 | ppl    21.40
| epoch  29 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.77 | loss  3.14 | ppl    23.00
| epoch  29 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.84 | loss  2.98 | ppl    19.65
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 64.00s | valid loss  4.69 | valid ppl   109.14
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.08 | ms/batch 46.51 | loss  3.14 | ppl    23.05
| epoch  30 |   400/ 1327 batches | lr 0.08 | ms/batch 46.52 | loss  3.12 | ppl    22.61
| epoch  30 |   600/ 1327 batches | lr 0.08 | ms/batch 45.78 | loss  3.12 | ppl    22.57
| epoch  30 |   800/ 1327 batches | lr 0.08 | ms/batch 46.78 | loss  3.06 | ppl    21.40
| epoch  30 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.59 | loss  3.13 | ppl    22.97
| epoch  30 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.43 | loss  2.98 | ppl    19.61
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 63.51s | valid loss  4.69 | valid ppl   109.08
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.08 | ms/batch 47.10 | loss  3.13 | ppl    22.94
| epoch  31 |   400/ 1327 batches | lr 0.08 | ms/batch 46.52 | loss  3.12 | ppl    22.72
| epoch  31 |   600/ 1327 batches | lr 0.08 | ms/batch 46.56 | loss  3.11 | ppl    22.51
| epoch  31 |   800/ 1327 batches | lr 0.08 | ms/batch 46.70 | loss  3.06 | ppl    21.26
| epoch  31 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.57 | loss  3.13 | ppl    22.93
| epoch  31 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.65 | loss  2.97 | ppl    19.57
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 63.81s | valid loss  4.69 | valid ppl   109.04
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.08 | ms/batch 46.86 | loss  3.13 | ppl    22.81
| epoch  32 |   400/ 1327 batches | lr 0.08 | ms/batch 46.43 | loss  3.12 | ppl    22.69
| epoch  32 |   600/ 1327 batches | lr 0.08 | ms/batch 46.38 | loss  3.11 | ppl    22.51
| epoch  32 |   800/ 1327 batches | lr 0.08 | ms/batch 46.45 | loss  3.06 | ppl    21.37
| epoch  32 |  1000/ 1327 batches | lr 0.08 | ms/batch 47.07 | loss  3.14 | ppl    22.99
| epoch  32 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.96 | loss  2.97 | ppl    19.55
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 63.86s | valid loss  4.69 | valid ppl   109.05
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.08 | ms/batch 47.35 | loss  3.14 | ppl    23.02
| epoch  33 |   400/ 1327 batches | lr 0.08 | ms/batch 46.78 | loss  3.12 | ppl    22.72
| epoch  33 |   600/ 1327 batches | lr 0.08 | ms/batch 46.71 | loss  3.11 | ppl    22.46
| epoch  33 |   800/ 1327 batches | lr 0.08 | ms/batch 46.95 | loss  3.06 | ppl    21.36
| epoch  33 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.89 | loss  3.14 | ppl    23.15
| epoch  33 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.74 | loss  2.98 | ppl    19.62
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 64.02s | valid loss  4.69 | valid ppl   108.97
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.08 | ms/batch 46.71 | loss  3.13 | ppl    22.98
| epoch  34 |   400/ 1327 batches | lr 0.08 | ms/batch 46.63 | loss  3.11 | ppl    22.50
| epoch  34 |   600/ 1327 batches | lr 0.08 | ms/batch 46.57 | loss  3.12 | ppl    22.54
| epoch  34 |   800/ 1327 batches | lr 0.08 | ms/batch 46.71 | loss  3.06 | ppl    21.23
| epoch  34 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.16 | loss  3.14 | ppl    23.14
| epoch  34 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.71 | loss  2.98 | ppl    19.60
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 63.64s | valid loss  4.69 | valid ppl   109.01
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.02 | ms/batch 47.32 | loss  3.13 | ppl    22.97
| epoch  35 |   400/ 1327 batches | lr 0.02 | ms/batch 46.44 | loss  3.12 | ppl    22.68
| epoch  35 |   600/ 1327 batches | lr 0.02 | ms/batch 46.67 | loss  3.12 | ppl    22.72
| epoch  35 |   800/ 1327 batches | lr 0.02 | ms/batch 46.85 | loss  3.06 | ppl    21.40
| epoch  35 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.80 | loss  3.14 | ppl    23.13
| epoch  35 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.68 | loss  2.97 | ppl    19.54
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 63.96s | valid loss  4.69 | valid ppl   108.96
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.02 | ms/batch 46.99 | loss  3.14 | ppl    23.02
| epoch  36 |   400/ 1327 batches | lr 0.02 | ms/batch 46.79 | loss  3.12 | ppl    22.70
| epoch  36 |   600/ 1327 batches | lr 0.02 | ms/batch 47.01 | loss  3.12 | ppl    22.60
| epoch  36 |   800/ 1327 batches | lr 0.02 | ms/batch 46.94 | loss  3.06 | ppl    21.31
| epoch  36 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.76 | loss  3.14 | ppl    23.07
| epoch  36 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.47 | loss  2.97 | ppl    19.47
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 63.96s | valid loss  4.69 | valid ppl   108.92
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.02 | ms/batch 46.91 | loss  3.14 | ppl    23.05
| epoch  37 |   400/ 1327 batches | lr 0.02 | ms/batch 46.30 | loss  3.12 | ppl    22.67
| epoch  37 |   600/ 1327 batches | lr 0.02 | ms/batch 46.33 | loss  3.11 | ppl    22.51
| epoch  37 |   800/ 1327 batches | lr 0.02 | ms/batch 46.23 | loss  3.06 | ppl    21.40
| epoch  37 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.58 | loss  3.14 | ppl    23.03
| epoch  37 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.47 | loss  2.97 | ppl    19.58
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 63.51s | valid loss  4.69 | valid ppl   108.89
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.02 | ms/batch 46.93 | loss  3.14 | ppl    23.06
| epoch  38 |   400/ 1327 batches | lr 0.02 | ms/batch 46.68 | loss  3.13 | ppl    22.84
| epoch  38 |   600/ 1327 batches | lr 0.02 | ms/batch 46.73 | loss  3.12 | ppl    22.57
| epoch  38 |   800/ 1327 batches | lr 0.02 | ms/batch 46.58 | loss  3.07 | ppl    21.46
| epoch  38 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.69 | loss  3.14 | ppl    23.02
| epoch  38 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.45 | loss  2.97 | ppl    19.55
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 63.81s | valid loss  4.69 | valid ppl   108.86
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.02 | ms/batch 47.10 | loss  3.14 | ppl    23.01
| epoch  39 |   400/ 1327 batches | lr 0.02 | ms/batch 46.82 | loss  3.12 | ppl    22.65
| epoch  39 |   600/ 1327 batches | lr 0.02 | ms/batch 46.82 | loss  3.11 | ppl    22.52
| epoch  39 |   800/ 1327 batches | lr 0.02 | ms/batch 46.51 | loss  3.06 | ppl    21.28
| epoch  39 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.71 | loss  3.14 | ppl    23.08
| epoch  39 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.67 | loss  2.98 | ppl    19.61
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 63.92s | valid loss  4.69 | valid ppl   108.84
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.02 | ms/batch 46.80 | loss  3.13 | ppl    22.97
| epoch  40 |   400/ 1327 batches | lr 0.02 | ms/batch 46.59 | loss  3.12 | ppl    22.70
| epoch  40 |   600/ 1327 batches | lr 0.02 | ms/batch 46.60 | loss  3.12 | ppl    22.56
| epoch  40 |   800/ 1327 batches | lr 0.02 | ms/batch 46.51 | loss  3.06 | ppl    21.35
| epoch  40 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.81 | loss  3.14 | ppl    23.12
| epoch  40 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.90 | loss  2.97 | ppl    19.51
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 63.87s | valid loss  4.69 | valid ppl   108.83
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.8393333333333334
sparsity at layer rnn.weight_hh_l0 is 0.8393333333333334
sparsity at layer rnn.weight_ih_l1 is 0.8393333333333334
sparsity at layer rnn.weight_hh_l1 is 0.8393333333333334
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.8443997317236753
=========================================================================================
| End of training | test loss  4.63 | test ppl   102.25
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 40 --dropout 0.50 --save sp86_epoch40_dropout0.50_lstm.pt --pretrained sp84_epoch40_dropout0.50_lstm.pt
debug
{'rnn.weight_ih_l0': 0.86, 'rnn.weight_hh_l0': 0.86, 'rnn.weight_ih_l1': 0.86, 'rnn.weight_hh_l1': 0.86}
{'rnn.weight_ih_l0': 0.86, 'rnn.weight_hh_l0': 0.86, 'rnn.weight_ih_l1': 0.86, 'rnn.weight_hh_l1': 0.86}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 50.98 | loss 20.66 | ppl 935343953.95
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 46.49 | loss  8.64 | ppl  5665.80
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 46.45 | loss  4.82 | ppl   123.42
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 47.51 | loss  3.59 | ppl    36.18
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 49.06 | loss  3.28 | ppl    26.46
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 49.50 | loss  2.98 | ppl    19.77
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 66.60s | valid loss  4.82 | valid ppl   123.53
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 54.59 | loss  6.03 | ppl   417.51
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 50.32 | loss  3.47 | ppl    32.15
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 50.21 | loss  2.97 | ppl    19.54
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 51.25 | loss  2.84 | ppl    17.08
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.17 | loss  2.88 | ppl    17.82
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 50.95 | loss  2.70 | ppl    14.81
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 70.32s | valid loss  4.89 | valid ppl   133.15
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 55.31 | loss  2.97 | ppl    19.40
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 50.69 | loss  2.84 | ppl    17.14
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 51.53 | loss  2.82 | ppl    16.77
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 51.46 | loss  2.78 | ppl    16.07
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.03 | loss  2.84 | ppl    17.10
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.31 | loss  2.66 | ppl    14.29
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 71.18s | valid loss  4.92 | valid ppl   136.32
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 55.94 | loss  2.89 | ppl    18.03
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 51.68 | loss  2.81 | ppl    16.65
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 51.16 | loss  2.80 | ppl    16.42
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 51.72 | loss  2.76 | ppl    15.77
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.89 | loss  2.82 | ppl    16.83
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.83 | loss  2.65 | ppl    14.09
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 71.70s | valid loss  4.91 | valid ppl   136.31
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 56.10 | loss  2.97 | ppl    19.50
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 51.80 | loss  2.90 | ppl    18.24
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 51.88 | loss  2.90 | ppl    18.14
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 52.70 | loss  2.85 | ppl    17.36
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.48 | loss  2.91 | ppl    18.45
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.58 | loss  2.75 | ppl    15.65
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 72.41s | valid loss  4.87 | valid ppl   130.06
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 56.51 | loss  2.94 | ppl    18.91
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 52.24 | loss  2.90 | ppl    18.11
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 53.11 | loss  2.88 | ppl    17.85
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 53.19 | loss  2.84 | ppl    17.14
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.59 | loss  2.90 | ppl    18.20
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 53.40 | loss  2.74 | ppl    15.44
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 73.24s | valid loss  4.87 | valid ppl   130.39
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 56.51 | loss  2.97 | ppl    19.54
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 52.90 | loss  2.91 | ppl    18.41
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 53.01 | loss  2.89 | ppl    17.96
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 53.09 | loss  2.84 | ppl    17.12
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.02 | loss  2.90 | ppl    18.20
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.02 | loss  2.74 | ppl    15.43
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 73.33s | valid loss  4.84 | valid ppl   126.83
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 57.63 | loss  2.93 | ppl    18.73
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 54.06 | loss  2.89 | ppl    18.04
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 53.83 | loss  2.88 | ppl    17.86
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 53.87 | loss  2.83 | ppl    17.00
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.99 | loss  2.90 | ppl    18.19
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.93 | loss  2.73 | ppl    15.30
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 74.57s | valid loss  4.85 | valid ppl   127.39
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 57.87 | loss  2.91 | ppl    18.32
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 54.53 | loss  2.88 | ppl    17.85
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 54.40 | loss  2.87 | ppl    17.72
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 54.32 | loss  2.83 | ppl    16.89
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.36 | loss  2.89 | ppl    18.03
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.52 | loss  2.72 | ppl    15.16
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 75.19s | valid loss  4.85 | valid ppl   127.21
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 2.50 | ms/batch 58.68 | loss  2.93 | ppl    18.65
| epoch  10 |   400/ 1327 batches | lr 2.50 | ms/batch 54.95 | loss  2.90 | ppl    18.20
| epoch  10 |   600/ 1327 batches | lr 2.50 | ms/batch 55.04 | loss  2.89 | ppl    17.93
| epoch  10 |   800/ 1327 batches | lr 2.50 | ms/batch 55.06 | loss  2.84 | ppl    17.18
| epoch  10 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.92 | loss  2.90 | ppl    18.23
| epoch  10 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.43 | loss  2.74 | ppl    15.49
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 76.00s | valid loss  4.84 | valid ppl   126.44
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 2.50 | ms/batch 58.85 | loss  2.61 | ppl    13.58
| epoch  11 |   400/ 1327 batches | lr 2.50 | ms/batch 54.97 | loss  2.61 | ppl    13.63
| epoch  11 |   600/ 1327 batches | lr 2.50 | ms/batch 55.88 | loss  2.61 | ppl    13.55
| epoch  11 |   800/ 1327 batches | lr 2.50 | ms/batch 55.35 | loss  2.57 | ppl    13.07
| epoch  11 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.11 | loss  2.63 | ppl    13.84
| epoch  11 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.15 | loss  2.47 | ppl    11.87
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 76.44s | valid loss  4.92 | valid ppl   136.81
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 2.50 | ms/batch 60.26 | loss  2.70 | ppl    14.84
| epoch  12 |   400/ 1327 batches | lr 2.50 | ms/batch 55.70 | loss  2.68 | ppl    14.54
| epoch  12 |   600/ 1327 batches | lr 2.50 | ms/batch 55.66 | loss  2.66 | ppl    14.35
| epoch  12 |   800/ 1327 batches | lr 2.50 | ms/batch 55.71 | loss  2.62 | ppl    13.76
| epoch  12 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.73 | loss  2.69 | ppl    14.71
| epoch  12 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.84 | loss  2.54 | ppl    12.66
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 77.33s | valid loss  4.90 | valid ppl   134.62
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 2.50 | ms/batch 60.09 | loss  2.70 | ppl    14.91
| epoch  13 |   400/ 1327 batches | lr 2.50 | ms/batch 56.46 | loss  2.68 | ppl    14.62
| epoch  13 |   600/ 1327 batches | lr 2.50 | ms/batch 56.36 | loss  2.68 | ppl    14.55
| epoch  13 |   800/ 1327 batches | lr 2.50 | ms/batch 56.30 | loss  2.63 | ppl    13.90
| epoch  13 |  1000/ 1327 batches | lr 2.50 | ms/batch 56.31 | loss  2.69 | ppl    14.72
| epoch  13 |  1200/ 1327 batches | lr 2.50 | ms/batch 56.50 | loss  2.54 | ppl    12.66
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 78.05s | valid loss  4.90 | valid ppl   134.83
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 60.75 | loss  2.92 | ppl    18.62
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 56.20 | loss  2.88 | ppl    17.87
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 57.32 | loss  2.87 | ppl    17.57
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 56.67 | loss  2.82 | ppl    16.84
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.70 | loss  2.87 | ppl    17.66
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.02 | loss  2.72 | ppl    15.13
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 78.62s | valid loss  4.84 | valid ppl   126.87
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 61.41 | loss  2.89 | ppl    17.99
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 57.10 | loss  2.87 | ppl    17.71
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 57.53 | loss  2.86 | ppl    17.45
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 57.62 | loss  2.80 | ppl    16.49
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.51 | loss  2.87 | ppl    17.68
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.52 | loss  2.71 | ppl    15.01
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 79.35s | valid loss  4.84 | valid ppl   126.20
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 62.24 | loss  2.90 | ppl    18.14
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 57.94 | loss  2.88 | ppl    17.76
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 57.97 | loss  2.86 | ppl    17.53
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 58.00 | loss  2.82 | ppl    16.79
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.66 | loss  2.88 | ppl    17.86
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.51 | loss  2.72 | ppl    15.18
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 80.34s | valid loss  4.83 | valid ppl   125.34
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 62.40 | loss  2.89 | ppl    18.05
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 58.48 | loss  2.87 | ppl    17.66
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 58.84 | loss  2.86 | ppl    17.45
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 58.73 | loss  2.81 | ppl    16.64
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.73 | loss  2.88 | ppl    17.80
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.74 | loss  2.71 | ppl    14.96
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 81.15s | valid loss  4.83 | valid ppl   125.03
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 1.25 | ms/batch 62.69 | loss  3.04 | ppl    20.96
| epoch  18 |   400/ 1327 batches | lr 1.25 | ms/batch 58.74 | loss  3.02 | ppl    20.47
| epoch  18 |   600/ 1327 batches | lr 1.25 | ms/batch 58.81 | loss  3.01 | ppl    20.29
| epoch  18 |   800/ 1327 batches | lr 1.25 | ms/batch 58.98 | loss  2.96 | ppl    19.20
| epoch  18 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.88 | loss  3.02 | ppl    20.50
| epoch  18 |  1200/ 1327 batches | lr 1.25 | ms/batch 59.89 | loss  2.86 | ppl    17.45
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 81.44s | valid loss  4.80 | valid ppl   121.06
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 1.25 | ms/batch 63.19 | loss  3.02 | ppl    20.57
| epoch  19 |   400/ 1327 batches | lr 1.25 | ms/batch 59.40 | loss  3.01 | ppl    20.24
| epoch  19 |   600/ 1327 batches | lr 1.25 | ms/batch 60.09 | loss  3.00 | ppl    20.06
| epoch  19 |   800/ 1327 batches | lr 1.25 | ms/batch 59.76 | loss  2.95 | ppl    19.07
| epoch  19 |  1000/ 1327 batches | lr 1.25 | ms/batch 59.48 | loss  3.02 | ppl    20.45
| epoch  19 |  1200/ 1327 batches | lr 1.25 | ms/batch 59.46 | loss  2.86 | ppl    17.39
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 82.19s | valid loss  4.79 | valid ppl   120.45
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 1.25 | ms/batch 64.21 | loss  3.06 | ppl    21.30
| epoch  20 |   400/ 1327 batches | lr 1.25 | ms/batch 59.64 | loss  3.04 | ppl    21.00
| epoch  20 |   600/ 1327 batches | lr 1.25 | ms/batch 60.37 | loss  3.03 | ppl    20.72
| epoch  20 |   800/ 1327 batches | lr 1.25 | ms/batch 59.82 | loss  2.98 | ppl    19.65
| epoch  20 |  1000/ 1327 batches | lr 1.25 | ms/batch 59.81 | loss  3.04 | ppl    20.99
| epoch  20 |  1200/ 1327 batches | lr 1.25 | ms/batch 60.22 | loss  2.89 | ppl    17.90
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 82.99s | valid loss  4.78 | valid ppl   119.13
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 1.25 | ms/batch 64.21 | loss  2.55 | ppl    12.77
| epoch  21 |   400/ 1327 batches | lr 1.25 | ms/batch 59.61 | loss  2.56 | ppl    12.95
| epoch  21 |   600/ 1327 batches | lr 1.25 | ms/batch 60.66 | loss  2.55 | ppl    12.84
| epoch  21 |   800/ 1327 batches | lr 1.25 | ms/batch 60.43 | loss  2.51 | ppl    12.33
| epoch  21 |  1000/ 1327 batches | lr 1.25 | ms/batch 60.32 | loss  2.58 | ppl    13.15
| epoch  21 |  1200/ 1327 batches | lr 1.25 | ms/batch 60.63 | loss  2.43 | ppl    11.31
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 83.25s | valid loss  4.90 | valid ppl   134.45
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 1.25 | ms/batch 64.97 | loss  2.59 | ppl    13.39
| epoch  22 |   400/ 1327 batches | lr 1.25 | ms/batch 60.99 | loss  2.57 | ppl    13.06
| epoch  22 |   600/ 1327 batches | lr 1.25 | ms/batch 61.26 | loss  2.57 | ppl    13.00
| epoch  22 |   800/ 1327 batches | lr 1.25 | ms/batch 60.71 | loss  2.53 | ppl    12.50
| epoch  22 |  1000/ 1327 batches | lr 1.25 | ms/batch 61.56 | loss  2.58 | ppl    13.23
| epoch  22 |  1200/ 1327 batches | lr 1.25 | ms/batch 61.05 | loss  2.43 | ppl    11.38
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 84.41s | valid loss  4.92 | valid ppl   136.87
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 1.25 | ms/batch 65.85 | loss  2.60 | ppl    13.44
| epoch  23 |   400/ 1327 batches | lr 1.25 | ms/batch 61.55 | loss  2.58 | ppl    13.18
| epoch  23 |   600/ 1327 batches | lr 1.25 | ms/batch 61.74 | loss  2.58 | ppl    13.13
| epoch  23 |   800/ 1327 batches | lr 1.25 | ms/batch 61.67 | loss  2.53 | ppl    12.53
| epoch  23 |  1000/ 1327 batches | lr 1.25 | ms/batch 61.72 | loss  2.59 | ppl    13.33
| epoch  23 |  1200/ 1327 batches | lr 1.25 | ms/batch 61.78 | loss  2.44 | ppl    11.47
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 85.03s | valid loss  4.93 | valid ppl   137.81
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.62 | ms/batch 66.16 | loss  2.91 | ppl    18.43
| epoch  24 |   400/ 1327 batches | lr 0.62 | ms/batch 62.24 | loss  2.88 | ppl    17.86
| epoch  24 |   600/ 1327 batches | lr 0.62 | ms/batch 62.00 | loss  2.87 | ppl    17.70
| epoch  24 |   800/ 1327 batches | lr 0.62 | ms/batch 62.69 | loss  2.81 | ppl    16.62
| epoch  24 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.34 | loss  2.88 | ppl    17.81
| epoch  24 |  1200/ 1327 batches | lr 0.62 | ms/batch 62.35 | loss  2.70 | ppl    14.95
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 85.93s | valid loss  4.85 | valid ppl   127.13
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.62 | ms/batch 66.27 | loss  2.88 | ppl    17.76
| epoch  25 |   400/ 1327 batches | lr 0.62 | ms/batch 62.49 | loss  2.85 | ppl    17.34
| epoch  25 |   600/ 1327 batches | lr 0.62 | ms/batch 62.42 | loss  2.85 | ppl    17.20
| epoch  25 |   800/ 1327 batches | lr 0.62 | ms/batch 62.98 | loss  2.80 | ppl    16.44
| epoch  25 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.52 | loss  2.87 | ppl    17.58
| epoch  25 |  1200/ 1327 batches | lr 0.62 | ms/batch 62.67 | loss  2.70 | ppl    14.89
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 86.29s | valid loss  4.84 | valid ppl   126.10
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.62 | ms/batch 66.71 | loss  2.87 | ppl    17.60
| epoch  26 |   400/ 1327 batches | lr 0.62 | ms/batch 62.97 | loss  2.85 | ppl    17.32
| epoch  26 |   600/ 1327 batches | lr 0.62 | ms/batch 63.03 | loss  2.84 | ppl    17.11
| epoch  26 |   800/ 1327 batches | lr 0.62 | ms/batch 63.73 | loss  2.79 | ppl    16.29
| epoch  26 |  1000/ 1327 batches | lr 0.62 | ms/batch 63.38 | loss  2.86 | ppl    17.51
| epoch  26 |  1200/ 1327 batches | lr 0.62 | ms/batch 63.30 | loss  2.69 | ppl    14.75
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 87.03s | valid loss  4.83 | valid ppl   125.48
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.62 | ms/batch 67.71 | loss  3.00 | ppl    20.09
| epoch  27 |   400/ 1327 batches | lr 0.62 | ms/batch 63.68 | loss  2.98 | ppl    19.68
| epoch  27 |   600/ 1327 batches | lr 0.62 | ms/batch 63.76 | loss  2.97 | ppl    19.51
| epoch  27 |   800/ 1327 batches | lr 0.62 | ms/batch 63.78 | loss  2.92 | ppl    18.54
| epoch  27 |  1000/ 1327 batches | lr 0.62 | ms/batch 64.44 | loss  2.99 | ppl    19.80
| epoch  27 |  1200/ 1327 batches | lr 0.62 | ms/batch 63.90 | loss  2.82 | ppl    16.81
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 87.94s | valid loss  4.81 | valid ppl   122.26
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.62 | ms/batch 68.15 | loss  2.99 | ppl    19.88
| epoch  28 |   400/ 1327 batches | lr 0.62 | ms/batch 63.98 | loss  2.98 | ppl    19.61
| epoch  28 |   600/ 1327 batches | lr 0.62 | ms/batch 64.04 | loss  2.96 | ppl    19.27
| epoch  28 |   800/ 1327 batches | lr 0.62 | ms/batch 64.41 | loss  2.92 | ppl    18.52
| epoch  28 |  1000/ 1327 batches | lr 0.62 | ms/batch 64.23 | loss  2.99 | ppl    19.87
| epoch  28 |  1200/ 1327 batches | lr 0.62 | ms/batch 64.28 | loss  2.82 | ppl    16.72
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 88.30s | valid loss  4.80 | valid ppl   121.40
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.62 | ms/batch 68.45 | loss  3.01 | ppl    20.32
| epoch  29 |   400/ 1327 batches | lr 0.62 | ms/batch 64.35 | loss  3.00 | ppl    20.02
| epoch  29 |   600/ 1327 batches | lr 0.62 | ms/batch 65.05 | loss  2.99 | ppl    19.90
| epoch  29 |   800/ 1327 batches | lr 0.62 | ms/batch 64.62 | loss  2.93 | ppl    18.81
| epoch  29 |  1000/ 1327 batches | lr 0.62 | ms/batch 65.82 | loss  3.01 | ppl    20.36
| epoch  29 |  1200/ 1327 batches | lr 0.62 | ms/batch 64.76 | loss  2.84 | ppl    17.15
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 89.13s | valid loss  4.79 | valid ppl   120.33
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.62 | ms/batch 69.35 | loss  3.01 | ppl    20.20
| epoch  30 |   400/ 1327 batches | lr 0.62 | ms/batch 65.11 | loss  3.00 | ppl    20.03
| epoch  30 |   600/ 1327 batches | lr 0.62 | ms/batch 65.79 | loss  2.98 | ppl    19.75
| epoch  30 |   800/ 1327 batches | lr 0.62 | ms/batch 65.58 | loss  2.94 | ppl    18.95
| epoch  30 |  1000/ 1327 batches | lr 0.62 | ms/batch 65.45 | loss  3.01 | ppl    20.24
| epoch  30 |  1200/ 1327 batches | lr 0.62 | ms/batch 65.71 | loss  2.84 | ppl    17.07
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 89.95s | valid loss  4.79 | valid ppl   120.04
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.62 | ms/batch 69.62 | loss  3.01 | ppl    20.24
| epoch  31 |   400/ 1327 batches | lr 0.62 | ms/batch 65.69 | loss  3.00 | ppl    20.01
| epoch  31 |   600/ 1327 batches | lr 0.62 | ms/batch 65.86 | loss  2.98 | ppl    19.72
| epoch  31 |   800/ 1327 batches | lr 0.62 | ms/batch 66.31 | loss  2.93 | ppl    18.79
| epoch  31 |  1000/ 1327 batches | lr 0.62 | ms/batch 65.98 | loss  3.00 | ppl    20.13
| epoch  31 |  1200/ 1327 batches | lr 0.62 | ms/batch 66.56 | loss  2.84 | ppl    17.14
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 90.70s | valid loss  4.79 | valid ppl   119.96
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.62 | ms/batch 69.84 | loss  3.09 | ppl    21.87
| epoch  32 |   400/ 1327 batches | lr 0.62 | ms/batch 66.37 | loss  3.07 | ppl    21.63
| epoch  32 |   600/ 1327 batches | lr 0.62 | ms/batch 66.20 | loss  3.07 | ppl    21.52
| epoch  32 |   800/ 1327 batches | lr 0.62 | ms/batch 66.38 | loss  3.01 | ppl    20.19
| epoch  32 |  1000/ 1327 batches | lr 0.62 | ms/batch 66.44 | loss  3.09 | ppl    21.88
| epoch  32 |  1200/ 1327 batches | lr 0.62 | ms/batch 66.46 | loss  2.92 | ppl    18.55
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 91.15s | valid loss  4.77 | valid ppl   117.72
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.62 | ms/batch 70.66 | loss  3.08 | ppl    21.68
| epoch  33 |   400/ 1327 batches | lr 0.62 | ms/batch 67.06 | loss  3.07 | ppl    21.55
| epoch  33 |   600/ 1327 batches | lr 0.62 | ms/batch 67.38 | loss  3.06 | ppl    21.31
| epoch  33 |   800/ 1327 batches | lr 0.62 | ms/batch 66.80 | loss  3.01 | ppl    20.27
| epoch  33 |  1000/ 1327 batches | lr 0.62 | ms/batch 67.36 | loss  3.08 | ppl    21.81
| epoch  33 |  1200/ 1327 batches | lr 0.62 | ms/batch 66.80 | loss  2.91 | ppl    18.40
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 91.97s | valid loss  4.76 | valid ppl   117.18
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.62 | ms/batch 71.44 | loss  3.09 | ppl    21.90
| epoch  34 |   400/ 1327 batches | lr 0.62 | ms/batch 67.43 | loss  3.07 | ppl    21.64
| epoch  34 |   600/ 1327 batches | lr 0.62 | ms/batch 67.73 | loss  3.06 | ppl    21.30
| epoch  34 |   800/ 1327 batches | lr 0.62 | ms/batch 67.74 | loss  3.01 | ppl    20.29
| epoch  34 |  1000/ 1327 batches | lr 0.62 | ms/batch 67.61 | loss  3.08 | ppl    21.77
| epoch  34 |  1200/ 1327 batches | lr 0.62 | ms/batch 68.06 | loss  2.91 | ppl    18.29
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 92.86s | valid loss  4.76 | valid ppl   116.94
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.62 | ms/batch 71.54 | loss  3.09 | ppl    21.96
| epoch  35 |   400/ 1327 batches | lr 0.62 | ms/batch 67.90 | loss  3.08 | ppl    21.69
| epoch  35 |   600/ 1327 batches | lr 0.62 | ms/batch 67.65 | loss  3.06 | ppl    21.42
| epoch  35 |   800/ 1327 batches | lr 0.62 | ms/batch 68.26 | loss  3.02 | ppl    20.40
| epoch  35 |  1000/ 1327 batches | lr 0.62 | ms/batch 68.41 | loss  3.09 | ppl    21.95
| epoch  35 |  1200/ 1327 batches | lr 0.62 | ms/batch 67.68 | loss  2.92 | ppl    18.55
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 93.14s | valid loss  4.76 | valid ppl   116.61
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.62 | ms/batch 72.31 | loss  3.09 | ppl    22.08
| epoch  36 |   400/ 1327 batches | lr 0.62 | ms/batch 68.39 | loss  3.08 | ppl    21.70
| epoch  36 |   600/ 1327 batches | lr 0.62 | ms/batch 69.35 | loss  3.07 | ppl    21.47
| epoch  36 |   800/ 1327 batches | lr 0.62 | ms/batch 68.46 | loss  3.02 | ppl    20.43
| epoch  36 |  1000/ 1327 batches | lr 0.62 | ms/batch 68.54 | loss  3.09 | ppl    21.90
| epoch  36 |  1200/ 1327 batches | lr 0.62 | ms/batch 69.21 | loss  2.92 | ppl    18.63
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 94.17s | valid loss  4.76 | valid ppl   116.22
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.62 | ms/batch 73.49 | loss  3.09 | ppl    22.00
| epoch  37 |   400/ 1327 batches | lr 0.62 | ms/batch 68.95 | loss  3.08 | ppl    21.70
| epoch  37 |   600/ 1327 batches | lr 0.62 | ms/batch 69.13 | loss  3.07 | ppl    21.64
| epoch  37 |   800/ 1327 batches | lr 0.62 | ms/batch 69.50 | loss  3.02 | ppl    20.46
| epoch  37 |  1000/ 1327 batches | lr 0.62 | ms/batch 69.24 | loss  3.09 | ppl    21.96
| epoch  37 |  1200/ 1327 batches | lr 0.62 | ms/batch 69.71 | loss  2.93 | ppl    18.72
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 95.19s | valid loss  4.75 | valid ppl   115.95
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.62 | ms/batch 73.57 | loss  3.09 | ppl    22.04
| epoch  38 |   400/ 1327 batches | lr 0.62 | ms/batch 69.17 | loss  3.08 | ppl    21.85
| epoch  38 |   600/ 1327 batches | lr 0.62 | ms/batch 69.91 | loss  3.07 | ppl    21.58
| epoch  38 |   800/ 1327 batches | lr 0.62 | ms/batch 69.54 | loss  3.02 | ppl    20.48
| epoch  38 |  1000/ 1327 batches | lr 0.62 | ms/batch 70.48 | loss  3.09 | ppl    22.02
| epoch  38 |  1200/ 1327 batches | lr 0.62 | ms/batch 69.61 | loss  2.93 | ppl    18.70
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 95.61s | valid loss  4.75 | valid ppl   115.72
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.62 | ms/batch 73.93 | loss  3.10 | ppl    22.23
| epoch  39 |   400/ 1327 batches | lr 0.62 | ms/batch 69.87 | loss  3.09 | ppl    22.08
| epoch  39 |   600/ 1327 batches | lr 0.62 | ms/batch 70.66 | loss  3.08 | ppl    21.74
| epoch  39 |   800/ 1327 batches | lr 0.62 | ms/batch 70.23 | loss  3.03 | ppl    20.69
| epoch  39 |  1000/ 1327 batches | lr 0.62 | ms/batch 70.45 | loss  3.09 | ppl    22.06
| epoch  39 |  1200/ 1327 batches | lr 0.62 | ms/batch 69.98 | loss  2.93 | ppl    18.80
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 96.18s | valid loss  4.75 | valid ppl   115.47
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.62 | ms/batch 74.42 | loss  3.11 | ppl    22.52
| epoch  40 |   400/ 1327 batches | lr 0.62 | ms/batch 70.53 | loss  3.09 | ppl    22.07
| epoch  40 |   600/ 1327 batches | lr 0.62 | ms/batch 71.13 | loss  3.10 | ppl    22.14
| epoch  40 |   800/ 1327 batches | lr 0.62 | ms/batch 71.23 | loss  3.03 | ppl    20.80
| epoch  40 |  1000/ 1327 batches | lr 0.62 | ms/batch 70.80 | loss  3.11 | ppl    22.44
| epoch  40 |  1200/ 1327 batches | lr 0.62 | ms/batch 71.05 | loss  2.95 | ppl    19.02
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 97.12s | valid loss  4.75 | valid ppl   115.22
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.8593333333333333
sparsity at layer rnn.weight_hh_l0 is 0.8593333333333333
sparsity at layer rnn.weight_ih_l1 is 0.8593333333333333
sparsity at layer rnn.weight_hh_l1 is 0.8593333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.8822724161533197
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 45.26 | loss  2.19 | ppl     8.98
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 46.00 | loss  2.23 | ppl     9.26
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 46.07 | loss  2.24 | ppl     9.44
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 46.55 | loss  2.22 | ppl     9.22
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.43 | loss  2.31 | ppl    10.08
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.41 | loss  2.18 | ppl     8.82
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 63.12s | valid loss  5.22 | valid ppl   185.85
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 46.32 | loss  2.26 | ppl     9.59
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 46.12 | loss  2.26 | ppl     9.61
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 46.20 | loss  2.26 | ppl     9.57
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 46.13 | loss  2.24 | ppl     9.39
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.27 | loss  2.33 | ppl    10.24
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.40 | loss  2.18 | ppl     8.85
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.26s | valid loss  5.22 | valid ppl   185.24
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 46.88 | loss  2.27 | ppl     9.72
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 46.45 | loss  2.27 | ppl     9.65
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 46.68 | loss  2.27 | ppl     9.65
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 46.53 | loss  2.25 | ppl     9.46
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.46 | loss  2.32 | ppl    10.22
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.56 | loss  2.18 | ppl     8.86
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 63.67s | valid loss  5.24 | valid ppl   188.28
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 47.35 | loss  2.65 | ppl    14.20
| epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 46.73 | loss  2.64 | ppl    13.96
| epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 46.67 | loss  2.63 | ppl    13.90
| epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 46.27 | loss  2.60 | ppl    13.46
| epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.97 | loss  2.68 | ppl    14.61
| epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.46 | loss  2.54 | ppl    12.71
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 63.91s | valid loss  5.04 | valid ppl   153.76
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 46.75 | loss  2.90 | ppl    18.19
| epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 46.53 | loss  2.88 | ppl    17.88
| epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 46.32 | loss  2.88 | ppl    17.77
| epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 46.63 | loss  2.85 | ppl    17.26
| epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.53 | loss  2.93 | ppl    18.67
| epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.44 | loss  2.79 | ppl    16.20
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 63.63s | valid loss  4.92 | valid ppl   136.40
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 46.86 | loss  2.89 | ppl    17.91
| epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 46.35 | loss  2.88 | ppl    17.85
| epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 46.39 | loss  2.88 | ppl    17.74
| epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 46.48 | loss  2.84 | ppl    17.18
| epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.40 | loss  2.93 | ppl    18.65
| epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.43 | loss  2.78 | ppl    16.18
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 63.54s | valid loss  4.92 | valid ppl   137.07
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 47.34 | loss  3.14 | ppl    23.16
| epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 46.61 | loss  3.09 | ppl    21.97
| epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 46.83 | loss  3.06 | ppl    21.32
| epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 46.46 | loss  3.00 | ppl    20.00
| epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.65 | loss  3.05 | ppl    21.20
| epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.93 | loss  2.90 | ppl    18.26
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 63.98s | valid loss  4.83 | valid ppl   125.55
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch 46.80 | loss  3.06 | ppl    21.31
| epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch 46.54 | loss  3.03 | ppl    20.78
| epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch 46.69 | loss  3.01 | ppl    20.38
| epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch 46.72 | loss  2.96 | ppl    19.27
| epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.28 | loss  3.03 | ppl    20.78
| epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.97 | loss  2.88 | ppl    17.73
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 63.81s | valid loss  4.83 | valid ppl   125.30
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 5.00 | ms/batch 46.39 | loss  3.08 | ppl    21.70
| epoch   9 |   400/ 1327 batches | lr 5.00 | ms/batch 46.29 | loss  3.06 | ppl    21.28
| epoch   9 |   600/ 1327 batches | lr 5.00 | ms/batch 46.16 | loss  3.05 | ppl    21.05
| epoch   9 |   800/ 1327 batches | lr 5.00 | ms/batch 46.23 | loss  3.00 | ppl    20.10
| epoch   9 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.12 | loss  3.06 | ppl    21.32
| epoch   9 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.81 | loss  2.91 | ppl    18.42
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 63.39s | valid loss  4.82 | valid ppl   123.60
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 5.00 | ms/batch 46.79 | loss  3.06 | ppl    21.23
| epoch  10 |   400/ 1327 batches | lr 5.00 | ms/batch 46.83 | loss  3.05 | ppl    21.07
| epoch  10 |   600/ 1327 batches | lr 5.00 | ms/batch 46.52 | loss  3.03 | ppl    20.76
| epoch  10 |   800/ 1327 batches | lr 5.00 | ms/batch 46.45 | loss  2.98 | ppl    19.64
| epoch  10 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.56 | loss  3.05 | ppl    21.15
| epoch  10 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.69 | loss  2.89 | ppl    18.07
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 63.75s | valid loss  4.82 | valid ppl   124.19
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 5.00 | ms/batch 47.43 | loss  3.14 | ppl    22.99
| epoch  11 |   400/ 1327 batches | lr 5.00 | ms/batch 46.57 | loss  3.12 | ppl    22.72
| epoch  11 |   600/ 1327 batches | lr 5.00 | ms/batch 46.47 | loss  3.11 | ppl    22.33
| epoch  11 |   800/ 1327 batches | lr 5.00 | ms/batch 46.56 | loss  3.05 | ppl    21.16
| epoch  11 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.47 | loss  3.13 | ppl    22.94
| epoch  11 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.58 | loss  2.98 | ppl    19.71
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 63.79s | valid loss  4.78 | valid ppl   119.67
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 5.00 | ms/batch 46.74 | loss  3.12 | ppl    22.69
| epoch  12 |   400/ 1327 batches | lr 5.00 | ms/batch 46.96 | loss  3.10 | ppl    22.18
| epoch  12 |   600/ 1327 batches | lr 5.00 | ms/batch 46.82 | loss  3.10 | ppl    22.18
| epoch  12 |   800/ 1327 batches | lr 5.00 | ms/batch 46.16 | loss  3.05 | ppl    21.11
| epoch  12 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.46 | loss  3.12 | ppl    22.55
| epoch  12 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.71 | loss  2.97 | ppl    19.54
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 63.79s | valid loss  4.78 | valid ppl   119.19
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 5.00 | ms/batch 46.36 | loss  3.12 | ppl    22.75
| epoch  13 |   400/ 1327 batches | lr 5.00 | ms/batch 46.57 | loss  3.11 | ppl    22.37
| epoch  13 |   600/ 1327 batches | lr 5.00 | ms/batch 46.19 | loss  3.10 | ppl    22.13
| epoch  13 |   800/ 1327 batches | lr 5.00 | ms/batch 46.08 | loss  3.05 | ppl    21.15
| epoch  13 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.58 | loss  3.12 | ppl    22.76
| epoch  13 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.93 | loss  2.97 | ppl    19.55
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 63.52s | valid loss  4.77 | valid ppl   117.95
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 5.00 | ms/batch 46.92 | loss  3.10 | ppl    22.30
| epoch  14 |   400/ 1327 batches | lr 5.00 | ms/batch 46.51 | loss  3.10 | ppl    22.17
| epoch  14 |   600/ 1327 batches | lr 5.00 | ms/batch 46.41 | loss  3.09 | ppl    21.97
| epoch  14 |   800/ 1327 batches | lr 5.00 | ms/batch 46.42 | loss  3.04 | ppl    20.82
| epoch  14 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.49 | loss  3.11 | ppl    22.48
| epoch  14 |  1200/ 1327 batches | lr 5.00 | ms/batch 47.01 | loss  2.97 | ppl    19.43
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 63.76s | valid loss  4.78 | valid ppl   118.82
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 47.09 | loss  3.14 | ppl    23.00
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 46.72 | loss  3.12 | ppl    22.65
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 46.70 | loss  3.10 | ppl    22.27
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 46.72 | loss  3.05 | ppl    21.04
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.45 | loss  3.12 | ppl    22.57
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.77 | loss  2.95 | ppl    19.17
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 63.88s | valid loss  4.75 | valid ppl   115.13
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 46.64 | loss  3.12 | ppl    22.61
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 46.12 | loss  3.10 | ppl    22.24
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 46.60 | loss  3.09 | ppl    21.97
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 45.95 | loss  3.04 | ppl    20.96
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.06 | loss  3.11 | ppl    22.40
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.67 | loss  2.95 | ppl    19.13
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.39s | valid loss  4.75 | valid ppl   115.21
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 47.08 | loss  3.13 | ppl    22.80
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 46.74 | loss  3.12 | ppl    22.54
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 46.84 | loss  3.11 | ppl    22.36
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 46.94 | loss  3.05 | ppl    21.07
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.68 | loss  3.12 | ppl    22.56
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.45 | loss  2.96 | ppl    19.34
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 63.99s | valid loss  4.74 | valid ppl   114.39
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 1.25 | ms/batch 46.62 | loss  3.12 | ppl    22.71
| epoch  18 |   400/ 1327 batches | lr 1.25 | ms/batch 46.18 | loss  3.11 | ppl    22.33
| epoch  18 |   600/ 1327 batches | lr 1.25 | ms/batch 46.73 | loss  3.10 | ppl    22.09
| epoch  18 |   800/ 1327 batches | lr 1.25 | ms/batch 46.66 | loss  3.05 | ppl    21.12
| epoch  18 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.59 | loss  3.10 | ppl    22.30
| epoch  18 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.63 | loss  2.96 | ppl    19.34
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 63.65s | valid loss  4.74 | valid ppl   114.48
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.31 | ms/batch 47.36 | loss  3.13 | ppl    22.98
| epoch  19 |   400/ 1327 batches | lr 0.31 | ms/batch 46.92 | loss  3.13 | ppl    22.87
| epoch  19 |   600/ 1327 batches | lr 0.31 | ms/batch 46.69 | loss  3.12 | ppl    22.74
| epoch  19 |   800/ 1327 batches | lr 0.31 | ms/batch 46.31 | loss  3.06 | ppl    21.35
| epoch  19 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.34 | loss  3.13 | ppl    22.88
| epoch  19 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.77 | loss  2.96 | ppl    19.26
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.90s | valid loss  4.72 | valid ppl   111.85
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.31 | ms/batch 46.39 | loss  3.14 | ppl    23.05
| epoch  20 |   400/ 1327 batches | lr 0.31 | ms/batch 46.63 | loss  3.12 | ppl    22.64
| epoch  20 |   600/ 1327 batches | lr 0.31 | ms/batch 46.36 | loss  3.11 | ppl    22.38
| epoch  20 |   800/ 1327 batches | lr 0.31 | ms/batch 46.31 | loss  3.05 | ppl    21.04
| epoch  20 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.57 | loss  3.13 | ppl    22.81
| epoch  20 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.36 | loss  2.96 | ppl    19.35
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 63.49s | valid loss  4.72 | valid ppl   111.69
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 0.31 | ms/batch 46.72 | loss  3.13 | ppl    22.87
| epoch  21 |   400/ 1327 batches | lr 0.31 | ms/batch 46.39 | loss  3.12 | ppl    22.57
| epoch  21 |   600/ 1327 batches | lr 0.31 | ms/batch 46.35 | loss  3.10 | ppl    22.21
| epoch  21 |   800/ 1327 batches | lr 0.31 | ms/batch 46.27 | loss  3.05 | ppl    21.05
| epoch  21 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.72 | loss  3.14 | ppl    23.00
| epoch  21 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.92 | loss  2.96 | ppl    19.35
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 63.71s | valid loss  4.71 | valid ppl   111.55
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 0.31 | ms/batch 46.51 | loss  3.13 | ppl    22.84
| epoch  22 |   400/ 1327 batches | lr 0.31 | ms/batch 46.96 | loss  3.11 | ppl    22.47
| epoch  22 |   600/ 1327 batches | lr 0.31 | ms/batch 46.71 | loss  3.10 | ppl    22.25
| epoch  22 |   800/ 1327 batches | lr 0.31 | ms/batch 46.31 | loss  3.05 | ppl    21.15
| epoch  22 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.32 | loss  3.12 | ppl    22.74
| epoch  22 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.93 | loss  2.96 | ppl    19.33
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 63.77s | valid loss  4.72 | valid ppl   111.68
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 0.31 | ms/batch 46.58 | loss  3.13 | ppl    22.85
| epoch  23 |   400/ 1327 batches | lr 0.31 | ms/batch 46.33 | loss  3.12 | ppl    22.62
| epoch  23 |   600/ 1327 batches | lr 0.31 | ms/batch 46.50 | loss  3.11 | ppl    22.46
| epoch  23 |   800/ 1327 batches | lr 0.31 | ms/batch 46.49 | loss  3.05 | ppl    21.05
| epoch  23 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.42 | loss  3.12 | ppl    22.71
| epoch  23 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.30 | loss  2.96 | ppl    19.39
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 63.48s | valid loss  4.71 | valid ppl   111.53
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.31 | ms/batch 46.69 | loss  3.13 | ppl    22.92
| epoch  24 |   400/ 1327 batches | lr 0.31 | ms/batch 46.60 | loss  3.11 | ppl    22.44
| epoch  24 |   600/ 1327 batches | lr 0.31 | ms/batch 46.77 | loss  3.10 | ppl    22.16
| epoch  24 |   800/ 1327 batches | lr 0.31 | ms/batch 46.77 | loss  3.05 | ppl    21.15
| epoch  24 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.72 | loss  3.12 | ppl    22.71
| epoch  24 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.65 | loss  2.96 | ppl    19.29
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 63.87s | valid loss  4.71 | valid ppl   111.43
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.31 | ms/batch 46.43 | loss  3.13 | ppl    22.87
| epoch  25 |   400/ 1327 batches | lr 0.31 | ms/batch 46.23 | loss  3.11 | ppl    22.34
| epoch  25 |   600/ 1327 batches | lr 0.31 | ms/batch 46.65 | loss  3.10 | ppl    22.25
| epoch  25 |   800/ 1327 batches | lr 0.31 | ms/batch 46.84 | loss  3.04 | ppl    20.99
| epoch  25 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.47 | loss  3.12 | ppl    22.75
| epoch  25 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.57 | loss  2.96 | ppl    19.24
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 63.60s | valid loss  4.71 | valid ppl   111.57
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.08 | ms/batch 47.25 | loss  3.14 | ppl    23.06
| epoch  26 |   400/ 1327 batches | lr 0.08 | ms/batch 46.57 | loss  3.13 | ppl    22.87
| epoch  26 |   600/ 1327 batches | lr 0.08 | ms/batch 46.82 | loss  3.12 | ppl    22.68
| epoch  26 |   800/ 1327 batches | lr 0.08 | ms/batch 46.22 | loss  3.06 | ppl    21.41
| epoch  26 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.75 | loss  3.14 | ppl    23.05
| epoch  26 |  1200/ 1327 batches | lr 0.08 | ms/batch 47.06 | loss  2.97 | ppl    19.41
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 63.93s | valid loss  4.71 | valid ppl   110.85
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.08 | ms/batch 46.62 | loss  3.13 | ppl    22.99
| epoch  27 |   400/ 1327 batches | lr 0.08 | ms/batch 46.51 | loss  3.12 | ppl    22.74
| epoch  27 |   600/ 1327 batches | lr 0.08 | ms/batch 46.31 | loss  3.12 | ppl    22.64
| epoch  27 |   800/ 1327 batches | lr 0.08 | ms/batch 46.85 | loss  3.06 | ppl    21.37
| epoch  27 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.27 | loss  3.13 | ppl    22.93
| epoch  27 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.38 | loss  2.98 | ppl    19.60
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 63.54s | valid loss  4.71 | valid ppl   110.52
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.08 | ms/batch 46.63 | loss  3.13 | ppl    22.95
| epoch  28 |   400/ 1327 batches | lr 0.08 | ms/batch 46.89 | loss  3.12 | ppl    22.72
| epoch  28 |   600/ 1327 batches | lr 0.08 | ms/batch 46.64 | loss  3.11 | ppl    22.49
| epoch  28 |   800/ 1327 batches | lr 0.08 | ms/batch 46.48 | loss  3.06 | ppl    21.30
| epoch  28 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.64 | loss  3.13 | ppl    22.95
| epoch  28 |  1200/ 1327 batches | lr 0.08 | ms/batch 47.06 | loss  2.97 | ppl    19.45
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 63.88s | valid loss  4.70 | valid ppl   110.38
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.08 | ms/batch 46.80 | loss  3.13 | ppl    22.89
| epoch  29 |   400/ 1327 batches | lr 0.08 | ms/batch 46.84 | loss  3.12 | ppl    22.54
| epoch  29 |   600/ 1327 batches | lr 0.08 | ms/batch 46.45 | loss  3.11 | ppl    22.32
| epoch  29 |   800/ 1327 batches | lr 0.08 | ms/batch 46.43 | loss  3.06 | ppl    21.25
| epoch  29 |  1000/ 1327 batches | lr 0.08 | ms/batch 47.08 | loss  3.13 | ppl    22.89
| epoch  29 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.67 | loss  2.98 | ppl    19.63
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 63.85s | valid loss  4.70 | valid ppl   110.31
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.08 | ms/batch 46.20 | loss  3.14 | ppl    23.01
| epoch  30 |   400/ 1327 batches | lr 0.08 | ms/batch 46.62 | loss  3.11 | ppl    22.50
| epoch  30 |   600/ 1327 batches | lr 0.08 | ms/batch 46.47 | loss  3.11 | ppl    22.52
| epoch  30 |   800/ 1327 batches | lr 0.08 | ms/batch 46.27 | loss  3.06 | ppl    21.30
| epoch  30 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.36 | loss  3.13 | ppl    22.83
| epoch  30 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.50 | loss  2.97 | ppl    19.50
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 63.46s | valid loss  4.70 | valid ppl   110.24
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.08 | ms/batch 46.81 | loss  3.13 | ppl    22.89
| epoch  31 |   400/ 1327 batches | lr 0.08 | ms/batch 46.65 | loss  3.12 | ppl    22.64
| epoch  31 |   600/ 1327 batches | lr 0.08 | ms/batch 46.37 | loss  3.11 | ppl    22.40
| epoch  31 |   800/ 1327 batches | lr 0.08 | ms/batch 47.08 | loss  3.05 | ppl    21.17
| epoch  31 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.71 | loss  3.13 | ppl    22.83
| epoch  31 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.71 | loss  2.97 | ppl    19.58
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 63.87s | valid loss  4.70 | valid ppl   110.22
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.08 | ms/batch 46.44 | loss  3.13 | ppl    22.79
| epoch  32 |   400/ 1327 batches | lr 0.08 | ms/batch 47.21 | loss  3.12 | ppl    22.55
| epoch  32 |   600/ 1327 batches | lr 0.08 | ms/batch 46.27 | loss  3.11 | ppl    22.48
| epoch  32 |   800/ 1327 batches | lr 0.08 | ms/batch 47.08 | loss  3.06 | ppl    21.30
| epoch  32 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.75 | loss  3.13 | ppl    22.87
| epoch  32 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.69 | loss  2.97 | ppl    19.49
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 63.88s | valid loss  4.70 | valid ppl   110.21
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.08 | ms/batch 46.88 | loss  3.13 | ppl    22.96
| epoch  33 |   400/ 1327 batches | lr 0.08 | ms/batch 46.75 | loss  3.12 | ppl    22.64
| epoch  33 |   600/ 1327 batches | lr 0.08 | ms/batch 46.55 | loss  3.11 | ppl    22.41
| epoch  33 |   800/ 1327 batches | lr 0.08 | ms/batch 46.57 | loss  3.06 | ppl    21.26
| epoch  33 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.77 | loss  3.14 | ppl    23.04
| epoch  33 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.69 | loss  2.97 | ppl    19.56
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 63.84s | valid loss  4.70 | valid ppl   110.16
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.08 | ms/batch 46.79 | loss  3.13 | ppl    22.88
| epoch  34 |   400/ 1327 batches | lr 0.08 | ms/batch 46.35 | loss  3.11 | ppl    22.41
| epoch  34 |   600/ 1327 batches | lr 0.08 | ms/batch 46.36 | loss  3.11 | ppl    22.45
| epoch  34 |   800/ 1327 batches | lr 0.08 | ms/batch 46.30 | loss  3.05 | ppl    21.11
| epoch  34 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.18 | loss  3.14 | ppl    23.04
| epoch  34 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.28 | loss  2.97 | ppl    19.52
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 63.50s | valid loss  4.70 | valid ppl   110.20
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.08 | ms/batch 47.55 | loss  3.13 | ppl    22.93
| epoch  35 |   400/ 1327 batches | lr 0.08 | ms/batch 46.47 | loss  3.12 | ppl    22.56
| epoch  35 |   600/ 1327 batches | lr 0.08 | ms/batch 46.49 | loss  3.12 | ppl    22.59
| epoch  35 |   800/ 1327 batches | lr 0.08 | ms/batch 46.64 | loss  3.06 | ppl    21.23
| epoch  35 |  1000/ 1327 batches | lr 0.08 | ms/batch 47.36 | loss  3.13 | ppl    22.98
| epoch  35 |  1200/ 1327 batches | lr 0.08 | ms/batch 47.07 | loss  2.97 | ppl    19.49
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 64.12s | valid loss  4.70 | valid ppl   110.17
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.08 | ms/batch 46.73 | loss  3.13 | ppl    22.99
| epoch  36 |   400/ 1327 batches | lr 0.08 | ms/batch 46.85 | loss  3.12 | ppl    22.55
| epoch  36 |   600/ 1327 batches | lr 0.08 | ms/batch 46.67 | loss  3.11 | ppl    22.42
| epoch  36 |   800/ 1327 batches | lr 0.08 | ms/batch 46.66 | loss  3.05 | ppl    21.13
| epoch  36 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.59 | loss  3.13 | ppl    22.98
| epoch  36 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.94 | loss  2.97 | ppl    19.45
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 63.87s | valid loss  4.70 | valid ppl   110.15
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.08 | ms/batch 46.38 | loss  3.13 | ppl    22.98
| epoch  37 |   400/ 1327 batches | lr 0.08 | ms/batch 46.38 | loss  3.11 | ppl    22.51
| epoch  37 |   600/ 1327 batches | lr 0.08 | ms/batch 46.63 | loss  3.11 | ppl    22.37
| epoch  37 |   800/ 1327 batches | lr 0.08 | ms/batch 46.39 | loss  3.06 | ppl    21.23
| epoch  37 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.40 | loss  3.13 | ppl    22.91
| epoch  37 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.38 | loss  2.97 | ppl    19.50
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 63.46s | valid loss  4.70 | valid ppl   110.14
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.08 | ms/batch 46.95 | loss  3.13 | ppl    22.96
| epoch  38 |   400/ 1327 batches | lr 0.08 | ms/batch 46.85 | loss  3.12 | ppl    22.63
| epoch  38 |   600/ 1327 batches | lr 0.08 | ms/batch 46.70 | loss  3.11 | ppl    22.51
| epoch  38 |   800/ 1327 batches | lr 0.08 | ms/batch 46.62 | loss  3.06 | ppl    21.31
| epoch  38 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.50 | loss  3.13 | ppl    22.89
| epoch  38 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.57 | loss  2.97 | ppl    19.50
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 63.85s | valid loss  4.70 | valid ppl   110.10
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.08 | ms/batch 46.65 | loss  3.13 | ppl    22.91
| epoch  39 |   400/ 1327 batches | lr 0.08 | ms/batch 46.79 | loss  3.11 | ppl    22.52
| epoch  39 |   600/ 1327 batches | lr 0.08 | ms/batch 46.44 | loss  3.11 | ppl    22.45
| epoch  39 |   800/ 1327 batches | lr 0.08 | ms/batch 46.27 | loss  3.05 | ppl    21.12
| epoch  39 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.44 | loss  3.13 | ppl    22.95
| epoch  39 |  1200/ 1327 batches | lr 0.08 | ms/batch 47.02 | loss  2.97 | ppl    19.57
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 63.77s | valid loss  4.70 | valid ppl   110.07
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.08 | ms/batch 46.98 | loss  3.13 | ppl    22.89
| epoch  40 |   400/ 1327 batches | lr 0.08 | ms/batch 46.85 | loss  3.12 | ppl    22.54
| epoch  40 |   600/ 1327 batches | lr 0.08 | ms/batch 46.75 | loss  3.11 | ppl    22.36
| epoch  40 |   800/ 1327 batches | lr 0.08 | ms/batch 46.47 | loss  3.05 | ppl    21.22
| epoch  40 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.86 | loss  3.13 | ppl    22.95
| epoch  40 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.93 | loss  2.97 | ppl    19.45
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 63.97s | valid loss  4.70 | valid ppl   110.10
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.8593333333333333
sparsity at layer rnn.weight_hh_l0 is 0.8593333333333333
sparsity at layer rnn.weight_ih_l1 is 0.8593333333333333
sparsity at layer rnn.weight_hh_l1 is 0.8593333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.8822724161533197
=========================================================================================
| End of training | test loss  4.64 | test ppl   103.25
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 40 --dropout 0.50 --save sp88_epoch40_dropout0.50_lstm.pt --pretrained sp86_epoch40_dropout0.50_lstm.pt
debug
{'rnn.weight_ih_l0': 0.88, 'rnn.weight_hh_l0': 0.88, 'rnn.weight_ih_l1': 0.88, 'rnn.weight_hh_l1': 0.88}
{'rnn.weight_ih_l0': 0.88, 'rnn.weight_hh_l0': 0.88, 'rnn.weight_ih_l1': 0.88, 'rnn.weight_hh_l1': 0.88}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 50.98 | loss 25.90 | ppl 176601482880.28
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 46.75 | loss 10.46 | ppl 34840.34
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 46.90 | loss  5.46 | ppl   234.11
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 48.10 | loss  3.86 | ppl    47.39
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 49.42 | loss  3.44 | ppl    31.06
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 49.72 | loss  3.12 | ppl    22.62
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 67.03s | valid loss  4.78 | valid ppl   119.30
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 54.70 | loss  6.93 | ppl  1026.09
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 50.26 | loss  3.68 | ppl    39.51
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 50.45 | loss  3.05 | ppl    21.21
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 51.12 | loss  2.90 | ppl    18.21
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 50.92 | loss  2.94 | ppl    18.93
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.79 | loss  2.77 | ppl    15.96
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 70.65s | valid loss  4.86 | valid ppl   129.32
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 55.74 | loss  3.02 | ppl    20.53
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 51.17 | loss  2.89 | ppl    18.07
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 51.00 | loss  2.87 | ppl    17.65
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 51.30 | loss  2.83 | ppl    16.96
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.53 | loss  2.90 | ppl    18.08
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.52 | loss  2.73 | ppl    15.33
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 71.22s | valid loss  4.89 | valid ppl   132.96
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 55.90 | loss  2.95 | ppl    19.03
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 51.98 | loss  2.86 | ppl    17.54
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 51.98 | loss  2.85 | ppl    17.30
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 52.05 | loss  2.81 | ppl    16.65
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.95 | loss  2.88 | ppl    17.77
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.99 | loss  2.72 | ppl    15.12
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 72.04s | valid loss  4.89 | valid ppl   132.78
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 56.03 | loss  2.99 | ppl    19.94
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 52.12 | loss  2.93 | ppl    18.68
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 52.23 | loss  2.92 | ppl    18.59
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 53.00 | loss  2.88 | ppl    17.78
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.72 | loss  2.94 | ppl    18.94
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.78 | loss  2.79 | ppl    16.26
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 72.74s | valid loss  4.86 | valid ppl   128.68
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 56.53 | loss  2.96 | ppl    19.38
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 53.11 | loss  2.92 | ppl    18.61
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 53.25 | loss  2.91 | ppl    18.32
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 53.13 | loss  2.86 | ppl    17.53
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 53.09 | loss  2.93 | ppl    18.68
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 53.24 | loss  2.77 | ppl    16.01
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 73.45s | valid loss  4.86 | valid ppl   129.23
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 57.08 | loss  3.01 | ppl    20.31
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 53.43 | loss  2.95 | ppl    19.03
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 53.26 | loss  2.92 | ppl    18.63
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 53.57 | loss  2.88 | ppl    17.79
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.50 | loss  2.94 | ppl    19.00
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.53 | loss  2.79 | ppl    16.23
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 73.94s | valid loss  4.83 | valid ppl   125.78
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 57.28 | loss  2.97 | ppl    19.46
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 53.50 | loss  2.93 | ppl    18.75
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 54.01 | loss  2.92 | ppl    18.57
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 54.08 | loss  2.87 | ppl    17.68
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.12 | loss  2.94 | ppl    18.94
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.20 | loss  2.78 | ppl    16.06
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 74.71s | valid loss  4.83 | valid ppl   125.69
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 58.37 | loss  2.95 | ppl    19.14
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 54.48 | loss  2.92 | ppl    18.54
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 54.65 | loss  2.91 | ppl    18.43
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 54.66 | loss  2.86 | ppl    17.52
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.61 | loss  2.93 | ppl    18.71
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.69 | loss  2.77 | ppl    15.95
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 75.52s | valid loss  4.83 | valid ppl   125.72
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 2.50 | ms/batch 59.10 | loss  2.96 | ppl    19.29
| epoch  10 |   400/ 1327 batches | lr 2.50 | ms/batch 55.08 | loss  2.94 | ppl    18.83
| epoch  10 |   600/ 1327 batches | lr 2.50 | ms/batch 55.43 | loss  2.92 | ppl    18.60
| epoch  10 |   800/ 1327 batches | lr 2.50 | ms/batch 55.22 | loss  2.88 | ppl    17.77
| epoch  10 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.36 | loss  2.94 | ppl    18.95
| epoch  10 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.30 | loss  2.78 | ppl    16.19
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 76.44s | valid loss  4.83 | valid ppl   124.98
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 2.50 | ms/batch 59.27 | loss  2.69 | ppl    14.79
| epoch  11 |   400/ 1327 batches | lr 2.50 | ms/batch 54.68 | loss  2.69 | ppl    14.77
| epoch  11 |   600/ 1327 batches | lr 2.50 | ms/batch 56.01 | loss  2.69 | ppl    14.68
| epoch  11 |   800/ 1327 batches | lr 2.50 | ms/batch 56.03 | loss  2.65 | ppl    14.09
| epoch  11 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.69 | loss  2.71 | ppl    15.07
| epoch  11 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.61 | loss  2.56 | ppl    12.99
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 76.75s | valid loss  4.89 | valid ppl   133.62
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 2.50 | ms/batch 60.08 | loss  2.76 | ppl    15.80
| epoch  12 |   400/ 1327 batches | lr 2.50 | ms/batch 55.71 | loss  2.74 | ppl    15.49
| epoch  12 |   600/ 1327 batches | lr 2.50 | ms/batch 55.96 | loss  2.72 | ppl    15.24
| epoch  12 |   800/ 1327 batches | lr 2.50 | ms/batch 56.17 | loss  2.68 | ppl    14.63
| epoch  12 |  1000/ 1327 batches | lr 2.50 | ms/batch 56.19 | loss  2.76 | ppl    15.74
| epoch  12 |  1200/ 1327 batches | lr 2.50 | ms/batch 56.11 | loss  2.61 | ppl    13.59
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 77.59s | valid loss  4.89 | valid ppl   132.48
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 2.50 | ms/batch 60.88 | loss  2.77 | ppl    15.91
| epoch  13 |   400/ 1327 batches | lr 2.50 | ms/batch 56.28 | loss  2.74 | ppl    15.55
| epoch  13 |   600/ 1327 batches | lr 2.50 | ms/batch 57.10 | loss  2.74 | ppl    15.46
| epoch  13 |   800/ 1327 batches | lr 2.50 | ms/batch 56.71 | loss  2.69 | ppl    14.77
| epoch  13 |  1000/ 1327 batches | lr 2.50 | ms/batch 56.70 | loss  2.76 | ppl    15.74
| epoch  13 |  1200/ 1327 batches | lr 2.50 | ms/batch 56.81 | loss  2.61 | ppl    13.62
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 78.38s | valid loss  4.89 | valid ppl   132.53
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 60.81 | loss  2.97 | ppl    19.44
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 56.73 | loss  2.93 | ppl    18.72
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 57.28 | loss  2.91 | ppl    18.41
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 56.74 | loss  2.87 | ppl    17.56
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.86 | loss  2.92 | ppl    18.53
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.83 | loss  2.77 | ppl    15.92
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 78.69s | valid loss  4.83 | valid ppl   125.57
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 60.97 | loss  2.94 | ppl    18.84
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 57.71 | loss  2.92 | ppl    18.55
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 57.75 | loss  2.90 | ppl    18.24
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 57.82 | loss  2.85 | ppl    17.28
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.79 | loss  2.92 | ppl    18.55
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.84 | loss  2.76 | ppl    15.79
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 79.70s | valid loss  4.83 | valid ppl   125.20
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 61.77 | loss  2.94 | ppl    19.00
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 58.37 | loss  2.92 | ppl    18.59
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 58.18 | loss  2.91 | ppl    18.37
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 58.43 | loss  2.86 | ppl    17.54
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.27 | loss  2.93 | ppl    18.77
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.20 | loss  2.77 | ppl    15.96
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 80.35s | valid loss  4.82 | valid ppl   123.91
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 62.49 | loss  2.94 | ppl    18.88
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 58.31 | loss  2.92 | ppl    18.48
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 58.40 | loss  2.90 | ppl    18.25
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 59.19 | loss  2.86 | ppl    17.46
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 59.06 | loss  2.93 | ppl    18.69
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.56 | loss  2.76 | ppl    15.81
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 80.97s | valid loss  4.82 | valid ppl   123.81
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 1.25 | ms/batch 63.16 | loss  3.06 | ppl    21.41
| epoch  18 |   400/ 1327 batches | lr 1.25 | ms/batch 58.71 | loss  3.04 | ppl    20.94
| epoch  18 |   600/ 1327 batches | lr 1.25 | ms/batch 58.98 | loss  3.03 | ppl    20.74
| epoch  18 |   800/ 1327 batches | lr 1.25 | ms/batch 59.29 | loss  2.98 | ppl    19.72
| epoch  18 |  1000/ 1327 batches | lr 1.25 | ms/batch 59.40 | loss  3.04 | ppl    20.98
| epoch  18 |  1200/ 1327 batches | lr 1.25 | ms/batch 59.44 | loss  2.89 | ppl    18.01
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 81.83s | valid loss  4.79 | valid ppl   120.62
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 1.25 | ms/batch 63.33 | loss  3.05 | ppl    21.04
| epoch  19 |   400/ 1327 batches | lr 1.25 | ms/batch 59.83 | loss  3.03 | ppl    20.73
| epoch  19 |   600/ 1327 batches | lr 1.25 | ms/batch 59.55 | loss  3.02 | ppl    20.49
| epoch  19 |   800/ 1327 batches | lr 1.25 | ms/batch 59.60 | loss  2.97 | ppl    19.57
| epoch  19 |  1000/ 1327 batches | lr 1.25 | ms/batch 60.18 | loss  3.04 | ppl    20.94
| epoch  19 |  1200/ 1327 batches | lr 1.25 | ms/batch 60.24 | loss  2.88 | ppl    17.90
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 82.46s | valid loss  4.79 | valid ppl   120.37
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 1.25 | ms/batch 64.06 | loss  3.08 | ppl    21.65
| epoch  20 |   400/ 1327 batches | lr 1.25 | ms/batch 60.11 | loss  3.06 | ppl    21.33
| epoch  20 |   600/ 1327 batches | lr 1.25 | ms/batch 60.60 | loss  3.05 | ppl    21.05
| epoch  20 |   800/ 1327 batches | lr 1.25 | ms/batch 60.71 | loss  3.00 | ppl    20.05
| epoch  20 |  1000/ 1327 batches | lr 1.25 | ms/batch 60.42 | loss  3.07 | ppl    21.46
| epoch  20 |  1200/ 1327 batches | lr 1.25 | ms/batch 60.47 | loss  2.91 | ppl    18.38
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 83.26s | valid loss  4.78 | valid ppl   119.04
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 1.25 | ms/batch 64.14 | loss  2.69 | ppl    14.67
| epoch  21 |   400/ 1327 batches | lr 1.25 | ms/batch 60.39 | loss  2.69 | ppl    14.73
| epoch  21 |   600/ 1327 batches | lr 1.25 | ms/batch 60.45 | loss  2.68 | ppl    14.62
| epoch  21 |   800/ 1327 batches | lr 1.25 | ms/batch 60.41 | loss  2.64 | ppl    14.05
| epoch  21 |  1000/ 1327 batches | lr 1.25 | ms/batch 60.67 | loss  2.71 | ppl    14.97
| epoch  21 |  1200/ 1327 batches | lr 1.25 | ms/batch 60.91 | loss  2.56 | ppl    12.94
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 83.48s | valid loss  4.87 | valid ppl   129.84
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 1.25 | ms/batch 65.41 | loss  2.72 | ppl    15.22
| epoch  22 |   400/ 1327 batches | lr 1.25 | ms/batch 60.76 | loss  2.70 | ppl    14.83
| epoch  22 |   600/ 1327 batches | lr 1.25 | ms/batch 61.46 | loss  2.69 | ppl    14.75
| epoch  22 |   800/ 1327 batches | lr 1.25 | ms/batch 61.23 | loss  2.65 | ppl    14.14
| epoch  22 |  1000/ 1327 batches | lr 1.25 | ms/batch 61.54 | loss  2.71 | ppl    15.04
| epoch  22 |  1200/ 1327 batches | lr 1.25 | ms/batch 61.53 | loss  2.56 | ppl    12.99
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 84.71s | valid loss  4.88 | valid ppl   131.73
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 1.25 | ms/batch 65.73 | loss  2.72 | ppl    15.24
| epoch  23 |   400/ 1327 batches | lr 1.25 | ms/batch 61.78 | loss  2.71 | ppl    15.00
| epoch  23 |   600/ 1327 batches | lr 1.25 | ms/batch 62.08 | loss  2.70 | ppl    14.91
| epoch  23 |   800/ 1327 batches | lr 1.25 | ms/batch 61.94 | loss  2.65 | ppl    14.21
| epoch  23 |  1000/ 1327 batches | lr 1.25 | ms/batch 61.98 | loss  2.72 | ppl    15.18
| epoch  23 |  1200/ 1327 batches | lr 1.25 | ms/batch 62.05 | loss  2.57 | ppl    13.10
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 85.40s | valid loss  4.88 | valid ppl   132.26
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.62 | ms/batch 66.34 | loss  2.97 | ppl    19.51
| epoch  24 |   400/ 1327 batches | lr 0.62 | ms/batch 61.93 | loss  2.94 | ppl    18.97
| epoch  24 |   600/ 1327 batches | lr 0.62 | ms/batch 62.53 | loss  2.93 | ppl    18.80
| epoch  24 |   800/ 1327 batches | lr 0.62 | ms/batch 62.53 | loss  2.87 | ppl    17.69
| epoch  24 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.39 | loss  2.95 | ppl    19.04
| epoch  24 |  1200/ 1327 batches | lr 0.62 | ms/batch 62.41 | loss  2.77 | ppl    16.03
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 85.86s | valid loss  4.82 | valid ppl   124.17
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.62 | ms/batch 66.68 | loss  2.94 | ppl    18.96
| epoch  25 |   400/ 1327 batches | lr 0.62 | ms/batch 62.44 | loss  2.92 | ppl    18.51
| epoch  25 |   600/ 1327 batches | lr 0.62 | ms/batch 62.91 | loss  2.91 | ppl    18.33
| epoch  25 |   800/ 1327 batches | lr 0.62 | ms/batch 62.90 | loss  2.87 | ppl    17.59
| epoch  25 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.72 | loss  2.93 | ppl    18.76
| epoch  25 |  1200/ 1327 batches | lr 0.62 | ms/batch 63.25 | loss  2.78 | ppl    16.08
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 86.53s | valid loss  4.82 | valid ppl   123.48
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.62 | ms/batch 67.01 | loss  2.94 | ppl    18.93
| epoch  26 |   400/ 1327 batches | lr 0.62 | ms/batch 62.94 | loss  2.92 | ppl    18.56
| epoch  26 |   600/ 1327 batches | lr 0.62 | ms/batch 63.38 | loss  2.91 | ppl    18.31
| epoch  26 |   800/ 1327 batches | lr 0.62 | ms/batch 63.69 | loss  2.86 | ppl    17.46
| epoch  26 |  1000/ 1327 batches | lr 0.62 | ms/batch 63.58 | loss  2.93 | ppl    18.78
| epoch  26 |  1200/ 1327 batches | lr 0.62 | ms/batch 63.23 | loss  2.76 | ppl    15.87
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 87.24s | valid loss  4.81 | valid ppl   123.08
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.62 | ms/batch 67.74 | loss  3.04 | ppl    20.92
| epoch  27 |   400/ 1327 batches | lr 0.62 | ms/batch 64.07 | loss  3.02 | ppl    20.53
| epoch  27 |   600/ 1327 batches | lr 0.62 | ms/batch 64.02 | loss  3.01 | ppl    20.36
| epoch  27 |   800/ 1327 batches | lr 0.62 | ms/batch 63.84 | loss  2.96 | ppl    19.39
| epoch  27 |  1000/ 1327 batches | lr 0.62 | ms/batch 64.25 | loss  3.03 | ppl    20.73
| epoch  27 |  1200/ 1327 batches | lr 0.62 | ms/batch 63.92 | loss  2.87 | ppl    17.65
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 88.13s | valid loss  4.79 | valid ppl   120.62
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.62 | ms/batch 68.09 | loss  3.03 | ppl    20.71
| epoch  28 |   400/ 1327 batches | lr 0.62 | ms/batch 64.22 | loss  3.02 | ppl    20.47
| epoch  28 |   600/ 1327 batches | lr 0.62 | ms/batch 64.64 | loss  3.00 | ppl    20.13
| epoch  28 |   800/ 1327 batches | lr 0.62 | ms/batch 64.35 | loss  2.96 | ppl    19.35
| epoch  28 |  1000/ 1327 batches | lr 0.62 | ms/batch 64.27 | loss  3.03 | ppl    20.80
| epoch  28 |  1200/ 1327 batches | lr 0.62 | ms/batch 64.37 | loss  2.87 | ppl    17.58
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 88.64s | valid loss  4.79 | valid ppl   120.12
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.62 | ms/batch 68.66 | loss  3.05 | ppl    21.11
| epoch  29 |   400/ 1327 batches | lr 0.62 | ms/batch 64.31 | loss  3.04 | ppl    20.85
| epoch  29 |   600/ 1327 batches | lr 0.62 | ms/batch 65.17 | loss  3.03 | ppl    20.64
| epoch  29 |   800/ 1327 batches | lr 0.62 | ms/batch 65.12 | loss  2.98 | ppl    19.59
| epoch  29 |  1000/ 1327 batches | lr 0.62 | ms/batch 65.18 | loss  3.05 | ppl    21.22
| epoch  29 |  1200/ 1327 batches | lr 0.62 | ms/batch 64.91 | loss  2.89 | ppl    17.98
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 89.31s | valid loss  4.78 | valid ppl   119.12
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.62 | ms/batch 69.19 | loss  3.05 | ppl    21.01
| epoch  30 |   400/ 1327 batches | lr 0.62 | ms/batch 65.93 | loss  3.04 | ppl    20.84
| epoch  30 |   600/ 1327 batches | lr 0.62 | ms/batch 65.53 | loss  3.02 | ppl    20.53
| epoch  30 |   800/ 1327 batches | lr 0.62 | ms/batch 65.89 | loss  2.98 | ppl    19.70
| epoch  30 |  1000/ 1327 batches | lr 0.62 | ms/batch 65.92 | loss  3.05 | ppl    21.07
| epoch  30 |  1200/ 1327 batches | lr 0.62 | ms/batch 65.59 | loss  2.88 | ppl    17.89
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 90.33s | valid loss  4.78 | valid ppl   119.00
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.62 | ms/batch 69.42 | loss  3.05 | ppl    21.06
| epoch  31 |   400/ 1327 batches | lr 0.62 | ms/batch 66.07 | loss  3.04 | ppl    20.84
| epoch  31 |   600/ 1327 batches | lr 0.62 | ms/batch 66.47 | loss  3.02 | ppl    20.54
| epoch  31 |   800/ 1327 batches | lr 0.62 | ms/batch 66.13 | loss  2.97 | ppl    19.55
| epoch  31 |  1000/ 1327 batches | lr 0.62 | ms/batch 66.29 | loss  3.05 | ppl    21.07
| epoch  31 |  1200/ 1327 batches | lr 0.62 | ms/batch 66.32 | loss  2.89 | ppl    17.98
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 90.96s | valid loss  4.78 | valid ppl   118.92
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.62 | ms/batch 70.33 | loss  3.10 | ppl    22.28
| epoch  32 |   400/ 1327 batches | lr 0.62 | ms/batch 66.64 | loss  3.09 | ppl    21.99
| epoch  32 |   600/ 1327 batches | lr 0.62 | ms/batch 66.57 | loss  3.09 | ppl    21.95
| epoch  32 |   800/ 1327 batches | lr 0.62 | ms/batch 66.52 | loss  3.03 | ppl    20.61
| epoch  32 |  1000/ 1327 batches | lr 0.62 | ms/batch 67.43 | loss  3.10 | ppl    22.28
| epoch  32 |  1200/ 1327 batches | lr 0.62 | ms/batch 66.53 | loss  2.95 | ppl    19.08
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 91.59s | valid loss  4.76 | valid ppl   117.29
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.62 | ms/batch 71.15 | loss  3.09 | ppl    22.06
| epoch  33 |   400/ 1327 batches | lr 0.62 | ms/batch 67.31 | loss  3.09 | ppl    21.95
| epoch  33 |   600/ 1327 batches | lr 0.62 | ms/batch 67.17 | loss  3.08 | ppl    21.66
| epoch  33 |   800/ 1327 batches | lr 0.62 | ms/batch 67.54 | loss  3.03 | ppl    20.68
| epoch  33 |  1000/ 1327 batches | lr 0.62 | ms/batch 67.18 | loss  3.11 | ppl    22.32
| epoch  33 |  1200/ 1327 batches | lr 0.62 | ms/batch 67.14 | loss  2.94 | ppl    18.87
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 92.34s | valid loss  4.76 | valid ppl   117.00
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.62 | ms/batch 71.43 | loss  3.11 | ppl    22.35
| epoch  34 |   400/ 1327 batches | lr 0.62 | ms/batch 67.81 | loss  3.09 | ppl    22.04
| epoch  34 |   600/ 1327 batches | lr 0.62 | ms/batch 67.93 | loss  3.08 | ppl    21.70
| epoch  34 |   800/ 1327 batches | lr 0.62 | ms/batch 67.95 | loss  3.03 | ppl    20.63
| epoch  34 |  1000/ 1327 batches | lr 0.62 | ms/batch 68.36 | loss  3.10 | ppl    22.21
| epoch  34 |  1200/ 1327 batches | lr 0.62 | ms/batch 67.77 | loss  2.93 | ppl    18.73
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 93.20s | valid loss  4.76 | valid ppl   116.86
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.62 | ms/batch 71.79 | loss  3.11 | ppl    22.38
| epoch  35 |   400/ 1327 batches | lr 0.62 | ms/batch 67.42 | loss  3.10 | ppl    22.13
| epoch  35 |   600/ 1327 batches | lr 0.62 | ms/batch 68.15 | loss  3.08 | ppl    21.77
| epoch  35 |   800/ 1327 batches | lr 0.62 | ms/batch 68.25 | loss  3.04 | ppl    20.80
| epoch  35 |  1000/ 1327 batches | lr 0.62 | ms/batch 68.48 | loss  3.11 | ppl    22.38
| epoch  35 |  1200/ 1327 batches | lr 0.62 | ms/batch 67.76 | loss  2.95 | ppl    19.04
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 93.52s | valid loss  4.76 | valid ppl   116.63
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.62 | ms/batch 72.10 | loss  3.11 | ppl    22.43
| epoch  36 |   400/ 1327 batches | lr 0.62 | ms/batch 68.65 | loss  3.09 | ppl    21.98
| epoch  36 |   600/ 1327 batches | lr 0.62 | ms/batch 69.18 | loss  3.08 | ppl    21.82
| epoch  36 |   800/ 1327 batches | lr 0.62 | ms/batch 69.00 | loss  3.04 | ppl    20.86
| epoch  36 |  1000/ 1327 batches | lr 0.62 | ms/batch 68.93 | loss  3.10 | ppl    22.31
| epoch  36 |  1200/ 1327 batches | lr 0.62 | ms/batch 68.81 | loss  2.95 | ppl    19.04
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 94.30s | valid loss  4.76 | valid ppl   116.21
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.62 | ms/batch 73.21 | loss  3.11 | ppl    22.39
| epoch  37 |   400/ 1327 batches | lr 0.62 | ms/batch 69.12 | loss  3.10 | ppl    22.10
| epoch  37 |   600/ 1327 batches | lr 0.62 | ms/batch 69.92 | loss  3.09 | ppl    21.94
| epoch  37 |   800/ 1327 batches | lr 0.62 | ms/batch 69.40 | loss  3.03 | ppl    20.80
| epoch  37 |  1000/ 1327 batches | lr 0.62 | ms/batch 70.18 | loss  3.11 | ppl    22.36
| epoch  37 |  1200/ 1327 batches | lr 0.62 | ms/batch 69.29 | loss  2.95 | ppl    19.15
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 95.35s | valid loss  4.75 | valid ppl   116.09
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.62 | ms/batch 73.33 | loss  3.11 | ppl    22.33
| epoch  38 |   400/ 1327 batches | lr 0.62 | ms/batch 69.03 | loss  3.10 | ppl    22.22
| epoch  38 |   600/ 1327 batches | lr 0.62 | ms/batch 70.04 | loss  3.09 | ppl    21.96
| epoch  38 |   800/ 1327 batches | lr 0.62 | ms/batch 69.78 | loss  3.04 | ppl    20.83
| epoch  38 |  1000/ 1327 batches | lr 0.62 | ms/batch 70.42 | loss  3.11 | ppl    22.39
| epoch  38 |  1200/ 1327 batches | lr 0.62 | ms/batch 69.91 | loss  2.95 | ppl    19.09
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 95.65s | valid loss  4.75 | valid ppl   115.89
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.62 | ms/batch 74.36 | loss  3.12 | ppl    22.58
| epoch  39 |   400/ 1327 batches | lr 0.62 | ms/batch 70.32 | loss  3.11 | ppl    22.40
| epoch  39 |   600/ 1327 batches | lr 0.62 | ms/batch 70.68 | loss  3.09 | ppl    21.99
| epoch  39 |   800/ 1327 batches | lr 0.62 | ms/batch 70.61 | loss  3.04 | ppl    21.00
| epoch  39 |  1000/ 1327 batches | lr 0.62 | ms/batch 70.30 | loss  3.11 | ppl    22.50
| epoch  39 |  1200/ 1327 batches | lr 0.62 | ms/batch 70.25 | loss  2.95 | ppl    19.19
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 96.56s | valid loss  4.75 | valid ppl   115.71
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.62 | ms/batch 74.86 | loss  3.13 | ppl    22.81
| epoch  40 |   400/ 1327 batches | lr 0.62 | ms/batch 70.93 | loss  3.11 | ppl    22.37
| epoch  40 |   600/ 1327 batches | lr 0.62 | ms/batch 71.12 | loss  3.10 | ppl    22.30
| epoch  40 |   800/ 1327 batches | lr 0.62 | ms/batch 71.57 | loss  3.05 | ppl    21.07
| epoch  40 |  1000/ 1327 batches | lr 0.62 | ms/batch 71.04 | loss  3.12 | ppl    22.71
| epoch  40 |  1200/ 1327 batches | lr 0.62 | ms/batch 70.90 | loss  2.96 | ppl    19.29
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 97.31s | valid loss  4.75 | valid ppl   115.58
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.8793333333333333
sparsity at layer rnn.weight_hh_l0 is 0.8793333333333333
sparsity at layer rnn.weight_ih_l1 is 0.8793333333333333
sparsity at layer rnn.weight_hh_l1 is 0.8793333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.9217330538085255
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 45.41 | loss  2.28 | ppl     9.80
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 46.19 | loss  2.32 | ppl    10.13
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 46.55 | loss  2.33 | ppl    10.27
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 46.58 | loss  2.31 | ppl    10.07
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.44 | loss  2.40 | ppl    10.97
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 47.00 | loss  2.27 | ppl     9.68
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 63.43s | valid loss  5.21 | valid ppl   182.40
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 46.35 | loss  2.35 | ppl    10.50
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 46.56 | loss  2.35 | ppl    10.45
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 46.36 | loss  2.35 | ppl    10.47
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 46.17 | loss  2.33 | ppl    10.27
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.40 | loss  2.41 | ppl    11.12
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.28 | loss  2.27 | ppl     9.69
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.37s | valid loss  5.20 | valid ppl   182.07
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 46.37 | loss  2.36 | ppl    10.57
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 46.57 | loss  2.36 | ppl    10.56
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 46.96 | loss  2.36 | ppl    10.56
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 47.01 | loss  2.33 | ppl    10.31
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.83 | loss  2.41 | ppl    11.11
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.73 | loss  2.27 | ppl     9.71
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 63.89s | valid loss  5.22 | valid ppl   184.47
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 47.44 | loss  2.53 | ppl    12.60
| epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 46.77 | loss  2.51 | ppl    12.35
| epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 46.49 | loss  2.51 | ppl    12.31
| epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 46.74 | loss  2.49 | ppl    12.01
| epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.59 | loss  2.56 | ppl    12.89
| epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.46 | loss  2.43 | ppl    11.33
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 63.86s | valid loss  5.12 | valid ppl   166.91
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 46.75 | loss  2.67 | ppl    14.40
| epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 46.97 | loss  2.65 | ppl    14.09
| epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 46.81 | loss  2.64 | ppl    14.01
| epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 46.48 | loss  2.62 | ppl    13.69
| epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 47.06 | loss  2.69 | ppl    14.76
| epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.71 | loss  2.55 | ppl    12.83
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 63.96s | valid loss  5.06 | valid ppl   157.31
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 46.31 | loss  2.65 | ppl    14.16
| epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 45.97 | loss  2.64 | ppl    14.00
| epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 46.44 | loss  2.63 | ppl    13.85
| epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 46.68 | loss  2.60 | ppl    13.48
| epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.62 | loss  2.68 | ppl    14.58
| epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.67 | loss  2.55 | ppl    12.74
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 63.53s | valid loss  5.06 | valid ppl   158.21
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 47.17 | loss  3.15 | ppl    23.28
| epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 46.84 | loss  3.08 | ppl    21.77
| epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 46.84 | loss  3.05 | ppl    21.13
| epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 46.83 | loss  2.98 | ppl    19.77
| epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.82 | loss  3.05 | ppl    21.03
| epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.65 | loss  2.90 | ppl    18.17
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 64.02s | valid loss  4.88 | valid ppl   131.62
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch 46.75 | loss  3.04 | ppl    21.00
| epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch 46.67 | loss  3.02 | ppl    20.50
| epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch 46.20 | loss  3.00 | ppl    20.10
| epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch 46.82 | loss  2.95 | ppl    19.06
| epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch 47.02 | loss  3.02 | ppl    20.54
| epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.78 | loss  2.87 | ppl    17.62
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 63.82s | valid loss  4.87 | valid ppl   130.08
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 5.00 | ms/batch 46.64 | loss  3.05 | ppl    21.13
| epoch   9 |   400/ 1327 batches | lr 5.00 | ms/batch 46.34 | loss  3.03 | ppl    20.70
| epoch   9 |   600/ 1327 batches | lr 5.00 | ms/batch 46.38 | loss  3.02 | ppl    20.46
| epoch   9 |   800/ 1327 batches | lr 5.00 | ms/batch 46.35 | loss  2.97 | ppl    19.55
| epoch   9 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.46 | loss  3.03 | ppl    20.75
| epoch   9 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.40 | loss  2.89 | ppl    18.03
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 63.48s | valid loss  4.85 | valid ppl   128.21
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 5.00 | ms/batch 46.91 | loss  3.03 | ppl    20.60
| epoch  10 |   400/ 1327 batches | lr 5.00 | ms/batch 46.55 | loss  3.02 | ppl    20.46
| epoch  10 |   600/ 1327 batches | lr 5.00 | ms/batch 46.50 | loss  3.00 | ppl    20.15
| epoch  10 |   800/ 1327 batches | lr 5.00 | ms/batch 46.89 | loss  2.95 | ppl    19.16
| epoch  10 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.61 | loss  3.03 | ppl    20.61
| epoch  10 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.48 | loss  2.87 | ppl    17.65
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 63.78s | valid loss  4.86 | valid ppl   128.80
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 5.00 | ms/batch 47.36 | loss  3.07 | ppl    21.50
| epoch  11 |   400/ 1327 batches | lr 5.00 | ms/batch 47.00 | loss  3.05 | ppl    21.16
| epoch  11 |   600/ 1327 batches | lr 5.00 | ms/batch 46.85 | loss  3.04 | ppl    20.85
| epoch  11 |   800/ 1327 batches | lr 5.00 | ms/batch 46.58 | loss  2.99 | ppl    19.84
| epoch  11 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.42 | loss  3.06 | ppl    21.41
| epoch  11 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.67 | loss  2.92 | ppl    18.48
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 64.00s | valid loss  4.84 | valid ppl   125.87
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 5.00 | ms/batch 46.88 | loss  3.05 | ppl    21.20
| epoch  12 |   400/ 1327 batches | lr 5.00 | ms/batch 46.33 | loss  3.03 | ppl    20.65
| epoch  12 |   600/ 1327 batches | lr 5.00 | ms/batch 46.68 | loss  3.03 | ppl    20.71
| epoch  12 |   800/ 1327 batches | lr 5.00 | ms/batch 46.95 | loss  2.98 | ppl    19.70
| epoch  12 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.89 | loss  3.05 | ppl    21.13
| epoch  12 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.83 | loss  2.91 | ppl    18.35
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 63.93s | valid loss  4.84 | valid ppl   126.34
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 46.90 | loss  3.06 | ppl    21.39
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 46.53 | loss  3.05 | ppl    21.04
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 46.50 | loss  3.03 | ppl    20.75
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 46.40 | loss  2.98 | ppl    19.64
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.51 | loss  3.05 | ppl    21.08
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.49 | loss  2.89 | ppl    18.00
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 63.64s | valid loss  4.81 | valid ppl   122.52
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 46.61 | loss  3.04 | ppl    20.95
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 46.69 | loss  3.03 | ppl    20.71
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 46.31 | loss  3.02 | ppl    20.49
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 47.17 | loss  2.96 | ppl    19.37
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 47.03 | loss  3.03 | ppl    20.73
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.80 | loss  2.88 | ppl    17.89
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 63.92s | valid loss  4.81 | valid ppl   123.05
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 47.27 | loss  3.15 | ppl    23.25
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 46.84 | loss  3.12 | ppl    22.66
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 46.76 | loss  3.12 | ppl    22.54
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 46.80 | loss  3.06 | ppl    21.34
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.82 | loss  3.13 | ppl    22.96
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.87 | loss  2.98 | ppl    19.66
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 64.09s | valid loss  4.78 | valid ppl   118.80
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 45.88 | loss  3.13 | ppl    22.94
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 47.01 | loss  3.12 | ppl    22.59
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 46.33 | loss  3.11 | ppl    22.36
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 46.08 | loss  3.06 | ppl    21.34
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.11 | loss  3.13 | ppl    22.86
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.90 | loss  2.97 | ppl    19.57
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.47s | valid loss  4.78 | valid ppl   118.59
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 46.81 | loss  3.14 | ppl    23.06
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 46.39 | loss  3.13 | ppl    22.81
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 46.70 | loss  3.12 | ppl    22.68
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 46.42 | loss  3.06 | ppl    21.41
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.42 | loss  3.13 | ppl    22.95
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.89 | loss  2.98 | ppl    19.74
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 63.72s | valid loss  4.77 | valid ppl   117.49
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 1.25 | ms/batch 46.73 | loss  3.13 | ppl    22.94
| epoch  18 |   400/ 1327 batches | lr 1.25 | ms/batch 46.59 | loss  3.12 | ppl    22.58
| epoch  18 |   600/ 1327 batches | lr 1.25 | ms/batch 46.53 | loss  3.11 | ppl    22.36
| epoch  18 |   800/ 1327 batches | lr 1.25 | ms/batch 46.59 | loss  3.06 | ppl    21.39
| epoch  18 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.67 | loss  3.12 | ppl    22.65
| epoch  18 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.91 | loss  2.98 | ppl    19.65
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 63.80s | valid loss  4.77 | valid ppl   117.72
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.31 | ms/batch 47.03 | loss  3.17 | ppl    23.87
| epoch  19 |   400/ 1327 batches | lr 0.31 | ms/batch 46.89 | loss  3.16 | ppl    23.68
| epoch  19 |   600/ 1327 batches | lr 0.31 | ms/batch 46.65 | loss  3.16 | ppl    23.67
| epoch  19 |   800/ 1327 batches | lr 0.31 | ms/batch 46.81 | loss  3.09 | ppl    22.05
| epoch  19 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.65 | loss  3.17 | ppl    23.72
| epoch  19 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.43 | loss  3.00 | ppl    20.05
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.91s | valid loss  4.74 | valid ppl   114.40
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.31 | ms/batch 46.51 | loss  3.17 | ppl    23.83
| epoch  20 |   400/ 1327 batches | lr 0.31 | ms/batch 46.94 | loss  3.16 | ppl    23.46
| epoch  20 |   600/ 1327 batches | lr 0.31 | ms/batch 46.32 | loss  3.14 | ppl    23.19
| epoch  20 |   800/ 1327 batches | lr 0.31 | ms/batch 46.36 | loss  3.08 | ppl    21.80
| epoch  20 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.19 | loss  3.17 | ppl    23.77
| epoch  20 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.73 | loss  3.01 | ppl    20.19
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 63.59s | valid loss  4.74 | valid ppl   113.99
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 0.31 | ms/batch 46.92 | loss  3.16 | ppl    23.68
| epoch  21 |   400/ 1327 batches | lr 0.31 | ms/batch 46.53 | loss  3.15 | ppl    23.40
| epoch  21 |   600/ 1327 batches | lr 0.31 | ms/batch 46.58 | loss  3.14 | ppl    23.00
| epoch  21 |   800/ 1327 batches | lr 0.31 | ms/batch 46.74 | loss  3.08 | ppl    21.82
| epoch  21 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.36 | loss  3.17 | ppl    23.83
| epoch  21 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.62 | loss  3.00 | ppl    20.17
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 63.81s | valid loss  4.73 | valid ppl   113.74
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 0.31 | ms/batch 46.74 | loss  3.16 | ppl    23.56
| epoch  22 |   400/ 1327 batches | lr 0.31 | ms/batch 46.57 | loss  3.15 | ppl    23.27
| epoch  22 |   600/ 1327 batches | lr 0.31 | ms/batch 46.65 | loss  3.14 | ppl    23.12
| epoch  22 |   800/ 1327 batches | lr 0.31 | ms/batch 46.65 | loss  3.09 | ppl    21.92
| epoch  22 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.74 | loss  3.16 | ppl    23.59
| epoch  22 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.65 | loss  3.00 | ppl    20.14
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 63.77s | valid loss  4.73 | valid ppl   113.81
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 0.31 | ms/batch 47.01 | loss  3.16 | ppl    23.58
| epoch  23 |   400/ 1327 batches | lr 0.31 | ms/batch 46.59 | loss  3.16 | ppl    23.47
| epoch  23 |   600/ 1327 batches | lr 0.31 | ms/batch 46.62 | loss  3.15 | ppl    23.24
| epoch  23 |   800/ 1327 batches | lr 0.31 | ms/batch 46.43 | loss  3.08 | ppl    21.83
| epoch  23 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.28 | loss  3.16 | ppl    23.58
| epoch  23 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.20 | loss  3.00 | ppl    20.10
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 63.55s | valid loss  4.73 | valid ppl   113.64
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.31 | ms/batch 46.68 | loss  3.16 | ppl    23.61
| epoch  24 |   400/ 1327 batches | lr 0.31 | ms/batch 47.02 | loss  3.15 | ppl    23.27
| epoch  24 |   600/ 1327 batches | lr 0.31 | ms/batch 46.34 | loss  3.13 | ppl    22.93
| epoch  24 |   800/ 1327 batches | lr 0.31 | ms/batch 46.68 | loss  3.09 | ppl    21.87
| epoch  24 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.61 | loss  3.16 | ppl    23.57
| epoch  24 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.96 | loss  3.00 | ppl    20.15
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 63.84s | valid loss  4.73 | valid ppl   113.43
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.31 | ms/batch 46.78 | loss  3.16 | ppl    23.62
| epoch  25 |   400/ 1327 batches | lr 0.31 | ms/batch 46.71 | loss  3.14 | ppl    23.10
| epoch  25 |   600/ 1327 batches | lr 0.31 | ms/batch 46.68 | loss  3.14 | ppl    23.00
| epoch  25 |   800/ 1327 batches | lr 0.31 | ms/batch 46.76 | loss  3.08 | ppl    21.74
| epoch  25 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.75 | loss  3.16 | ppl    23.58
| epoch  25 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.67 | loss  2.99 | ppl    19.97
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 63.86s | valid loss  4.73 | valid ppl   113.51
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.08 | ms/batch 46.86 | loss  3.17 | ppl    23.92
| epoch  26 |   400/ 1327 batches | lr 0.08 | ms/batch 46.49 | loss  3.17 | ppl    23.74
| epoch  26 |   600/ 1327 batches | lr 0.08 | ms/batch 46.54 | loss  3.16 | ppl    23.53
| epoch  26 |   800/ 1327 batches | lr 0.08 | ms/batch 46.73 | loss  3.10 | ppl    22.19
| epoch  26 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.79 | loss  3.18 | ppl    24.00
| epoch  26 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.75 | loss  3.01 | ppl    20.28
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 63.82s | valid loss  4.73 | valid ppl   112.75
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.08 | ms/batch 46.40 | loss  3.17 | ppl    23.80
| epoch  27 |   400/ 1327 batches | lr 0.08 | ms/batch 46.50 | loss  3.16 | ppl    23.62
| epoch  27 |   600/ 1327 batches | lr 0.08 | ms/batch 46.19 | loss  3.16 | ppl    23.61
| epoch  27 |   800/ 1327 batches | lr 0.08 | ms/batch 46.53 | loss  3.10 | ppl    22.17
| epoch  27 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.65 | loss  3.17 | ppl    23.84
| epoch  27 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.31 | loss  3.02 | ppl    20.41
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 63.45s | valid loss  4.72 | valid ppl   112.38
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.08 | ms/batch 46.78 | loss  3.17 | ppl    23.78
| epoch  28 |   400/ 1327 batches | lr 0.08 | ms/batch 46.75 | loss  3.16 | ppl    23.58
| epoch  28 |   600/ 1327 batches | lr 0.08 | ms/batch 46.75 | loss  3.15 | ppl    23.35
| epoch  28 |   800/ 1327 batches | lr 0.08 | ms/batch 46.39 | loss  3.10 | ppl    22.10
| epoch  28 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.80 | loss  3.17 | ppl    23.92
| epoch  28 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.75 | loss  3.01 | ppl    20.35
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 63.85s | valid loss  4.72 | valid ppl   112.24
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.08 | ms/batch 46.33 | loss  3.17 | ppl    23.72
| epoch  29 |   400/ 1327 batches | lr 0.08 | ms/batch 46.61 | loss  3.15 | ppl    23.42
| epoch  29 |   600/ 1327 batches | lr 0.08 | ms/batch 46.93 | loss  3.15 | ppl    23.25
| epoch  29 |   800/ 1327 batches | lr 0.08 | ms/batch 46.76 | loss  3.10 | ppl    22.12
| epoch  29 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.79 | loss  3.17 | ppl    23.74
| epoch  29 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.73 | loss  3.02 | ppl    20.44
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 63.81s | valid loss  4.72 | valid ppl   112.10
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.08 | ms/batch 46.36 | loss  3.17 | ppl    23.83
| epoch  30 |   400/ 1327 batches | lr 0.08 | ms/batch 46.32 | loss  3.15 | ppl    23.38
| epoch  30 |   600/ 1327 batches | lr 0.08 | ms/batch 46.31 | loss  3.15 | ppl    23.39
| epoch  30 |   800/ 1327 batches | lr 0.08 | ms/batch 46.31 | loss  3.10 | ppl    22.12
| epoch  30 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.40 | loss  3.17 | ppl    23.78
| epoch  30 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.60 | loss  3.01 | ppl    20.38
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 63.48s | valid loss  4.72 | valid ppl   112.04
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.08 | ms/batch 46.25 | loss  3.17 | ppl    23.70
| epoch  31 |   400/ 1327 batches | lr 0.08 | ms/batch 47.01 | loss  3.16 | ppl    23.52
| epoch  31 |   600/ 1327 batches | lr 0.08 | ms/batch 46.53 | loss  3.15 | ppl    23.28
| epoch  31 |   800/ 1327 batches | lr 0.08 | ms/batch 46.52 | loss  3.09 | ppl    21.92
| epoch  31 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.52 | loss  3.17 | ppl    23.71
| epoch  31 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.98 | loss  3.02 | ppl    20.45
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 63.74s | valid loss  4.72 | valid ppl   112.02
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.08 | ms/batch 46.53 | loss  3.16 | ppl    23.64
| epoch  32 |   400/ 1327 batches | lr 0.08 | ms/batch 46.99 | loss  3.15 | ppl    23.38
| epoch  32 |   600/ 1327 batches | lr 0.08 | ms/batch 46.22 | loss  3.15 | ppl    23.36
| epoch  32 |   800/ 1327 batches | lr 0.08 | ms/batch 46.84 | loss  3.09 | ppl    22.06
| epoch  32 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.43 | loss  3.17 | ppl    23.85
| epoch  32 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.49 | loss  3.01 | ppl    20.33
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 63.67s | valid loss  4.72 | valid ppl   112.01
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.08 | ms/batch 46.82 | loss  3.17 | ppl    23.83
| epoch  33 |   400/ 1327 batches | lr 0.08 | ms/batch 46.73 | loss  3.16 | ppl    23.57
| epoch  33 |   600/ 1327 batches | lr 0.08 | ms/batch 46.84 | loss  3.15 | ppl    23.31
| epoch  33 |   800/ 1327 batches | lr 0.08 | ms/batch 46.69 | loss  3.10 | ppl    22.09
| epoch  33 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.80 | loss  3.18 | ppl    23.94
| epoch  33 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.45 | loss  3.02 | ppl    20.45
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 63.82s | valid loss  4.72 | valid ppl   111.92
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.08 | ms/batch 46.55 | loss  3.17 | ppl    23.77
| epoch  34 |   400/ 1327 batches | lr 0.08 | ms/batch 46.53 | loss  3.15 | ppl    23.29
| epoch  34 |   600/ 1327 batches | lr 0.08 | ms/batch 46.42 | loss  3.15 | ppl    23.29
| epoch  34 |   800/ 1327 batches | lr 0.08 | ms/batch 46.42 | loss  3.09 | ppl    21.92
| epoch  34 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.40 | loss  3.18 | ppl    23.97
| epoch  34 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.35 | loss  3.02 | ppl    20.42
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 63.49s | valid loss  4.72 | valid ppl   111.95
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.08 | ms/batch 47.58 | loss  3.17 | ppl    23.75
| epoch  35 |   400/ 1327 batches | lr 0.08 | ms/batch 46.88 | loss  3.15 | ppl    23.35
| epoch  35 |   600/ 1327 batches | lr 0.08 | ms/batch 46.75 | loss  3.15 | ppl    23.38
| epoch  35 |   800/ 1327 batches | lr 0.08 | ms/batch 46.66 | loss  3.09 | ppl    22.07
| epoch  35 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.67 | loss  3.18 | ppl    23.96
| epoch  35 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.56 | loss  3.01 | ppl    20.36
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 64.02s | valid loss  4.72 | valid ppl   111.89
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.08 | ms/batch 46.81 | loss  3.17 | ppl    23.80
| epoch  36 |   400/ 1327 batches | lr 0.08 | ms/batch 46.72 | loss  3.15 | ppl    23.38
| epoch  36 |   600/ 1327 batches | lr 0.08 | ms/batch 46.59 | loss  3.14 | ppl    23.19
| epoch  36 |   800/ 1327 batches | lr 0.08 | ms/batch 46.41 | loss  3.09 | ppl    21.99
| epoch  36 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.95 | loss  3.17 | ppl    23.87
| epoch  36 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.77 | loss  3.01 | ppl    20.29
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 63.83s | valid loss  4.72 | valid ppl   111.90
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.02 | ms/batch 47.08 | loss  3.17 | ppl    23.83
| epoch  37 |   400/ 1327 batches | lr 0.02 | ms/batch 46.24 | loss  3.15 | ppl    23.43
| epoch  37 |   600/ 1327 batches | lr 0.02 | ms/batch 46.36 | loss  3.15 | ppl    23.29
| epoch  37 |   800/ 1327 batches | lr 0.02 | ms/batch 46.39 | loss  3.10 | ppl    22.09
| epoch  37 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.13 | loss  3.17 | ppl    23.80
| epoch  37 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.34 | loss  3.01 | ppl    20.26
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 63.50s | valid loss  4.72 | valid ppl   111.87
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.02 | ms/batch 46.95 | loss  3.17 | ppl    23.81
| epoch  38 |   400/ 1327 batches | lr 0.02 | ms/batch 46.62 | loss  3.16 | ppl    23.54
| epoch  38 |   600/ 1327 batches | lr 0.02 | ms/batch 46.57 | loss  3.15 | ppl    23.43
| epoch  38 |   800/ 1327 batches | lr 0.02 | ms/batch 46.71 | loss  3.10 | ppl    22.12
| epoch  38 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.30 | loss  3.17 | ppl    23.81
| epoch  38 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.20 | loss  3.01 | ppl    20.33
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 63.68s | valid loss  4.72 | valid ppl   111.84
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.02 | ms/batch 46.94 | loss  3.17 | ppl    23.81
| epoch  39 |   400/ 1327 batches | lr 0.02 | ms/batch 46.88 | loss  3.15 | ppl    23.45
| epoch  39 |   600/ 1327 batches | lr 0.02 | ms/batch 46.54 | loss  3.15 | ppl    23.38
| epoch  39 |   800/ 1327 batches | lr 0.02 | ms/batch 46.47 | loss  3.09 | ppl    22.04
| epoch  39 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.99 | loss  3.18 | ppl    23.98
| epoch  39 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.54 | loss  3.01 | ppl    20.36
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 63.86s | valid loss  4.72 | valid ppl   111.80
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.02 | ms/batch 46.79 | loss  3.17 | ppl    23.83
| epoch  40 |   400/ 1327 batches | lr 0.02 | ms/batch 46.50 | loss  3.16 | ppl    23.52
| epoch  40 |   600/ 1327 batches | lr 0.02 | ms/batch 46.37 | loss  3.15 | ppl    23.30
| epoch  40 |   800/ 1327 batches | lr 0.02 | ms/batch 46.83 | loss  3.10 | ppl    22.12
| epoch  40 |  1000/ 1327 batches | lr 0.02 | ms/batch 46.29 | loss  3.18 | ppl    23.94
| epoch  40 |  1200/ 1327 batches | lr 0.02 | ms/batch 46.28 | loss  3.01 | ppl    20.33
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 63.63s | valid loss  4.72 | valid ppl   111.78
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.8793333333333333
sparsity at layer rnn.weight_hh_l0 is 0.8793333333333333
sparsity at layer rnn.weight_ih_l1 is 0.8793333333333333
sparsity at layer rnn.weight_hh_l1 is 0.8793333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.9217330538085255
=========================================================================================
| End of training | test loss  4.65 | test ppl   104.83
=========================================================================================
python -u admm_prune.py --cuda --emsize 1500 --nhid 1500 --data ./data/ptb --arch ptb --config_file tmp.yaml --admm --rho 0.001 --sparsity_type balanced_row  --epoch 40 --dropout 0.50 --save sp90_epoch40_dropout0.50_lstm.pt --pretrained sp88_epoch40_dropout0.50_lstm.pt
debug
{'rnn.weight_ih_l0': 0.9, 'rnn.weight_hh_l0': 0.9, 'rnn.weight_ih_l1': 0.9, 'rnn.weight_hh_l1': 0.9}
{'rnn.weight_ih_l0': 0.9, 'rnn.weight_hh_l0': 0.9, 'rnn.weight_ih_l1': 0.9, 'rnn.weight_hh_l1': 0.9}
encoder.weight willnot be pruned
rnn.weight_ih_l0 will be pruned
rnn.weight_hh_l0 will be pruned
rnn.bias_ih_l0 willnot be pruned
rnn.bias_hh_l0 willnot be pruned
rnn.weight_ih_l1 will be pruned
rnn.weight_hh_l1 will be pruned
rnn.bias_ih_l1 willnot be pruned
rnn.bias_hh_l1 willnot be pruned
decoder.weight willnot be pruned
decoder.bias willnot be pruned
| epoch   1 |   200/ 1327 batches | lr 5.00 | ms/batch 50.41 | loss 35.74 | ppl 3313642638899939.00
| epoch   1 |   400/ 1327 batches | lr 5.00 | ms/batch 46.35 | loss 14.36 | ppl 1717998.15
| epoch   1 |   600/ 1327 batches | lr 5.00 | ms/batch 46.84 | loss  6.99 | ppl  1088.05
| epoch   1 |   800/ 1327 batches | lr 5.00 | ms/batch 48.29 | loss  4.54 | ppl    93.82
| epoch   1 |  1000/ 1327 batches | lr 5.00 | ms/batch 49.44 | loss  3.81 | ppl    45.19
| epoch   1 |  1200/ 1327 batches | lr 5.00 | ms/batch 49.97 | loss  3.40 | ppl    30.10
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 66.88s | valid loss  4.75 | valid ppl   115.94
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 5.00 | ms/batch 54.10 | loss  8.47 | ppl  4789.76
| epoch   2 |   400/ 1327 batches | lr 5.00 | ms/batch 50.33 | loss  4.12 | ppl    61.36
| epoch   2 |   600/ 1327 batches | lr 5.00 | ms/batch 50.66 | loss  3.24 | ppl    25.60
| epoch   2 |   800/ 1327 batches | lr 5.00 | ms/batch 51.25 | loss  3.03 | ppl    20.77
| epoch   2 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.21 | loss  3.06 | ppl    21.23
| epoch   2 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.19 | loss  2.89 | ppl    18.06
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 70.48s | valid loss  4.85 | valid ppl   127.29
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 5.00 | ms/batch 55.49 | loss  3.14 | ppl    23.15
| epoch   3 |   400/ 1327 batches | lr 5.00 | ms/batch 51.32 | loss  2.99 | ppl    19.95
| epoch   3 |   600/ 1327 batches | lr 5.00 | ms/batch 51.65 | loss  2.97 | ppl    19.56
| epoch   3 |   800/ 1327 batches | lr 5.00 | ms/batch 51.11 | loss  2.93 | ppl    18.68
| epoch   3 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.53 | loss  2.99 | ppl    19.98
| epoch   3 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.73 | loss  2.84 | ppl    17.10
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 71.38s | valid loss  4.87 | valid ppl   130.86
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 55.67 | loss  3.04 | ppl    20.99
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 51.49 | loss  2.96 | ppl    19.29
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 51.95 | loss  2.95 | ppl    19.08
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 51.99 | loss  2.90 | ppl    18.26
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 51.88 | loss  2.97 | ppl    19.49
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 51.91 | loss  2.82 | ppl    16.72
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 71.89s | valid loss  4.87 | valid ppl   129.95
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 56.03 | loss  3.07 | ppl    21.54
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 52.03 | loss  3.00 | ppl    20.16
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 52.07 | loss  3.00 | ppl    19.99
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 52.81 | loss  2.96 | ppl    19.25
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 52.83 | loss  3.02 | ppl    20.53
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.70 | loss  2.87 | ppl    17.72
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 72.69s | valid loss  4.84 | valid ppl   126.45
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 56.77 | loss  3.04 | ppl    20.88
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 52.47 | loss  3.00 | ppl    20.00
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 52.50 | loss  2.98 | ppl    19.78
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 53.57 | loss  2.94 | ppl    18.96
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 53.27 | loss  3.00 | ppl    20.17
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 52.82 | loss  2.86 | ppl    17.39
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 73.30s | valid loss  4.85 | valid ppl   127.69
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 2.50 | ms/batch 57.28 | loss  3.10 | ppl    22.11
| epoch   7 |   400/ 1327 batches | lr 2.50 | ms/batch 53.45 | loss  3.03 | ppl    20.68
| epoch   7 |   600/ 1327 batches | lr 2.50 | ms/batch 53.38 | loss  3.01 | ppl    20.26
| epoch   7 |   800/ 1327 batches | lr 2.50 | ms/batch 53.34 | loss  2.97 | ppl    19.48
| epoch   7 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.30 | loss  3.03 | ppl    20.68
| epoch   7 |  1200/ 1327 batches | lr 2.50 | ms/batch 53.37 | loss  2.88 | ppl    17.78
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 73.83s | valid loss  4.82 | valid ppl   123.73
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 2.50 | ms/batch 57.24 | loss  3.05 | ppl    21.18
| epoch   8 |   400/ 1327 batches | lr 2.50 | ms/batch 53.79 | loss  3.01 | ppl    20.36
| epoch   8 |   600/ 1327 batches | lr 2.50 | ms/batch 54.08 | loss  3.01 | ppl    20.31
| epoch   8 |   800/ 1327 batches | lr 2.50 | ms/batch 53.98 | loss  2.96 | ppl    19.29
| epoch   8 |  1000/ 1327 batches | lr 2.50 | ms/batch 53.97 | loss  3.02 | ppl    20.54
| epoch   8 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.08 | loss  2.87 | ppl    17.59
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 74.64s | valid loss  4.82 | valid ppl   123.75
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 2.50 | ms/batch 58.65 | loss  3.03 | ppl    20.76
| epoch   9 |   400/ 1327 batches | lr 2.50 | ms/batch 53.98 | loss  3.01 | ppl    20.19
| epoch   9 |   600/ 1327 batches | lr 2.50 | ms/batch 55.21 | loss  3.00 | ppl    20.15
| epoch   9 |   800/ 1327 batches | lr 2.50 | ms/batch 54.88 | loss  2.95 | ppl    19.11
| epoch   9 |  1000/ 1327 batches | lr 2.50 | ms/batch 54.94 | loss  3.02 | ppl    20.45
| epoch   9 |  1200/ 1327 batches | lr 2.50 | ms/batch 54.55 | loss  2.86 | ppl    17.49
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 75.78s | valid loss  4.82 | valid ppl   123.80
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 2.50 | ms/batch 59.17 | loss  3.04 | ppl    20.91
| epoch  10 |   400/ 1327 batches | lr 2.50 | ms/batch 54.92 | loss  3.02 | ppl    20.40
| epoch  10 |   600/ 1327 batches | lr 2.50 | ms/batch 54.53 | loss  3.01 | ppl    20.22
| epoch  10 |   800/ 1327 batches | lr 2.50 | ms/batch 55.46 | loss  2.96 | ppl    19.35
| epoch  10 |  1000/ 1327 batches | lr 2.50 | ms/batch 55.71 | loss  3.03 | ppl    20.61
| epoch  10 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.15 | loss  2.87 | ppl    17.71
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 76.23s | valid loss  4.82 | valid ppl   123.67
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 2.50 | ms/batch 58.98 | loss  2.81 | ppl    16.63
| epoch  11 |   400/ 1327 batches | lr 2.50 | ms/batch 55.20 | loss  2.81 | ppl    16.63
| epoch  11 |   600/ 1327 batches | lr 2.50 | ms/batch 55.14 | loss  2.80 | ppl    16.47
| epoch  11 |   800/ 1327 batches | lr 2.50 | ms/batch 55.14 | loss  2.76 | ppl    15.82
| epoch  11 |  1000/ 1327 batches | lr 2.50 | ms/batch 56.10 | loss  2.83 | ppl    16.99
| epoch  11 |  1200/ 1327 batches | lr 2.50 | ms/batch 55.81 | loss  2.69 | ppl    14.69
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 76.59s | valid loss  4.87 | valid ppl   130.41
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 60.13 | loss  2.88 | ppl    17.73
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 56.11 | loss  2.85 | ppl    17.31
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 55.72 | loss  2.83 | ppl    17.02
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 56.59 | loss  2.79 | ppl    16.27
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.55 | loss  2.86 | ppl    17.45
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.16 | loss  2.72 | ppl    15.13
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 77.64s | valid loss  4.85 | valid ppl   127.76
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 60.49 | loss  2.87 | ppl    17.69
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 56.08 | loss  2.85 | ppl    17.29
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 56.27 | loss  2.84 | ppl    17.19
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 57.57 | loss  2.80 | ppl    16.44
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 56.73 | loss  2.86 | ppl    17.47
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 56.68 | loss  2.72 | ppl    15.14
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 78.22s | valid loss  4.85 | valid ppl   128.03
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 61.11 | loss  3.04 | ppl    20.96
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 56.41 | loss  3.01 | ppl    20.38
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 56.86 | loss  3.00 | ppl    20.10
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 57.64 | loss  2.96 | ppl    19.24
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.21 | loss  3.02 | ppl    20.42
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.04 | loss  2.87 | ppl    17.58
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 78.78s | valid loss  4.81 | valid ppl   123.20
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 61.37 | loss  3.02 | ppl    20.54
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 57.53 | loss  3.01 | ppl    20.28
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 57.76 | loss  3.00 | ppl    20.01
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 57.72 | loss  2.94 | ppl    18.99
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 57.66 | loss  3.01 | ppl    20.38
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 57.64 | loss  2.86 | ppl    17.46
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 79.76s | valid loss  4.81 | valid ppl   122.69
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 61.61 | loss  3.04 | ppl    20.80
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 58.04 | loss  3.01 | ppl    20.31
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 58.56 | loss  3.00 | ppl    20.10
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 58.49 | loss  2.96 | ppl    19.23
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.28 | loss  3.03 | ppl    20.61
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.17 | loss  2.87 | ppl    17.62
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 80.43s | valid loss  4.80 | valid ppl   122.05
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 62.19 | loss  3.03 | ppl    20.73
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 58.32 | loss  3.01 | ppl    20.23
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 58.36 | loss  3.00 | ppl    20.10
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 59.04 | loss  2.95 | ppl    19.18
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 58.94 | loss  3.02 | ppl    20.53
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 58.83 | loss  2.86 | ppl    17.50
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 81.00s | valid loss  4.80 | valid ppl   121.80
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 1.25 | ms/batch 62.19 | loss  3.13 | ppl    22.98
| epoch  18 |   400/ 1327 batches | lr 1.25 | ms/batch 58.71 | loss  3.12 | ppl    22.57
| epoch  18 |   600/ 1327 batches | lr 1.25 | ms/batch 58.83 | loss  3.11 | ppl    22.38
| epoch  18 |   800/ 1327 batches | lr 1.25 | ms/batch 59.15 | loss  3.06 | ppl    21.33
| epoch  18 |  1000/ 1327 batches | lr 1.25 | ms/batch 59.58 | loss  3.12 | ppl    22.71
| epoch  18 |  1200/ 1327 batches | lr 1.25 | ms/batch 59.39 | loss  2.98 | ppl    19.60
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 81.48s | valid loss  4.78 | valid ppl   119.11
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 1.25 | ms/batch 62.77 | loss  3.12 | ppl    22.66
| epoch  19 |   400/ 1327 batches | lr 1.25 | ms/batch 59.33 | loss  3.10 | ppl    22.30
| epoch  19 |   600/ 1327 batches | lr 1.25 | ms/batch 59.27 | loss  3.10 | ppl    22.24
| epoch  19 |   800/ 1327 batches | lr 1.25 | ms/batch 59.89 | loss  3.05 | ppl    21.21
| epoch  19 |  1000/ 1327 batches | lr 1.25 | ms/batch 59.98 | loss  3.12 | ppl    22.66
| epoch  19 |  1200/ 1327 batches | lr 1.25 | ms/batch 59.93 | loss  2.97 | ppl    19.47
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 82.12s | valid loss  4.78 | valid ppl   118.95
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 1.25 | ms/batch 63.83 | loss  3.15 | ppl    23.25
| epoch  20 |   400/ 1327 batches | lr 1.25 | ms/batch 60.19 | loss  3.13 | ppl    22.88
| epoch  20 |   600/ 1327 batches | lr 1.25 | ms/batch 60.05 | loss  3.12 | ppl    22.65
| epoch  20 |   800/ 1327 batches | lr 1.25 | ms/batch 60.21 | loss  3.07 | ppl    21.53
| epoch  20 |  1000/ 1327 batches | lr 1.25 | ms/batch 60.49 | loss  3.14 | ppl    23.14
| epoch  20 |  1200/ 1327 batches | lr 1.25 | ms/batch 60.48 | loss  2.99 | ppl    19.82
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 83.07s | valid loss  4.77 | valid ppl   117.86
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 1.25 | ms/batch 64.07 | loss  2.83 | ppl    17.03
| epoch  21 |   400/ 1327 batches | lr 1.25 | ms/batch 60.28 | loss  2.83 | ppl    17.02
| epoch  21 |   600/ 1327 batches | lr 1.25 | ms/batch 60.20 | loss  2.83 | ppl    16.95
| epoch  21 |   800/ 1327 batches | lr 1.25 | ms/batch 60.35 | loss  2.79 | ppl    16.28
| epoch  21 |  1000/ 1327 batches | lr 1.25 | ms/batch 60.44 | loss  2.85 | ppl    17.32
| epoch  21 |  1200/ 1327 batches | lr 1.25 | ms/batch 60.61 | loss  2.71 | ppl    15.03
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 83.16s | valid loss  4.84 | valid ppl   126.03
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 0.62 | ms/batch 65.32 | loss  2.87 | ppl    17.67
| epoch  22 |   400/ 1327 batches | lr 0.62 | ms/batch 61.08 | loss  2.85 | ppl    17.26
| epoch  22 |   600/ 1327 batches | lr 0.62 | ms/batch 61.47 | loss  2.84 | ppl    17.13
| epoch  22 |   800/ 1327 batches | lr 0.62 | ms/batch 61.18 | loss  2.79 | ppl    16.36
| epoch  22 |  1000/ 1327 batches | lr 0.62 | ms/batch 61.77 | loss  2.86 | ppl    17.44
| epoch  22 |  1200/ 1327 batches | lr 0.62 | ms/batch 61.36 | loss  2.71 | ppl    15.07
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 84.60s | valid loss  4.83 | valid ppl   124.95
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 0.62 | ms/batch 65.43 | loss  2.87 | ppl    17.66
| epoch  23 |   400/ 1327 batches | lr 0.62 | ms/batch 61.24 | loss  2.86 | ppl    17.38
| epoch  23 |   600/ 1327 batches | lr 0.62 | ms/batch 61.89 | loss  2.85 | ppl    17.31
| epoch  23 |   800/ 1327 batches | lr 0.62 | ms/batch 62.29 | loss  2.80 | ppl    16.48
| epoch  23 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.05 | loss  2.86 | ppl    17.54
| epoch  23 |  1200/ 1327 batches | lr 0.62 | ms/batch 61.94 | loss  2.72 | ppl    15.21
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 85.16s | valid loss  4.83 | valid ppl   125.29
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.62 | ms/batch 66.21 | loss  3.06 | ppl    21.43
| epoch  24 |   400/ 1327 batches | lr 0.62 | ms/batch 62.11 | loss  3.04 | ppl    20.84
| epoch  24 |   600/ 1327 batches | lr 0.62 | ms/batch 62.29 | loss  3.03 | ppl    20.75
| epoch  24 |   800/ 1327 batches | lr 0.62 | ms/batch 62.32 | loss  2.97 | ppl    19.57
| epoch  24 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.46 | loss  3.05 | ppl    21.06
| epoch  24 |  1200/ 1327 batches | lr 0.62 | ms/batch 62.48 | loss  2.88 | ppl    17.89
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 85.79s | valid loss  4.79 | valid ppl   120.72
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.62 | ms/batch 66.05 | loss  3.04 | ppl    20.97
| epoch  25 |   400/ 1327 batches | lr 0.62 | ms/batch 62.67 | loss  3.02 | ppl    20.46
| epoch  25 |   600/ 1327 batches | lr 0.62 | ms/batch 62.73 | loss  3.01 | ppl    20.36
| epoch  25 |   800/ 1327 batches | lr 0.62 | ms/batch 63.05 | loss  2.97 | ppl    19.51
| epoch  25 |  1000/ 1327 batches | lr 0.62 | ms/batch 62.70 | loss  3.04 | ppl    20.88
| epoch  25 |  1200/ 1327 batches | lr 0.62 | ms/batch 62.76 | loss  2.89 | ppl    17.92
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 86.24s | valid loss  4.79 | valid ppl   120.44
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.62 | ms/batch 66.87 | loss  3.04 | ppl    20.94
| epoch  26 |   400/ 1327 batches | lr 0.62 | ms/batch 63.25 | loss  3.02 | ppl    20.58
| epoch  26 |   600/ 1327 batches | lr 0.62 | ms/batch 63.13 | loss  3.01 | ppl    20.30
| epoch  26 |   800/ 1327 batches | lr 0.62 | ms/batch 63.57 | loss  2.97 | ppl    19.51
| epoch  26 |  1000/ 1327 batches | lr 0.62 | ms/batch 63.57 | loss  3.04 | ppl    20.83
| epoch  26 |  1200/ 1327 batches | lr 0.62 | ms/batch 63.36 | loss  2.88 | ppl    17.81
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 87.09s | valid loss  4.79 | valid ppl   120.01
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.62 | ms/batch 67.26 | loss  3.12 | ppl    22.75
| epoch  27 |   400/ 1327 batches | lr 0.62 | ms/batch 63.78 | loss  3.11 | ppl    22.33
| epoch  27 |   600/ 1327 batches | lr 0.62 | ms/batch 63.97 | loss  3.10 | ppl    22.14
| epoch  27 |   800/ 1327 batches | lr 0.62 | ms/batch 64.18 | loss  3.05 | ppl    21.15
| epoch  27 |  1000/ 1327 batches | lr 0.62 | ms/batch 64.23 | loss  3.12 | ppl    22.64
| epoch  27 |  1200/ 1327 batches | lr 0.62 | ms/batch 64.42 | loss  2.96 | ppl    19.34
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 88.08s | valid loss  4.77 | valid ppl   118.16
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.62 | ms/batch 67.68 | loss  3.12 | ppl    22.62
| epoch  28 |   400/ 1327 batches | lr 0.62 | ms/batch 63.97 | loss  3.10 | ppl    22.27
| epoch  28 |   600/ 1327 batches | lr 0.62 | ms/batch 64.60 | loss  3.09 | ppl    22.01
| epoch  28 |   800/ 1327 batches | lr 0.62 | ms/batch 64.08 | loss  3.05 | ppl    21.08
| epoch  28 |  1000/ 1327 batches | lr 0.62 | ms/batch 64.14 | loss  3.12 | ppl    22.70
| epoch  28 |  1200/ 1327 batches | lr 0.62 | ms/batch 64.56 | loss  2.96 | ppl    19.36
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 88.42s | valid loss  4.77 | valid ppl   117.77
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.62 | ms/batch 68.42 | loss  3.13 | ppl    22.90
| epoch  29 |   400/ 1327 batches | lr 0.62 | ms/batch 64.64 | loss  3.12 | ppl    22.59
| epoch  29 |   600/ 1327 batches | lr 0.62 | ms/batch 65.25 | loss  3.11 | ppl    22.51
| epoch  29 |   800/ 1327 batches | lr 0.62 | ms/batch 64.96 | loss  3.06 | ppl    21.33
| epoch  29 |  1000/ 1327 batches | lr 0.62 | ms/batch 65.07 | loss  3.14 | ppl    23.12
| epoch  29 |  1200/ 1327 batches | lr 0.62 | ms/batch 65.29 | loss  2.98 | ppl    19.64
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 89.38s | valid loss  4.76 | valid ppl   117.15
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.62 | ms/batch 68.85 | loss  3.12 | ppl    22.76
| epoch  30 |   400/ 1327 batches | lr 0.62 | ms/batch 65.08 | loss  3.12 | ppl    22.65
| epoch  30 |   600/ 1327 batches | lr 0.62 | ms/batch 65.65 | loss  3.11 | ppl    22.41
| epoch  30 |   800/ 1327 batches | lr 0.62 | ms/batch 65.87 | loss  3.07 | ppl    21.47
| epoch  30 |  1000/ 1327 batches | lr 0.62 | ms/batch 65.69 | loss  3.13 | ppl    22.98
| epoch  30 |  1200/ 1327 batches | lr 0.62 | ms/batch 65.76 | loss  2.98 | ppl    19.60
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 89.98s | valid loss  4.76 | valid ppl   116.97
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.62 | ms/batch 69.69 | loss  3.13 | ppl    22.86
| epoch  31 |   400/ 1327 batches | lr 0.62 | ms/batch 65.95 | loss  3.12 | ppl    22.57
| epoch  31 |   600/ 1327 batches | lr 0.62 | ms/batch 66.14 | loss  3.11 | ppl    22.41
| epoch  31 |   800/ 1327 batches | lr 0.62 | ms/batch 66.09 | loss  3.06 | ppl    21.29
| epoch  31 |  1000/ 1327 batches | lr 0.62 | ms/batch 66.20 | loss  3.13 | ppl    22.96
| epoch  31 |  1200/ 1327 batches | lr 0.62 | ms/batch 66.15 | loss  2.98 | ppl    19.67
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 90.68s | valid loss  4.76 | valid ppl   116.92
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.62 | ms/batch 69.90 | loss  3.17 | ppl    23.86
| epoch  32 |   400/ 1327 batches | lr 0.62 | ms/batch 65.87 | loss  3.16 | ppl    23.65
| epoch  32 |   600/ 1327 batches | lr 0.62 | ms/batch 66.61 | loss  3.16 | ppl    23.59
| epoch  32 |   800/ 1327 batches | lr 0.62 | ms/batch 66.63 | loss  3.10 | ppl    22.20
| epoch  32 |  1000/ 1327 batches | lr 0.62 | ms/batch 66.60 | loss  3.18 | ppl    23.95
| epoch  32 |  1200/ 1327 batches | lr 0.62 | ms/batch 66.58 | loss  3.02 | ppl    20.58
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 91.24s | valid loss  4.75 | valid ppl   115.83
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.62 | ms/batch 70.51 | loss  3.16 | ppl    23.66
| epoch  33 |   400/ 1327 batches | lr 0.62 | ms/batch 66.69 | loss  3.16 | ppl    23.54
| epoch  33 |   600/ 1327 batches | lr 0.62 | ms/batch 66.92 | loss  3.15 | ppl    23.34
| epoch  33 |   800/ 1327 batches | lr 0.62 | ms/batch 67.40 | loss  3.10 | ppl    22.20
| epoch  33 |  1000/ 1327 batches | lr 0.62 | ms/batch 67.54 | loss  3.17 | ppl    23.90
| epoch  33 |  1200/ 1327 batches | lr 0.62 | ms/batch 67.11 | loss  3.02 | ppl    20.42
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 92.02s | valid loss  4.75 | valid ppl   115.61
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.62 | ms/batch 71.36 | loss  3.18 | ppl    23.95
| epoch  34 |   400/ 1327 batches | lr 0.62 | ms/batch 67.42 | loss  3.16 | ppl    23.67
| epoch  34 |   600/ 1327 batches | lr 0.62 | ms/batch 67.71 | loss  3.15 | ppl    23.34
| epoch  34 |   800/ 1327 batches | lr 0.62 | ms/batch 67.86 | loss  3.10 | ppl    22.20
| epoch  34 |  1000/ 1327 batches | lr 0.62 | ms/batch 67.76 | loss  3.17 | ppl    23.88
| epoch  34 |  1200/ 1327 batches | lr 0.62 | ms/batch 67.79 | loss  3.01 | ppl    20.31
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 92.80s | valid loss  4.75 | valid ppl   115.30
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.62 | ms/batch 71.51 | loss  3.18 | ppl    23.94
| epoch  35 |   400/ 1327 batches | lr 0.62 | ms/batch 67.69 | loss  3.16 | ppl    23.68
| epoch  35 |   600/ 1327 batches | lr 0.62 | ms/batch 67.79 | loss  3.15 | ppl    23.41
| epoch  35 |   800/ 1327 batches | lr 0.62 | ms/batch 67.71 | loss  3.10 | ppl    22.30
| epoch  35 |  1000/ 1327 batches | lr 0.62 | ms/batch 68.24 | loss  3.18 | ppl    24.03
| epoch  35 |  1200/ 1327 batches | lr 0.62 | ms/batch 68.05 | loss  3.02 | ppl    20.50
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 93.01s | valid loss  4.75 | valid ppl   115.36
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.31 | ms/batch 73.00 | loss  3.19 | ppl    24.23
| epoch  36 |   400/ 1327 batches | lr 0.31 | ms/batch 68.22 | loss  3.17 | ppl    23.70
| epoch  36 |   600/ 1327 batches | lr 0.31 | ms/batch 68.71 | loss  3.16 | ppl    23.64
| epoch  36 |   800/ 1327 batches | lr 0.31 | ms/batch 69.19 | loss  3.12 | ppl    22.55
| epoch  36 |  1000/ 1327 batches | lr 0.31 | ms/batch 68.90 | loss  3.18 | ppl    24.11
| epoch  36 |  1200/ 1327 batches | lr 0.31 | ms/batch 68.90 | loss  3.03 | ppl    20.62
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 94.31s | valid loss  4.74 | valid ppl   113.91
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.31 | ms/batch 72.78 | loss  3.18 | ppl    24.12
| epoch  37 |   400/ 1327 batches | lr 0.31 | ms/batch 69.29 | loss  3.17 | ppl    23.82
| epoch  37 |   600/ 1327 batches | lr 0.31 | ms/batch 69.30 | loss  3.16 | ppl    23.66
| epoch  37 |   800/ 1327 batches | lr 0.31 | ms/batch 69.82 | loss  3.12 | ppl    22.55
| epoch  37 |  1000/ 1327 batches | lr 0.31 | ms/batch 68.81 | loss  3.18 | ppl    24.10
| epoch  37 |  1200/ 1327 batches | lr 0.31 | ms/batch 69.52 | loss  3.03 | ppl    20.60
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 95.04s | valid loss  4.74 | valid ppl   113.93
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.31 | ms/batch 73.27 | loss  3.18 | ppl    24.01
| epoch  38 |   400/ 1327 batches | lr 0.31 | ms/batch 69.68 | loss  3.17 | ppl    23.87
| epoch  38 |   600/ 1327 batches | lr 0.31 | ms/batch 69.84 | loss  3.16 | ppl    23.61
| epoch  38 |   800/ 1327 batches | lr 0.31 | ms/batch 70.43 | loss  3.11 | ppl    22.41
| epoch  38 |  1000/ 1327 batches | lr 0.31 | ms/batch 69.87 | loss  3.18 | ppl    24.12
| epoch  38 |  1200/ 1327 batches | lr 0.31 | ms/batch 69.90 | loss  3.03 | ppl    20.64
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 95.74s | valid loss  4.73 | valid ppl   113.67
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.31 | ms/batch 73.80 | loss  3.19 | ppl    24.26
| epoch  39 |   400/ 1327 batches | lr 0.31 | ms/batch 70.02 | loss  3.18 | ppl    24.05
| epoch  39 |   600/ 1327 batches | lr 0.31 | ms/batch 70.56 | loss  3.17 | ppl    23.74
| epoch  39 |   800/ 1327 batches | lr 0.31 | ms/batch 70.17 | loss  3.12 | ppl    22.57
| epoch  39 |  1000/ 1327 batches | lr 0.31 | ms/batch 70.49 | loss  3.19 | ppl    24.22
| epoch  39 |  1200/ 1327 batches | lr 0.31 | ms/batch 70.21 | loss  3.03 | ppl    20.69
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 96.26s | valid loss  4.73 | valid ppl   113.61
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.31 | ms/batch 74.71 | loss  3.19 | ppl    24.32
| epoch  40 |   400/ 1327 batches | lr 0.31 | ms/batch 70.16 | loss  3.18 | ppl    24.00
| epoch  40 |   600/ 1327 batches | lr 0.31 | ms/batch 71.18 | loss  3.18 | ppl    24.05
| epoch  40 |   800/ 1327 batches | lr 0.31 | ms/batch 70.95 | loss  3.12 | ppl    22.66
| epoch  40 |  1000/ 1327 batches | lr 0.31 | ms/batch 71.37 | loss  3.19 | ppl    24.40
| epoch  40 |  1200/ 1327 batches | lr 0.31 | ms/batch 70.75 | loss  3.03 | ppl    20.78
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 97.21s | valid loss  4.73 | valid ppl   113.47
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.8993333333333333
sparsity at layer rnn.weight_hh_l0 is 0.8993333333333333
sparsity at layer rnn.weight_ih_l1 is 0.8993333333333333
sparsity at layer rnn.weight_hh_l1 is 0.8993333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.9628836545324768
| epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 45.33 | loss  2.34 | ppl    10.42
| epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 45.87 | loss  2.38 | ppl    10.79
| epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 45.79 | loss  2.39 | ppl    10.96
| epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 46.83 | loss  2.37 | ppl    10.74
| epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.68 | loss  2.45 | ppl    11.63
| epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.14 | loss  2.34 | ppl    10.34
-----------------------------------------------------------------------------------------
| end of epoch   1 | time: 63.15s | valid loss  5.18 | valid ppl   178.01
-----------------------------------------------------------------------------------------
| epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 46.35 | loss  2.41 | ppl    11.16
| epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 45.72 | loss  2.41 | ppl    11.11
| epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 45.95 | loss  2.41 | ppl    11.12
| epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 46.57 | loss  2.39 | ppl    10.95
| epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.15 | loss  2.47 | ppl    11.83
| epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.12 | loss  2.34 | ppl    10.34
-----------------------------------------------------------------------------------------
| end of epoch   2 | time: 63.11s | valid loss  5.19 | valid ppl   179.39
-----------------------------------------------------------------------------------------
| epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 47.32 | loss  2.42 | ppl    11.26
| epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 46.49 | loss  2.41 | ppl    11.18
| epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 46.66 | loss  2.42 | ppl    11.20
| epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 46.58 | loss  2.39 | ppl    10.93
| epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 46.54 | loss  2.46 | ppl    11.76
| epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 46.63 | loss  2.34 | ppl    10.37
-----------------------------------------------------------------------------------------
| end of epoch   3 | time: 63.81s | valid loss  5.21 | valid ppl   183.35
-----------------------------------------------------------------------------------------
| epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 46.86 | loss  2.52 | ppl    12.44
| epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 46.62 | loss  2.48 | ppl    11.89
| epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 46.73 | loss  2.45 | ppl    11.55
| epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 46.46 | loss  2.40 | ppl    11.07
| epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.38 | loss  2.45 | ppl    11.59
| epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.45 | loss  2.31 | ppl    10.10
-----------------------------------------------------------------------------------------
| end of epoch   4 | time: 63.65s | valid loss  5.15 | valid ppl   172.24
-----------------------------------------------------------------------------------------
| epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 46.74 | loss  2.52 | ppl    12.43
| epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 46.57 | loss  2.49 | ppl    12.02
| epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 46.25 | loss  2.46 | ppl    11.74
| epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 46.66 | loss  2.42 | ppl    11.30
| epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.67 | loss  2.48 | ppl    11.94
| epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.48 | loss  2.34 | ppl    10.34
-----------------------------------------------------------------------------------------
| end of epoch   5 | time: 63.69s | valid loss  5.12 | valid ppl   167.67
-----------------------------------------------------------------------------------------
| epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 46.21 | loss  2.45 | ppl    11.58
| epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 45.89 | loss  2.43 | ppl    11.32
| epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 46.83 | loss  2.41 | ppl    11.13
| epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 46.16 | loss  2.37 | ppl    10.69
| epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.47 | loss  2.43 | ppl    11.38
| epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.30 | loss  2.29 | ppl     9.86
-----------------------------------------------------------------------------------------
| end of epoch   6 | time: 63.32s | valid loss  5.15 | valid ppl   172.24
-----------------------------------------------------------------------------------------
| epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 47.44 | loss  3.06 | ppl    21.26
| epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 46.59 | loss  3.00 | ppl    20.18
| epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 46.49 | loss  2.99 | ppl    19.88
| epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 46.49 | loss  2.94 | ppl    18.91
| epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.56 | loss  3.01 | ppl    20.21
| epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.40 | loss  2.87 | ppl    17.66
-----------------------------------------------------------------------------------------
| end of epoch   7 | time: 63.79s | valid loss  4.92 | valid ppl   136.56
-----------------------------------------------------------------------------------------
| epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch 46.69 | loss  3.00 | ppl    20.05
| epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch 46.66 | loss  2.98 | ppl    19.68
| epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch 46.30 | loss  2.97 | ppl    19.43
| epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch 46.25 | loss  2.92 | ppl    18.62
| epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.78 | loss  3.00 | ppl    20.08
| epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.54 | loss  2.85 | ppl    17.30
-----------------------------------------------------------------------------------------
| end of epoch   8 | time: 63.64s | valid loss  4.90 | valid ppl   134.06
-----------------------------------------------------------------------------------------
| epoch   9 |   200/ 1327 batches | lr 5.00 | ms/batch 46.11 | loss  3.01 | ppl    20.21
| epoch   9 |   400/ 1327 batches | lr 5.00 | ms/batch 46.35 | loss  2.99 | ppl    19.84
| epoch   9 |   600/ 1327 batches | lr 5.00 | ms/batch 46.04 | loss  2.98 | ppl    19.69
| epoch   9 |   800/ 1327 batches | lr 5.00 | ms/batch 46.07 | loss  2.94 | ppl    18.92
| epoch   9 |  1000/ 1327 batches | lr 5.00 | ms/batch 45.87 | loss  3.00 | ppl    20.16
| epoch   9 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.55 | loss  2.87 | ppl    17.57
-----------------------------------------------------------------------------------------
| end of epoch   9 | time: 63.17s | valid loss  4.89 | valid ppl   132.59
-----------------------------------------------------------------------------------------
| epoch  10 |   200/ 1327 batches | lr 5.00 | ms/batch 46.72 | loss  2.99 | ppl    19.87
| epoch  10 |   400/ 1327 batches | lr 5.00 | ms/batch 46.55 | loss  2.98 | ppl    19.73
| epoch  10 |   600/ 1327 batches | lr 5.00 | ms/batch 46.46 | loss  2.98 | ppl    19.59
| epoch  10 |   800/ 1327 batches | lr 5.00 | ms/batch 46.20 | loss  2.92 | ppl    18.62
| epoch  10 |  1000/ 1327 batches | lr 5.00 | ms/batch 46.41 | loss  3.00 | ppl    20.09
| epoch  10 |  1200/ 1327 batches | lr 5.00 | ms/batch 46.46 | loss  2.85 | ppl    17.28
-----------------------------------------------------------------------------------------
| end of epoch  10 | time: 63.53s | valid loss  4.89 | valid ppl   133.15
-----------------------------------------------------------------------------------------
| epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 47.32 | loss  3.03 | ppl    20.74
| epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 46.70 | loss  3.02 | ppl    20.39
| epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 46.57 | loss  3.00 | ppl    20.09
| epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 46.62 | loss  2.94 | ppl    19.00
| epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.50 | loss  3.02 | ppl    20.41
| epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.63 | loss  2.87 | ppl    17.55
-----------------------------------------------------------------------------------------
| end of epoch  11 | time: 63.87s | valid loss  4.85 | valid ppl   127.77
-----------------------------------------------------------------------------------------
| epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 46.44 | loss  3.01 | ppl    20.34
| epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 46.62 | loss  2.98 | ppl    19.75
| epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 46.58 | loss  2.99 | ppl    19.88
| epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 46.58 | loss  2.94 | ppl    18.86
| epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.36 | loss  3.00 | ppl    20.12
| epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.55 | loss  2.86 | ppl    17.48
-----------------------------------------------------------------------------------------
| end of epoch  12 | time: 63.62s | valid loss  4.85 | valid ppl   128.17
-----------------------------------------------------------------------------------------
| epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 46.98 | loss  3.11 | ppl    22.49
| epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 46.53 | loss  3.09 | ppl    22.03
| epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 46.28 | loss  3.08 | ppl    21.86
| epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 46.21 | loss  3.04 | ppl    20.80
| epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.12 | loss  3.11 | ppl    22.38
| epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.14 | loss  2.96 | ppl    19.26
-----------------------------------------------------------------------------------------
| end of epoch  13 | time: 63.43s | valid loss  4.82 | valid ppl   123.53
-----------------------------------------------------------------------------------------
| epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 46.77 | loss  3.10 | ppl    22.17
| epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 46.66 | loss  3.09 | ppl    21.92
| epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 46.67 | loss  3.08 | ppl    21.77
| epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 46.23 | loss  3.03 | ppl    20.66
| epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.50 | loss  3.10 | ppl    22.15
| epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.83 | loss  2.95 | ppl    19.17
-----------------------------------------------------------------------------------------
| end of epoch  14 | time: 63.69s | valid loss  4.81 | valid ppl   123.15
-----------------------------------------------------------------------------------------
| epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 46.56 | loss  3.16 | ppl    23.59
| epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 46.16 | loss  3.14 | ppl    23.12
| epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 46.75 | loss  3.14 | ppl    23.02
| epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 46.24 | loss  3.09 | ppl    21.90
| epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.54 | loss  3.16 | ppl    23.62
| epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.60 | loss  3.01 | ppl    20.30
-----------------------------------------------------------------------------------------
| end of epoch  15 | time: 63.57s | valid loss  4.79 | valid ppl   120.52
-----------------------------------------------------------------------------------------
| epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 45.91 | loss  3.15 | ppl    23.39
| epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 46.34 | loss  3.14 | ppl    23.09
| epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 46.49 | loss  3.13 | ppl    22.91
| epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 46.24 | loss  3.09 | ppl    21.94
| epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.12 | loss  3.16 | ppl    23.47
| epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.10 | loss  3.00 | ppl    20.16
-----------------------------------------------------------------------------------------
| end of epoch  16 | time: 63.25s | valid loss  4.79 | valid ppl   120.12
-----------------------------------------------------------------------------------------
| epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 46.52 | loss  3.16 | ppl    23.49
| epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 46.53 | loss  3.14 | ppl    23.19
| epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 46.56 | loss  3.14 | ppl    23.18
| epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 46.65 | loss  3.09 | ppl    21.94
| epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.55 | loss  3.16 | ppl    23.51
| epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.28 | loss  3.01 | ppl    20.34
-----------------------------------------------------------------------------------------
| end of epoch  17 | time: 63.54s | valid loss  4.78 | valid ppl   119.37
-----------------------------------------------------------------------------------------
| epoch  18 |   200/ 1327 batches | lr 1.25 | ms/batch 46.48 | loss  3.15 | ppl    23.35
| epoch  18 |   400/ 1327 batches | lr 1.25 | ms/batch 46.92 | loss  3.14 | ppl    23.00
| epoch  18 |   600/ 1327 batches | lr 1.25 | ms/batch 46.68 | loss  3.13 | ppl    22.91
| epoch  18 |   800/ 1327 batches | lr 1.25 | ms/batch 46.53 | loss  3.09 | ppl    21.87
| epoch  18 |  1000/ 1327 batches | lr 1.25 | ms/batch 46.47 | loss  3.14 | ppl    23.19
| epoch  18 |  1200/ 1327 batches | lr 1.25 | ms/batch 46.51 | loss  3.01 | ppl    20.23
-----------------------------------------------------------------------------------------
| end of epoch  18 | time: 63.66s | valid loss  4.78 | valid ppl   119.47
-----------------------------------------------------------------------------------------
| epoch  19 |   200/ 1327 batches | lr 0.31 | ms/batch 47.04 | loss  3.21 | ppl    24.69
| epoch  19 |   400/ 1327 batches | lr 0.31 | ms/batch 46.53 | loss  3.20 | ppl    24.58
| epoch  19 |   600/ 1327 batches | lr 0.31 | ms/batch 46.11 | loss  3.20 | ppl    24.53
| epoch  19 |   800/ 1327 batches | lr 0.31 | ms/batch 46.80 | loss  3.14 | ppl    22.99
| epoch  19 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.63 | loss  3.21 | ppl    24.67
| epoch  19 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.52 | loss  3.05 | ppl    21.03
-----------------------------------------------------------------------------------------
| end of epoch  19 | time: 63.65s | valid loss  4.75 | valid ppl   115.70
-----------------------------------------------------------------------------------------
| epoch  20 |   200/ 1327 batches | lr 0.31 | ms/batch 46.54 | loss  3.20 | ppl    24.65
| epoch  20 |   400/ 1327 batches | lr 0.31 | ms/batch 46.14 | loss  3.19 | ppl    24.29
| epoch  20 |   600/ 1327 batches | lr 0.31 | ms/batch 46.40 | loss  3.18 | ppl    24.07
| epoch  20 |   800/ 1327 batches | lr 0.31 | ms/batch 46.28 | loss  3.12 | ppl    22.71
| epoch  20 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.51 | loss  3.21 | ppl    24.79
| epoch  20 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.46 | loss  3.05 | ppl    21.05
-----------------------------------------------------------------------------------------
| end of epoch  20 | time: 63.43s | valid loss  4.75 | valid ppl   115.24
-----------------------------------------------------------------------------------------
| epoch  21 |   200/ 1327 batches | lr 0.31 | ms/batch 46.64 | loss  3.20 | ppl    24.55
| epoch  21 |   400/ 1327 batches | lr 0.31 | ms/batch 46.35 | loss  3.19 | ppl    24.22
| epoch  21 |   600/ 1327 batches | lr 0.31 | ms/batch 46.29 | loss  3.18 | ppl    23.93
| epoch  21 |   800/ 1327 batches | lr 0.31 | ms/batch 46.47 | loss  3.12 | ppl    22.72
| epoch  21 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.52 | loss  3.21 | ppl    24.86
| epoch  21 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.41 | loss  3.05 | ppl    21.10
-----------------------------------------------------------------------------------------
| end of epoch  21 | time: 63.52s | valid loss  4.74 | valid ppl   114.86
-----------------------------------------------------------------------------------------
| epoch  22 |   200/ 1327 batches | lr 0.31 | ms/batch 46.67 | loss  3.19 | ppl    24.30
| epoch  22 |   400/ 1327 batches | lr 0.31 | ms/batch 46.62 | loss  3.18 | ppl    24.10
| epoch  22 |   600/ 1327 batches | lr 0.31 | ms/batch 46.57 | loss  3.18 | ppl    24.05
| epoch  22 |   800/ 1327 batches | lr 0.31 | ms/batch 46.44 | loss  3.13 | ppl    22.83
| epoch  22 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.26 | loss  3.20 | ppl    24.56
| epoch  22 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.21 | loss  3.05 | ppl    21.09
-----------------------------------------------------------------------------------------
| end of epoch  22 | time: 63.52s | valid loss  4.74 | valid ppl   114.94
-----------------------------------------------------------------------------------------
| epoch  23 |   200/ 1327 batches | lr 0.31 | ms/batch 47.01 | loss  3.19 | ppl    24.39
| epoch  23 |   400/ 1327 batches | lr 0.31 | ms/batch 46.48 | loss  3.19 | ppl    24.24
| epoch  23 |   600/ 1327 batches | lr 0.31 | ms/batch 45.87 | loss  3.19 | ppl    24.18
| epoch  23 |   800/ 1327 batches | lr 0.31 | ms/batch 45.86 | loss  3.12 | ppl    22.66
| epoch  23 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.80 | loss  3.20 | ppl    24.56
| epoch  23 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.37 | loss  3.05 | ppl    21.01
-----------------------------------------------------------------------------------------
| end of epoch  23 | time: 63.42s | valid loss  4.74 | valid ppl   114.78
-----------------------------------------------------------------------------------------
| epoch  24 |   200/ 1327 batches | lr 0.31 | ms/batch 46.20 | loss  3.19 | ppl    24.39
| epoch  24 |   400/ 1327 batches | lr 0.31 | ms/batch 46.64 | loss  3.18 | ppl    24.09
| epoch  24 |   600/ 1327 batches | lr 0.31 | ms/batch 46.50 | loss  3.17 | ppl    23.85
| epoch  24 |   800/ 1327 batches | lr 0.31 | ms/batch 46.72 | loss  3.13 | ppl    22.81
| epoch  24 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.59 | loss  3.20 | ppl    24.56
| epoch  24 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.63 | loss  3.05 | ppl    21.04
-----------------------------------------------------------------------------------------
| end of epoch  24 | time: 63.63s | valid loss  4.74 | valid ppl   114.55
-----------------------------------------------------------------------------------------
| epoch  25 |   200/ 1327 batches | lr 0.31 | ms/batch 46.22 | loss  3.19 | ppl    24.34
| epoch  25 |   400/ 1327 batches | lr 0.31 | ms/batch 46.63 | loss  3.18 | ppl    23.94
| epoch  25 |   600/ 1327 batches | lr 0.31 | ms/batch 46.51 | loss  3.17 | ppl    23.89
| epoch  25 |   800/ 1327 batches | lr 0.31 | ms/batch 46.59 | loss  3.12 | ppl    22.64
| epoch  25 |  1000/ 1327 batches | lr 0.31 | ms/batch 46.60 | loss  3.20 | ppl    24.61
| epoch  25 |  1200/ 1327 batches | lr 0.31 | ms/batch 46.24 | loss  3.04 | ppl    20.90
-----------------------------------------------------------------------------------------
| end of epoch  25 | time: 63.55s | valid loss  4.74 | valid ppl   114.58
-----------------------------------------------------------------------------------------
| epoch  26 |   200/ 1327 batches | lr 0.08 | ms/batch 46.96 | loss  3.21 | ppl    24.81
| epoch  26 |   400/ 1327 batches | lr 0.08 | ms/batch 46.73 | loss  3.21 | ppl    24.72
| epoch  26 |   600/ 1327 batches | lr 0.08 | ms/batch 46.57 | loss  3.20 | ppl    24.55
| epoch  26 |   800/ 1327 batches | lr 0.08 | ms/batch 46.64 | loss  3.14 | ppl    23.16
| epoch  26 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.22 | loss  3.22 | ppl    25.06
| epoch  26 |  1200/ 1327 batches | lr 0.08 | ms/batch 45.98 | loss  3.06 | ppl    21.29
-----------------------------------------------------------------------------------------
| end of epoch  26 | time: 63.62s | valid loss  4.73 | valid ppl   113.77
-----------------------------------------------------------------------------------------
| epoch  27 |   200/ 1327 batches | lr 0.08 | ms/batch 46.49 | loss  3.21 | ppl    24.74
| epoch  27 |   400/ 1327 batches | lr 0.08 | ms/batch 46.16 | loss  3.20 | ppl    24.45
| epoch  27 |   600/ 1327 batches | lr 0.08 | ms/batch 46.00 | loss  3.20 | ppl    24.52
| epoch  27 |   800/ 1327 batches | lr 0.08 | ms/batch 45.79 | loss  3.14 | ppl    23.14
| epoch  27 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.90 | loss  3.22 | ppl    24.91
| epoch  27 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.41 | loss  3.06 | ppl    21.37
-----------------------------------------------------------------------------------------
| end of epoch  27 | time: 63.31s | valid loss  4.73 | valid ppl   113.39
-----------------------------------------------------------------------------------------
| epoch  28 |   200/ 1327 batches | lr 0.08 | ms/batch 46.54 | loss  3.21 | ppl    24.73
| epoch  28 |   400/ 1327 batches | lr 0.08 | ms/batch 46.26 | loss  3.20 | ppl    24.51
| epoch  28 |   600/ 1327 batches | lr 0.08 | ms/batch 46.25 | loss  3.19 | ppl    24.33
| epoch  28 |   800/ 1327 batches | lr 0.08 | ms/batch 46.99 | loss  3.14 | ppl    23.10
| epoch  28 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.48 | loss  3.22 | ppl    24.95
| epoch  28 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.43 | loss  3.06 | ppl    21.36
-----------------------------------------------------------------------------------------
| end of epoch  28 | time: 63.56s | valid loss  4.73 | valid ppl   113.26
-----------------------------------------------------------------------------------------
| epoch  29 |   200/ 1327 batches | lr 0.08 | ms/batch 46.84 | loss  3.20 | ppl    24.62
| epoch  29 |   400/ 1327 batches | lr 0.08 | ms/batch 46.20 | loss  3.19 | ppl    24.25
| epoch  29 |   600/ 1327 batches | lr 0.08 | ms/batch 46.39 | loss  3.19 | ppl    24.21
| epoch  29 |   800/ 1327 batches | lr 0.08 | ms/batch 46.82 | loss  3.14 | ppl    23.12
| epoch  29 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.41 | loss  3.21 | ppl    24.80
| epoch  29 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.42 | loss  3.07 | ppl    21.49
-----------------------------------------------------------------------------------------
| end of epoch  29 | time: 63.57s | valid loss  4.73 | valid ppl   113.11
-----------------------------------------------------------------------------------------
| epoch  30 |   200/ 1327 batches | lr 0.08 | ms/batch 46.33 | loss  3.21 | ppl    24.75
| epoch  30 |   400/ 1327 batches | lr 0.08 | ms/batch 46.43 | loss  3.19 | ppl    24.25
| epoch  30 |   600/ 1327 batches | lr 0.08 | ms/batch 46.21 | loss  3.19 | ppl    24.38
| epoch  30 |   800/ 1327 batches | lr 0.08 | ms/batch 45.86 | loss  3.14 | ppl    23.11
| epoch  30 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.20 | loss  3.21 | ppl    24.81
| epoch  30 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.34 | loss  3.06 | ppl    21.40
-----------------------------------------------------------------------------------------
| end of epoch  30 | time: 63.22s | valid loss  4.73 | valid ppl   113.04
-----------------------------------------------------------------------------------------
| epoch  31 |   200/ 1327 batches | lr 0.08 | ms/batch 46.45 | loss  3.20 | ppl    24.65
| epoch  31 |   400/ 1327 batches | lr 0.08 | ms/batch 46.55 | loss  3.20 | ppl    24.48
| epoch  31 |   600/ 1327 batches | lr 0.08 | ms/batch 46.70 | loss  3.19 | ppl    24.20
| epoch  31 |   800/ 1327 batches | lr 0.08 | ms/batch 46.10 | loss  3.13 | ppl    22.96
| epoch  31 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.60 | loss  3.21 | ppl    24.85
| epoch  31 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.48 | loss  3.07 | ppl    21.49
-----------------------------------------------------------------------------------------
| end of epoch  31 | time: 63.54s | valid loss  4.73 | valid ppl   113.01
-----------------------------------------------------------------------------------------
| epoch  32 |   200/ 1327 batches | lr 0.08 | ms/batch 46.63 | loss  3.20 | ppl    24.47
| epoch  32 |   400/ 1327 batches | lr 0.08 | ms/batch 46.14 | loss  3.19 | ppl    24.29
| epoch  32 |   600/ 1327 batches | lr 0.08 | ms/batch 46.14 | loss  3.19 | ppl    24.37
| epoch  32 |   800/ 1327 batches | lr 0.08 | ms/batch 46.54 | loss  3.14 | ppl    23.05
| epoch  32 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.83 | loss  3.22 | ppl    24.94
| epoch  32 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.43 | loss  3.06 | ppl    21.33
-----------------------------------------------------------------------------------------
| end of epoch  32 | time: 63.50s | valid loss  4.73 | valid ppl   112.99
-----------------------------------------------------------------------------------------
| epoch  33 |   200/ 1327 batches | lr 0.08 | ms/batch 46.64 | loss  3.21 | ppl    24.73
| epoch  33 |   400/ 1327 batches | lr 0.08 | ms/batch 46.42 | loss  3.20 | ppl    24.42
| epoch  33 |   600/ 1327 batches | lr 0.08 | ms/batch 46.58 | loss  3.19 | ppl    24.25
| epoch  33 |   800/ 1327 batches | lr 0.08 | ms/batch 46.52 | loss  3.13 | ppl    22.97
| epoch  33 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.22 | loss  3.22 | ppl    25.01
| epoch  33 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.62 | loss  3.06 | ppl    21.37
-----------------------------------------------------------------------------------------
| end of epoch  33 | time: 63.58s | valid loss  4.73 | valid ppl   112.94
-----------------------------------------------------------------------------------------
| epoch  34 |   200/ 1327 batches | lr 0.08 | ms/batch 46.29 | loss  3.20 | ppl    24.65
| epoch  34 |   400/ 1327 batches | lr 0.08 | ms/batch 46.31 | loss  3.19 | ppl    24.25
| epoch  34 |   600/ 1327 batches | lr 0.08 | ms/batch 46.56 | loss  3.19 | ppl    24.20
| epoch  34 |   800/ 1327 batches | lr 0.08 | ms/batch 46.22 | loss  3.13 | ppl    22.91
| epoch  34 |  1000/ 1327 batches | lr 0.08 | ms/batch 45.91 | loss  3.22 | ppl    25.10
| epoch  34 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.29 | loss  3.06 | ppl    21.38
-----------------------------------------------------------------------------------------
| end of epoch  34 | time: 63.29s | valid loss  4.73 | valid ppl   112.93
-----------------------------------------------------------------------------------------
| epoch  35 |   200/ 1327 batches | lr 0.08 | ms/batch 46.69 | loss  3.20 | ppl    24.58
| epoch  35 |   400/ 1327 batches | lr 0.08 | ms/batch 46.77 | loss  3.19 | ppl    24.25
| epoch  35 |   600/ 1327 batches | lr 0.08 | ms/batch 46.55 | loss  3.19 | ppl    24.30
| epoch  35 |   800/ 1327 batches | lr 0.08 | ms/batch 46.63 | loss  3.14 | ppl    23.08
| epoch  35 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.53 | loss  3.22 | ppl    25.01
| epoch  35 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.55 | loss  3.06 | ppl    21.41
-----------------------------------------------------------------------------------------
| end of epoch  35 | time: 63.70s | valid loss  4.73 | valid ppl   112.86
-----------------------------------------------------------------------------------------
| epoch  36 |   200/ 1327 batches | lr 0.08 | ms/batch 46.62 | loss  3.21 | ppl    24.69
| epoch  36 |   400/ 1327 batches | lr 0.08 | ms/batch 46.20 | loss  3.19 | ppl    24.30
| epoch  36 |   600/ 1327 batches | lr 0.08 | ms/batch 46.54 | loss  3.18 | ppl    24.11
| epoch  36 |   800/ 1327 batches | lr 0.08 | ms/batch 46.81 | loss  3.13 | ppl    22.97
| epoch  36 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.22 | loss  3.21 | ppl    24.87
| epoch  36 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.26 | loss  3.06 | ppl    21.34
-----------------------------------------------------------------------------------------
| end of epoch  36 | time: 63.49s | valid loss  4.73 | valid ppl   112.88
-----------------------------------------------------------------------------------------
| epoch  37 |   200/ 1327 batches | lr 0.08 | ms/batch 46.88 | loss  3.21 | ppl    24.66
| epoch  37 |   400/ 1327 batches | lr 0.08 | ms/batch 46.49 | loss  3.19 | ppl    24.34
| epoch  37 |   600/ 1327 batches | lr 0.08 | ms/batch 46.30 | loss  3.19 | ppl    24.24
| epoch  37 |   800/ 1327 batches | lr 0.08 | ms/batch 46.09 | loss  3.14 | ppl    23.05
| epoch  37 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.07 | loss  3.21 | ppl    24.86
| epoch  37 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.04 | loss  3.06 | ppl    21.35
-----------------------------------------------------------------------------------------
| end of epoch  37 | time: 63.30s | valid loss  4.73 | valid ppl   112.86
-----------------------------------------------------------------------------------------
| epoch  38 |   200/ 1327 batches | lr 0.08 | ms/batch 46.60 | loss  3.21 | ppl    24.67
| epoch  38 |   400/ 1327 batches | lr 0.08 | ms/batch 46.50 | loss  3.20 | ppl    24.42
| epoch  38 |   600/ 1327 batches | lr 0.08 | ms/batch 46.32 | loss  3.19 | ppl    24.25
| epoch  38 |   800/ 1327 batches | lr 0.08 | ms/batch 46.42 | loss  3.14 | ppl    23.14
| epoch  38 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.52 | loss  3.21 | ppl    24.88
| epoch  38 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.41 | loss  3.06 | ppl    21.40
-----------------------------------------------------------------------------------------
| end of epoch  38 | time: 63.51s | valid loss  4.73 | valid ppl   112.78
-----------------------------------------------------------------------------------------
| epoch  39 |   200/ 1327 batches | lr 0.08 | ms/batch 46.73 | loss  3.21 | ppl    24.69
| epoch  39 |   400/ 1327 batches | lr 0.08 | ms/batch 46.40 | loss  3.19 | ppl    24.31
| epoch  39 |   600/ 1327 batches | lr 0.08 | ms/batch 46.66 | loss  3.19 | ppl    24.33
| epoch  39 |   800/ 1327 batches | lr 0.08 | ms/batch 46.53 | loss  3.13 | ppl    22.95
| epoch  39 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.55 | loss  3.22 | ppl    25.05
| epoch  39 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.03 | loss  3.06 | ppl    21.36
-----------------------------------------------------------------------------------------
| end of epoch  39 | time: 63.49s | valid loss  4.73 | valid ppl   112.74
-----------------------------------------------------------------------------------------
| epoch  40 |   200/ 1327 batches | lr 0.08 | ms/batch 46.75 | loss  3.21 | ppl    24.71
| epoch  40 |   400/ 1327 batches | lr 0.08 | ms/batch 46.19 | loss  3.19 | ppl    24.36
| epoch  40 |   600/ 1327 batches | lr 0.08 | ms/batch 46.26 | loss  3.19 | ppl    24.20
| epoch  40 |   800/ 1327 batches | lr 0.08 | ms/batch 46.95 | loss  3.14 | ppl    23.07
| epoch  40 |  1000/ 1327 batches | lr 0.08 | ms/batch 46.57 | loss  3.22 | ppl    24.99
| epoch  40 |  1200/ 1327 batches | lr 0.08 | ms/batch 46.28 | loss  3.06 | ppl    21.28
-----------------------------------------------------------------------------------------
| end of epoch  40 | time: 63.56s | valid loss  4.73 | valid ppl   112.77
-----------------------------------------------------------------------------------------
sparsity at layer encoder.weight is 0.0
sparsity at layer rnn.weight_ih_l0 is 0.8993333333333333
sparsity at layer rnn.weight_hh_l0 is 0.8993333333333333
sparsity at layer rnn.weight_ih_l1 is 0.8993333333333333
sparsity at layer rnn.weight_hh_l1 is 0.8993333333333333
sparsity at layer decoder.weight is 0.0
overal compression rate is 1.9628836545324768
=========================================================================================
| End of training | test loss  4.66 | test ppl   105.89
=========================================================================================
