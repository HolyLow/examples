python main.py --cuda --epochs 6 --save model/prune/model.pt --data ./data/ptb --prune --retrain --sparsity 0.9
<class 'torch.Tensor'> torch.Size([10000, 200])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([10000, 200])
<class 'torch.Tensor'> torch.Size([10000])
RNNModel(
  (drop): Dropout(p=0.2)
  (encoder): Embedding(10000, 200)
  (rnn): LSTM(200, 200, num_layers=2, dropout=0.2)
  (decoder): Linear(in_features=200, out_features=10000, bias=True)
)
Dropout(p=0.2)
Embedding(10000, 200)
LSTM(200, 200, num_layers=2, dropout=0.2)
Linear(in_features=200, out_features=10000, bias=True)
| train-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch  8.14 | loss  6.93 | ppl  1026.28
| train-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch  8.05 | loss  6.31 | ppl   548.36
| train-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch  8.56 | loss  6.05 | ppl   423.46
| train-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch  8.22 | loss  5.77 | ppl   319.13
| train-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.24 | loss  5.62 | ppl   277.05
| train-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.20 | loss  5.47 | ppl   238.25
-----------------------------------------------------------------------------------------
| end of train epoch   1 | time: 10.82s | valid loss  5.38 | valid ppl   216.53
-----------------------------------------------------------------------------------------
| train-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch  7.25 | loss  5.39 | ppl   219.00
| train-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch  7.20 | loss  5.32 | ppl   204.30
| train-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch  7.23 | loss  5.27 | ppl   194.95
| train-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch  7.20 | loss  5.16 | ppl   174.84
| train-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.21 | loss  5.16 | ppl   173.71
| train-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.19 | loss  5.05 | ppl   155.32
-----------------------------------------------------------------------------------------
| end of train epoch   2 | time: 10.00s | valid loss  5.08 | valid ppl   160.57
-----------------------------------------------------------------------------------------
| train-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch  7.25 | loss  5.05 | ppl   155.55
| train-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch  7.19 | loss  5.02 | ppl   151.26
| train-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch  8.02 | loss  4.99 | ppl   147.43
| train-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch  7.85 | loss  4.91 | ppl   135.84
| train-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.83 | loss  4.94 | ppl   139.98
| train-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.82 | loss  4.83 | ppl   125.71
-----------------------------------------------------------------------------------------
| end of train epoch   3 | time: 10.67s | valid loss  4.94 | valid ppl   139.80
-----------------------------------------------------------------------------------------
| train-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch  7.84 | loss  4.86 | ppl   128.92
| train-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch  7.16 | loss  4.85 | ppl   127.58
| train-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch  7.13 | loss  4.83 | ppl   124.96
| train-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch  7.11 | loss  4.76 | ppl   116.30
| train-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.79 | loss  4.80 | ppl   121.98
| train-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.20 | loss  4.69 | ppl   109.08
-----------------------------------------------------------------------------------------
| end of train epoch   4 | time: 10.18s | valid loss  4.85 | valid ppl   128.38
-----------------------------------------------------------------------------------------
| train-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch  7.17 | loss  4.74 | ppl   114.03
| train-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch  7.18 | loss  4.73 | ppl   113.67
| train-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch  7.16 | loss  4.72 | ppl   111.69
| train-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch  7.13 | loss  4.65 | ppl   104.21
| train-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.14 | loss  4.71 | ppl   111.08
| train-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.14 | loss  4.59 | ppl    98.79
-----------------------------------------------------------------------------------------
| end of train epoch   5 | time:  9.92s | valid loss  4.81 | valid ppl   122.60
-----------------------------------------------------------------------------------------
| train-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch  7.19 | loss  4.64 | ppl   104.01
| train-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch  7.15 | loss  4.64 | ppl   103.65
| train-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch  7.12 | loss  4.63 | ppl   102.61
| train-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch  7.17 | loss  4.57 | ppl    96.14
| train-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.22 | loss  4.64 | ppl   103.08
| train-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.19 | loss  4.52 | ppl    91.70
-----------------------------------------------------------------------------------------
| end of train epoch   6 | time:  9.95s | valid loss  4.77 | valid ppl   118.37
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.57 | ppl    96.73
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch  7.46 | loss  4.56 | ppl    95.91
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch  7.46 | loss  4.55 | ppl    94.36
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch  7.51 | loss  4.48 | ppl    88.42
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.46 | loss  4.55 | ppl    94.83
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.53 | loss  4.43 | ppl    83.91
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   1 | time: 10.38s | valid loss  4.74 | valid ppl   114.44
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.50 | ppl    89.91
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch  7.50 | loss  4.50 | ppl    90.01
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch  7.74 | loss  4.48 | ppl    88.61
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch  7.93 | loss  4.43 | ppl    83.62
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.97 | loss  4.50 | ppl    90.00
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.96 | loss  4.37 | ppl    79.27
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   2 | time: 10.78s | valid loss  4.72 | valid ppl   111.65
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch  7.90 | loss  4.45 | ppl    85.52
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch  7.89 | loss  4.45 | ppl    85.42
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch  7.91 | loss  4.44 | ppl    84.53
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch  7.83 | loss  4.38 | ppl    80.14
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.79 | loss  4.46 | ppl    86.35
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.22 | loss  4.33 | ppl    76.24
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   3 | time: 10.50s | valid loss  4.71 | valid ppl   111.23
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch  6.71 | loss  4.41 | ppl    82.39
| prune-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch  7.30 | loss  4.41 | ppl    82.16
| prune-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch  8.28 | loss  4.40 | ppl    81.36
| prune-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch  8.38 | loss  4.34 | ppl    77.02
| prune-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.35 | loss  4.42 | ppl    83.34
| prune-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.40 | loss  4.30 | ppl    73.68
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   4 | time: 11.05s | valid loss  4.70 | valid ppl   109.47
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch  8.44 | loss  4.37 | ppl    79.40
| prune-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.37 | ppl    79.31
| prune-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.37 | ppl    78.72
| prune-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.31 | ppl    74.61
| prune-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.39 | ppl    80.80
| prune-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.27 | ppl    71.42
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   5 | time: 10.77s | valid loss  4.69 | valid ppl   108.98
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch  7.72 | loss  4.35 | ppl    77.15
| prune-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch  7.56 | loss  4.35 | ppl    77.17
| prune-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.34 | ppl    76.42
| prune-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch  7.61 | loss  4.28 | ppl    72.48
| prune-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.61 | loss  4.37 | ppl    78.75
| prune-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.62 | loss  4.25 | ppl    69.84
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   6 | time: 10.54s | valid loss  4.68 | valid ppl   108.23
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch  7.73 | loss  4.32 | ppl    74.88
| prune-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch  7.61 | loss  4.32 | ppl    74.94
| prune-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.31 | ppl    74.61
| prune-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.26 | ppl    70.85
| prune-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.34 | ppl    76.90
| prune-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.22 | ppl    67.92
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   7 | time: 10.54s | valid loss  4.69 | valid ppl   109.20
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.30 | ppl    73.60
| prune-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.30 | ppl    73.71
| prune-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch  7.61 | loss  4.28 | ppl    72.54
| prune-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.24 | ppl    69.10
| prune-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.69 | loss  4.31 | ppl    74.67
| prune-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.19 | ppl    65.94
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
-----------------------------------------------------------------------------------------
| end of prune epoch   8 | time: 10.57s | valid loss  4.68 | valid ppl   107.87
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch  7.73 | loss  4.27 | ppl    71.60
| prune-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.27 | ppl    71.72
| prune-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch  7.75 | loss  4.26 | ppl    71.15
| prune-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch  7.98 | loss  4.21 | ppl    67.46
| prune-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.01 | loss  4.29 | ppl    73.06
| prune-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.17 | ppl    64.63
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
-----------------------------------------------------------------------------------------
| end of prune epoch   9 | time: 10.86s | valid loss  4.68 | valid ppl   107.48
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch  8.13 | loss  4.25 | ppl    70.02
| prune-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch  8.02 | loss  4.25 | ppl    69.99
| prune-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch  8.02 | loss  4.25 | ppl    69.81
| prune-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.19 | ppl    66.28
| prune-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.28 | ppl    72.01
| prune-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.15 | ppl    63.61
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
-----------------------------------------------------------------------------------------
| end of prune epoch  10 | time: 11.07s | valid loss  4.68 | valid ppl   107.50
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch  8.12 | loss  4.25 | ppl    69.78
| prune-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.24 | ppl    69.34
| prune-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch  8.04 | loss  4.23 | ppl    68.96
| prune-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.18 | ppl    65.32
| prune-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.26 | ppl    70.65
| prune-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.98 | loss  4.13 | ppl    62.35
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
-----------------------------------------------------------------------------------------
| end of prune epoch  11 | time: 11.07s | valid loss  4.67 | valid ppl   106.84
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch  8.10 | loss  4.22 | ppl    67.77
| prune-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.22 | ppl    68.00
| prune-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.21 | ppl    67.20
| prune-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.16 | ppl    64.05
| prune-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.24 | ppl    69.23
| prune-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.98 | loss  4.12 | ppl    61.51
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
-----------------------------------------------------------------------------------------
| end of prune epoch  12 | time: 11.07s | valid loss  4.67 | valid ppl   106.48
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch  8.12 | loss  4.20 | ppl    66.50
| prune-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.19 | ppl    66.31
| prune-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.19 | ppl    66.08
| prune-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch  8.03 | loss  4.14 | ppl    62.90
| prune-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.99 | loss  4.22 | ppl    68.14
| prune-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.10 | ppl    60.28
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
-----------------------------------------------------------------------------------------
| end of prune epoch  13 | time: 11.08s | valid loss  4.66 | valid ppl   105.82
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch  8.10 | loss  4.18 | ppl    65.28
| prune-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch  7.99 | loss  4.18 | ppl    65.25
| prune-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.18 | ppl    65.19
| prune-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch  7.77 | loss  4.12 | ppl    61.71
| prune-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.55 | loss  4.21 | ppl    67.13
| prune-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.55 | loss  4.08 | ppl    59.35
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
-----------------------------------------------------------------------------------------
| end of prune epoch  14 | time: 10.78s | valid loss  4.66 | valid ppl   105.90
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.21 | ppl    67.45
| prune-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.20 | ppl    66.96
| prune-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch  7.56 | loss  4.19 | ppl    66.14
| prune-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.15 | ppl    63.13
| prune-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.53 | loss  4.21 | ppl    67.65
| prune-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.56 | loss  4.09 | ppl    59.73
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
-----------------------------------------------------------------------------------------
| end of prune epoch  15 | time: 10.48s | valid loss  4.66 | valid ppl   105.72
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  16 |   200/ 1327 batches | lr 20.00 | ms/batch  7.69 | loss  4.17 | ppl    64.99
| prune-epoch  16 |   400/ 1327 batches | lr 20.00 | ms/batch  7.55 | loss  4.17 | ppl    64.96
| prune-epoch  16 |   600/ 1327 batches | lr 20.00 | ms/batch  7.57 | loss  4.17 | ppl    64.40
| prune-epoch  16 |   800/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.12 | ppl    61.55
| prune-epoch  16 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.20 | ppl    66.42
| prune-epoch  16 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.07 | ppl    58.49
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
-----------------------------------------------------------------------------------------
| end of prune epoch  16 | time: 10.52s | valid loss  4.67 | valid ppl   106.38
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  17 |   200/ 1327 batches | lr 20.00 | ms/batch  7.49 | loss  4.29 | ppl    72.62
| prune-epoch  17 |   400/ 1327 batches | lr 20.00 | ms/batch  7.61 | loss  4.26 | ppl    70.87
| prune-epoch  17 |   600/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.24 | ppl    69.57
| prune-epoch  17 |   800/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.19 | ppl    65.90
| prune-epoch  17 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.61 | loss  4.26 | ppl    70.67
| prune-epoch  17 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.13 | ppl    62.29
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
-----------------------------------------------------------------------------------------
| end of prune epoch  17 | time: 10.50s | valid loss  4.66 | valid ppl   105.38
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  18 |   200/ 1327 batches | lr 20.00 | ms/batch  7.71 | loss  4.21 | ppl    67.56
| prune-epoch  18 |   400/ 1327 batches | lr 20.00 | ms/batch  7.61 | loss  4.21 | ppl    67.17
| prune-epoch  18 |   600/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.20 | ppl    66.98
| prune-epoch  18 |   800/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.15 | ppl    63.18
| prune-epoch  18 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.23 | ppl    68.53
| prune-epoch  18 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.10 | ppl    60.35
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
-----------------------------------------------------------------------------------------
| end of prune epoch  18 | time: 10.55s | valid loss  4.66 | valid ppl   105.59
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  19 |   200/ 1327 batches | lr 20.00 | ms/batch  7.69 | loss  4.28 | ppl    72.60
| prune-epoch  19 |   400/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.27 | ppl    71.36
| prune-epoch  19 |   600/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.25 | ppl    70.41
| prune-epoch  19 |   800/ 1327 batches | lr 20.00 | ms/batch  7.56 | loss  4.20 | ppl    66.41
| prune-epoch  19 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.27 | ppl    71.51
| prune-epoch  19 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.14 | ppl    63.07
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
-----------------------------------------------------------------------------------------
| end of prune epoch  19 | time: 10.53s | valid loss  4.66 | valid ppl   105.87
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  20 |   200/ 1327 batches | lr 20.00 | ms/batch  7.72 | loss  4.22 | ppl    68.32
| prune-epoch  20 |   400/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.22 | ppl    68.17
| prune-epoch  20 |   600/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.21 | ppl    67.49
| prune-epoch  20 |   800/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.16 | ppl    63.76
| prune-epoch  20 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.24 | ppl    69.13
| prune-epoch  20 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.11 | ppl    61.15
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
-----------------------------------------------------------------------------------------
| end of prune epoch  20 | time: 10.52s | valid loss  4.66 | valid ppl   105.77
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  21 |   200/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.19 | ppl    66.30
| prune-epoch  21 |   400/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.20 | ppl    66.42
| prune-epoch  21 |   600/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.19 | ppl    65.84
| prune-epoch  21 |   800/ 1327 batches | lr 20.00 | ms/batch  7.56 | loss  4.13 | ppl    62.48
| prune-epoch  21 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.21 | ppl    67.53
| prune-epoch  21 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.09 | ppl    59.78
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
-----------------------------------------------------------------------------------------
| end of prune epoch  21 | time: 10.53s | valid loss  4.66 | valid ppl   105.92
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  22 |   200/ 1327 batches | lr 20.00 | ms/batch  7.68 | loss  4.35 | ppl    77.44
| prune-epoch  22 |   400/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.31 | ppl    74.64
| prune-epoch  22 |   600/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.30 | ppl    73.71
| prune-epoch  22 |   800/ 1327 batches | lr 20.00 | ms/batch  8.06 | loss  4.25 | ppl    70.01
| prune-epoch  22 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.43 | loss  4.31 | ppl    74.24
| prune-epoch  22 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.39 | loss  4.19 | ppl    65.91
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of prune epoch  22 | time: 11.11s | valid loss  4.67 | valid ppl   106.59
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch  8.47 | loss  4.26 | ppl    71.02
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch  8.41 | loss  4.26 | ppl    70.78
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch  8.32 | loss  4.25 | ppl    70.22
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch  8.41 | loss  4.20 | ppl    66.43
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.38 | loss  4.27 | ppl    71.27
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.41 | loss  4.15 | ppl    63.34
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   1 | time: 11.63s | valid loss  4.67 | valid ppl   106.33
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch  8.52 | loss  4.23 | ppl    68.88
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch  8.39 | loss  4.23 | ppl    68.47
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch  8.37 | loss  4.22 | ppl    68.04
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch  8.39 | loss  4.17 | ppl    64.98
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.42 | loss  4.25 | ppl    69.99
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.43 | loss  4.12 | ppl    61.75
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   2 | time: 11.67s | valid loss  4.67 | valid ppl   106.73
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch  8.47 | loss  4.21 | ppl    67.15
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch  8.41 | loss  4.20 | ppl    66.90
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch  8.40 | loss  4.20 | ppl    66.44
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch  8.42 | loss  4.15 | ppl    63.37
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.41 | loss  4.22 | ppl    68.27
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.40 | loss  4.10 | ppl    60.58
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   3 | time: 11.66s | valid loss  4.67 | valid ppl   106.85
-----------------------------------------------------------------------------------------
required epochs   6 | actual epochs  31
pretrain epochs   6 | prune epochs  22 | retrain epochs   3
=========================================================================================
| End of training | test loss  4.63 | test ppl   102.64
=========================================================================================
python main.py --cuda --epochs 6 --tied --save model/prune/model.pt --data ./data/ptb --prune --retrain --sparsity 0.9
<class 'torch.Tensor'> torch.Size([10000, 200])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([10000])
RNNModel(
  (drop): Dropout(p=0.2)
  (encoder): Embedding(10000, 200)
  (rnn): LSTM(200, 200, num_layers=2, dropout=0.2)
  (decoder): Linear(in_features=200, out_features=10000, bias=True)
)
Dropout(p=0.2)
Embedding(10000, 200)
LSTM(200, 200, num_layers=2, dropout=0.2)
Linear(in_features=200, out_features=10000, bias=True)
| train-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch  7.34 | loss  6.90 | ppl   992.47
| train-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch  7.06 | loss  6.22 | ppl   501.02
| train-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch  7.07 | loss  5.89 | ppl   360.59
| train-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch  7.10 | loss  5.63 | ppl   277.83
| train-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch  6.97 | loss  5.51 | ppl   246.22
| train-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.03 | loss  5.36 | ppl   212.65
-----------------------------------------------------------------------------------------
| end of train epoch   1 | time:  9.83s | valid loss  5.27 | valid ppl   193.93
-----------------------------------------------------------------------------------------
| train-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch  7.49 | loss  5.29 | ppl   198.27
| train-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch  7.03 | loss  5.23 | ppl   186.17
| train-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch  6.99 | loss  5.18 | ppl   176.95
| train-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch  6.98 | loss  5.08 | ppl   160.04
| train-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch  6.90 | loss  5.08 | ppl   160.12
| train-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch  6.98 | loss  4.97 | ppl   143.96
-----------------------------------------------------------------------------------------
| end of train epoch   2 | time:  9.79s | valid loss  5.00 | valid ppl   148.05
-----------------------------------------------------------------------------------------
| train-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch  7.04 | loss  4.98 | ppl   145.36
| train-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch  7.00 | loss  4.96 | ppl   142.07
| train-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch  6.93 | loss  4.92 | ppl   137.68
| train-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch  6.93 | loss  4.85 | ppl   128.16
| train-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch  6.94 | loss  4.89 | ppl   132.55
| train-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch  6.94 | loss  4.78 | ppl   118.98
-----------------------------------------------------------------------------------------
| end of train epoch   3 | time:  9.66s | valid loss  4.87 | valid ppl   130.24
-----------------------------------------------------------------------------------------
| train-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch  6.99 | loss  4.81 | ppl   123.32
| train-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch  6.96 | loss  4.81 | ppl   122.45
| train-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch  7.00 | loss  4.79 | ppl   119.72
| train-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch  6.92 | loss  4.72 | ppl   112.31
| train-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch  6.95 | loss  4.77 | ppl   118.32
| train-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.00 | loss  4.66 | ppl   105.65
-----------------------------------------------------------------------------------------
| end of train epoch   4 | time:  9.67s | valid loss  4.79 | valid ppl   120.34
-----------------------------------------------------------------------------------------
| train-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch  7.03 | loss  4.71 | ppl   110.95
| train-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch  7.01 | loss  4.71 | ppl   111.07
| train-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch  7.02 | loss  4.70 | ppl   109.44
| train-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch  7.02 | loss  4.64 | ppl   103.20
| train-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch  6.98 | loss  4.69 | ppl   109.12
| train-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.04 | loss  4.58 | ppl    97.43
-----------------------------------------------------------------------------------------
| end of train epoch   5 | time:  9.73s | valid loss  4.75 | valid ppl   116.08
-----------------------------------------------------------------------------------------
| train-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch  7.04 | loss  4.64 | ppl   103.03
| train-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch  6.99 | loss  4.64 | ppl   103.59
| train-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch  7.03 | loss  4.63 | ppl   102.20
| train-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch  7.07 | loss  4.57 | ppl    96.70
| train-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.21 | loss  4.64 | ppl   103.81
| train-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.44 | loss  4.52 | ppl    91.96
-----------------------------------------------------------------------------------------
| end of train epoch   6 | time:  9.88s | valid loss  4.73 | valid ppl   113.31
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch  7.46 | loss  4.59 | ppl    98.37
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch  7.36 | loss  4.58 | ppl    97.81
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch  7.32 | loss  4.57 | ppl    96.09
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch  7.33 | loss  4.50 | ppl    90.22
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.33 | loss  4.57 | ppl    96.89
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.46 | loss  4.46 | ppl    86.06
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   1 | time: 10.21s | valid loss  4.69 | valid ppl   109.14
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch  7.48 | loss  4.52 | ppl    92.22
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch  7.39 | loss  4.53 | ppl    93.02
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch  7.34 | loss  4.52 | ppl    91.80
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch  7.40 | loss  4.46 | ppl    86.66
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.40 | loss  4.54 | ppl    93.27
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.38 | loss  4.41 | ppl    82.56
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   2 | time: 10.26s | valid loss  4.68 | valid ppl   107.74
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch  7.50 | loss  4.49 | ppl    89.24
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch  7.42 | loss  4.49 | ppl    89.56
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch  7.43 | loss  4.48 | ppl    88.53
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch  7.39 | loss  4.43 | ppl    83.94
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.41 | loss  4.50 | ppl    90.41
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.47 | loss  4.38 | ppl    79.78
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   3 | time: 10.29s | valid loss  4.67 | valid ppl   106.97
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch  7.57 | loss  4.46 | ppl    86.45
| prune-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch  7.40 | loss  4.47 | ppl    87.23
| prune-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch  7.43 | loss  4.46 | ppl    86.07
| prune-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch  7.43 | loss  4.41 | ppl    81.87
| prune-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.41 | loss  4.48 | ppl    88.64
| prune-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.44 | loss  4.36 | ppl    78.32
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   4 | time: 10.32s | valid loss  4.66 | valid ppl   105.99
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch  7.55 | loss  4.44 | ppl    84.50
| prune-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch  7.42 | loss  4.45 | ppl    85.28
| prune-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch  7.45 | loss  4.44 | ppl    84.45
| prune-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch  7.46 | loss  4.38 | ppl    79.82
| prune-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.42 | loss  4.46 | ppl    86.51
| prune-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.42 | loss  4.34 | ppl    76.86
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   5 | time: 10.47s | valid loss  4.66 | valid ppl   105.83
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch  8.29 | loss  4.42 | ppl    82.81
| prune-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch  8.07 | loss  4.43 | ppl    83.68
| prune-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch  8.07 | loss  4.41 | ppl    82.06
| prune-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch  8.10 | loss  4.37 | ppl    78.70
| prune-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.01 | loss  4.45 | ppl    85.60
| prune-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.13 | loss  4.32 | ppl    74.83
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   6 | time: 11.39s | valid loss  4.65 | valid ppl   104.57
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch  7.85 | loss  4.41 | ppl    81.97
| prune-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch  8.12 | loss  4.41 | ppl    82.27
| prune-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch  8.22 | loss  4.40 | ppl    81.66
| prune-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch  8.26 | loss  4.35 | ppl    77.63
| prune-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.25 | loss  4.42 | ppl    83.47
| prune-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.28 | loss  4.31 | ppl    74.17
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   7 | time: 11.33s | valid loss  4.65 | valid ppl   104.10
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch  8.35 | loss  4.39 | ppl    80.63
| prune-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch  8.26 | loss  4.39 | ppl    80.92
| prune-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch  8.28 | loss  4.38 | ppl    80.09
| prune-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch  8.29 | loss  4.34 | ppl    76.37
| prune-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.28 | loss  4.42 | ppl    83.05
| prune-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.25 | loss  4.29 | ppl    72.92
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   8 | time: 11.47s | valid loss  4.64 | valid ppl   103.63
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch  8.19 | loss  4.37 | ppl    79.20
| prune-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch  7.96 | loss  4.38 | ppl    79.84
| prune-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.37 | ppl    79.18
| prune-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.32 | ppl    75.56
| prune-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.74 | loss  4.41 | ppl    81.90
| prune-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.51 | loss  4.28 | ppl    72.48
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   9 | time: 10.86s | valid loss  4.64 | valid ppl   104.02
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.36 | ppl    78.46
| prune-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch  7.53 | loss  4.37 | ppl    78.70
| prune-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch  7.57 | loss  4.36 | ppl    77.89
| prune-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch  7.71 | loss  4.31 | ppl    74.08
| prune-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.38 | ppl    80.15
| prune-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.27 | ppl    71.19
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
-----------------------------------------------------------------------------------------
| end of prune epoch  10 | time: 10.52s | valid loss  4.64 | valid ppl   103.44
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.34 | ppl    77.01
| prune-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch  7.53 | loss  4.35 | ppl    77.42
| prune-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch  7.75 | loss  4.34 | ppl    76.89
| prune-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch  7.99 | loss  4.29 | ppl    73.05
| prune-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.97 | loss  4.37 | ppl    79.22
| prune-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.25 | ppl    70.05
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
-----------------------------------------------------------------------------------------
| end of prune epoch  11 | time: 10.83s | valid loss  4.63 | valid ppl   102.91
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch  8.10 | loss  4.33 | ppl    75.99
| prune-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.34 | ppl    76.59
| prune-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.33 | ppl    75.82
| prune-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.28 | ppl    72.29
| prune-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.36 | ppl    78.35
| prune-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.82 | loss  4.24 | ppl    69.29
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
-----------------------------------------------------------------------------------------
| end of prune epoch  12 | time: 10.98s | valid loss  4.64 | valid ppl   103.09
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch  7.71 | loss  4.33 | ppl    76.30
| prune-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.34 | ppl    76.60
| prune-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.32 | ppl    75.52
| prune-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.28 | ppl    71.98
| prune-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.35 | ppl    77.76
| prune-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.23 | ppl    68.66
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
-----------------------------------------------------------------------------------------
| end of prune epoch  13 | time: 10.55s | valid loss  4.63 | valid ppl   102.71
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch  7.71 | loss  4.31 | ppl    74.74
| prune-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.32 | ppl    75.20
| prune-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch  7.54 | loss  4.31 | ppl    74.44
| prune-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.26 | ppl    71.05
| prune-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.34 | ppl    76.69
| prune-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.51 | loss  4.22 | ppl    67.98
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
-----------------------------------------------------------------------------------------
| end of prune epoch  14 | time: 10.50s | valid loss  4.62 | valid ppl   101.59
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch  7.68 | loss  4.30 | ppl    73.55
| prune-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch  8.01 | loss  4.31 | ppl    74.57
| prune-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch  8.29 | loss  4.30 | ppl    73.62
| prune-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch  8.29 | loss  4.25 | ppl    69.93
| prune-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.27 | loss  4.33 | ppl    75.73
| prune-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.27 | loss  4.20 | ppl    66.93
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
-----------------------------------------------------------------------------------------
| end of prune epoch  15 | time: 11.29s | valid loss  4.62 | valid ppl   101.75
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  16 |   200/ 1327 batches | lr 20.00 | ms/batch  8.41 | loss  4.33 | ppl    76.14
| prune-epoch  16 |   400/ 1327 batches | lr 20.00 | ms/batch  8.28 | loss  4.33 | ppl    76.15
| prune-epoch  16 |   600/ 1327 batches | lr 20.00 | ms/batch  8.30 | loss  4.32 | ppl    75.22
| prune-epoch  16 |   800/ 1327 batches | lr 20.00 | ms/batch  8.37 | loss  4.27 | ppl    71.35
| prune-epoch  16 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.26 | loss  4.34 | ppl    76.69
| prune-epoch  16 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.28 | loss  4.22 | ppl    67.93
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
-----------------------------------------------------------------------------------------
| end of prune epoch  16 | time: 11.52s | valid loss  4.63 | valid ppl   102.02
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  17 |   200/ 1327 batches | lr 20.00 | ms/batch  8.35 | loss  4.31 | ppl    74.23
| prune-epoch  17 |   400/ 1327 batches | lr 20.00 | ms/batch  7.96 | loss  4.31 | ppl    74.18
| prune-epoch  17 |   600/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.30 | ppl    73.43
| prune-epoch  17 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.25 | ppl    70.03
| prune-epoch  17 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.33 | ppl    75.79
| prune-epoch  17 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.20 | ppl    66.81
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
-----------------------------------------------------------------------------------------
| end of prune epoch  17 | time: 11.10s | valid loss  4.62 | valid ppl   101.77
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  18 |   200/ 1327 batches | lr 20.00 | ms/batch  8.10 | loss  4.29 | ppl    72.73
| prune-epoch  18 |   400/ 1327 batches | lr 20.00 | ms/batch  8.01 | loss  4.30 | ppl    73.34
| prune-epoch  18 |   600/ 1327 batches | lr 20.00 | ms/batch  7.95 | loss  4.28 | ppl    72.45
| prune-epoch  18 |   800/ 1327 batches | lr 20.00 | ms/batch  7.91 | loss  4.24 | ppl    69.27
| prune-epoch  18 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.99 | loss  4.32 | ppl    74.96
| prune-epoch  18 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.97 | loss  4.19 | ppl    66.15
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
-----------------------------------------------------------------------------------------
| end of prune epoch  18 | time: 11.01s | valid loss  4.62 | valid ppl   101.63
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  19 |   200/ 1327 batches | lr 20.00 | ms/batch  8.09 | loss  4.28 | ppl    71.96
| prune-epoch  19 |   400/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.28 | ppl    72.49
| prune-epoch  19 |   600/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.27 | ppl    71.63
| prune-epoch  19 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.22 | ppl    68.33
| prune-epoch  19 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.31 | ppl    74.26
| prune-epoch  19 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.18 | ppl    65.59
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
-----------------------------------------------------------------------------------------
| end of prune epoch  19 | time: 11.06s | valid loss  4.61 | valid ppl   100.76
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  20 |   200/ 1327 batches | lr 20.00 | ms/batch  8.09 | loss  4.27 | ppl    71.36
| prune-epoch  20 |   400/ 1327 batches | lr 20.00 | ms/batch  7.93 | loss  4.27 | ppl    71.49
| prune-epoch  20 |   600/ 1327 batches | lr 20.00 | ms/batch  7.98 | loss  4.26 | ppl    70.86
| prune-epoch  20 |   800/ 1327 batches | lr 20.00 | ms/batch  7.88 | loss  4.22 | ppl    67.77
| prune-epoch  20 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.97 | loss  4.30 | ppl    73.48
| prune-epoch  20 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.17 | ppl    65.01
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
-----------------------------------------------------------------------------------------
| end of prune epoch  20 | time: 11.01s | valid loss  4.61 | valid ppl   100.93
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  21 |   200/ 1327 batches | lr 20.00 | ms/batch  8.02 | loss  4.37 | ppl    79.10
| prune-epoch  21 |   400/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.35 | ppl    77.50
| prune-epoch  21 |   600/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.33 | ppl    76.19
| prune-epoch  21 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.29 | ppl    72.62
| prune-epoch  21 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.36 | ppl    78.17
| prune-epoch  21 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.01 | loss  4.23 | ppl    68.73
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
-----------------------------------------------------------------------------------------
| end of prune epoch  21 | time: 11.04s | valid loss  4.62 | valid ppl   101.09
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  22 |   200/ 1327 batches | lr 20.00 | ms/batch  8.04 | loss  4.31 | ppl    74.63
| prune-epoch  22 |   400/ 1327 batches | lr 20.00 | ms/batch  7.90 | loss  4.32 | ppl    74.86
| prune-epoch  22 |   600/ 1327 batches | lr 20.00 | ms/batch  7.96 | loss  4.30 | ppl    73.85
| prune-epoch  22 |   800/ 1327 batches | lr 20.00 | ms/batch  7.91 | loss  4.26 | ppl    70.69
| prune-epoch  22 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.33 | ppl    76.14
| prune-epoch  22 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.21 | ppl    67.39
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
-----------------------------------------------------------------------------------------
| end of prune epoch  22 | time: 11.01s | valid loss  4.62 | valid ppl   101.38
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  23 |   200/ 1327 batches | lr 20.00 | ms/batch  8.10 | loss  4.39 | ppl    80.99
| prune-epoch  23 |   400/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.38 | ppl    80.04
| prune-epoch  23 |   600/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.36 | ppl    78.55
| prune-epoch  23 |   800/ 1327 batches | lr 20.00 | ms/batch  7.94 | loss  4.31 | ppl    74.66
| prune-epoch  23 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.38 | ppl    79.65
| prune-epoch  23 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.96 | loss  4.26 | ppl    70.85
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
-----------------------------------------------------------------------------------------
| end of prune epoch  23 | time: 11.03s | valid loss  4.62 | valid ppl   102.00
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  24 |   200/ 1327 batches | lr 20.00 | ms/batch  7.98 | loss  4.34 | ppl    76.89
| prune-epoch  24 |   400/ 1327 batches | lr 20.00 | ms/batch  7.99 | loss  4.34 | ppl    76.85
| prune-epoch  24 |   600/ 1327 batches | lr 20.00 | ms/batch  7.94 | loss  4.33 | ppl    75.82
| prune-epoch  24 |   800/ 1327 batches | lr 20.00 | ms/batch  7.56 | loss  4.29 | ppl    72.74
| prune-epoch  24 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.36 | ppl    78.16
| prune-epoch  24 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.56 | loss  4.24 | ppl    69.24
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
-----------------------------------------------------------------------------------------
| end of prune epoch  24 | time: 10.71s | valid loss  4.63 | valid ppl   102.25
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  25 |   200/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.49 | ppl    89.42
| prune-epoch  25 |   400/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.46 | ppl    86.32
| prune-epoch  25 |   600/ 1327 batches | lr 20.00 | ms/batch  7.54 | loss  4.44 | ppl    84.72
| prune-epoch  25 |   800/ 1327 batches | lr 20.00 | ms/batch  7.55 | loss  4.38 | ppl    80.19
| prune-epoch  25 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.53 | loss  4.45 | ppl    85.47
| prune-epoch  25 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.53 | loss  4.33 | ppl    75.86
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of prune epoch  25 | time: 10.47s | valid loss  4.64 | valid ppl   103.32
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.41 | ppl    82.33
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch  7.55 | loss  4.41 | ppl    81.86
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch  7.55 | loss  4.39 | ppl    81.01
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch  7.54 | loss  4.34 | ppl    77.09
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.52 | loss  4.42 | ppl    82.75
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.55 | loss  4.30 | ppl    73.53
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   1 | time: 10.45s | valid loss  4.64 | valid ppl   103.53
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.38 | ppl    79.88
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch  7.57 | loss  4.39 | ppl    80.35
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch  7.55 | loss  4.37 | ppl    79.33
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch  7.54 | loss  4.33 | ppl    75.64
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.54 | loss  4.40 | ppl    81.08
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.54 | loss  4.28 | ppl    72.44
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   2 | time: 10.45s | valid loss  4.63 | valid ppl   102.37
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.36 | ppl    78.43
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch  7.55 | loss  4.36 | ppl    78.32
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch  7.54 | loss  4.36 | ppl    77.90
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.31 | ppl    74.61
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.53 | loss  4.38 | ppl    79.97
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.54 | loss  4.27 | ppl    71.24
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   3 | time: 10.46s | valid loss  4.63 | valid ppl   102.32
-----------------------------------------------------------------------------------------
required epochs   6 | actual epochs  34
pretrain epochs   6 | prune epochs  25 | retrain epochs   3
=========================================================================================
| End of training | test loss  4.59 | test ppl    98.19
=========================================================================================
python main.py --cuda --tied --save model/prune/model.pt --data ./data/ptb --prune --retrain --sparsity 0.9
<class 'torch.Tensor'> torch.Size([10000, 200])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800, 200])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([800])
<class 'torch.Tensor'> torch.Size([10000])
RNNModel(
  (drop): Dropout(p=0.2)
  (encoder): Embedding(10000, 200)
  (rnn): LSTM(200, 200, num_layers=2, dropout=0.2)
  (decoder): Linear(in_features=200, out_features=10000, bias=True)
)
Dropout(p=0.2)
Embedding(10000, 200)
LSTM(200, 200, num_layers=2, dropout=0.2)
Linear(in_features=200, out_features=10000, bias=True)
| train-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch  7.45 | loss  6.90 | ppl   992.47
| train-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch  7.22 | loss  6.22 | ppl   501.02
| train-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch  7.25 | loss  5.89 | ppl   360.59
| train-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch  7.23 | loss  5.63 | ppl   277.83
| train-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.17 | loss  5.51 | ppl   246.22
| train-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.19 | loss  5.36 | ppl   212.65
-----------------------------------------------------------------------------------------
| end of train epoch   1 | time: 10.03s | valid loss  5.27 | valid ppl   193.93
-----------------------------------------------------------------------------------------
| train-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch  7.26 | loss  5.29 | ppl   198.27
| train-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch  7.22 | loss  5.23 | ppl   186.17
| train-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch  7.21 | loss  5.18 | ppl   176.95
| train-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch  7.24 | loss  5.08 | ppl   160.04
| train-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.15 | loss  5.08 | ppl   160.12
| train-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.22 | loss  4.97 | ppl   143.96
-----------------------------------------------------------------------------------------
| end of train epoch   2 | time: 10.00s | valid loss  5.00 | valid ppl   148.05
-----------------------------------------------------------------------------------------
| train-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch  7.27 | loss  4.98 | ppl   145.36
| train-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch  7.21 | loss  4.96 | ppl   142.07
| train-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch  7.20 | loss  4.92 | ppl   137.68
| train-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch  7.20 | loss  4.85 | ppl   128.16
| train-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.21 | loss  4.89 | ppl   132.55
| train-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.25 | loss  4.78 | ppl   118.98
-----------------------------------------------------------------------------------------
| end of train epoch   3 | time: 10.01s | valid loss  4.87 | valid ppl   130.24
-----------------------------------------------------------------------------------------
| train-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch  7.26 | loss  4.81 | ppl   123.32
| train-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch  7.19 | loss  4.81 | ppl   122.45
| train-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch  7.21 | loss  4.79 | ppl   119.72
| train-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch  7.21 | loss  4.72 | ppl   112.31
| train-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.17 | loss  4.77 | ppl   118.32
| train-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.19 | loss  4.66 | ppl   105.65
-----------------------------------------------------------------------------------------
| end of train epoch   4 | time:  9.98s | valid loss  4.79 | valid ppl   120.34
-----------------------------------------------------------------------------------------
| train-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch  7.28 | loss  4.71 | ppl   110.95
| train-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch  7.22 | loss  4.71 | ppl   111.07
| train-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch  7.20 | loss  4.70 | ppl   109.44
| train-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch  7.20 | loss  4.64 | ppl   103.20
| train-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.23 | loss  4.69 | ppl   109.12
| train-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.23 | loss  4.58 | ppl    97.43
-----------------------------------------------------------------------------------------
| end of train epoch   5 | time: 10.01s | valid loss  4.75 | valid ppl   116.08
-----------------------------------------------------------------------------------------
| train-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch  7.22 | loss  4.64 | ppl   103.03
| train-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch  7.21 | loss  4.64 | ppl   103.59
| train-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch  7.28 | loss  4.63 | ppl   102.20
| train-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch  7.27 | loss  4.57 | ppl    96.70
| train-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.22 | loss  4.64 | ppl   103.81
| train-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.25 | loss  4.52 | ppl    91.96
-----------------------------------------------------------------------------------------
| end of train epoch   6 | time: 10.04s | valid loss  4.73 | valid ppl   113.31
-----------------------------------------------------------------------------------------
| train-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch  7.26 | loss  4.59 | ppl    98.19
| train-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch  7.25 | loss  4.59 | ppl    98.47
| train-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch  7.27 | loss  4.58 | ppl    97.53
| train-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch  7.31 | loss  4.52 | ppl    92.01
| train-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.26 | loss  4.60 | ppl    99.12
| train-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.30 | loss  4.48 | ppl    88.29
-----------------------------------------------------------------------------------------
| end of train epoch   7 | time: 10.09s | valid loss  4.71 | valid ppl   111.36
-----------------------------------------------------------------------------------------
| train-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch  7.34 | loss  4.55 | ppl    94.20
| train-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch  7.35 | loss  4.55 | ppl    94.99
| train-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch  7.37 | loss  4.55 | ppl    94.32
| train-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch  7.82 | loss  4.49 | ppl    88.75
| train-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.57 | ppl    96.11
| train-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.45 | ppl    85.35
-----------------------------------------------------------------------------------------
| end of train epoch   8 | time: 10.68s | valid loss  4.69 | valid ppl   109.23
-----------------------------------------------------------------------------------------
| train-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch  8.01 | loss  4.51 | ppl    91.35
| train-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch  8.01 | loss  4.52 | ppl    91.74
| train-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch  7.99 | loss  4.51 | ppl    91.12
| train-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.46 | ppl    86.22
| train-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.96 | loss  4.54 | ppl    93.50
| train-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.03 | loss  4.42 | ppl    82.93
-----------------------------------------------------------------------------------------
| end of train epoch   9 | time: 11.10s | valid loss  4.69 | valid ppl   108.58
-----------------------------------------------------------------------------------------
| train-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch  8.05 | loss  4.49 | ppl    89.01
| train-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch  7.88 | loss  4.50 | ppl    89.67
| train-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch  7.30 | loss  4.49 | ppl    88.79
| train-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch  7.31 | loss  4.43 | ppl    84.24
| train-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.32 | loss  4.52 | ppl    91.48
| train-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.33 | loss  4.40 | ppl    81.13
-----------------------------------------------------------------------------------------
| end of train epoch  10 | time: 10.39s | valid loss  4.68 | valid ppl   108.23
-----------------------------------------------------------------------------------------
| train-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch  7.36 | loss  4.46 | ppl    86.56
| train-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch  7.28 | loss  4.47 | ppl    87.65
| train-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch  7.28 | loss  4.47 | ppl    87.10
| train-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch  7.29 | loss  4.41 | ppl    82.42
| train-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.24 | loss  4.49 | ppl    89.35
| train-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.29 | loss  4.37 | ppl    79.27
-----------------------------------------------------------------------------------------
| end of train epoch  11 | time: 10.09s | valid loss  4.67 | valid ppl   106.80
-----------------------------------------------------------------------------------------
| train-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch  7.38 | loss  4.44 | ppl    85.15
| train-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch  7.31 | loss  4.46 | ppl    86.11
| train-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.44 | ppl    85.03
| train-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch  7.74 | loss  4.40 | ppl    81.07
| train-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.81 | loss  4.48 | ppl    88.39
| train-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.74 | loss  4.35 | ppl    77.72
-----------------------------------------------------------------------------------------
| end of train epoch  12 | time: 10.49s | valid loss  4.66 | valid ppl   105.89
-----------------------------------------------------------------------------------------
| train-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch  7.38 | loss  4.43 | ppl    83.91
| train-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch  7.35 | loss  4.44 | ppl    84.58
| train-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch  7.48 | loss  4.43 | ppl    84.03
| train-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.38 | ppl    80.23
| train-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.41 | loss  4.46 | ppl    86.71
| train-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.57 | loss  4.34 | ppl    76.76
-----------------------------------------------------------------------------------------
| end of train epoch  13 | time: 10.33s | valid loss  4.66 | valid ppl   105.48
-----------------------------------------------------------------------------------------
| train-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch  7.36 | loss  4.42 | ppl    82.71
| train-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch  7.39 | loss  4.42 | ppl    83.45
| train-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch  7.32 | loss  4.41 | ppl    82.57
| train-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch  7.33 | loss  4.37 | ppl    78.94
| train-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.33 | loss  4.45 | ppl    85.54
| train-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.38 | loss  4.33 | ppl    75.81
-----------------------------------------------------------------------------------------
| end of train epoch  14 | time: 10.19s | valid loss  4.65 | valid ppl   104.81
-----------------------------------------------------------------------------------------
| train-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch  7.41 | loss  4.40 | ppl    81.66
| train-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch  7.36 | loss  4.41 | ppl    82.05
| train-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch  7.32 | loss  4.40 | ppl    81.81
| train-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch  7.35 | loss  4.36 | ppl    78.09
| train-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.30 | loss  4.44 | ppl    84.38
| train-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.37 | loss  4.32 | ppl    75.05
-----------------------------------------------------------------------------------------
| end of train epoch  15 | time: 10.18s | valid loss  4.66 | valid ppl   105.38
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch  7.83 | loss  4.40 | ppl    81.40
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.40 | ppl    81.30
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.39 | ppl    80.56
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.33 | ppl    75.76
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.41 | ppl    82.10
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.28 | ppl    72.50
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   1 | time: 10.62s | valid loss  4.64 | valid ppl   103.34
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch  7.75 | loss  4.37 | ppl    78.68
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.37 | ppl    78.70
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch  7.62 | loss  4.36 | ppl    78.02
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.31 | ppl    74.27
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.39 | ppl    80.45
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.71 | loss  4.26 | ppl    70.89
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   2 | time: 10.62s | valid loss  4.63 | valid ppl   102.95
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch  7.79 | loss  4.34 | ppl    76.90
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.35 | ppl    77.51
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.34 | ppl    76.75
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch  7.89 | loss  4.29 | ppl    73.06
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.37 | ppl    79.16
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.25 | ppl    70.23
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   3 | time: 10.85s | valid loss  4.63 | valid ppl   102.75
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch  8.12 | loss  4.33 | ppl    76.02
| prune-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch  8.01 | loss  4.34 | ppl    76.40
| prune-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch  7.74 | loss  4.33 | ppl    75.69
| prune-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.28 | ppl    72.31
| prune-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.56 | loss  4.36 | ppl    78.36
| prune-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.54 | loss  4.23 | ppl    69.05
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   4 | time: 10.72s | valid loss  4.63 | valid ppl   102.68
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch  7.75 | loss  4.32 | ppl    74.92
| prune-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.33 | ppl    75.76
| prune-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch  7.71 | loss  4.31 | ppl    74.66
| prune-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch  7.69 | loss  4.27 | ppl    71.64
| prune-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.35 | ppl    77.48
| prune-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.68 | loss  4.23 | ppl    68.58
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   5 | time: 10.62s | valid loss  4.63 | valid ppl   102.11
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch  7.70 | loss  4.31 | ppl    74.33
| prune-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch  7.69 | loss  4.32 | ppl    75.00
| prune-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.31 | ppl    74.19
| prune-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.26 | ppl    70.99
| prune-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.34 | ppl    76.73
| prune-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.62 | loss  4.22 | ppl    67.97
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.4  actual sp:  0.395
-----------------------------------------------------------------------------------------
| end of prune epoch   6 | time: 10.60s | valid loss  4.63 | valid ppl   102.59
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch  7.72 | loss  4.31 | ppl    74.25
| prune-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.31 | ppl    74.29
| prune-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.30 | ppl    73.75
| prune-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.25 | ppl    70.16
| prune-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.33 | ppl    75.77
| prune-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.21 | ppl    67.10
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
-----------------------------------------------------------------------------------------
| end of prune epoch   7 | time: 10.59s | valid loss  4.62 | valid ppl   101.50
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch  7.82 | loss  4.29 | ppl    73.14
| prune-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch  7.69 | loss  4.29 | ppl    73.14
| prune-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch  7.68 | loss  4.28 | ppl    72.46
| prune-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch  7.68 | loss  4.24 | ppl    69.19
| prune-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.31 | ppl    74.79
| prune-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.20 | ppl    66.40
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
-----------------------------------------------------------------------------------------
| end of prune epoch   8 | time: 10.63s | valid loss  4.62 | valid ppl   101.04
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch  7.77 | loss  4.28 | ppl    72.26
| prune-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.28 | ppl    72.48
| prune-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.28 | ppl    72.03
| prune-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.23 | ppl    68.67
| prune-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.31 | ppl    74.35
| prune-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.19 | ppl    65.96
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
-----------------------------------------------------------------------------------------
| end of prune epoch   9 | time: 10.61s | valid loss  4.62 | valid ppl   101.03
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch  7.70 | loss  4.27 | ppl    71.67
| prune-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch  7.97 | loss  4.28 | ppl    72.02
| prune-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch  8.33 | loss  4.27 | ppl    71.24
| prune-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch  8.32 | loss  4.22 | ppl    68.24
| prune-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.05 | loss  4.30 | ppl    73.77
| prune-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.18 | ppl    65.54
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
-----------------------------------------------------------------------------------------
| end of prune epoch  10 | time: 11.12s | valid loss  4.61 | valid ppl   100.58
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch  8.11 | loss  4.27 | ppl    71.21
| prune-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.26 | ppl    71.14
| prune-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch  7.98 | loss  4.26 | ppl    70.76
| prune-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch  7.99 | loss  4.21 | ppl    67.57
| prune-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.99 | loss  4.29 | ppl    73.29
| prune-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.99 | loss  4.17 | ppl    64.98
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.5  actual sp:  0.495
-----------------------------------------------------------------------------------------
| end of prune epoch  11 | time: 11.05s | valid loss  4.62 | valid ppl   101.41
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch  8.08 | loss  4.28 | ppl    72.28
| prune-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.28 | ppl    71.96
| prune-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.27 | ppl    71.32
| prune-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.22 | ppl    68.06
| prune-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.30 | ppl    73.51
| prune-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.17 | ppl    64.85
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
-----------------------------------------------------------------------------------------
| end of prune epoch  12 | time: 11.06s | valid loss  4.61 | valid ppl   100.67
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch  8.11 | loss  4.26 | ppl    70.61
| prune-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch  7.98 | loss  4.26 | ppl    70.90
| prune-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch  7.98 | loss  4.25 | ppl    70.35
| prune-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch  7.97 | loss  4.21 | ppl    67.16
| prune-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.95 | loss  4.28 | ppl    72.58
| prune-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.17 | ppl    64.44
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.6  actual sp:  0.595
-----------------------------------------------------------------------------------------
| end of prune epoch  13 | time: 11.04s | valid loss  4.61 | valid ppl   100.89
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch  8.11 | loss  4.31 | ppl    74.72
| prune-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.31 | ppl    74.43
| prune-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.29 | ppl    73.11
| prune-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.24 | ppl    69.73
| prune-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.32 | ppl    74.84
| prune-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.20 | ppl    66.56
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
-----------------------------------------------------------------------------------------
| end of prune epoch  14 | time: 11.07s | valid loss  4.62 | valid ppl   101.01
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch  8.10 | loss  4.28 | ppl    72.29
| prune-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.28 | ppl    72.32
| prune-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch  8.02 | loss  4.26 | ppl    71.16
| prune-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.22 | ppl    68.33
| prune-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.30 | ppl    73.74
| prune-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.73 | loss  4.18 | ppl    65.10
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7  actual sp:  0.6950000000000001
-----------------------------------------------------------------------------------------
| end of prune epoch  15 | time: 10.96s | valid loss  4.62 | valid ppl   101.25
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  16 |   200/ 1327 batches | lr 20.00 | ms/batch  7.68 | loss  4.41 | ppl    82.34
| prune-epoch  16 |   400/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.38 | ppl    79.89
| prune-epoch  16 |   600/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.36 | ppl    78.55
| prune-epoch  16 |   800/ 1327 batches | lr 20.00 | ms/batch  7.69 | loss  4.31 | ppl    74.66
| prune-epoch  16 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.37 | ppl    79.36
| prune-epoch  16 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.25 | ppl    70.38
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
-----------------------------------------------------------------------------------------
| end of prune epoch  16 | time: 10.56s | valid loss  4.62 | valid ppl   101.54
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  17 |   200/ 1327 batches | lr 20.00 | ms/batch  7.70 | loss  4.34 | ppl    76.74
| prune-epoch  17 |   400/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.33 | ppl    76.23
| prune-epoch  17 |   600/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.33 | ppl    75.61
| prune-epoch  17 |   800/ 1327 batches | lr 20.00 | ms/batch  7.57 | loss  4.27 | ppl    71.88
| prune-epoch  17 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.35 | ppl    77.12
| prune-epoch  17 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.57 | loss  4.23 | ppl    68.67
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
-----------------------------------------------------------------------------------------
| end of prune epoch  17 | time: 10.52s | valid loss  4.61 | valid ppl   100.80
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  18 |   200/ 1327 batches | lr 20.00 | ms/batch  7.70 | loss  4.31 | ppl    74.59
| prune-epoch  18 |   400/ 1327 batches | lr 20.00 | ms/batch  7.62 | loss  4.31 | ppl    74.81
| prune-epoch  18 |   600/ 1327 batches | lr 20.00 | ms/batch  7.61 | loss  4.31 | ppl    74.24
| prune-epoch  18 |   800/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.26 | ppl    70.60
| prune-epoch  18 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.33 | ppl    76.22
| prune-epoch  18 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.59 | loss  4.22 | ppl    67.74
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
-----------------------------------------------------------------------------------------
| end of prune epoch  18 | time: 10.54s | valid loss  4.61 | valid ppl   100.43
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  19 |   200/ 1327 batches | lr 20.00 | ms/batch  7.70 | loss  4.29 | ppl    73.25
| prune-epoch  19 |   400/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.30 | ppl    73.34
| prune-epoch  19 |   600/ 1327 batches | lr 20.00 | ms/batch  7.96 | loss  4.29 | ppl    73.00
| prune-epoch  19 |   800/ 1327 batches | lr 20.00 | ms/batch  8.00 | loss  4.24 | ppl    69.75
| prune-epoch  19 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.96 | loss  4.32 | ppl    74.99
| prune-epoch  19 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.04 | loss  4.20 | ppl    66.94
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
-----------------------------------------------------------------------------------------
| end of prune epoch  19 | time: 10.92s | valid loss  4.61 | valid ppl   100.03
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  20 |   200/ 1327 batches | lr 20.00 | ms/batch  7.76 | loss  4.28 | ppl    72.58
| prune-epoch  20 |   400/ 1327 batches | lr 20.00 | ms/batch  7.70 | loss  4.28 | ppl    72.47
| prune-epoch  20 |   600/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.27 | ppl    71.74
| prune-epoch  20 |   800/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.23 | ppl    68.72
| prune-epoch  20 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.31 | ppl    74.16
| prune-epoch  20 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.19 | ppl    66.05
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
-----------------------------------------------------------------------------------------
| end of prune epoch  20 | time: 10.63s | valid loss  4.60 | valid ppl    99.71
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  21 |   200/ 1327 batches | lr 20.00 | ms/batch  8.11 | loss  4.27 | ppl    71.47
| prune-epoch  21 |   400/ 1327 batches | lr 20.00 | ms/batch  8.01 | loss  4.28 | ppl    72.03
| prune-epoch  21 |   600/ 1327 batches | lr 20.00 | ms/batch  7.57 | loss  4.26 | ppl    70.81
| prune-epoch  21 |   800/ 1327 batches | lr 20.00 | ms/batch  7.34 | loss  4.22 | ppl    67.98
| prune-epoch  21 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.37 | loss  4.30 | ppl    73.46
| prune-epoch  21 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.53 | loss  4.18 | ppl    65.43
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.7999999999999999  actual sp:  0.795
-----------------------------------------------------------------------------------------
| end of prune epoch  21 | time: 10.58s | valid loss  4.60 | valid ppl    99.72
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  22 |   200/ 1327 batches | lr 20.00 | ms/batch  7.76 | loss  4.35 | ppl    77.75
| prune-epoch  22 |   400/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.34 | ppl    76.48
| prune-epoch  22 |   600/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.32 | ppl    75.17
| prune-epoch  22 |   800/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.28 | ppl    71.92
| prune-epoch  22 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.34 | ppl    76.95
| prune-epoch  22 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.68 | loss  4.22 | ppl    68.12
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
-----------------------------------------------------------------------------------------
| end of prune epoch  22 | time: 10.60s | valid loss  4.61 | valid ppl   100.44
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  23 |   200/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.31 | ppl    74.59
| prune-epoch  23 |   400/ 1327 batches | lr 20.00 | ms/batch  7.61 | loss  4.30 | ppl    73.94
| prune-epoch  23 |   600/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.30 | ppl    73.57
| prune-epoch  23 |   800/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.25 | ppl    70.26
| prune-epoch  23 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.63 | loss  4.32 | ppl    75.46
| prune-epoch  23 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.21 | ppl    67.29
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.85  actual sp:  0.845
-----------------------------------------------------------------------------------------
| end of prune epoch  23 | time: 10.55s | valid loss  4.62 | valid ppl   101.15
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  24 |   200/ 1327 batches | lr 20.00 | ms/batch  7.74 | loss  4.47 | ppl    87.72
| prune-epoch  24 |   400/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.44 | ppl    84.59
| prune-epoch  24 |   600/ 1327 batches | lr 20.00 | ms/batch  7.61 | loss  4.42 | ppl    82.98
| prune-epoch  24 |   800/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.37 | ppl    79.07
| prune-epoch  24 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.60 | loss  4.43 | ppl    83.76
| prune-epoch  24 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.58 | loss  4.32 | ppl    75.01
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of prune epoch  24 | time: 10.55s | valid loss  4.63 | valid ppl   102.51
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch  7.73 | loss  4.39 | ppl    81.01
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.39 | ppl    80.50
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch  7.65 | loss  4.38 | ppl    79.94
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.34 | ppl    76.37
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.40 | ppl    81.11
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.62 | loss  4.29 | ppl    73.16
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   1 | time: 10.59s | valid loss  4.62 | valid ppl   101.84
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch  7.76 | loss  4.36 | ppl    78.64
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.36 | ppl    78.39
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.35 | ppl    77.82
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.31 | ppl    74.33
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.61 | loss  4.38 | ppl    80.16
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.26 | ppl    71.11
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   2 | time: 10.73s | valid loss  4.64 | valid ppl   103.23
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch  8.43 | loss  4.35 | ppl    77.45
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch  7.98 | loss  4.34 | ppl    77.07
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch  7.67 | loss  4.34 | ppl    76.40
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.29 | ppl    73.18
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.68 | loss  4.36 | ppl    78.60
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.26 | ppl    70.47
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   3 | time: 10.81s | valid loss  4.61 | valid ppl   100.71
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch  7.74 | loss  4.33 | ppl    76.00
| prune-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch  7.66 | loss  4.33 | ppl    75.67
| prune-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch  7.64 | loss  4.32 | ppl    75.37
| prune-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch  7.71 | loss  4.28 | ppl    72.42
| prune-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch  7.98 | loss  4.35 | ppl    77.51
| prune-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch  7.99 | loss  4.24 | ppl    69.45
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   4 | time: 10.80s | valid loss  4.61 | valid ppl   100.13
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch  7.68 | loss  4.32 | ppl    75.02
| prune-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch  7.62 | loss  4.31 | ppl    74.80
| prune-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch  7.76 | loss  4.31 | ppl    74.67
| prune-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch  8.35 | loss  4.27 | ppl    71.70
| prune-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch  8.34 | loss  4.34 | ppl    76.45
| prune-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch  8.35 | loss  4.22 | ppl    68.26
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   5 | time: 11.16s | valid loss  4.62 | valid ppl   101.23
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch  8.44 | loss  4.30 | ppl    73.49
| prune-epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch  8.35 | loss  4.28 | ppl    72.16
| prune-epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch  8.37 | loss  4.25 | ppl    70.39
| prune-epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch  8.37 | loss  4.20 | ppl    66.82
| prune-epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch  8.33 | loss  4.26 | ppl    70.66
| prune-epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch  8.37 | loss  4.13 | ppl    62.04
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   6 | time: 11.59s | valid loss  4.57 | valid ppl    96.30
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch  8.44 | loss  4.26 | ppl    70.79
| prune-epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch  8.32 | loss  4.24 | ppl    69.71
| prune-epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch  8.37 | loss  4.23 | ppl    68.84
| prune-epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch  8.35 | loss  4.18 | ppl    65.46
| prune-epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch  8.34 | loss  4.24 | ppl    69.62
| prune-epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch  8.36 | loss  4.12 | ppl    61.34
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   7 | time: 11.48s | valid loss  4.56 | valid ppl    95.85
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch  8.06 | loss  4.24 | ppl    69.71
| prune-epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch  7.99 | loss  4.23 | ppl    69.02
| prune-epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch  7.99 | loss  4.22 | ppl    68.08
| prune-epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch  8.00 | loss  4.17 | ppl    65.03
| prune-epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch  7.99 | loss  4.24 | ppl    69.42
| prune-epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch  7.99 | loss  4.12 | ppl    61.43
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   8 | time: 11.05s | valid loss  4.56 | valid ppl    95.32
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 5.00 | ms/batch  8.10 | loss  4.24 | ppl    69.18
| prune-epoch   9 |   400/ 1327 batches | lr 5.00 | ms/batch  7.99 | loss  4.23 | ppl    68.59
| prune-epoch   9 |   600/ 1327 batches | lr 5.00 | ms/batch  7.99 | loss  4.21 | ppl    67.68
| prune-epoch   9 |   800/ 1327 batches | lr 5.00 | ms/batch  7.99 | loss  4.17 | ppl    64.56
| prune-epoch   9 |  1000/ 1327 batches | lr 5.00 | ms/batch  8.02 | loss  4.23 | ppl    68.90
| prune-epoch   9 |  1200/ 1327 batches | lr 5.00 | ms/batch  8.00 | loss  4.12 | ppl    61.32
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch   9 | time: 11.06s | valid loss  4.56 | valid ppl    95.57
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 5.00 | ms/batch  8.08 | loss  4.23 | ppl    68.52
| prune-epoch  10 |   400/ 1327 batches | lr 5.00 | ms/batch  7.98 | loss  4.22 | ppl    67.89
| prune-epoch  10 |   600/ 1327 batches | lr 5.00 | ms/batch  8.00 | loss  4.20 | ppl    67.00
| prune-epoch  10 |   800/ 1327 batches | lr 5.00 | ms/batch  8.00 | loss  4.16 | ppl    64.11
| prune-epoch  10 |  1000/ 1327 batches | lr 5.00 | ms/batch  8.00 | loss  4.23 | ppl    68.59
| prune-epoch  10 |  1200/ 1327 batches | lr 5.00 | ms/batch  8.00 | loss  4.11 | ppl    60.99
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  10 | time: 11.06s | valid loss  4.56 | valid ppl    95.41
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 5.00 | ms/batch  7.85 | loss  4.22 | ppl    68.11
| prune-epoch  11 |   400/ 1327 batches | lr 5.00 | ms/batch  7.34 | loss  4.21 | ppl    67.56
| prune-epoch  11 |   600/ 1327 batches | lr 5.00 | ms/batch  7.38 | loss  4.20 | ppl    66.87
| prune-epoch  11 |   800/ 1327 batches | lr 5.00 | ms/batch  7.33 | loss  4.16 | ppl    64.14
| prune-epoch  11 |  1000/ 1327 batches | lr 5.00 | ms/batch  7.46 | loss  4.22 | ppl    68.32
| prune-epoch  11 |  1200/ 1327 batches | lr 5.00 | ms/batch  7.47 | loss  4.11 | ppl    60.93
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  11 | time: 10.34s | valid loss  4.56 | valid ppl    95.22
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 5.00 | ms/batch  7.53 | loss  4.21 | ppl    67.49
| prune-epoch  12 |   400/ 1327 batches | lr 5.00 | ms/batch  7.46 | loss  4.21 | ppl    67.17
| prune-epoch  12 |   600/ 1327 batches | lr 5.00 | ms/batch  7.47 | loss  4.20 | ppl    66.54
| prune-epoch  12 |   800/ 1327 batches | lr 5.00 | ms/batch  7.46 | loss  4.16 | ppl    63.80
| prune-epoch  12 |  1000/ 1327 batches | lr 5.00 | ms/batch  7.46 | loss  4.22 | ppl    68.02
| prune-epoch  12 |  1200/ 1327 batches | lr 5.00 | ms/batch  7.47 | loss  4.10 | ppl    60.62
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  12 | time: 10.34s | valid loss  4.56 | valid ppl    95.17
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 5.00 | ms/batch  7.46 | loss  4.21 | ppl    67.33
| prune-epoch  13 |   400/ 1327 batches | lr 5.00 | ms/batch  7.42 | loss  4.21 | ppl    67.03
| prune-epoch  13 |   600/ 1327 batches | lr 5.00 | ms/batch  7.39 | loss  4.19 | ppl    66.08
| prune-epoch  13 |   800/ 1327 batches | lr 5.00 | ms/batch  7.38 | loss  4.15 | ppl    63.15
| prune-epoch  13 |  1000/ 1327 batches | lr 5.00 | ms/batch  7.72 | loss  4.22 | ppl    67.71
| prune-epoch  13 |  1200/ 1327 batches | lr 5.00 | ms/batch  7.48 | loss  4.10 | ppl    60.48
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  13 | time: 10.32s | valid loss  4.57 | valid ppl    96.99
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch  7.54 | loss  4.21 | ppl    67.57
| prune-epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch  7.44 | loss  4.20 | ppl    66.88
| prune-epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch  7.45 | loss  4.18 | ppl    65.35
| prune-epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch  7.43 | loss  4.14 | ppl    62.56
| prune-epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch  8.19 | loss  4.20 | ppl    66.75
| prune-epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch  7.51 | loss  4.08 | ppl    59.08
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  14 | time: 10.50s | valid loss  4.55 | valid ppl    94.32
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch  7.69 | loss  4.20 | ppl    66.86
| prune-epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch  7.35 | loss  4.19 | ppl    66.15
| prune-epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch  7.35 | loss  4.18 | ppl    65.42
| prune-epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch  7.33 | loss  4.13 | ppl    62.34
| prune-epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch  7.35 | loss  4.20 | ppl    66.36
| prune-epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch  7.38 | loss  4.07 | ppl    58.76
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  15 | time: 10.26s | valid loss  4.55 | valid ppl    94.23
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch  7.47 | loss  4.20 | ppl    66.67
| prune-epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch  7.43 | loss  4.19 | ppl    66.17
| prune-epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch  7.64 | loss  4.18 | ppl    65.10
| prune-epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch  7.67 | loss  4.13 | ppl    62.14
| prune-epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch  7.67 | loss  4.19 | ppl    66.24
| prune-epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch  7.65 | loss  4.07 | ppl    58.80
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  16 | time: 10.50s | valid loss  4.55 | valid ppl    94.30
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch  7.72 | loss  4.20 | ppl    66.40
| prune-epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch  7.64 | loss  4.18 | ppl    65.60
| prune-epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch  7.70 | loss  4.17 | ppl    64.86
| prune-epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch  7.67 | loss  4.12 | ppl    61.86
| prune-epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch  7.64 | loss  4.20 | ppl    66.65
| prune-epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch  7.66 | loss  4.07 | ppl    58.76
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  17 | time: 10.61s | valid loss  4.55 | valid ppl    94.29
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  18 |   200/ 1327 batches | lr 1.25 | ms/batch  7.78 | loss  4.19 | ppl    66.12
| prune-epoch  18 |   400/ 1327 batches | lr 1.25 | ms/batch  7.65 | loss  4.18 | ppl    65.65
| prune-epoch  18 |   600/ 1327 batches | lr 1.25 | ms/batch  7.71 | loss  4.17 | ppl    64.99
| prune-epoch  18 |   800/ 1327 batches | lr 1.25 | ms/batch  8.33 | loss  4.13 | ppl    61.88
| prune-epoch  18 |  1000/ 1327 batches | lr 1.25 | ms/batch  8.37 | loss  4.19 | ppl    66.11
| prune-epoch  18 |  1200/ 1327 batches | lr 1.25 | ms/batch  8.40 | loss  4.07 | ppl    58.67
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  18 | time: 11.06s | valid loss  4.55 | valid ppl    94.24
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  19 |   200/ 1327 batches | lr 1.25 | ms/batch  7.76 | loss  4.19 | ppl    65.87
| prune-epoch  19 |   400/ 1327 batches | lr 1.25 | ms/batch  7.65 | loss  4.18 | ppl    65.57
| prune-epoch  19 |   600/ 1327 batches | lr 1.25 | ms/batch  7.68 | loss  4.17 | ppl    64.82
| prune-epoch  19 |   800/ 1327 batches | lr 1.25 | ms/batch  8.21 | loss  4.12 | ppl    61.79
| prune-epoch  19 |  1000/ 1327 batches | lr 1.25 | ms/batch  8.37 | loss  4.19 | ppl    66.14
| prune-epoch  19 |  1200/ 1327 batches | lr 1.25 | ms/batch  8.37 | loss  4.07 | ppl    58.65
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  19 | time: 11.16s | valid loss  4.54 | valid ppl    94.14
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  20 |   200/ 1327 batches | lr 1.25 | ms/batch  8.44 | loss  4.19 | ppl    66.06
| prune-epoch  20 |   400/ 1327 batches | lr 1.25 | ms/batch  7.86 | loss  4.18 | ppl    65.58
| prune-epoch  20 |   600/ 1327 batches | lr 1.25 | ms/batch  7.65 | loss  4.17 | ppl    64.56
| prune-epoch  20 |   800/ 1327 batches | lr 1.25 | ms/batch  7.65 | loss  4.13 | ppl    61.94
| prune-epoch  20 |  1000/ 1327 batches | lr 1.25 | ms/batch  7.70 | loss  4.19 | ppl    65.91
| prune-epoch  20 |  1200/ 1327 batches | lr 1.25 | ms/batch  7.57 | loss  4.07 | ppl    58.62
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  20 | time: 10.78s | valid loss  4.55 | valid ppl    94.17
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  21 |   200/ 1327 batches | lr 0.31 | ms/batch  8.10 | loss  4.19 | ppl    66.15
| prune-epoch  21 |   400/ 1327 batches | lr 0.31 | ms/batch  7.70 | loss  4.18 | ppl    65.35
| prune-epoch  21 |   600/ 1327 batches | lr 0.31 | ms/batch  7.70 | loss  4.17 | ppl    64.49
| prune-epoch  21 |   800/ 1327 batches | lr 0.31 | ms/batch  7.70 | loss  4.12 | ppl    61.66
| prune-epoch  21 |  1000/ 1327 batches | lr 0.31 | ms/batch  7.69 | loss  4.19 | ppl    65.88
| prune-epoch  21 |  1200/ 1327 batches | lr 0.31 | ms/batch  7.69 | loss  4.06 | ppl    58.25
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  21 | time: 10.73s | valid loss  4.54 | valid ppl    93.78
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  22 |   200/ 1327 batches | lr 0.31 | ms/batch  7.76 | loss  4.19 | ppl    65.82
| prune-epoch  22 |   400/ 1327 batches | lr 0.31 | ms/batch  8.07 | loss  4.18 | ppl    65.16
| prune-epoch  22 |   600/ 1327 batches | lr 0.31 | ms/batch  8.38 | loss  4.16 | ppl    64.37
| prune-epoch  22 |   800/ 1327 batches | lr 0.31 | ms/batch  8.27 | loss  4.12 | ppl    61.55
| prune-epoch  22 |  1000/ 1327 batches | lr 0.31 | ms/batch  7.69 | loss  4.19 | ppl    65.77
| prune-epoch  22 |  1200/ 1327 batches | lr 0.31 | ms/batch  7.69 | loss  4.06 | ppl    58.02
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  22 | time: 10.98s | valid loss  4.54 | valid ppl    93.79
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  23 |   200/ 1327 batches | lr 0.31 | ms/batch  7.72 | loss  4.19 | ppl    66.05
| prune-epoch  23 |   400/ 1327 batches | lr 0.31 | ms/batch  7.65 | loss  4.18 | ppl    65.15
| prune-epoch  23 |   600/ 1327 batches | lr 0.31 | ms/batch  7.64 | loss  4.17 | ppl    64.80
| prune-epoch  23 |   800/ 1327 batches | lr 0.31 | ms/batch  7.64 | loss  4.12 | ppl    61.55
| prune-epoch  23 |  1000/ 1327 batches | lr 0.31 | ms/batch  7.63 | loss  4.19 | ppl    65.83
| prune-epoch  23 |  1200/ 1327 batches | lr 0.31 | ms/batch  7.41 | loss  4.06 | ppl    58.26
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  23 | time: 10.51s | valid loss  4.54 | valid ppl    93.73
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  24 |   200/ 1327 batches | lr 0.31 | ms/batch  7.46 | loss  4.19 | ppl    65.76
| prune-epoch  24 |   400/ 1327 batches | lr 0.31 | ms/batch  7.36 | loss  4.18 | ppl    65.31
| prune-epoch  24 |   600/ 1327 batches | lr 0.31 | ms/batch  7.39 | loss  4.16 | ppl    64.21
| prune-epoch  24 |   800/ 1327 batches | lr 0.31 | ms/batch  7.44 | loss  4.12 | ppl    61.30
| prune-epoch  24 |  1000/ 1327 batches | lr 0.31 | ms/batch  7.40 | loss  4.18 | ppl    65.52
| prune-epoch  24 |  1200/ 1327 batches | lr 0.31 | ms/batch  7.42 | loss  4.06 | ppl    58.26
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  24 | time: 10.26s | valid loss  4.54 | valid ppl    93.72
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  25 |   200/ 1327 batches | lr 0.31 | ms/batch  7.68 | loss  4.18 | ppl    65.64
| prune-epoch  25 |   400/ 1327 batches | lr 0.31 | ms/batch  7.66 | loss  4.18 | ppl    65.09
| prune-epoch  25 |   600/ 1327 batches | lr 0.31 | ms/batch  7.66 | loss  4.16 | ppl    64.37
| prune-epoch  25 |   800/ 1327 batches | lr 0.31 | ms/batch  7.63 | loss  4.12 | ppl    61.30
| prune-epoch  25 |  1000/ 1327 batches | lr 0.31 | ms/batch  7.70 | loss  4.18 | ppl    65.49
| prune-epoch  25 |  1200/ 1327 batches | lr 0.31 | ms/batch  7.65 | loss  4.07 | ppl    58.40
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  25 | time: 10.61s | valid loss  4.54 | valid ppl    93.74
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  26 |   200/ 1327 batches | lr 0.08 | ms/batch  7.68 | loss  4.19 | ppl    65.90
| prune-epoch  26 |   400/ 1327 batches | lr 0.08 | ms/batch  7.38 | loss  4.18 | ppl    65.35
| prune-epoch  26 |   600/ 1327 batches | lr 0.08 | ms/batch  7.39 | loss  4.16 | ppl    64.35
| prune-epoch  26 |   800/ 1327 batches | lr 0.08 | ms/batch  7.64 | loss  4.12 | ppl    61.29
| prune-epoch  26 |  1000/ 1327 batches | lr 0.08 | ms/batch  7.90 | loss  4.18 | ppl    65.68
| prune-epoch  26 |  1200/ 1327 batches | lr 0.08 | ms/batch  8.03 | loss  4.06 | ppl    58.00
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  26 | time: 10.65s | valid loss  4.54 | valid ppl    93.57
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  27 |   200/ 1327 batches | lr 0.08 | ms/batch  8.13 | loss  4.18 | ppl    65.65
| prune-epoch  27 |   400/ 1327 batches | lr 0.08 | ms/batch  8.02 | loss  4.18 | ppl    65.21
| prune-epoch  27 |   600/ 1327 batches | lr 0.08 | ms/batch  8.02 | loss  4.17 | ppl    64.46
| prune-epoch  27 |   800/ 1327 batches | lr 0.08 | ms/batch  7.94 | loss  4.12 | ppl    61.31
| prune-epoch  27 |  1000/ 1327 batches | lr 0.08 | ms/batch  8.04 | loss  4.18 | ppl    65.43
| prune-epoch  27 |  1200/ 1327 batches | lr 0.08 | ms/batch  8.01 | loss  4.06 | ppl    58.10
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  27 | time: 11.08s | valid loss  4.54 | valid ppl    93.55
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  28 |   200/ 1327 batches | lr 0.08 | ms/batch  8.11 | loss  4.19 | ppl    65.82
| prune-epoch  28 |   400/ 1327 batches | lr 0.08 | ms/batch  8.01 | loss  4.18 | ppl    65.07
| prune-epoch  28 |   600/ 1327 batches | lr 0.08 | ms/batch  8.01 | loss  4.16 | ppl    64.17
| prune-epoch  28 |   800/ 1327 batches | lr 0.08 | ms/batch  7.83 | loss  4.11 | ppl    61.00
| prune-epoch  28 |  1000/ 1327 batches | lr 0.08 | ms/batch  7.72 | loss  4.19 | ppl    65.96
| prune-epoch  28 |  1200/ 1327 batches | lr 0.08 | ms/batch  7.71 | loss  4.06 | ppl    57.87
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  28 | time: 10.88s | valid loss  4.54 | valid ppl    93.53
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  29 |   200/ 1327 batches | lr 0.08 | ms/batch  7.81 | loss  4.18 | ppl    65.48
| prune-epoch  29 |   400/ 1327 batches | lr 0.08 | ms/batch  8.34 | loss  4.18 | ppl    65.05
| prune-epoch  29 |   600/ 1327 batches | lr 0.08 | ms/batch  8.35 | loss  4.16 | ppl    64.39
| prune-epoch  29 |   800/ 1327 batches | lr 0.08 | ms/batch  8.36 | loss  4.12 | ppl    61.41
| prune-epoch  29 |  1000/ 1327 batches | lr 0.08 | ms/batch  8.34 | loss  4.19 | ppl    65.72
| prune-epoch  29 |  1200/ 1327 batches | lr 0.08 | ms/batch  8.32 | loss  4.07 | ppl    58.34
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  29 | time: 11.45s | valid loss  4.54 | valid ppl    93.51
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  30 |   200/ 1327 batches | lr 0.08 | ms/batch  8.41 | loss  4.18 | ppl    65.66
| prune-epoch  30 |   400/ 1327 batches | lr 0.08 | ms/batch  8.35 | loss  4.18 | ppl    65.09
| prune-epoch  30 |   600/ 1327 batches | lr 0.08 | ms/batch  8.34 | loss  4.16 | ppl    64.24
| prune-epoch  30 |   800/ 1327 batches | lr 0.08 | ms/batch  8.37 | loss  4.12 | ppl    61.28
| prune-epoch  30 |  1000/ 1327 batches | lr 0.08 | ms/batch  8.34 | loss  4.18 | ppl    65.36
| prune-epoch  30 |  1200/ 1327 batches | lr 0.08 | ms/batch  8.35 | loss  4.06 | ppl    58.19
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  30 | time: 11.59s | valid loss  4.54 | valid ppl    93.52
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  31 |   200/ 1327 batches | lr 0.08 | ms/batch  8.43 | loss  4.19 | ppl    65.74
| prune-epoch  31 |   400/ 1327 batches | lr 0.08 | ms/batch  8.33 | loss  4.17 | ppl    64.94
| prune-epoch  31 |   600/ 1327 batches | lr 0.08 | ms/batch  8.32 | loss  4.16 | ppl    64.31
| prune-epoch  31 |   800/ 1327 batches | lr 0.08 | ms/batch  8.33 | loss  4.12 | ppl    61.34
| prune-epoch  31 |  1000/ 1327 batches | lr 0.08 | ms/batch  8.33 | loss  4.19 | ppl    65.84
| prune-epoch  31 |  1200/ 1327 batches | lr 0.08 | ms/batch  8.33 | loss  4.06 | ppl    58.15
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  31 | time: 11.56s | valid loss  4.54 | valid ppl    93.51
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  32 |   200/ 1327 batches | lr 0.08 | ms/batch  8.40 | loss  4.18 | ppl    65.48
| prune-epoch  32 |   400/ 1327 batches | lr 0.08 | ms/batch  8.33 | loss  4.17 | ppl    64.94
| prune-epoch  32 |   600/ 1327 batches | lr 0.08 | ms/batch  8.32 | loss  4.16 | ppl    64.30
| prune-epoch  32 |   800/ 1327 batches | lr 0.08 | ms/batch  8.36 | loss  4.12 | ppl    61.43
| prune-epoch  32 |  1000/ 1327 batches | lr 0.08 | ms/batch  8.36 | loss  4.18 | ppl    65.48
| prune-epoch  32 |  1200/ 1327 batches | lr 0.08 | ms/batch  8.26 | loss  4.06 | ppl    58.17
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  32 | time: 11.55s | valid loss  4.54 | valid ppl    93.52
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  33 |   200/ 1327 batches | lr 0.02 | ms/batch  8.41 | loss  4.18 | ppl    65.56
| prune-epoch  33 |   400/ 1327 batches | lr 0.02 | ms/batch  8.38 | loss  4.18 | ppl    65.17
| prune-epoch  33 |   600/ 1327 batches | lr 0.02 | ms/batch  8.32 | loss  4.16 | ppl    64.23
| prune-epoch  33 |   800/ 1327 batches | lr 0.02 | ms/batch  8.32 | loss  4.12 | ppl    61.41
| prune-epoch  33 |  1000/ 1327 batches | lr 0.02 | ms/batch  8.35 | loss  4.18 | ppl    65.67
| prune-epoch  33 |  1200/ 1327 batches | lr 0.02 | ms/batch  8.35 | loss  4.06 | ppl    58.22
end prun train
weight_ih_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l0        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_ih_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
weight_hh_l1        shape torch.Size([800, 200])
       expected sp:  0.9  actual sp:  0.895
-----------------------------------------------------------------------------------------
| end of retrain epoch  33 | time: 11.58s | valid loss  4.54 | valid ppl    93.49
-----------------------------------------------------------------------------------------
required epochs  40 | actual epochs  72
pretrain epochs  15 | prune epochs  24 | retrain epochs  33
=========================================================================================
| End of training | test loss  4.49 | test ppl    89.13
=========================================================================================
python main.py --cuda --emsize 650 --nhid 650 --dropout 0.5 --epochs 40 --save model/prune/model.pt --data ./data/ptb --prune --retrain --sparsity 0.9
<class 'torch.Tensor'> torch.Size([10000, 650])
<class 'torch.Tensor'> torch.Size([2600, 650])
<class 'torch.Tensor'> torch.Size([2600, 650])
<class 'torch.Tensor'> torch.Size([2600])
<class 'torch.Tensor'> torch.Size([2600])
<class 'torch.Tensor'> torch.Size([2600, 650])
<class 'torch.Tensor'> torch.Size([2600, 650])
<class 'torch.Tensor'> torch.Size([2600])
<class 'torch.Tensor'> torch.Size([2600])
<class 'torch.Tensor'> torch.Size([10000, 650])
<class 'torch.Tensor'> torch.Size([10000])
RNNModel(
  (drop): Dropout(p=0.5)
  (encoder): Embedding(10000, 650)
  (rnn): LSTM(650, 650, num_layers=2, dropout=0.5)
  (decoder): Linear(in_features=650, out_features=10000, bias=True)
)
Dropout(p=0.5)
Embedding(10000, 650)
LSTM(650, 650, num_layers=2, dropout=0.5)
Linear(in_features=650, out_features=10000, bias=True)
| train-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 15.59 | loss  6.99 | ppl  1087.71
| train-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  6.26 | ppl   522.99
| train-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  5.99 | ppl   400.97
| train-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  5.75 | ppl   313.98
| train-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.26 | loss  5.62 | ppl   277.12
| train-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  5.48 | ppl   240.58
-----------------------------------------------------------------------------------------
| end of train epoch   1 | time: 21.04s | valid loss  5.39 | valid ppl   218.96
-----------------------------------------------------------------------------------------
| train-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  5.41 | ppl   224.21
| train-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 15.20 | loss  5.35 | ppl   209.64
| train-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 15.26 | loss  5.30 | ppl   199.46
| train-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  5.19 | ppl   179.57
| train-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.20 | loss  5.18 | ppl   178.17
| train-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.44 | loss  5.07 | ppl   159.89
-----------------------------------------------------------------------------------------
| end of train epoch   2 | time: 20.95s | valid loss  5.06 | valid ppl   157.59
-----------------------------------------------------------------------------------------
| train-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 15.41 | loss  5.08 | ppl   160.49
| train-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  5.05 | ppl   156.10
| train-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  5.01 | ppl   150.59
| train-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 15.30 | loss  4.94 | ppl   139.31
| train-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  4.97 | ppl   143.33
| train-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.85 | ppl   128.03
-----------------------------------------------------------------------------------------
| end of train epoch   3 | time: 20.97s | valid loss  4.89 | valid ppl   132.69
-----------------------------------------------------------------------------------------
| train-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 15.59 | loss  4.88 | ppl   131.35
| train-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 15.51 | loss  4.87 | ppl   129.85
| train-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 15.47 | loss  4.84 | ppl   126.19
| train-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 15.18 | loss  4.77 | ppl   117.51
| train-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  4.81 | ppl   123.14
| train-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.51 | loss  4.70 | ppl   109.45
-----------------------------------------------------------------------------------------
| end of train epoch   4 | time: 21.13s | valid loss  4.77 | valid ppl   118.45
-----------------------------------------------------------------------------------------
| train-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 15.43 | loss  4.74 | ppl   113.92
| train-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.73 | ppl   113.35
| train-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.70 | ppl   110.21
| train-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.64 | ppl   103.82
| train-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  4.70 | ppl   109.68
| train-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  4.58 | ppl    97.10
-----------------------------------------------------------------------------------------
| end of train epoch   5 | time: 21.02s | valid loss  4.70 | valid ppl   110.05
-----------------------------------------------------------------------------------------
| train-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 15.55 | loss  4.62 | ppl   101.75
| train-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 15.45 | loss  4.62 | ppl   101.83
| train-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 15.44 | loss  4.60 | ppl    99.79
| train-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 15.43 | loss  4.54 | ppl    94.08
| train-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.39 | loss  4.60 | ppl    99.80
| train-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.45 | loss  4.48 | ppl    88.22
-----------------------------------------------------------------------------------------
| end of train epoch   6 | time: 21.15s | valid loss  4.65 | valid ppl   104.39
-----------------------------------------------------------------------------------------
| train-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch 15.44 | loss  4.54 | ppl    93.38
| train-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  4.54 | ppl    93.27
| train-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch 15.36 | loss  4.52 | ppl    91.68
| train-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch 15.28 | loss  4.45 | ppl    85.86
| train-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.36 | loss  4.53 | ppl    92.30
| train-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.36 | loss  4.40 | ppl    81.80
-----------------------------------------------------------------------------------------
| end of train epoch   7 | time: 21.03s | valid loss  4.60 | valid ppl    99.82
-----------------------------------------------------------------------------------------
| train-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch 15.54 | loss  4.46 | ppl    86.20
| train-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch 15.45 | loss  4.46 | ppl    86.46
| train-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch 15.44 | loss  4.44 | ppl    85.19
| train-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch 15.39 | loss  4.38 | ppl    80.16
| train-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.44 | loss  4.46 | ppl    86.11
| train-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.44 | loss  4.33 | ppl    76.28
-----------------------------------------------------------------------------------------
| end of train epoch   8 | time: 21.15s | valid loss  4.58 | valid ppl    97.58
-----------------------------------------------------------------------------------------
| train-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch 15.46 | loss  4.40 | ppl    81.18
| train-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch 15.36 | loss  4.40 | ppl    81.44
| train-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.38 | ppl    79.97
| train-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.33 | ppl    75.59
| train-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  4.40 | ppl    81.44
| train-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.37 | loss  4.28 | ppl    72.06
-----------------------------------------------------------------------------------------
| end of train epoch   9 | time: 21.05s | valid loss  4.56 | valid ppl    95.74
-----------------------------------------------------------------------------------------
| train-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch 15.42 | loss  4.34 | ppl    76.77
| train-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  4.35 | ppl    77.31
| train-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  4.33 | ppl    75.87
| train-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch 15.12 | loss  4.27 | ppl    71.78
| train-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.12 | loss  4.35 | ppl    77.32
| train-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.16 | loss  4.23 | ppl    68.53
-----------------------------------------------------------------------------------------
| end of train epoch  10 | time: 20.82s | valid loss  4.54 | valid ppl    93.96
-----------------------------------------------------------------------------------------
| train-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch 15.09 | loss  4.29 | ppl    73.27
| train-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch 14.95 | loss  4.29 | ppl    73.05
| train-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch 15.08 | loss  4.28 | ppl    72.20
| train-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch 15.05 | loss  4.23 | ppl    68.66
| train-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.11 | loss  4.31 | ppl    74.34
| train-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.08 | loss  4.18 | ppl    65.41
-----------------------------------------------------------------------------------------
| end of train epoch  11 | time: 20.64s | valid loss  4.54 | valid ppl    93.30
-----------------------------------------------------------------------------------------
| train-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch 15.24 | loss  4.25 | ppl    70.03
| train-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch 15.14 | loss  4.25 | ppl    69.98
| train-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch 15.10 | loss  4.24 | ppl    69.27
| train-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch 15.18 | loss  4.19 | ppl    65.87
| train-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.17 | loss  4.27 | ppl    71.28
| train-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.18 | loss  4.14 | ppl    63.11
-----------------------------------------------------------------------------------------
| end of train epoch  12 | time: 20.78s | valid loss  4.52 | valid ppl    91.97
-----------------------------------------------------------------------------------------
| train-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch 15.28 | loss  4.21 | ppl    67.48
| train-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch 15.20 | loss  4.21 | ppl    67.36
| train-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch 15.13 | loss  4.20 | ppl    66.77
| train-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch 15.22 | loss  4.15 | ppl    63.55
| train-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.20 | loss  4.23 | ppl    68.90
| train-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  4.10 | ppl    60.64
-----------------------------------------------------------------------------------------
| end of train epoch  13 | time: 20.83s | valid loss  4.52 | valid ppl    91.68
-----------------------------------------------------------------------------------------
| train-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  4.17 | ppl    64.98
| train-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch 15.13 | loss  4.18 | ppl    65.34
| train-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch 15.04 | loss  4.17 | ppl    64.72
| train-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch 15.12 | loss  4.12 | ppl    61.53
| train-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.13 | loss  4.20 | ppl    66.47
| train-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.13 | loss  4.07 | ppl    58.68
-----------------------------------------------------------------------------------------
| end of train epoch  14 | time: 20.73s | valid loss  4.51 | valid ppl    91.18
-----------------------------------------------------------------------------------------
| train-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch 15.31 | loss  4.14 | ppl    63.05
| train-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch 15.23 | loss  4.15 | ppl    63.28
| train-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch 15.14 | loss  4.13 | ppl    62.48
| train-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  4.09 | ppl    59.65
| train-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.16 | loss  4.17 | ppl    64.58
| train-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  4.04 | ppl    56.82
-----------------------------------------------------------------------------------------
| end of train epoch  15 | time: 20.86s | valid loss  4.51 | valid ppl    91.19
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 15.88 | loss  4.12 | ppl    61.63
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 15.23 | loss  4.12 | ppl    61.31
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 15.18 | loss  4.10 | ppl    60.23
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 15.37 | loss  4.05 | ppl    57.16
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.49 | loss  4.12 | ppl    61.77
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.55 | loss  3.99 | ppl    54.17
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch   1 | time: 21.15s | valid loss  4.50 | valid ppl    90.13
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 15.78 | loss  4.07 | ppl    58.62
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  4.08 | ppl    58.91
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  4.06 | ppl    57.91
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 15.39 | loss  4.01 | ppl    54.97
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.44 | loss  4.10 | ppl    60.20
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.44 | loss  3.96 | ppl    52.25
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch   2 | time: 21.12s | valid loss  4.50 | valid ppl    89.83
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 15.64 | loss  4.04 | ppl    56.55
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 15.08 | loss  4.04 | ppl    57.08
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 15.17 | loss  4.03 | ppl    56.05
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 15.22 | loss  3.98 | ppl    53.40
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.22 | loss  4.07 | ppl    58.34
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  3.94 | ppl    51.28
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch   3 | time: 20.88s | valid loss  4.50 | valid ppl    89.90
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 15.77 | loss  4.03 | ppl    56.19
| prune-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  4.02 | ppl    55.58
| prune-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 15.27 | loss  4.00 | ppl    54.83
| prune-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 15.28 | loss  3.96 | ppl    52.36
| prune-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.26 | loss  4.04 | ppl    56.75
| prune-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.27 | loss  3.91 | ppl    49.82
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch   4 | time: 20.99s | valid loss  4.50 | valid ppl    90.09
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 15.76 | loss  3.99 | ppl    54.22
| prune-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 15.24 | loss  3.99 | ppl    54.10
| prune-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  3.98 | ppl    53.54
| prune-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  3.93 | ppl    50.87
| prune-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.02 | ppl    55.49
| prune-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  3.88 | ppl    48.63
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch   5 | time: 21.05s | valid loss  4.49 | valid ppl    89.52
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 15.67 | loss  3.97 | ppl    52.98
| prune-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 15.20 | loss  3.97 | ppl    52.84
| prune-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 15.22 | loss  3.96 | ppl    52.28
| prune-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 15.23 | loss  3.91 | ppl    50.05
| prune-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.24 | loss  3.99 | ppl    54.31
| prune-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  3.86 | ppl    47.62
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch   6 | time: 20.94s | valid loss  4.50 | valid ppl    90.33
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch 15.74 | loss  3.97 | ppl    52.98
| prune-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  3.96 | ppl    52.54
| prune-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  3.95 | ppl    51.73
| prune-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  3.90 | ppl    49.32
| prune-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.31 | loss  3.98 | ppl    53.65
| prune-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.31 | loss  3.85 | ppl    47.10
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch   7 | time: 21.06s | valid loss  4.50 | valid ppl    90.35
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch 15.61 | loss  3.94 | ppl    51.30
| prune-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch 15.26 | loss  3.94 | ppl    51.43
| prune-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch 15.28 | loss  3.92 | ppl    50.45
| prune-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  3.88 | ppl    48.39
| prune-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.24 | loss  3.96 | ppl    52.41
| prune-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  3.83 | ppl    46.22
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch   8 | time: 20.97s | valid loss  4.50 | valid ppl    90.28
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch 15.74 | loss  3.91 | ppl    50.12
| prune-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch 15.31 | loss  3.92 | ppl    50.26
| prune-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch 15.31 | loss  3.91 | ppl    49.69
| prune-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch 15.31 | loss  3.85 | ppl    47.08
| prune-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.30 | loss  3.94 | ppl    51.56
| prune-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.30 | loss  3.81 | ppl    45.24
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch   9 | time: 21.05s | valid loss  4.50 | valid ppl    89.99
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch 15.63 | loss  3.90 | ppl    49.23
| prune-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  3.89 | ppl    48.96
| prune-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  3.88 | ppl    48.50
| prune-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch 15.22 | loss  3.84 | ppl    46.61
| prune-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  3.92 | ppl    50.59
| prune-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.22 | loss  3.79 | ppl    44.47
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch  10 | time: 20.91s | valid loss  4.51 | valid ppl    90.91
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch 15.78 | loss  3.93 | ppl    50.68
| prune-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch 15.28 | loss  3.92 | ppl    50.37
| prune-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch 15.28 | loss  3.90 | ppl    49.60
| prune-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch 15.28 | loss  3.85 | ppl    47.22
| prune-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  3.93 | ppl    51.08
| prune-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.27 | loss  3.80 | ppl    44.87
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
-----------------------------------------------------------------------------------------
| end of prune epoch  11 | time: 21.01s | valid loss  4.51 | valid ppl    90.54
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch 15.74 | loss  3.89 | ppl    48.76
| prune-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch 15.30 | loss  3.88 | ppl    48.50
| prune-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  3.88 | ppl    48.41
| prune-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  3.83 | ppl    45.97
| prune-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.30 | loss  3.91 | ppl    49.84
| prune-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  3.78 | ppl    44.01
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
-----------------------------------------------------------------------------------------
| end of prune epoch  12 | time: 21.04s | valid loss  4.51 | valid ppl    90.86
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch 15.70 | loss  4.00 | ppl    54.44
| prune-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch 15.23 | loss  3.98 | ppl    53.27
| prune-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch 15.24 | loss  3.97 | ppl    52.73
| prune-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch 15.23 | loss  3.91 | ppl    50.12
| prune-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.23 | loss  3.99 | ppl    53.81
| prune-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.23 | loss  3.85 | ppl    47.16
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch  13 | time: 20.87s | valid loss  4.51 | valid ppl    90.70
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch 14.96 | loss  3.93 | ppl    50.96
| prune-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch 14.57 | loss  3.93 | ppl    50.76
| prune-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch 14.76 | loss  3.92 | ppl    50.51
| prune-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch 14.59 | loss  3.87 | ppl    48.10
| prune-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  3.95 | ppl    52.10
| prune-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.47 | loss  3.82 | ppl    45.66
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch  14 | time: 20.56s | valid loss  4.51 | valid ppl    90.66
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch 15.79 | loss  3.91 | ppl    49.74
| prune-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch 15.39 | loss  3.90 | ppl    49.44
| prune-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch 15.40 | loss  3.89 | ppl    48.78
| prune-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch 15.40 | loss  3.85 | ppl    47.13
| prune-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.40 | loss  3.92 | ppl    50.63
| prune-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.40 | loss  3.80 | ppl    44.49
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch  15 | time: 21.16s | valid loss  4.51 | valid ppl    90.57
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  16 |   200/ 1327 batches | lr 20.00 | ms/batch 15.83 | loss  3.89 | ppl    48.73
| prune-epoch  16 |   400/ 1327 batches | lr 20.00 | ms/batch 15.45 | loss  3.88 | ppl    48.39
| prune-epoch  16 |   600/ 1327 batches | lr 20.00 | ms/batch 15.44 | loss  3.87 | ppl    47.86
| prune-epoch  16 |   800/ 1327 batches | lr 20.00 | ms/batch 15.46 | loss  3.83 | ppl    46.17
| prune-epoch  16 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.45 | loss  3.91 | ppl    49.99
| prune-epoch  16 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.45 | loss  3.78 | ppl    43.98
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch  16 | time: 21.23s | valid loss  4.51 | valid ppl    91.29
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  17 |   200/ 1327 batches | lr 20.00 | ms/batch 15.76 | loss  3.95 | ppl    52.05
| prune-epoch  17 |   400/ 1327 batches | lr 20.00 | ms/batch 15.36 | loss  3.94 | ppl    51.57
| prune-epoch  17 |   600/ 1327 batches | lr 20.00 | ms/batch 15.23 | loss  3.92 | ppl    50.51
| prune-epoch  17 |   800/ 1327 batches | lr 20.00 | ms/batch 15.47 | loss  3.89 | ppl    48.67
| prune-epoch  17 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.40 | loss  3.96 | ppl    52.48
| prune-epoch  17 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.39 | loss  3.83 | ppl    45.94
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
-----------------------------------------------------------------------------------------
| end of prune epoch  17 | time: 21.13s | valid loss  4.51 | valid ppl    90.52
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  18 |   200/ 1327 batches | lr 20.00 | ms/batch 15.84 | loss  3.91 | ppl    49.99
| prune-epoch  18 |   400/ 1327 batches | lr 20.00 | ms/batch 15.47 | loss  3.90 | ppl    49.59
| prune-epoch  18 |   600/ 1327 batches | lr 20.00 | ms/batch 15.48 | loss  3.89 | ppl    49.02
| prune-epoch  18 |   800/ 1327 batches | lr 20.00 | ms/batch 15.49 | loss  3.85 | ppl    47.14
| prune-epoch  18 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.50 | loss  3.93 | ppl    50.98
| prune-epoch  18 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.48 | loss  3.80 | ppl    44.86
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
-----------------------------------------------------------------------------------------
| end of prune epoch  18 | time: 21.27s | valid loss  4.51 | valid ppl    90.97
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  19 |   200/ 1327 batches | lr 20.00 | ms/batch 15.86 | loss  4.07 | ppl    58.29
| prune-epoch  19 |   400/ 1327 batches | lr 20.00 | ms/batch 15.49 | loss  4.04 | ppl    56.75
| prune-epoch  19 |   600/ 1327 batches | lr 20.00 | ms/batch 15.50 | loss  4.02 | ppl    55.95
| prune-epoch  19 |   800/ 1327 batches | lr 20.00 | ms/batch 15.53 | loss  3.97 | ppl    53.18
| prune-epoch  19 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.52 | loss  4.04 | ppl    56.89
| prune-epoch  19 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.52 | loss  3.92 | ppl    50.33
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch  19 | time: 21.32s | valid loss  4.51 | valid ppl    91.22
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 15.74 | loss  4.00 | ppl    54.34
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  3.99 | ppl    53.83
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 15.49 | loss  3.97 | ppl    53.16
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 15.42 | loss  3.94 | ppl    51.35
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.41 | loss  4.00 | ppl    54.84
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.41 | loss  3.89 | ppl    48.92
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   1 | time: 21.17s | valid loss  4.51 | valid ppl    90.93
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 15.87 | loss  3.96 | ppl    52.61
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 15.51 | loss  3.96 | ppl    52.36
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 15.50 | loss  3.95 | ppl    51.71
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 15.50 | loss  3.91 | ppl    49.88
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.48 | loss  3.99 | ppl    53.97
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.51 | loss  3.86 | ppl    47.62
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   2 | time: 21.29s | valid loss  4.51 | valid ppl    91.35
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 15.74 | loss  3.94 | ppl    51.65
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 15.41 | loss  3.94 | ppl    51.62
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 15.62 | loss  3.93 | ppl    50.86
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 15.69 | loss  3.90 | ppl    49.22
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.68 | loss  3.97 | ppl    52.77
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.68 | loss  3.85 | ppl    46.88
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   3 | time: 21.38s | valid loss  4.52 | valid ppl    91.85
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 5.00 | ms/batch 16.20 | loss  3.92 | ppl    50.42
| prune-epoch   4 |   400/ 1327 batches | lr 5.00 | ms/batch 15.78 | loss  3.89 | ppl    48.84
| prune-epoch   4 |   600/ 1327 batches | lr 5.00 | ms/batch 15.74 | loss  3.86 | ppl    47.38
| prune-epoch   4 |   800/ 1327 batches | lr 5.00 | ms/batch 15.74 | loss  3.81 | ppl    45.02
| prune-epoch   4 |  1000/ 1327 batches | lr 5.00 | ms/batch 15.75 | loss  3.87 | ppl    47.74
| prune-epoch   4 |  1200/ 1327 batches | lr 5.00 | ms/batch 15.74 | loss  3.72 | ppl    41.40
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   4 | time: 21.64s | valid loss  4.50 | valid ppl    89.93
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 16.08 | loss  3.86 | ppl    47.56
| prune-epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 15.61 | loss  3.86 | ppl    47.23
| prune-epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 15.41 | loss  3.83 | ppl    46.17
| prune-epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 16.52 | loss  3.78 | ppl    43.91
| prune-epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 17.52 | loss  3.84 | ppl    46.69
| prune-epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 15.39 | loss  3.71 | ppl    40.80
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   5 | time: 21.92s | valid loss  4.50 | valid ppl    89.60
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 15.95 | loss  3.84 | ppl    46.66
| prune-epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 15.50 | loss  3.83 | ppl    46.17
| prune-epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 15.46 | loss  3.82 | ppl    45.47
| prune-epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 15.46 | loss  3.77 | ppl    43.21
| prune-epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 15.28 | loss  3.84 | ppl    46.60
| prune-epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 15.52 | loss  3.70 | ppl    40.54
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   6 | time: 21.26s | valid loss  4.50 | valid ppl    89.87
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 15.84 | loss  3.83 | ppl    46.18
| prune-epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 15.50 | loss  3.82 | ppl    45.38
| prune-epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 15.50 | loss  3.81 | ppl    45.12
| prune-epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 15.50 | loss  3.76 | ppl    42.87
| prune-epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 15.50 | loss  3.83 | ppl    46.10
| prune-epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 15.51 | loss  3.69 | ppl    40.09
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   7 | time: 21.29s | valid loss  4.50 | valid ppl    89.94
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 1.25 | ms/batch 15.75 | loss  3.84 | ppl    46.54
| prune-epoch   8 |   400/ 1327 batches | lr 1.25 | ms/batch 15.40 | loss  3.82 | ppl    45.82
| prune-epoch   8 |   600/ 1327 batches | lr 1.25 | ms/batch 15.41 | loss  3.81 | ppl    44.95
| prune-epoch   8 |   800/ 1327 batches | lr 1.25 | ms/batch 15.40 | loss  3.74 | ppl    42.22
| prune-epoch   8 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.41 | loss  3.82 | ppl    45.38
| prune-epoch   8 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.40 | loss  3.67 | ppl    39.33
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   8 | time: 21.17s | valid loss  4.49 | valid ppl    88.80
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 1.25 | ms/batch 15.86 | loss  3.83 | ppl    45.94
| prune-epoch   9 |   400/ 1327 batches | lr 1.25 | ms/batch 15.48 | loss  3.81 | ppl    45.15
| prune-epoch   9 |   600/ 1327 batches | lr 1.25 | ms/batch 15.46 | loss  3.79 | ppl    44.18
| prune-epoch   9 |   800/ 1327 batches | lr 1.25 | ms/batch 15.37 | loss  3.74 | ppl    42.18
| prune-epoch   9 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.52 | loss  3.81 | ppl    45.00
| prune-epoch   9 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.49 | loss  3.67 | ppl    39.08
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   9 | time: 21.26s | valid loss  4.49 | valid ppl    88.72
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 15.78 | loss  3.82 | ppl    45.47
| prune-epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 15.42 | loss  3.80 | ppl    44.79
| prune-epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 15.43 | loss  3.79 | ppl    44.18
| prune-epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 15.41 | loss  3.73 | ppl    41.70
| prune-epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.54 | loss  3.80 | ppl    44.89
| prune-epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.58 | loss  3.67 | ppl    39.15
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  10 | time: 21.27s | valid loss  4.49 | valid ppl    88.78
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 15.96 | loss  3.81 | ppl    45.09
| prune-epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 15.62 | loss  3.79 | ppl    44.42
| prune-epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 15.63 | loss  3.78 | ppl    43.96
| prune-epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 15.62 | loss  3.73 | ppl    41.52
| prune-epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.62 | loss  3.80 | ppl    44.69
| prune-epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.61 | loss  3.66 | ppl    39.00
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  11 | time: 21.45s | valid loss  4.49 | valid ppl    88.94
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 0.31 | ms/batch 15.80 | loss  3.82 | ppl    45.63
| prune-epoch  12 |   400/ 1327 batches | lr 0.31 | ms/batch 15.23 | loss  3.81 | ppl    44.93
| prune-epoch  12 |   600/ 1327 batches | lr 0.31 | ms/batch 15.61 | loss  3.79 | ppl    44.20
| prune-epoch  12 |   800/ 1327 batches | lr 0.31 | ms/batch 15.58 | loss  3.73 | ppl    41.79
| prune-epoch  12 |  1000/ 1327 batches | lr 0.31 | ms/batch 15.57 | loss  3.80 | ppl    44.66
| prune-epoch  12 |  1200/ 1327 batches | lr 0.31 | ms/batch 15.57 | loss  3.66 | ppl    38.80
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  12 | time: 21.31s | valid loss  4.48 | valid ppl    88.34
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 0.31 | ms/batch 16.03 | loss  3.81 | ppl    45.33
| prune-epoch  13 |   400/ 1327 batches | lr 0.31 | ms/batch 15.66 | loss  3.79 | ppl    44.35
| prune-epoch  13 |   600/ 1327 batches | lr 0.31 | ms/batch 15.66 | loss  3.78 | ppl    43.89
| prune-epoch  13 |   800/ 1327 batches | lr 0.31 | ms/batch 15.52 | loss  3.73 | ppl    41.59
| prune-epoch  13 |  1000/ 1327 batches | lr 0.31 | ms/batch 15.49 | loss  3.80 | ppl    44.61
| prune-epoch  13 |  1200/ 1327 batches | lr 0.31 | ms/batch 15.47 | loss  3.65 | ppl    38.59
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  13 | time: 21.39s | valid loss  4.48 | valid ppl    88.32
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 0.31 | ms/batch 15.89 | loss  3.81 | ppl    45.27
| prune-epoch  14 |   400/ 1327 batches | lr 0.31 | ms/batch 15.52 | loss  3.80 | ppl    44.62
| prune-epoch  14 |   600/ 1327 batches | lr 0.31 | ms/batch 15.52 | loss  3.78 | ppl    43.60
| prune-epoch  14 |   800/ 1327 batches | lr 0.31 | ms/batch 15.51 | loss  3.72 | ppl    41.41
| prune-epoch  14 |  1000/ 1327 batches | lr 0.31 | ms/batch 15.51 | loss  3.80 | ppl    44.61
| prune-epoch  14 |  1200/ 1327 batches | lr 0.31 | ms/batch 15.52 | loss  3.66 | ppl    38.75
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  14 | time: 21.30s | valid loss  4.48 | valid ppl    88.29
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 0.31 | ms/batch 15.74 | loss  3.81 | ppl    45.21
| prune-epoch  15 |   400/ 1327 batches | lr 0.31 | ms/batch 15.43 | loss  3.79 | ppl    44.34
| prune-epoch  15 |   600/ 1327 batches | lr 0.31 | ms/batch 15.40 | loss  3.78 | ppl    43.79
| prune-epoch  15 |   800/ 1327 batches | lr 0.31 | ms/batch 15.38 | loss  3.73 | ppl    41.65
| prune-epoch  15 |  1000/ 1327 batches | lr 0.31 | ms/batch 15.38 | loss  3.80 | ppl    44.66
| prune-epoch  15 |  1200/ 1327 batches | lr 0.31 | ms/batch 15.39 | loss  3.66 | ppl    38.70
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  15 | time: 21.15s | valid loss  4.48 | valid ppl    88.23
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  16 |   200/ 1327 batches | lr 0.31 | ms/batch 15.87 | loss  3.81 | ppl    45.07
| prune-epoch  16 |   400/ 1327 batches | lr 0.31 | ms/batch 15.49 | loss  3.79 | ppl    44.23
| prune-epoch  16 |   600/ 1327 batches | lr 0.31 | ms/batch 15.47 | loss  3.78 | ppl    43.62
| prune-epoch  16 |   800/ 1327 batches | lr 0.31 | ms/batch 15.47 | loss  3.72 | ppl    41.42
| prune-epoch  16 |  1000/ 1327 batches | lr 0.31 | ms/batch 15.47 | loss  3.80 | ppl    44.57
| prune-epoch  16 |  1200/ 1327 batches | lr 0.31 | ms/batch 15.48 | loss  3.66 | ppl    38.84
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  16 | time: 21.27s | valid loss  4.48 | valid ppl    88.24
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  17 |   200/ 1327 batches | lr 0.31 | ms/batch 15.72 | loss  3.80 | ppl    44.89
| prune-epoch  17 |   400/ 1327 batches | lr 0.31 | ms/batch 15.41 | loss  3.79 | ppl    44.30
| prune-epoch  17 |   600/ 1327 batches | lr 0.31 | ms/batch 15.39 | loss  3.77 | ppl    43.38
| prune-epoch  17 |   800/ 1327 batches | lr 0.31 | ms/batch 15.39 | loss  3.72 | ppl    41.27
| prune-epoch  17 |  1000/ 1327 batches | lr 0.31 | ms/batch 15.39 | loss  3.80 | ppl    44.59
| prune-epoch  17 |  1200/ 1327 batches | lr 0.31 | ms/batch 15.27 | loss  3.65 | ppl    38.57
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  17 | time: 21.14s | valid loss  4.48 | valid ppl    88.26
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  18 |   200/ 1327 batches | lr 0.08 | ms/batch 15.79 | loss  3.81 | ppl    44.98
| prune-epoch  18 |   400/ 1327 batches | lr 0.08 | ms/batch 15.44 | loss  3.79 | ppl    44.35
| prune-epoch  18 |   600/ 1327 batches | lr 0.08 | ms/batch 15.46 | loss  3.78 | ppl    43.67
| prune-epoch  18 |   800/ 1327 batches | lr 0.08 | ms/batch 15.44 | loss  3.72 | ppl    41.44
| prune-epoch  18 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.46 | loss  3.79 | ppl    44.37
| prune-epoch  18 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.46 | loss  3.65 | ppl    38.56
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  18 | time: 21.23s | valid loss  4.48 | valid ppl    88.09
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  19 |   200/ 1327 batches | lr 0.08 | ms/batch 15.78 | loss  3.81 | ppl    45.18
| prune-epoch  19 |   400/ 1327 batches | lr 0.08 | ms/batch 15.41 | loss  3.79 | ppl    44.16
| prune-epoch  19 |   600/ 1327 batches | lr 0.08 | ms/batch 15.39 | loss  3.77 | ppl    43.53
| prune-epoch  19 |   800/ 1327 batches | lr 0.08 | ms/batch 15.40 | loss  3.72 | ppl    41.37
| prune-epoch  19 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.40 | loss  3.79 | ppl    44.32
| prune-epoch  19 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.38 | loss  3.65 | ppl    38.57
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  19 | time: 21.16s | valid loss  4.48 | valid ppl    88.06
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  20 |   200/ 1327 batches | lr 0.08 | ms/batch 15.85 | loss  3.81 | ppl    45.21
| prune-epoch  20 |   400/ 1327 batches | lr 0.08 | ms/batch 15.45 | loss  3.79 | ppl    44.14
| prune-epoch  20 |   600/ 1327 batches | lr 0.08 | ms/batch 15.46 | loss  3.77 | ppl    43.53
| prune-epoch  20 |   800/ 1327 batches | lr 0.08 | ms/batch 15.35 | loss  3.72 | ppl    41.32
| prune-epoch  20 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.43 | loss  3.80 | ppl    44.71
| prune-epoch  20 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.47 | loss  3.65 | ppl    38.52
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  20 | time: 21.22s | valid loss  4.48 | valid ppl    88.03
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  21 |   200/ 1327 batches | lr 0.08 | ms/batch 15.97 | loss  3.80 | ppl    44.90
| prune-epoch  21 |   400/ 1327 batches | lr 0.08 | ms/batch 15.49 | loss  3.79 | ppl    44.24
| prune-epoch  21 |   600/ 1327 batches | lr 0.08 | ms/batch 15.50 | loss  3.78 | ppl    43.80
| prune-epoch  21 |   800/ 1327 batches | lr 0.08 | ms/batch 15.48 | loss  3.72 | ppl    41.15
| prune-epoch  21 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.48 | loss  3.80 | ppl    44.50
| prune-epoch  21 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.47 | loss  3.65 | ppl    38.40
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  21 | time: 21.30s | valid loss  4.48 | valid ppl    88.01
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  22 |   200/ 1327 batches | lr 0.08 | ms/batch 15.79 | loss  3.80 | ppl    44.86
| prune-epoch  22 |   400/ 1327 batches | lr 0.08 | ms/batch 15.45 | loss  3.79 | ppl    44.15
| prune-epoch  22 |   600/ 1327 batches | lr 0.08 | ms/batch 15.42 | loss  3.78 | ppl    43.85
| prune-epoch  22 |   800/ 1327 batches | lr 0.08 | ms/batch 15.41 | loss  3.72 | ppl    41.23
| prune-epoch  22 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.43 | loss  3.80 | ppl    44.66
| prune-epoch  22 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.42 | loss  3.66 | ppl    38.75
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  22 | time: 21.20s | valid loss  4.48 | valid ppl    88.02
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  23 |   200/ 1327 batches | lr 0.08 | ms/batch 15.84 | loss  3.81 | ppl    45.04
| prune-epoch  23 |   400/ 1327 batches | lr 0.08 | ms/batch 15.50 | loss  3.79 | ppl    44.04
| prune-epoch  23 |   600/ 1327 batches | lr 0.08 | ms/batch 15.32 | loss  3.77 | ppl    43.50
| prune-epoch  23 |   800/ 1327 batches | lr 0.08 | ms/batch 15.56 | loss  3.72 | ppl    41.10
| prune-epoch  23 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.50 | loss  3.79 | ppl    44.13
| prune-epoch  23 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.49 | loss  3.65 | ppl    38.52
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  23 | time: 21.26s | valid loss  4.48 | valid ppl    88.01
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  24 |   200/ 1327 batches | lr 0.08 | ms/batch 15.82 | loss  3.81 | ppl    45.00
| prune-epoch  24 |   400/ 1327 batches | lr 0.08 | ms/batch 15.45 | loss  3.79 | ppl    44.17
| prune-epoch  24 |   600/ 1327 batches | lr 0.08 | ms/batch 15.45 | loss  3.77 | ppl    43.30
| prune-epoch  24 |   800/ 1327 batches | lr 0.08 | ms/batch 15.44 | loss  3.72 | ppl    41.35
| prune-epoch  24 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.43 | loss  3.79 | ppl    44.29
| prune-epoch  24 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.43 | loss  3.66 | ppl    38.70
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  24 | time: 21.22s | valid loss  4.48 | valid ppl    88.01
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  25 |   200/ 1327 batches | lr 0.08 | ms/batch 15.87 | loss  3.80 | ppl    44.77
| prune-epoch  25 |   400/ 1327 batches | lr 0.08 | ms/batch 15.48 | loss  3.79 | ppl    44.33
| prune-epoch  25 |   600/ 1327 batches | lr 0.08 | ms/batch 15.50 | loss  3.77 | ppl    43.37
| prune-epoch  25 |   800/ 1327 batches | lr 0.08 | ms/batch 15.49 | loss  3.72 | ppl    41.32
| prune-epoch  25 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.48 | loss  3.79 | ppl    44.36
| prune-epoch  25 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.49 | loss  3.66 | ppl    38.69
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  25 | time: 21.28s | valid loss  4.48 | valid ppl    87.99
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  26 |   200/ 1327 batches | lr 0.08 | ms/batch 15.70 | loss  3.81 | ppl    45.01
| prune-epoch  26 |   400/ 1327 batches | lr 0.08 | ms/batch 15.38 | loss  3.79 | ppl    44.07
| prune-epoch  26 |   600/ 1327 batches | lr 0.08 | ms/batch 15.45 | loss  3.77 | ppl    43.49
| prune-epoch  26 |   800/ 1327 batches | lr 0.08 | ms/batch 15.43 | loss  3.72 | ppl    41.07
| prune-epoch  26 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.41 | loss  3.79 | ppl    44.46
| prune-epoch  26 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.41 | loss  3.66 | ppl    38.75
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  26 | time: 21.17s | valid loss  4.48 | valid ppl    88.00
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  27 |   200/ 1327 batches | lr 0.02 | ms/batch 15.82 | loss  3.81 | ppl    44.95
| prune-epoch  27 |   400/ 1327 batches | lr 0.02 | ms/batch 15.48 | loss  3.79 | ppl    44.07
| prune-epoch  27 |   600/ 1327 batches | lr 0.02 | ms/batch 15.49 | loss  3.78 | ppl    43.80
| prune-epoch  27 |   800/ 1327 batches | lr 0.02 | ms/batch 15.48 | loss  3.72 | ppl    41.14
| prune-epoch  27 |  1000/ 1327 batches | lr 0.02 | ms/batch 15.48 | loss  3.80 | ppl    44.64
| prune-epoch  27 |  1200/ 1327 batches | lr 0.02 | ms/batch 15.48 | loss  3.66 | ppl    38.70
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  27 | time: 21.27s | valid loss  4.48 | valid ppl    87.98
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  28 |   200/ 1327 batches | lr 0.02 | ms/batch 15.93 | loss  3.81 | ppl    44.97
| prune-epoch  28 |   400/ 1327 batches | lr 0.02 | ms/batch 15.53 | loss  3.79 | ppl    44.22
| prune-epoch  28 |   600/ 1327 batches | lr 0.02 | ms/batch 15.52 | loss  3.77 | ppl    43.46
| prune-epoch  28 |   800/ 1327 batches | lr 0.02 | ms/batch 15.52 | loss  3.72 | ppl    41.21
| prune-epoch  28 |  1000/ 1327 batches | lr 0.02 | ms/batch 15.53 | loss  3.79 | ppl    44.27
| prune-epoch  28 |  1200/ 1327 batches | lr 0.02 | ms/batch 15.51 | loss  3.65 | ppl    38.47
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  28 | time: 21.30s | valid loss  4.48 | valid ppl    87.97
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  29 |   200/ 1327 batches | lr 0.02 | ms/batch 15.85 | loss  3.81 | ppl    44.96
| prune-epoch  29 |   400/ 1327 batches | lr 0.02 | ms/batch 15.41 | loss  3.79 | ppl    44.15
| prune-epoch  29 |   600/ 1327 batches | lr 0.02 | ms/batch 15.64 | loss  3.77 | ppl    43.51
| prune-epoch  29 |   800/ 1327 batches | lr 0.02 | ms/batch 17.95 | loss  3.72 | ppl    41.39
| prune-epoch  29 |  1000/ 1327 batches | lr 0.02 | ms/batch 15.43 | loss  3.79 | ppl    44.39
| prune-epoch  29 |  1200/ 1327 batches | lr 0.02 | ms/batch 15.38 | loss  3.66 | ppl    38.69
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  29 | time: 21.74s | valid loss  4.48 | valid ppl    87.97
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  30 |   200/ 1327 batches | lr 0.02 | ms/batch 15.84 | loss  3.81 | ppl    45.04
| prune-epoch  30 |   400/ 1327 batches | lr 0.02 | ms/batch 15.69 | loss  3.79 | ppl    44.09
| prune-epoch  30 |   600/ 1327 batches | lr 0.02 | ms/batch 15.76 | loss  3.77 | ppl    43.49
| prune-epoch  30 |   800/ 1327 batches | lr 0.02 | ms/batch 15.74 | loss  3.72 | ppl    41.16
| prune-epoch  30 |  1000/ 1327 batches | lr 0.02 | ms/batch 18.57 | loss  3.79 | ppl    44.34
| prune-epoch  30 |  1200/ 1327 batches | lr 0.02 | ms/batch 20.67 | loss  3.65 | ppl    38.44
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  30 | time: 23.75s | valid loss  4.48 | valid ppl    87.97
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  31 |   200/ 1327 batches | lr 0.02 | ms/batch 18.82 | loss  3.81 | ppl    45.05
| prune-epoch  31 |   400/ 1327 batches | lr 0.02 | ms/batch 15.42 | loss  3.79 | ppl    44.17
| prune-epoch  31 |   600/ 1327 batches | lr 0.02 | ms/batch 15.40 | loss  3.77 | ppl    43.33
| prune-epoch  31 |   800/ 1327 batches | lr 0.02 | ms/batch 15.22 | loss  3.72 | ppl    41.15
| prune-epoch  31 |  1000/ 1327 batches | lr 0.02 | ms/batch 15.46 | loss  3.79 | ppl    44.21
| prune-epoch  31 |  1200/ 1327 batches | lr 0.02 | ms/batch 15.40 | loss  3.65 | ppl    38.65
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  31 | time: 21.76s | valid loss  4.48 | valid ppl    87.96
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  32 |   200/ 1327 batches | lr 0.02 | ms/batch 16.69 | loss  3.81 | ppl    45.06
| prune-epoch  32 |   400/ 1327 batches | lr 0.02 | ms/batch 27.53 | loss  3.79 | ppl    44.18
| prune-epoch  32 |   600/ 1327 batches | lr 0.02 | ms/batch 43.32 | loss  3.77 | ppl    43.50
| prune-epoch  32 |   800/ 1327 batches | lr 0.02 | ms/batch 25.12 | loss  3.72 | ppl    41.26
| prune-epoch  32 |  1000/ 1327 batches | lr 0.02 | ms/batch 16.79 | loss  3.79 | ppl    44.24
| prune-epoch  32 |  1200/ 1327 batches | lr 0.02 | ms/batch 19.61 | loss  3.65 | ppl    38.56
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  32 | time: 38.32s | valid loss  4.48 | valid ppl    87.95
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  33 |   200/ 1327 batches | lr 0.02 | ms/batch 42.80 | loss  3.80 | ppl    44.92
| prune-epoch  33 |   400/ 1327 batches | lr 0.02 | ms/batch 37.15 | loss  3.79 | ppl    44.15
| prune-epoch  33 |   600/ 1327 batches | lr 0.02 | ms/batch 50.98 | loss  3.77 | ppl    43.58
| prune-epoch  33 |   800/ 1327 batches | lr 0.02 | ms/batch 36.16 | loss  3.72 | ppl    41.25
| prune-epoch  33 |  1000/ 1327 batches | lr 0.02 | ms/batch 36.87 | loss  3.79 | ppl    44.36
| prune-epoch  33 |  1200/ 1327 batches | lr 0.02 | ms/batch 15.40 | loss  3.65 | ppl    38.62
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  33 | time: 46.48s | valid loss  4.48 | valid ppl    87.95
-----------------------------------------------------------------------------------------
required epochs  40 | actual epochs  67
pretrain epochs  15 | prune epochs  19 | retrain epochs  33
=========================================================================================
| End of training | test loss  4.42 | test ppl    83.37
=========================================================================================
python main.py --cuda --emsize 650 --nhid 650 --dropout 0.5 --epochs 40 --tied --save model/prune/model.pt --data ./data/ptb --prune --retrain --sparsity 0.9
<class 'torch.Tensor'> torch.Size([10000, 650])
<class 'torch.Tensor'> torch.Size([2600, 650])
<class 'torch.Tensor'> torch.Size([2600, 650])
<class 'torch.Tensor'> torch.Size([2600])
<class 'torch.Tensor'> torch.Size([2600])
<class 'torch.Tensor'> torch.Size([2600, 650])
<class 'torch.Tensor'> torch.Size([2600, 650])
<class 'torch.Tensor'> torch.Size([2600])
<class 'torch.Tensor'> torch.Size([2600])
<class 'torch.Tensor'> torch.Size([10000])
RNNModel(
  (drop): Dropout(p=0.5)
  (encoder): Embedding(10000, 650)
  (rnn): LSTM(650, 650, num_layers=2, dropout=0.5)
  (decoder): Linear(in_features=650, out_features=10000, bias=True)
)
Dropout(p=0.5)
Embedding(10000, 650)
LSTM(650, 650, num_layers=2, dropout=0.5)
Linear(in_features=650, out_features=10000, bias=True)
| train-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 15.26 | loss  7.00 | ppl  1093.67
| train-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 15.04 | loss  6.23 | ppl   506.48
| train-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 14.97 | loss  5.92 | ppl   373.25
| train-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  5.68 | ppl   292.55
| train-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  5.57 | ppl   262.34
| train-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.22 | loss  5.43 | ppl   228.61
-----------------------------------------------------------------------------------------
| end of train epoch   1 | time: 20.83s | valid loss  5.31 | valid ppl   202.55
-----------------------------------------------------------------------------------------
| train-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 15.19 | loss  5.37 | ppl   213.88
| train-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 15.09 | loss  5.30 | ppl   200.46
| train-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 15.13 | loss  5.25 | ppl   190.26
| train-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 15.13 | loss  5.14 | ppl   171.55
| train-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.13 | loss  5.14 | ppl   171.21
| train-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.14 | loss  5.04 | ppl   154.00
-----------------------------------------------------------------------------------------
| end of train epoch   2 | time: 20.75s | valid loss  5.00 | valid ppl   147.69
-----------------------------------------------------------------------------------------
| train-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 15.49 | loss  5.04 | ppl   154.33
| train-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 15.41 | loss  5.02 | ppl   151.05
| train-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 15.39 | loss  4.99 | ppl   146.32
| train-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 15.42 | loss  4.91 | ppl   135.20
| train-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.39 | loss  4.93 | ppl   138.57
| train-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.42 | loss  4.82 | ppl   123.94
-----------------------------------------------------------------------------------------
| end of train epoch   3 | time: 21.12s | valid loss  4.83 | valid ppl   125.75
-----------------------------------------------------------------------------------------
| train-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  4.85 | ppl   127.69
| train-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.84 | ppl   126.48
| train-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.82 | ppl   124.29
| train-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 15.31 | loss  4.75 | ppl   116.00
| train-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.79 | ppl   120.88
| train-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.68 | ppl   108.06
-----------------------------------------------------------------------------------------
| end of train epoch   4 | time: 21.00s | valid loss  4.73 | valid ppl   113.02
-----------------------------------------------------------------------------------------
| train-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 15.47 | loss  4.73 | ppl   112.91
| train-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 15.40 | loss  4.72 | ppl   112.11
| train-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 15.40 | loss  4.71 | ppl   110.52
| train-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 15.38 | loss  4.64 | ppl   103.81
| train-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.39 | loss  4.70 | ppl   109.52
| train-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.38 | loss  4.58 | ppl    97.77
-----------------------------------------------------------------------------------------
| end of train epoch   5 | time: 21.09s | valid loss  4.66 | valid ppl   105.44
-----------------------------------------------------------------------------------------
| train-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 15.44 | loss  4.63 | ppl   102.72
| train-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 15.42 | loss  4.63 | ppl   102.52
| train-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 15.39 | loss  4.62 | ppl   101.22
| train-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 15.39 | loss  4.56 | ppl    95.19
| train-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.38 | loss  4.62 | ppl   101.33
| train-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.37 | loss  4.50 | ppl    89.88
-----------------------------------------------------------------------------------------
| end of train epoch   6 | time: 21.05s | valid loss  4.61 | valid ppl   100.07
-----------------------------------------------------------------------------------------
| train-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch 15.20 | loss  4.56 | ppl    95.67
| train-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch 15.15 | loss  4.56 | ppl    95.76
| train-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch 15.07 | loss  4.55 | ppl    94.53
| train-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch 15.10 | loss  4.49 | ppl    88.90
| train-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.09 | loss  4.55 | ppl    95.08
| train-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.08 | loss  4.44 | ppl    84.44
-----------------------------------------------------------------------------------------
| end of train epoch   7 | time: 20.71s | valid loss  4.58 | valid ppl    97.10
-----------------------------------------------------------------------------------------
| train-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch 15.22 | loss  4.50 | ppl    90.00
| train-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch 15.18 | loss  4.50 | ppl    89.93
| train-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch 15.16 | loss  4.49 | ppl    89.02
| train-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch 15.14 | loss  4.43 | ppl    84.28
| train-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.14 | loss  4.50 | ppl    90.28
| train-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.14 | loss  4.39 | ppl    80.29
-----------------------------------------------------------------------------------------
| end of train epoch   8 | time: 20.77s | valid loss  4.54 | valid ppl    94.12
-----------------------------------------------------------------------------------------
| train-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch 15.16 | loss  4.45 | ppl    85.40
| train-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch 15.08 | loss  4.46 | ppl    86.38
| train-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch 15.08 | loss  4.44 | ppl    85.12
| train-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch 15.06 | loss  4.39 | ppl    80.62
| train-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.05 | loss  4.46 | ppl    86.61
| train-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch 14.94 | loss  4.34 | ppl    76.72
-----------------------------------------------------------------------------------------
| end of train epoch   9 | time: 20.67s | valid loss  4.53 | valid ppl    92.73
-----------------------------------------------------------------------------------------
| train-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch 15.23 | loss  4.41 | ppl    81.94
| train-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch 15.16 | loss  4.41 | ppl    82.25
| train-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch 15.15 | loss  4.40 | ppl    81.60
| train-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch 15.14 | loss  4.35 | ppl    77.29
| train-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.15 | loss  4.42 | ppl    83.40
| train-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.16 | loss  4.30 | ppl    73.99
-----------------------------------------------------------------------------------------
| end of train epoch  10 | time: 20.78s | valid loss  4.51 | valid ppl    91.33
-----------------------------------------------------------------------------------------
| train-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch 15.26 | loss  4.37 | ppl    79.16
| train-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch 15.14 | loss  4.37 | ppl    79.25
| train-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch 15.15 | loss  4.37 | ppl    78.71
| train-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch 15.14 | loss  4.31 | ppl    74.51
| train-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.14 | loss  4.39 | ppl    80.74
| train-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.18 | loss  4.27 | ppl    71.21
-----------------------------------------------------------------------------------------
| end of train epoch  11 | time: 20.81s | valid loss  4.50 | valid ppl    89.86
-----------------------------------------------------------------------------------------
| train-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  4.34 | ppl    76.72
| train-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  4.34 | ppl    76.59
| train-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  4.33 | ppl    76.14
| train-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch 15.22 | loss  4.28 | ppl    72.23
| train-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch 14.99 | loss  4.36 | ppl    78.31
| train-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.23 | loss  4.24 | ppl    69.13
-----------------------------------------------------------------------------------------
| end of train epoch  12 | time: 20.82s | valid loss  4.49 | valid ppl    88.94
-----------------------------------------------------------------------------------------
| train-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch 15.24 | loss  4.31 | ppl    74.22
| train-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch 15.18 | loss  4.31 | ppl    74.75
| train-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch 15.15 | loss  4.30 | ppl    73.87
| train-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch 15.15 | loss  4.25 | ppl    70.23
| train-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.15 | loss  4.33 | ppl    75.98
| train-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.14 | loss  4.21 | ppl    67.25
-----------------------------------------------------------------------------------------
| end of train epoch  13 | time: 20.78s | valid loss  4.48 | valid ppl    88.04
-----------------------------------------------------------------------------------------
| train-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch 15.15 | loss  4.28 | ppl    72.18
| train-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch 15.11 | loss  4.28 | ppl    72.48
| train-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch 15.10 | loss  4.28 | ppl    71.99
| train-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch 15.08 | loss  4.23 | ppl    68.46
| train-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.09 | loss  4.31 | ppl    74.22
| train-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.08 | loss  4.18 | ppl    65.67
-----------------------------------------------------------------------------------------
| end of train epoch  14 | time: 20.70s | valid loss  4.47 | valid ppl    87.45
-----------------------------------------------------------------------------------------
| train-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  4.26 | ppl    70.54
| train-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch 15.16 | loss  4.26 | ppl    71.01
| train-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch 15.16 | loss  4.25 | ppl    70.22
| train-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch 15.01 | loss  4.20 | ppl    66.91
| train-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.16 | loss  4.29 | ppl    72.81
| train-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.16 | loss  4.17 | ppl    64.40
-----------------------------------------------------------------------------------------
| end of train epoch  15 | time: 20.75s | valid loss  4.46 | valid ppl    86.85
-----------------------------------------------------------------------------------------
| train-epoch  16 |   200/ 1327 batches | lr 20.00 | ms/batch 15.16 | loss  4.24 | ppl    69.15
| train-epoch  16 |   400/ 1327 batches | lr 20.00 | ms/batch 15.11 | loss  4.24 | ppl    69.64
| train-epoch  16 |   600/ 1327 batches | lr 20.00 | ms/batch 15.10 | loss  4.23 | ppl    68.78
| train-epoch  16 |   800/ 1327 batches | lr 20.00 | ms/batch 15.09 | loss  4.18 | ppl    65.51
| train-epoch  16 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.09 | loss  4.27 | ppl    71.35
| train-epoch  16 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.10 | loss  4.14 | ppl    62.99
-----------------------------------------------------------------------------------------
| end of train epoch  16 | time: 20.70s | valid loss  4.46 | valid ppl    86.88
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 15.85 | loss  4.22 | ppl    67.95
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  4.22 | ppl    67.80
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.20 | ppl    66.85
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.15 | ppl    63.60
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.23 | ppl    68.74
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.10 | ppl    60.19
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch   1 | time: 21.10s | valid loss  4.45 | valid ppl    85.51
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 15.73 | loss  4.18 | ppl    65.45
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  4.18 | ppl    65.16
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 15.18 | loss  4.17 | ppl    64.77
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 15.30 | loss  4.12 | ppl    61.49
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.27 | loss  4.21 | ppl    67.02
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.26 | loss  4.08 | ppl    59.13
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch   2 | time: 20.98s | valid loss  4.45 | valid ppl    85.42
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 15.81 | loss  4.16 | ppl    64.00
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.16 | ppl    64.07
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.15 | ppl    63.40
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.10 | ppl    60.26
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.18 | ppl    65.63
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.05 | ppl    57.59
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch   3 | time: 21.09s | valid loss  4.44 | valid ppl    84.51
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 15.84 | loss  4.13 | ppl    62.44
| prune-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.14 | ppl    62.67
| prune-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 15.36 | loss  4.12 | ppl    61.84
| prune-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.07 | ppl    58.78
| prune-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.17 | ppl    64.73
| prune-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.04 | ppl    56.57
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.4  actual sp:  0.3984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch   4 | time: 21.11s | valid loss  4.44 | valid ppl    84.65
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 15.66 | loss  4.12 | ppl    61.63
| prune-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 15.24 | loss  4.12 | ppl    61.49
| prune-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  4.12 | ppl    61.46
| prune-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 15.27 | loss  4.06 | ppl    58.02
| prune-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  4.15 | ppl    63.59
| prune-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  4.02 | ppl    55.44
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch   5 | time: 20.98s | valid loss  4.43 | valid ppl    84.18
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 15.81 | loss  4.10 | ppl    60.47
| prune-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.10 | ppl    60.44
| prune-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.10 | ppl    60.17
| prune-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.05 | ppl    57.20
| prune-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.13 | ppl    62.28
| prune-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.01 | ppl    54.91
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.5  actual sp:  0.4984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch   6 | time: 21.09s | valid loss  4.44 | valid ppl    84.73
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch 15.73 | loss  4.10 | ppl    60.56
| prune-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  4.10 | ppl    60.25
| prune-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  4.09 | ppl    59.74
| prune-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch 15.31 | loss  4.04 | ppl    56.70
| prune-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.12 | ppl    61.61
| prune-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.49 | loss  3.99 | ppl    54.16
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch   7 | time: 21.10s | valid loss  4.43 | valid ppl    84.05
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch 16.26 | loss  4.07 | ppl    58.78
| prune-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch 15.70 | loss  4.08 | ppl    59.00
| prune-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch 15.72 | loss  4.07 | ppl    58.31
| prune-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch 15.72 | loss  4.01 | ppl    55.42
| prune-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.74 | loss  4.10 | ppl    60.41
| prune-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.75 | loss  3.97 | ppl    53.23
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch   8 | time: 21.64s | valid loss  4.43 | valid ppl    83.99
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch 15.77 | loss  4.05 | ppl    57.58
| prune-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch 15.69 | loss  4.06 | ppl    57.74
| prune-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch 15.70 | loss  4.05 | ppl    57.24
| prune-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch 15.70 | loss  4.00 | ppl    54.50
| prune-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.67 | loss  4.09 | ppl    59.86
| prune-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.70 | loss  3.96 | ppl    52.46
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.6  actual sp:  0.5984615384615385
-----------------------------------------------------------------------------------------
| end of prune epoch   9 | time: 21.50s | valid loss  4.44 | valid ppl    84.48
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch 15.86 | loss  4.09 | ppl    59.84
| prune-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch 15.38 | loss  4.08 | ppl    59.23
| prune-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch 15.37 | loss  4.07 | ppl    58.41
| prune-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch 15.37 | loss  4.02 | ppl    55.47
| prune-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.10 | ppl    60.50
| prune-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.27 | loss  3.97 | ppl    53.16
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
-----------------------------------------------------------------------------------------
| end of prune epoch  10 | time: 21.12s | valid loss  4.43 | valid ppl    84.32
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch 15.73 | loss  4.05 | ppl    57.32
| prune-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.05 | ppl    57.66
| prune-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  4.04 | ppl    56.95
| prune-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  3.99 | ppl    54.15
| prune-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.08 | ppl    59.08
| prune-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.36 | loss  3.95 | ppl    51.98
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
-----------------------------------------------------------------------------------------
| end of prune epoch  11 | time: 21.10s | valid loss  4.42 | valid ppl    83.42
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch 15.69 | loss  4.04 | ppl    56.79
| prune-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch 15.26 | loss  4.03 | ppl    56.54
| prune-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.03 | ppl    56.29
| prune-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch 15.31 | loss  3.98 | ppl    53.35
| prune-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  4.06 | ppl    58.16
| prune-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.28 | loss  3.94 | ppl    51.30
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.7  actual sp:  0.696923076923077
-----------------------------------------------------------------------------------------
| end of prune epoch  12 | time: 21.02s | valid loss  4.43 | valid ppl    84.04
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch 15.75 | loss  4.13 | ppl    61.91
| prune-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch 15.38 | loss  4.11 | ppl    61.14
| prune-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch 15.47 | loss  4.10 | ppl    60.21
| prune-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch 15.21 | loss  4.05 | ppl    57.42
| prune-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.37 | loss  4.12 | ppl    61.77
| prune-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  3.99 | ppl    54.30
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch  13 | time: 21.10s | valid loss  4.43 | valid ppl    83.93
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch 15.66 | loss  4.07 | ppl    58.73
| prune-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.07 | ppl    58.48
| prune-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch 15.28 | loss  4.06 | ppl    57.99
| prune-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch 15.27 | loss  4.01 | ppl    55.02
| prune-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.27 | loss  4.10 | ppl    60.38
| prune-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  3.97 | ppl    53.20
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.7999999999999999  actual sp:  0.7984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch  14 | time: 21.02s | valid loss  4.43 | valid ppl    84.02
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch 15.71 | loss  4.14 | ppl    62.80
| prune-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  4.13 | ppl    61.95
| prune-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.12 | ppl    61.40
| prune-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.07 | ppl    58.38
| prune-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.36 | loss  4.15 | ppl    63.24
| prune-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.02 | ppl    55.54
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
-----------------------------------------------------------------------------------------
| end of prune epoch  15 | time: 21.08s | valid loss  4.43 | valid ppl    84.22
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  16 |   200/ 1327 batches | lr 20.00 | ms/batch 15.62 | loss  4.09 | ppl    60.03
| prune-epoch  16 |   400/ 1327 batches | lr 20.00 | ms/batch 15.30 | loss  4.09 | ppl    59.74
| prune-epoch  16 |   600/ 1327 batches | lr 20.00 | ms/batch 15.11 | loss  4.08 | ppl    59.28
| prune-epoch  16 |   800/ 1327 batches | lr 20.00 | ms/batch 15.44 | loss  4.04 | ppl    56.59
| prune-epoch  16 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.47 | loss  4.12 | ppl    61.53
| prune-epoch  16 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.40 | loss  3.99 | ppl    54.05
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.85  actual sp:  0.8476923076923077
-----------------------------------------------------------------------------------------
| end of prune epoch  16 | time: 21.06s | valid loss  4.44 | valid ppl    84.36
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  17 |   200/ 1327 batches | lr 20.00 | ms/batch 15.70 | loss  4.23 | ppl    68.47
| prune-epoch  17 |   400/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.21 | ppl    67.50
| prune-epoch  17 |   600/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.19 | ppl    66.14
| prune-epoch  17 |   800/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.14 | ppl    63.01
| prune-epoch  17 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.22 | ppl    67.72
| prune-epoch  17 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.09 | ppl    59.54
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of prune epoch  17 | time: 21.06s | valid loss  4.45 | valid ppl    85.45
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 15.68 | loss  4.16 | ppl    64.02
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  4.16 | ppl    63.92
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.15 | ppl    63.49
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.10 | ppl    60.63
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.35 | loss  4.18 | ppl    65.36
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.06 | ppl    57.99
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   1 | time: 21.10s | valid loss  4.45 | valid ppl    85.25
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 15.61 | loss  4.14 | ppl    62.71
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 15.15 | loss  4.14 | ppl    62.75
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 15.37 | loss  4.13 | ppl    62.16
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 15.24 | loss  4.08 | ppl    59.42
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.27 | loss  4.16 | ppl    64.31
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.26 | loss  4.04 | ppl    57.02
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   2 | time: 20.97s | valid loss  4.44 | valid ppl    84.45
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 15.72 | loss  4.12 | ppl    61.50
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 15.32 | loss  4.11 | ppl    61.08
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.11 | ppl    61.24
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.06 | ppl    58.25
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.34 | loss  4.15 | ppl    63.15
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.39 | loss  4.03 | ppl    56.13
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   3 | time: 21.13s | valid loss  4.45 | valid ppl    85.24
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 15.61 | loss  4.11 | ppl    60.66
| prune-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 15.24 | loss  4.10 | ppl    60.50
| prune-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 15.24 | loss  4.10 | ppl    60.11
| prune-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 15.24 | loss  4.05 | ppl    57.60
| prune-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.25 | loss  4.13 | ppl    62.26
| prune-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.26 | loss  4.01 | ppl    55.05
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   4 | time: 20.94s | valid loss  4.44 | valid ppl    85.01
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 15.64 | loss  4.09 | ppl    59.91
| prune-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 15.36 | loss  4.09 | ppl    60.01
| prune-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 15.33 | loss  4.09 | ppl    59.65
| prune-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 15.30 | loss  4.04 | ppl    56.89
| prune-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 15.30 | loss  4.13 | ppl    61.95
| prune-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 15.29 | loss  4.00 | ppl    54.37
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   5 | time: 21.04s | valid loss  4.45 | valid ppl    85.21
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 15.58 | loss  4.07 | ppl    58.85
| prune-epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 15.25 | loss  4.05 | ppl    57.33
| prune-epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 15.25 | loss  4.03 | ppl    56.35
| prune-epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 15.31 | loss  3.96 | ppl    52.63
| prune-epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 15.23 | loss  4.03 | ppl    56.51
| prune-epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 15.24 | loss  3.90 | ppl    49.27
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   6 | time: 20.96s | valid loss  4.42 | valid ppl    82.76
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 15.67 | loss  4.03 | ppl    55.99
| prune-epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 15.29 | loss  4.01 | ppl    55.28
| prune-epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 15.30 | loss  4.00 | ppl    54.60
| prune-epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 15.31 | loss  3.95 | ppl    51.80
| prune-epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 15.32 | loss  4.02 | ppl    55.85
| prune-epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 15.24 | loss  3.88 | ppl    48.63
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   7 | time: 21.02s | valid loss  4.42 | valid ppl    82.78
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch 15.63 | loss  4.00 | ppl    54.85
| prune-epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch 15.30 | loss  4.00 | ppl    54.57
| prune-epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch 15.30 | loss  3.98 | ppl    53.74
| prune-epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch 15.31 | loss  3.94 | ppl    51.18
| prune-epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch 15.31 | loss  4.01 | ppl    55.30
| prune-epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch 15.35 | loss  3.88 | ppl    48.30
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   8 | time: 21.04s | valid loss  4.42 | valid ppl    82.70
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 5.00 | ms/batch 15.58 | loss  4.00 | ppl    54.43
| prune-epoch   9 |   400/ 1327 batches | lr 5.00 | ms/batch 15.30 | loss  3.99 | ppl    54.05
| prune-epoch   9 |   600/ 1327 batches | lr 5.00 | ms/batch 15.28 | loss  3.98 | ppl    53.29
| prune-epoch   9 |   800/ 1327 batches | lr 5.00 | ms/batch 15.33 | loss  3.93 | ppl    50.86
| prune-epoch   9 |  1000/ 1327 batches | lr 5.00 | ms/batch 15.23 | loss  4.00 | ppl    54.81
| prune-epoch   9 |  1200/ 1327 batches | lr 5.00 | ms/batch 15.23 | loss  3.87 | ppl    47.98
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch   9 | time: 20.98s | valid loss  4.41 | valid ppl    82.66
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 5.00 | ms/batch 15.67 | loss  3.99 | ppl    53.80
| prune-epoch  10 |   400/ 1327 batches | lr 5.00 | ms/batch 15.37 | loss  3.98 | ppl    53.38
| prune-epoch  10 |   600/ 1327 batches | lr 5.00 | ms/batch 15.34 | loss  3.97 | ppl    52.93
| prune-epoch  10 |   800/ 1327 batches | lr 5.00 | ms/batch 15.33 | loss  3.92 | ppl    50.32
| prune-epoch  10 |  1000/ 1327 batches | lr 5.00 | ms/batch 15.21 | loss  4.00 | ppl    54.50
| prune-epoch  10 |  1200/ 1327 batches | lr 5.00 | ms/batch 15.44 | loss  3.87 | ppl    47.74
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  10 | time: 21.08s | valid loss  4.41 | valid ppl    82.59
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 5.00 | ms/batch 15.60 | loss  3.98 | ppl    53.39
| prune-epoch  11 |   400/ 1327 batches | lr 5.00 | ms/batch 15.32 | loss  3.97 | ppl    53.11
| prune-epoch  11 |   600/ 1327 batches | lr 5.00 | ms/batch 15.31 | loss  3.96 | ppl    52.43
| prune-epoch  11 |   800/ 1327 batches | lr 5.00 | ms/batch 15.26 | loss  3.91 | ppl    49.89
| prune-epoch  11 |  1000/ 1327 batches | lr 5.00 | ms/batch 15.26 | loss  3.99 | ppl    53.93
| prune-epoch  11 |  1200/ 1327 batches | lr 5.00 | ms/batch 15.28 | loss  3.86 | ppl    47.51
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  11 | time: 21.00s | valid loss  4.41 | valid ppl    82.34
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 5.00 | ms/batch 15.65 | loss  3.98 | ppl    53.33
| prune-epoch  12 |   400/ 1327 batches | lr 5.00 | ms/batch 15.36 | loss  3.96 | ppl    52.51
| prune-epoch  12 |   600/ 1327 batches | lr 5.00 | ms/batch 15.36 | loss  3.96 | ppl    52.25
| prune-epoch  12 |   800/ 1327 batches | lr 5.00 | ms/batch 15.32 | loss  3.91 | ppl    49.73
| prune-epoch  12 |  1000/ 1327 batches | lr 5.00 | ms/batch 15.34 | loss  3.98 | ppl    53.75
| prune-epoch  12 |  1200/ 1327 batches | lr 5.00 | ms/batch 15.33 | loss  3.86 | ppl    47.39
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  12 | time: 21.07s | valid loss  4.41 | valid ppl    82.56
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 1.25 | ms/batch 15.60 | loss  3.98 | ppl    53.43
| prune-epoch  13 |   400/ 1327 batches | lr 1.25 | ms/batch 15.25 | loss  3.96 | ppl    52.58
| prune-epoch  13 |   600/ 1327 batches | lr 1.25 | ms/batch 15.22 | loss  3.95 | ppl    52.06
| prune-epoch  13 |   800/ 1327 batches | lr 1.25 | ms/batch 15.21 | loss  3.90 | ppl    49.61
| prune-epoch  13 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.33 | loss  3.97 | ppl    52.86
| prune-epoch  13 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.27 | loss  3.84 | ppl    46.36
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  13 | time: 20.97s | valid loss  4.40 | valid ppl    81.85
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 1.25 | ms/batch 15.70 | loss  3.96 | ppl    52.69
| prune-epoch  14 |   400/ 1327 batches | lr 1.25 | ms/batch 15.33 | loss  3.95 | ppl    52.18
| prune-epoch  14 |   600/ 1327 batches | lr 1.25 | ms/batch 15.35 | loss  3.94 | ppl    51.48
| prune-epoch  14 |   800/ 1327 batches | lr 1.25 | ms/batch 15.33 | loss  3.89 | ppl    48.86
| prune-epoch  14 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.34 | loss  3.97 | ppl    52.82
| prune-epoch  14 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.35 | loss  3.83 | ppl    46.05
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  14 | time: 21.08s | valid loss  4.40 | valid ppl    81.83
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 1.25 | ms/batch 15.72 | loss  3.96 | ppl    52.56
| prune-epoch  15 |   400/ 1327 batches | lr 1.25 | ms/batch 15.33 | loss  3.95 | ppl    51.94
| prune-epoch  15 |   600/ 1327 batches | lr 1.25 | ms/batch 15.33 | loss  3.94 | ppl    51.39
| prune-epoch  15 |   800/ 1327 batches | lr 1.25 | ms/batch 15.31 | loss  3.88 | ppl    48.64
| prune-epoch  15 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.33 | loss  3.96 | ppl    52.45
| prune-epoch  15 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.32 | loss  3.83 | ppl    45.99
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  15 | time: 21.07s | valid loss  4.40 | valid ppl    81.81
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  16 |   200/ 1327 batches | lr 1.25 | ms/batch 15.59 | loss  3.96 | ppl    52.25
| prune-epoch  16 |   400/ 1327 batches | lr 1.25 | ms/batch 15.23 | loss  3.94 | ppl    51.59
| prune-epoch  16 |   600/ 1327 batches | lr 1.25 | ms/batch 15.33 | loss  3.94 | ppl    51.22
| prune-epoch  16 |   800/ 1327 batches | lr 1.25 | ms/batch 15.33 | loss  3.89 | ppl    48.71
| prune-epoch  16 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.30 | loss  3.96 | ppl    52.57
| prune-epoch  16 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.30 | loss  3.83 | ppl    46.01
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  16 | time: 21.01s | valid loss  4.40 | valid ppl    81.66
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  17 |   200/ 1327 batches | lr 1.25 | ms/batch 15.70 | loss  3.95 | ppl    52.10
| prune-epoch  17 |   400/ 1327 batches | lr 1.25 | ms/batch 15.36 | loss  3.94 | ppl    51.45
| prune-epoch  17 |   600/ 1327 batches | lr 1.25 | ms/batch 15.34 | loss  3.93 | ppl    51.03
| prune-epoch  17 |   800/ 1327 batches | lr 1.25 | ms/batch 15.35 | loss  3.88 | ppl    48.60
| prune-epoch  17 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.37 | loss  3.96 | ppl    52.32
| prune-epoch  17 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.33 | loss  3.82 | ppl    45.79
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  17 | time: 21.09s | valid loss  4.40 | valid ppl    81.83
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  18 |   200/ 1327 batches | lr 1.25 | ms/batch 15.62 | loss  3.95 | ppl    52.00
| prune-epoch  18 |   400/ 1327 batches | lr 1.25 | ms/batch 15.29 | loss  3.94 | ppl    51.18
| prune-epoch  18 |   600/ 1327 batches | lr 1.25 | ms/batch 15.29 | loss  3.93 | ppl    51.12
| prune-epoch  18 |   800/ 1327 batches | lr 1.25 | ms/batch 15.27 | loss  3.88 | ppl    48.33
| prune-epoch  18 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.29 | loss  3.96 | ppl    52.30
| prune-epoch  18 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.27 | loss  3.82 | ppl    45.83
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  18 | time: 21.00s | valid loss  4.40 | valid ppl    81.68
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  19 |   200/ 1327 batches | lr 1.25 | ms/batch 15.56 | loss  3.95 | ppl    51.81
| prune-epoch  19 |   400/ 1327 batches | lr 1.25 | ms/batch 15.42 | loss  3.94 | ppl    51.32
| prune-epoch  19 |   600/ 1327 batches | lr 1.25 | ms/batch 15.32 | loss  3.93 | ppl    50.69
| prune-epoch  19 |   800/ 1327 batches | lr 1.25 | ms/batch 15.32 | loss  3.88 | ppl    48.29
| prune-epoch  19 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.31 | loss  3.95 | ppl    51.84
| prune-epoch  19 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.33 | loss  3.82 | ppl    45.78
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  19 | time: 21.05s | valid loss  4.40 | valid ppl    81.66
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  20 |   200/ 1327 batches | lr 1.25 | ms/batch 15.60 | loss  3.95 | ppl    51.74
| prune-epoch  20 |   400/ 1327 batches | lr 1.25 | ms/batch 15.26 | loss  3.93 | ppl    50.99
| prune-epoch  20 |   600/ 1327 batches | lr 1.25 | ms/batch 15.23 | loss  3.93 | ppl    50.92
| prune-epoch  20 |   800/ 1327 batches | lr 1.25 | ms/batch 15.26 | loss  3.87 | ppl    48.17
| prune-epoch  20 |  1000/ 1327 batches | lr 1.25 | ms/batch 15.26 | loss  3.95 | ppl    51.99
| prune-epoch  20 |  1200/ 1327 batches | lr 1.25 | ms/batch 15.25 | loss  3.82 | ppl    45.61
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  20 | time: 20.96s | valid loss  4.40 | valid ppl    81.69
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  21 |   200/ 1327 batches | lr 0.31 | ms/batch 15.65 | loss  3.95 | ppl    51.83
| prune-epoch  21 |   400/ 1327 batches | lr 0.31 | ms/batch 15.30 | loss  3.94 | ppl    51.24
| prune-epoch  21 |   600/ 1327 batches | lr 0.31 | ms/batch 15.30 | loss  3.93 | ppl    51.02
| prune-epoch  21 |   800/ 1327 batches | lr 0.31 | ms/batch 15.34 | loss  3.88 | ppl    48.32
| prune-epoch  21 |  1000/ 1327 batches | lr 0.31 | ms/batch 15.39 | loss  3.95 | ppl    52.11
| prune-epoch  21 |  1200/ 1327 batches | lr 0.31 | ms/batch 15.33 | loss  3.81 | ppl    45.31
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  21 | time: 21.04s | valid loss  4.40 | valid ppl    81.28
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  22 |   200/ 1327 batches | lr 0.31 | ms/batch 15.80 | loss  3.95 | ppl    51.76
| prune-epoch  22 |   400/ 1327 batches | lr 0.31 | ms/batch 15.33 | loss  3.93 | ppl    50.95
| prune-epoch  22 |   600/ 1327 batches | lr 0.31 | ms/batch 15.33 | loss  3.93 | ppl    50.87
| prune-epoch  22 |   800/ 1327 batches | lr 0.31 | ms/batch 15.34 | loss  3.87 | ppl    48.15
| prune-epoch  22 |  1000/ 1327 batches | lr 0.31 | ms/batch 15.34 | loss  3.95 | ppl    51.80
| prune-epoch  22 |  1200/ 1327 batches | lr 0.31 | ms/batch 15.33 | loss  3.82 | ppl    45.50
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  22 | time: 21.10s | valid loss  4.40 | valid ppl    81.21
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  23 |   200/ 1327 batches | lr 0.31 | ms/batch 15.62 | loss  3.94 | ppl    51.37
| prune-epoch  23 |   400/ 1327 batches | lr 0.31 | ms/batch 15.29 | loss  3.93 | ppl    50.91
| prune-epoch  23 |   600/ 1327 batches | lr 0.31 | ms/batch 15.28 | loss  3.93 | ppl    50.78
| prune-epoch  23 |   800/ 1327 batches | lr 0.31 | ms/batch 15.28 | loss  3.87 | ppl    48.02
| prune-epoch  23 |  1000/ 1327 batches | lr 0.31 | ms/batch 15.28 | loss  3.95 | ppl    51.83
| prune-epoch  23 |  1200/ 1327 batches | lr 0.31 | ms/batch 15.27 | loss  3.82 | ppl    45.60
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  23 | time: 21.00s | valid loss  4.40 | valid ppl    81.17
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  24 |   200/ 1327 batches | lr 0.31 | ms/batch 15.68 | loss  3.95 | ppl    51.68
| prune-epoch  24 |   400/ 1327 batches | lr 0.31 | ms/batch 15.38 | loss  3.93 | ppl    50.79
| prune-epoch  24 |   600/ 1327 batches | lr 0.31 | ms/batch 15.49 | loss  3.92 | ppl    50.58
| prune-epoch  24 |   800/ 1327 batches | lr 0.31 | ms/batch 15.56 | loss  3.87 | ppl    48.08
| prune-epoch  24 |  1000/ 1327 batches | lr 0.31 | ms/batch 15.27 | loss  3.95 | ppl    51.80
| prune-epoch  24 |  1200/ 1327 batches | lr 0.31 | ms/batch 15.33 | loss  3.81 | ppl    45.26
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  24 | time: 21.15s | valid loss  4.40 | valid ppl    81.17
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  25 |   200/ 1327 batches | lr 0.31 | ms/batch 15.61 | loss  3.94 | ppl    51.65
| prune-epoch  25 |   400/ 1327 batches | lr 0.31 | ms/batch 15.27 | loss  3.93 | ppl    50.76
| prune-epoch  25 |   600/ 1327 batches | lr 0.31 | ms/batch 15.27 | loss  3.93 | ppl    50.69
| prune-epoch  25 |   800/ 1327 batches | lr 0.31 | ms/batch 15.26 | loss  3.87 | ppl    47.87
| prune-epoch  25 |  1000/ 1327 batches | lr 0.31 | ms/batch 15.26 | loss  3.94 | ppl    51.60
| prune-epoch  25 |  1200/ 1327 batches | lr 0.31 | ms/batch 15.27 | loss  3.82 | ppl    45.46
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  25 | time: 20.98s | valid loss  4.40 | valid ppl    81.19
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  26 |   200/ 1327 batches | lr 0.08 | ms/batch 15.65 | loss  3.94 | ppl    51.59
| prune-epoch  26 |   400/ 1327 batches | lr 0.08 | ms/batch 15.32 | loss  3.93 | ppl    50.81
| prune-epoch  26 |   600/ 1327 batches | lr 0.08 | ms/batch 15.35 | loss  3.92 | ppl    50.62
| prune-epoch  26 |   800/ 1327 batches | lr 0.08 | ms/batch 15.37 | loss  3.87 | ppl    48.04
| prune-epoch  26 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.30 | loss  3.94 | ppl    51.61
| prune-epoch  26 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.29 | loss  3.81 | ppl    45.27
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  26 | time: 21.05s | valid loss  4.40 | valid ppl    81.08
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  27 |   200/ 1327 batches | lr 0.08 | ms/batch 15.59 | loss  3.94 | ppl    51.47
| prune-epoch  27 |   400/ 1327 batches | lr 0.08 | ms/batch 15.24 | loss  3.93 | ppl    50.72
| prune-epoch  27 |   600/ 1327 batches | lr 0.08 | ms/batch 15.22 | loss  3.92 | ppl    50.55
| prune-epoch  27 |   800/ 1327 batches | lr 0.08 | ms/batch 15.17 | loss  3.87 | ppl    47.86
| prune-epoch  27 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.22 | loss  3.94 | ppl    51.54
| prune-epoch  27 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.23 | loss  3.81 | ppl    45.28
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  27 | time: 20.93s | valid loss  4.39 | valid ppl    81.02
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  28 |   200/ 1327 batches | lr 0.08 | ms/batch 15.66 | loss  3.94 | ppl    51.25
| prune-epoch  28 |   400/ 1327 batches | lr 0.08 | ms/batch 15.33 | loss  3.93 | ppl    51.08
| prune-epoch  28 |   600/ 1327 batches | lr 0.08 | ms/batch 15.30 | loss  3.92 | ppl    50.41
| prune-epoch  28 |   800/ 1327 batches | lr 0.08 | ms/batch 15.29 | loss  3.87 | ppl    47.76
| prune-epoch  28 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.29 | loss  3.94 | ppl    51.52
| prune-epoch  28 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.31 | loss  3.81 | ppl    45.26
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  28 | time: 21.03s | valid loss  4.39 | valid ppl    81.04
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  29 |   200/ 1327 batches | lr 0.08 | ms/batch 15.63 | loss  3.94 | ppl    51.46
| prune-epoch  29 |   400/ 1327 batches | lr 0.08 | ms/batch 15.33 | loss  3.93 | ppl    50.73
| prune-epoch  29 |   600/ 1327 batches | lr 0.08 | ms/batch 15.31 | loss  3.92 | ppl    50.47
| prune-epoch  29 |   800/ 1327 batches | lr 0.08 | ms/batch 15.30 | loss  3.87 | ppl    47.88
| prune-epoch  29 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.30 | loss  3.95 | ppl    51.70
| prune-epoch  29 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.34 | loss  3.81 | ppl    45.24
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  29 | time: 21.05s | valid loss  4.39 | valid ppl    81.01
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  30 |   200/ 1327 batches | lr 0.08 | ms/batch 15.60 | loss  3.94 | ppl    51.59
| prune-epoch  30 |   400/ 1327 batches | lr 0.08 | ms/batch 15.23 | loss  3.93 | ppl    50.76
| prune-epoch  30 |   600/ 1327 batches | lr 0.08 | ms/batch 15.10 | loss  3.92 | ppl    50.28
| prune-epoch  30 |   800/ 1327 batches | lr 0.08 | ms/batch 15.23 | loss  3.87 | ppl    47.93
| prune-epoch  30 |  1000/ 1327 batches | lr 0.08 | ms/batch 15.31 | loss  3.95 | ppl    51.80
| prune-epoch  30 |  1200/ 1327 batches | lr 0.08 | ms/batch 15.26 | loss  3.81 | ppl    45.24
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  30 | time: 20.94s | valid loss  4.39 | valid ppl    81.02
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  31 |   200/ 1327 batches | lr 0.02 | ms/batch 15.68 | loss  3.94 | ppl    51.53
| prune-epoch  31 |   400/ 1327 batches | lr 0.02 | ms/batch 15.34 | loss  3.93 | ppl    50.72
| prune-epoch  31 |   600/ 1327 batches | lr 0.02 | ms/batch 15.40 | loss  3.92 | ppl    50.23
| prune-epoch  31 |   800/ 1327 batches | lr 0.02 | ms/batch 15.34 | loss  3.87 | ppl    48.05
| prune-epoch  31 |  1000/ 1327 batches | lr 0.02 | ms/batch 15.33 | loss  3.94 | ppl    51.56
| prune-epoch  31 |  1200/ 1327 batches | lr 0.02 | ms/batch 15.33 | loss  3.81 | ppl    45.01
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  31 | time: 21.09s | valid loss  4.39 | valid ppl    81.01
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  32 |   200/ 1327 batches | lr 0.02 | ms/batch 15.59 | loss  3.94 | ppl    51.54
| prune-epoch  32 |   400/ 1327 batches | lr 0.02 | ms/batch 15.36 | loss  3.93 | ppl    50.69
| prune-epoch  32 |   600/ 1327 batches | lr 0.02 | ms/batch 15.30 | loss  3.92 | ppl    50.37
| prune-epoch  32 |   800/ 1327 batches | lr 0.02 | ms/batch 15.28 | loss  3.87 | ppl    48.08
| prune-epoch  32 |  1000/ 1327 batches | lr 0.02 | ms/batch 15.22 | loss  3.95 | ppl    51.74
| prune-epoch  32 |  1200/ 1327 batches | lr 0.02 | ms/batch 15.24 | loss  3.81 | ppl    45.12
end prun train
weight_ih_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l0        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_ih_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
weight_hh_l1        shape torch.Size([2600, 650])
       expected sp:  0.9  actual sp:  0.8984615384615384
-----------------------------------------------------------------------------------------
| end of retrain epoch  32 | time: 20.99s | valid loss  4.39 | valid ppl    80.99
-----------------------------------------------------------------------------------------
required epochs  40 | actual epochs  65
pretrain epochs  16 | prune epochs  17 | retrain epochs  32
=========================================================================================
| End of training | test loss  4.34 | test ppl    77.07
=========================================================================================
python main.py --cuda --emsize 1500 --nhid 1500 --dropout 0.65 --epochs 40 --save model/prune/model.pt --data ./data/ptb --prune --retrain --sparsity 0.9
<class 'torch.Tensor'> torch.Size([10000, 1500])
<class 'torch.Tensor'> torch.Size([6000, 1500])
<class 'torch.Tensor'> torch.Size([6000, 1500])
<class 'torch.Tensor'> torch.Size([6000])
<class 'torch.Tensor'> torch.Size([6000])
<class 'torch.Tensor'> torch.Size([6000, 1500])
<class 'torch.Tensor'> torch.Size([6000, 1500])
<class 'torch.Tensor'> torch.Size([6000])
<class 'torch.Tensor'> torch.Size([6000])
<class 'torch.Tensor'> torch.Size([10000, 1500])
<class 'torch.Tensor'> torch.Size([10000])
RNNModel(
  (drop): Dropout(p=0.65)
  (encoder): Embedding(10000, 1500)
  (rnn): LSTM(1500, 1500, num_layers=2, dropout=0.65)
  (decoder): Linear(in_features=1500, out_features=10000, bias=True)
)
Dropout(p=0.65)
Embedding(10000, 1500)
LSTM(1500, 1500, num_layers=2, dropout=0.65)
Linear(in_features=1500, out_features=10000, bias=True)
| train-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 43.56 | loss  7.19 | ppl  1321.94
| train-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 43.29 | loss  6.23 | ppl   507.30
| train-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 43.25 | loss  5.98 | ppl   394.55
| train-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 43.24 | loss  5.75 | ppl   314.82
| train-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.22 | loss  5.64 | ppl   281.80
| train-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.28 | loss  5.51 | ppl   248.03
-----------------------------------------------------------------------------------------
| end of train epoch   1 | time: 59.11s | valid loss  5.39 | valid ppl   220.20
-----------------------------------------------------------------------------------------
| train-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 43.65 | loss  5.44 | ppl   231.43
| train-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 43.37 | loss  5.38 | ppl   217.56
| train-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 43.40 | loss  5.34 | ppl   208.84
| train-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 43.39 | loss  5.24 | ppl   188.20
| train-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.36 | loss  5.23 | ppl   187.13
| train-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.17 | loss  5.13 | ppl   169.05
-----------------------------------------------------------------------------------------
| end of train epoch   2 | time: 59.17s | valid loss  5.08 | valid ppl   160.79
-----------------------------------------------------------------------------------------
| train-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 43.23 | loss  5.13 | ppl   169.83
| train-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 43.28 | loss  5.11 | ppl   165.51
| train-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 43.26 | loss  5.08 | ppl   160.90
| train-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 43.26 | loss  5.00 | ppl   148.98
| train-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.26 | loss  5.02 | ppl   152.08
| train-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.28 | loss  4.92 | ppl   136.33
-----------------------------------------------------------------------------------------
| end of train epoch   3 | time: 59.05s | valid loss  4.91 | valid ppl   135.84
-----------------------------------------------------------------------------------------
| train-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 43.32 | loss  4.94 | ppl   140.02
| train-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 43.11 | loss  4.93 | ppl   138.12
| train-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 43.14 | loss  4.91 | ppl   135.01
| train-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 43.13 | loss  4.83 | ppl   125.73
| train-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.11 | loss  4.87 | ppl   130.87
| train-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.14 | loss  4.76 | ppl   116.31
-----------------------------------------------------------------------------------------
| end of train epoch   4 | time: 58.90s | valid loss  4.79 | valid ppl   120.11
-----------------------------------------------------------------------------------------
| train-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 43.44 | loss  4.80 | ppl   121.27
| train-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 43.23 | loss  4.79 | ppl   120.11
| train-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 43.23 | loss  4.77 | ppl   117.55
| train-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 43.24 | loss  4.71 | ppl   110.63
| train-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.23 | loss  4.75 | ppl   116.01
| train-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.24 | loss  4.64 | ppl   103.31
-----------------------------------------------------------------------------------------
| end of train epoch   5 | time: 59.05s | valid loss  4.70 | valid ppl   109.87
-----------------------------------------------------------------------------------------
| train-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 43.55 | loss  4.67 | ppl   106.92
| train-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 43.37 | loss  4.67 | ppl   107.15
| train-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 43.36 | loss  4.66 | ppl   105.40
| train-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 43.36 | loss  4.59 | ppl    98.82
| train-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.35 | loss  4.65 | ppl   104.91
| train-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.35 | loss  4.53 | ppl    92.96
-----------------------------------------------------------------------------------------
| end of train epoch   6 | time: 59.22s | valid loss  4.64 | valid ppl   103.91
-----------------------------------------------------------------------------------------
| train-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch 42.99 | loss  4.58 | ppl    97.74
| train-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch 42.80 | loss  4.58 | ppl    98.00
| train-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch 42.74 | loss  4.57 | ppl    96.22
| train-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch 42.76 | loss  4.51 | ppl    90.55
| train-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.76 | loss  4.57 | ppl    96.07
| train-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.79 | loss  4.45 | ppl    85.32
-----------------------------------------------------------------------------------------
| end of train epoch   7 | time: 58.44s | valid loss  4.60 | valid ppl    99.12
-----------------------------------------------------------------------------------------
| train-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch 43.59 | loss  4.50 | ppl    89.87
| train-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch 43.30 | loss  4.50 | ppl    90.11
| train-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch 43.31 | loss  4.49 | ppl    88.88
| train-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch 43.30 | loss  4.43 | ppl    83.69
| train-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.31 | loss  4.50 | ppl    89.69
| train-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.31 | loss  4.37 | ppl    79.08
-----------------------------------------------------------------------------------------
| end of train epoch   8 | time: 59.17s | valid loss  4.56 | valid ppl    95.18
-----------------------------------------------------------------------------------------
| train-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch 43.57 | loss  4.42 | ppl    83.45
| train-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch 43.30 | loss  4.43 | ppl    83.72
| train-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch 43.30 | loss  4.42 | ppl    82.69
| train-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch 43.32 | loss  4.35 | ppl    77.72
| train-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.28 | loss  4.43 | ppl    83.80
| train-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.30 | loss  4.30 | ppl    73.56
-----------------------------------------------------------------------------------------
| end of train epoch   9 | time: 59.16s | valid loss  4.53 | valid ppl    92.75
-----------------------------------------------------------------------------------------
| train-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch 43.52 | loss  4.36 | ppl    78.45
| train-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch 43.27 | loss  4.36 | ppl    78.36
| train-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch 43.26 | loss  4.36 | ppl    77.90
| train-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch 43.26 | loss  4.29 | ppl    72.80
| train-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.26 | loss  4.37 | ppl    78.89
| train-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.26 | loss  4.24 | ppl    69.55
-----------------------------------------------------------------------------------------
| end of train epoch  10 | time: 59.10s | valid loss  4.50 | valid ppl    90.02
-----------------------------------------------------------------------------------------
| train-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch 43.37 | loss  4.31 | ppl    74.18
| train-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch 43.11 | loss  4.30 | ppl    73.85
| train-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch 43.08 | loss  4.29 | ppl    73.06
| train-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch 43.10 | loss  4.23 | ppl    68.81
| train-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.13 | loss  4.31 | ppl    74.60
| train-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.10 | loss  4.18 | ppl    65.57
-----------------------------------------------------------------------------------------
| end of train epoch  11 | time: 58.89s | valid loss  4.49 | valid ppl    88.88
-----------------------------------------------------------------------------------------
| train-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch 43.49 | loss  4.25 | ppl    69.85
| train-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch 43.21 | loss  4.25 | ppl    69.98
| train-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch 43.22 | loss  4.24 | ppl    69.21
| train-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch 43.22 | loss  4.18 | ppl    65.32
| train-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.19 | loss  4.26 | ppl    70.82
| train-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.22 | loss  4.13 | ppl    62.41
-----------------------------------------------------------------------------------------
| end of train epoch  12 | time: 59.04s | valid loss  4.47 | valid ppl    87.58
-----------------------------------------------------------------------------------------
| train-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch 43.71 | loss  4.20 | ppl    66.64
| train-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch 43.45 | loss  4.19 | ppl    66.30
| train-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch 43.44 | loss  4.18 | ppl    65.68
| train-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch 43.44 | loss  4.13 | ppl    62.14
| train-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.45 | loss  4.21 | ppl    67.51
| train-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.46 | loss  4.08 | ppl    59.34
-----------------------------------------------------------------------------------------
| end of train epoch  13 | time: 59.34s | valid loss  4.46 | valid ppl    86.79
-----------------------------------------------------------------------------------------
| train-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch 43.38 | loss  4.15 | ppl    63.34
| train-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch 43.14 | loss  4.15 | ppl    63.21
| train-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch 43.12 | loss  4.14 | ppl    62.73
| train-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch 43.13 | loss  4.08 | ppl    59.10
| train-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.14 | loss  4.17 | ppl    64.49
| train-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.14 | loss  4.04 | ppl    56.57
-----------------------------------------------------------------------------------------
| end of train epoch  14 | time: 58.93s | valid loss  4.45 | valid ppl    85.85
-----------------------------------------------------------------------------------------
| train-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch 43.60 | loss  4.10 | ppl    60.35
| train-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch 43.33 | loss  4.10 | ppl    60.43
| train-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch 43.33 | loss  4.09 | ppl    59.75
| train-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch 43.33 | loss  4.04 | ppl    56.96
| train-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.32 | loss  4.13 | ppl    62.09
| train-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.30 | loss  3.99 | ppl    54.28
-----------------------------------------------------------------------------------------
| end of train epoch  15 | time: 59.19s | valid loss  4.44 | valid ppl    84.68
-----------------------------------------------------------------------------------------
| train-epoch  16 |   200/ 1327 batches | lr 20.00 | ms/batch 43.56 | loss  4.06 | ppl    58.01
| train-epoch  16 |   400/ 1327 batches | lr 20.00 | ms/batch 43.31 | loss  4.06 | ppl    57.77
| train-epoch  16 |   600/ 1327 batches | lr 20.00 | ms/batch 43.31 | loss  4.05 | ppl    57.38
| train-epoch  16 |   800/ 1327 batches | lr 20.00 | ms/batch 43.32 | loss  4.00 | ppl    54.36
| train-epoch  16 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.31 | loss  4.08 | ppl    59.23
| train-epoch  16 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.28 | loss  3.95 | ppl    51.96
-----------------------------------------------------------------------------------------
| end of train epoch  16 | time: 59.16s | valid loss  4.44 | valid ppl    84.50
-----------------------------------------------------------------------------------------
| train-epoch  17 |   200/ 1327 batches | lr 20.00 | ms/batch 43.58 | loss  4.02 | ppl    55.48
| train-epoch  17 |   400/ 1327 batches | lr 20.00 | ms/batch 43.29 | loss  4.02 | ppl    55.57
| train-epoch  17 |   600/ 1327 batches | lr 20.00 | ms/batch 43.28 | loss  4.00 | ppl    54.76
| train-epoch  17 |   800/ 1327 batches | lr 20.00 | ms/batch 43.29 | loss  3.95 | ppl    52.11
| train-epoch  17 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.28 | loss  4.05 | ppl    57.33
| train-epoch  17 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.26 | loss  3.91 | ppl    49.68
-----------------------------------------------------------------------------------------
| end of train epoch  17 | time: 59.14s | valid loss  4.44 | valid ppl    84.60
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 46.30 | loss  3.99 | ppl    53.97
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 43.53 | loss  3.97 | ppl    52.94
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 43.55 | loss  3.96 | ppl    52.44
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 43.54 | loss  3.90 | ppl    49.52
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.54 | loss  3.99 | ppl    54.16
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.51 | loss  3.85 | ppl    47.06
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.39933311111111114
-----------------------------------------------------------------------------------------
| end of prune epoch   1 | time: 59.96s | valid loss  4.43 | valid ppl    83.84
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 46.30 | loss  3.93 | ppl    50.94
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 43.67 | loss  3.92 | ppl    50.51
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 43.67 | loss  3.92 | ppl    50.20
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 43.67 | loss  3.86 | ppl    47.31
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.69 | loss  3.95 | ppl    52.13
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.62 | loss  3.81 | ppl    45.12
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   2 | time: 60.11s | valid loss  4.43 | valid ppl    83.76
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 46.45 | loss  3.89 | ppl    49.11
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 43.83 | loss  3.89 | ppl    48.69
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 43.83 | loss  3.88 | ppl    48.40
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 43.83 | loss  3.82 | ppl    45.71
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.86 | loss  3.91 | ppl    50.00
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.81 | loss  3.78 | ppl    43.64
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   3 | time: 60.33s | valid loss  4.44 | valid ppl    84.47
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 45.97 | loss  3.87 | ppl    47.71
| prune-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 43.25 | loss  3.85 | ppl    47.20
| prune-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 43.26 | loss  3.84 | ppl    46.66
| prune-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 43.24 | loss  3.79 | ppl    44.16
| prune-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.22 | loss  3.88 | ppl    48.60
| prune-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.21 | loss  3.74 | ppl    41.97
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   4 | time: 59.55s | valid loss  4.43 | valid ppl    83.80
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 46.37 | loss  3.82 | ppl    45.75
| prune-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 43.79 | loss  3.81 | ppl    45.20
| prune-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 43.78 | loss  3.81 | ppl    44.98
| prune-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 43.78 | loss  3.75 | ppl    42.58
| prune-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.73 | loss  3.85 | ppl    46.84
| prune-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.81 | loss  3.70 | ppl    40.52
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   5 | time: 60.25s | valid loss  4.45 | valid ppl    85.38
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 46.46 | loss  3.81 | ppl    45.09
| prune-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 43.78 | loss  3.80 | ppl    44.64
| prune-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 43.78 | loss  3.79 | ppl    44.26
| prune-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 43.77 | loss  3.73 | ppl    41.83
| prune-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.74 | loss  3.82 | ppl    45.77
| prune-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.78 | loss  3.68 | ppl    39.83
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   6 | time: 60.25s | valid loss  4.44 | valid ppl    85.12
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch 46.25 | loss  3.77 | ppl    43.18
| prune-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch 43.73 | loss  3.76 | ppl    42.94
| prune-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch 43.74 | loss  3.75 | ppl    42.50
| prune-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch 43.74 | loss  3.70 | ppl    40.40
| prune-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.69 | loss  3.80 | ppl    44.53
| prune-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.72 | loss  3.64 | ppl    38.10
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   7 | time: 60.15s | valid loss  4.44 | valid ppl    85.04
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch 46.07 | loss  3.73 | ppl    41.69
| prune-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch 43.57 | loss  3.72 | ppl    41.24
| prune-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch 43.62 | loss  3.72 | ppl    41.09
| prune-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch 43.60 | loss  3.67 | ppl    39.21
| prune-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.56 | loss  3.76 | ppl    42.93
| prune-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.59 | loss  3.62 | ppl    37.22
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   8 | time: 59.96s | valid loss  4.45 | valid ppl    85.75
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch 46.27 | loss  3.75 | ppl    42.61
| prune-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch 43.72 | loss  3.74 | ppl    42.13
| prune-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch 43.72 | loss  3.73 | ppl    41.49
| prune-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch 43.68 | loss  3.67 | ppl    39.13
| prune-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.66 | loss  3.76 | ppl    43.00
| prune-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.69 | loss  3.61 | ppl    37.02
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
-----------------------------------------------------------------------------------------
| end of prune epoch   9 | time: 60.12s | valid loss  4.45 | valid ppl    86.02
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch 46.26 | loss  3.70 | ppl    40.36
| prune-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch 43.91 | loss  3.69 | ppl    40.22
| prune-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch 43.90 | loss  3.68 | ppl    39.78
| prune-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch 43.86 | loss  3.63 | ppl    37.68
| prune-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.91 | loss  3.72 | ppl    41.46
| prune-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.92 | loss  3.58 | ppl    35.78
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
-----------------------------------------------------------------------------------------
| end of prune epoch  10 | time: 60.36s | valid loss  4.46 | valid ppl    86.87
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch 45.68 | loss  3.80 | ppl    44.53
| prune-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch 43.32 | loss  3.77 | ppl    43.43
| prune-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch 43.32 | loss  3.74 | ppl    42.29
| prune-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch 43.28 | loss  3.69 | ppl    40.16
| prune-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.31 | loss  3.78 | ppl    43.89
| prune-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.35 | loss  3.64 | ppl    38.04
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993332222222223
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch  11 | time: 59.58s | valid loss  4.47 | valid ppl    87.40
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch 46.02 | loss  3.72 | ppl    41.41
| prune-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch 43.87 | loss  3.71 | ppl    40.93
| prune-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch 43.89 | loss  3.70 | ppl    40.47
| prune-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch 43.85 | loss  3.65 | ppl    38.51
| prune-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.87 | loss  3.74 | ppl    42.28
| prune-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.87 | loss  3.60 | ppl    36.46
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch  12 | time: 60.27s | valid loss  4.48 | valid ppl    88.01
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch 46.01 | loss  3.78 | ppl    43.98
| prune-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch 43.85 | loss  3.77 | ppl    43.24
| prune-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch 43.84 | loss  3.75 | ppl    42.41
| prune-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch 43.80 | loss  3.70 | ppl    40.64
| prune-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.84 | loss  3.78 | ppl    44.03
| prune-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.86 | loss  3.64 | ppl    38.27
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493332222222222
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch  13 | time: 60.23s | valid loss  4.48 | valid ppl    88.16
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch 45.81 | loss  3.72 | ppl    41.42
| prune-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch 43.79 | loss  3.72 | ppl    41.23
| prune-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch 43.80 | loss  3.70 | ppl    40.58
| prune-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch 43.76 | loss  3.66 | ppl    38.68
| prune-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.78 | loss  3.75 | ppl    42.39
| prune-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.81 | loss  3.61 | ppl    36.90
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch  14 | time: 60.14s | valid loss  4.49 | valid ppl    88.82
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch 45.65 | loss  3.87 | ppl    48.04
| prune-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch 43.61 | loss  3.84 | ppl    46.50
| prune-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch 43.57 | loss  3.83 | ppl    45.92
| prune-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch 43.62 | loss  3.77 | ppl    43.52
| prune-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.62 | loss  3.85 | ppl    47.21
| prune-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.61 | loss  3.72 | ppl    41.12
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch  15 | time: 59.90s | valid loss  4.49 | valid ppl    89.24
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 45.61 | loss  3.79 | ppl    44.23
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 43.74 | loss  3.78 | ppl    43.73
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 43.68 | loss  3.77 | ppl    43.26
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 43.74 | loss  3.72 | ppl    41.23
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.74 | loss  3.81 | ppl    45.09
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.73 | loss  3.67 | ppl    39.20
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   1 | time: 60.03s | valid loss  4.49 | valid ppl    89.21
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 45.96 | loss  3.76 | ppl    42.82
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 44.14 | loss  3.75 | ppl    42.35
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 44.11 | loss  3.74 | ppl    41.91
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 44.12 | loss  3.69 | ppl    39.96
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 44.12 | loss  3.78 | ppl    43.80
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 44.01 | loss  3.63 | ppl    37.89
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   2 | time: 60.49s | valid loss  4.49 | valid ppl    88.82
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 45.23 | loss  3.73 | ppl    41.61
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 43.29 | loss  3.72 | ppl    41.09
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 43.26 | loss  3.71 | ppl    40.85
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 43.31 | loss  3.66 | ppl    38.91
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.31 | loss  3.76 | ppl    42.73
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.30 | loss  3.61 | ppl    36.85
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   3 | time: 59.46s | valid loss  4.50 | valid ppl    89.78
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 45.74 | loss  3.70 | ppl    40.51
| prune-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 43.86 | loss  3.69 | ppl    40.07
| prune-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 43.80 | loss  3.68 | ppl    39.69
| prune-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 43.87 | loss  3.63 | ppl    37.75
| prune-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 43.86 | loss  3.73 | ppl    41.54
| prune-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 43.86 | loss  3.59 | ppl    36.34
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   4 | time: 60.20s | valid loss  4.51 | valid ppl    90.81
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 5.00 | ms/batch 45.71 | loss  3.67 | ppl    39.28
| prune-epoch   5 |   400/ 1327 batches | lr 5.00 | ms/batch 43.89 | loss  3.63 | ppl    37.74
| prune-epoch   5 |   600/ 1327 batches | lr 5.00 | ms/batch 44.09 | loss  3.60 | ppl    36.61
| prune-epoch   5 |   800/ 1327 batches | lr 5.00 | ms/batch 44.08 | loss  3.54 | ppl    34.31
| prune-epoch   5 |  1000/ 1327 batches | lr 5.00 | ms/batch 44.07 | loss  3.61 | ppl    36.85
| prune-epoch   5 |  1200/ 1327 batches | lr 5.00 | ms/batch 44.07 | loss  3.45 | ppl    31.61
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   5 | time: 60.43s | valid loss  4.50 | valid ppl    89.79
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 46.56 | loss  3.60 | ppl    36.59
| prune-epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 43.93 | loss  3.59 | ppl    36.22
| prune-epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 43.79 | loss  3.57 | ppl    35.43
| prune-epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 43.77 | loss  3.50 | ppl    33.23
| prune-epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 43.77 | loss  3.59 | ppl    36.11
| prune-epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 43.79 | loss  3.44 | ppl    31.13
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   6 | time: 60.31s | valid loss  4.50 | valid ppl    90.02
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 1.25 | ms/batch 45.75 | loss  3.61 | ppl    36.90
| prune-epoch   7 |   400/ 1327 batches | lr 1.25 | ms/batch 43.83 | loss  3.59 | ppl    36.20
| prune-epoch   7 |   600/ 1327 batches | lr 1.25 | ms/batch 43.88 | loss  3.57 | ppl    35.44
| prune-epoch   7 |   800/ 1327 batches | lr 1.25 | ms/batch 43.86 | loss  3.50 | ppl    33.02
| prune-epoch   7 |  1000/ 1327 batches | lr 1.25 | ms/batch 43.90 | loss  3.56 | ppl    35.22
| prune-epoch   7 |  1200/ 1327 batches | lr 1.25 | ms/batch 43.90 | loss  3.41 | ppl    30.34
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   7 | time: 60.25s | valid loss  4.48 | valid ppl    88.60
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 1.25 | ms/batch 46.54 | loss  3.59 | ppl    36.24
| prune-epoch   8 |   400/ 1327 batches | lr 1.25 | ms/batch 43.91 | loss  3.57 | ppl    35.40
| prune-epoch   8 |   600/ 1327 batches | lr 1.25 | ms/batch 43.98 | loss  3.55 | ppl    34.97
| prune-epoch   8 |   800/ 1327 batches | lr 1.25 | ms/batch 44.00 | loss  3.48 | ppl    32.54
| prune-epoch   8 |  1000/ 1327 batches | lr 1.25 | ms/batch 44.00 | loss  3.56 | ppl    35.09
| prune-epoch   8 |  1200/ 1327 batches | lr 1.25 | ms/batch 44.00 | loss  3.41 | ppl    30.38
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   8 | time: 60.51s | valid loss  4.49 | valid ppl    88.80
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 1.25 | ms/batch 46.42 | loss  3.58 | ppl    35.86
| prune-epoch   9 |   400/ 1327 batches | lr 1.25 | ms/batch 43.85 | loss  3.55 | ppl    34.98
| prune-epoch   9 |   600/ 1327 batches | lr 1.25 | ms/batch 43.87 | loss  3.54 | ppl    34.45
| prune-epoch   9 |   800/ 1327 batches | lr 1.25 | ms/batch 43.88 | loss  3.48 | ppl    32.36
| prune-epoch   9 |  1000/ 1327 batches | lr 1.25 | ms/batch 43.89 | loss  3.55 | ppl    34.90
| prune-epoch   9 |  1200/ 1327 batches | lr 1.25 | ms/batch 43.87 | loss  3.40 | ppl    29.99
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   9 | time: 60.36s | valid loss  4.49 | valid ppl    88.86
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 0.31 | ms/batch 45.09 | loss  3.59 | ppl    36.33
| prune-epoch  10 |   400/ 1327 batches | lr 0.31 | ms/batch 42.75 | loss  3.57 | ppl    35.35
| prune-epoch  10 |   600/ 1327 batches | lr 0.31 | ms/batch 42.65 | loss  3.55 | ppl    34.81
| prune-epoch  10 |   800/ 1327 batches | lr 0.31 | ms/batch 42.64 | loss  3.50 | ppl    32.96
| prune-epoch  10 |  1000/ 1327 batches | lr 0.31 | ms/batch 42.64 | loss  3.56 | ppl    35.14
| prune-epoch  10 |  1200/ 1327 batches | lr 0.31 | ms/batch 42.65 | loss  3.40 | ppl    29.83
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  10 | time: 58.71s | valid loss  4.48 | valid ppl    87.91
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 0.31 | ms/batch 45.04 | loss  3.58 | ppl    36.04
| prune-epoch  11 |   400/ 1327 batches | lr 0.31 | ms/batch 43.18 | loss  3.56 | ppl    35.19
| prune-epoch  11 |   600/ 1327 batches | lr 0.31 | ms/batch 43.17 | loss  3.55 | ppl    34.83
| prune-epoch  11 |   800/ 1327 batches | lr 0.31 | ms/batch 43.15 | loss  3.49 | ppl    32.77
| prune-epoch  11 |  1000/ 1327 batches | lr 0.31 | ms/batch 43.17 | loss  3.56 | ppl    35.08
| prune-epoch  11 |  1200/ 1327 batches | lr 0.31 | ms/batch 43.17 | loss  3.40 | ppl    30.04
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  11 | time: 59.26s | valid loss  4.47 | valid ppl    87.74
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 0.31 | ms/batch 45.02 | loss  3.59 | ppl    36.19
| prune-epoch  12 |   400/ 1327 batches | lr 0.31 | ms/batch 43.13 | loss  3.55 | ppl    34.92
| prune-epoch  12 |   600/ 1327 batches | lr 0.31 | ms/batch 43.12 | loss  3.54 | ppl    34.42
| prune-epoch  12 |   800/ 1327 batches | lr 0.31 | ms/batch 43.13 | loss  3.48 | ppl    32.53
| prune-epoch  12 |  1000/ 1327 batches | lr 0.31 | ms/batch 43.12 | loss  3.55 | ppl    34.94
| prune-epoch  12 |  1200/ 1327 batches | lr 0.31 | ms/batch 43.13 | loss  3.41 | ppl    30.17
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  12 | time: 59.21s | valid loss  4.47 | valid ppl    87.66
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 0.31 | ms/batch 45.03 | loss  3.59 | ppl    36.21
| prune-epoch  13 |   400/ 1327 batches | lr 0.31 | ms/batch 43.12 | loss  3.55 | ppl    34.97
| prune-epoch  13 |   600/ 1327 batches | lr 0.31 | ms/batch 43.12 | loss  3.54 | ppl    34.46
| prune-epoch  13 |   800/ 1327 batches | lr 0.31 | ms/batch 43.12 | loss  3.48 | ppl    32.48
| prune-epoch  13 |  1000/ 1327 batches | lr 0.31 | ms/batch 43.11 | loss  3.55 | ppl    34.94
| prune-epoch  13 |  1200/ 1327 batches | lr 0.31 | ms/batch 43.12 | loss  3.40 | ppl    30.01
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  13 | time: 59.20s | valid loss  4.48 | valid ppl    87.82
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 0.31 | ms/batch 44.77 | loss  3.58 | ppl    35.85
| prune-epoch  14 |   400/ 1327 batches | lr 0.31 | ms/batch 42.90 | loss  3.55 | ppl    34.88
| prune-epoch  14 |   600/ 1327 batches | lr 0.31 | ms/batch 42.89 | loss  3.54 | ppl    34.37
| prune-epoch  14 |   800/ 1327 batches | lr 0.31 | ms/batch 42.89 | loss  3.47 | ppl    32.25
| prune-epoch  14 |  1000/ 1327 batches | lr 0.31 | ms/batch 42.90 | loss  3.55 | ppl    34.94
| prune-epoch  14 |  1200/ 1327 batches | lr 0.31 | ms/batch 42.88 | loss  3.40 | ppl    29.98
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  14 | time: 58.90s | valid loss  4.48 | valid ppl    87.80
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 0.31 | ms/batch 45.00 | loss  3.59 | ppl    36.06
| prune-epoch  15 |   400/ 1327 batches | lr 0.31 | ms/batch 43.09 | loss  3.55 | ppl    34.81
| prune-epoch  15 |   600/ 1327 batches | lr 0.31 | ms/batch 43.10 | loss  3.53 | ppl    34.07
| prune-epoch  15 |   800/ 1327 batches | lr 0.31 | ms/batch 43.11 | loss  3.48 | ppl    32.37
| prune-epoch  15 |  1000/ 1327 batches | lr 0.31 | ms/batch 43.10 | loss  3.55 | ppl    34.89
| prune-epoch  15 |  1200/ 1327 batches | lr 0.31 | ms/batch 43.10 | loss  3.40 | ppl    30.02
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  15 | time: 59.18s | valid loss  4.48 | valid ppl    87.80
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  16 |   200/ 1327 batches | lr 0.08 | ms/batch 45.04 | loss  3.59 | ppl    36.21
| prune-epoch  16 |   400/ 1327 batches | lr 0.08 | ms/batch 43.29 | loss  3.56 | ppl    35.32
| prune-epoch  16 |   600/ 1327 batches | lr 0.08 | ms/batch 43.57 | loss  3.55 | ppl    34.70
| prune-epoch  16 |   800/ 1327 batches | lr 0.08 | ms/batch 43.58 | loss  3.48 | ppl    32.37
| prune-epoch  16 |  1000/ 1327 batches | lr 0.08 | ms/batch 43.56 | loss  3.55 | ppl    34.90
| prune-epoch  16 |  1200/ 1327 batches | lr 0.08 | ms/batch 43.56 | loss  3.40 | ppl    29.88
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  16 | time: 59.67s | valid loss  4.47 | valid ppl    87.50
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  17 |   200/ 1327 batches | lr 0.08 | ms/batch 44.54 | loss  3.58 | ppl    35.90
| prune-epoch  17 |   400/ 1327 batches | lr 0.08 | ms/batch 42.62 | loss  3.56 | ppl    35.00
| prune-epoch  17 |   600/ 1327 batches | lr 0.08 | ms/batch 42.64 | loss  3.54 | ppl    34.47
| prune-epoch  17 |   800/ 1327 batches | lr 0.08 | ms/batch 42.63 | loss  3.48 | ppl    32.57
| prune-epoch  17 |  1000/ 1327 batches | lr 0.08 | ms/batch 42.62 | loss  3.55 | ppl    34.69
| prune-epoch  17 |  1200/ 1327 batches | lr 0.08 | ms/batch 42.64 | loss  3.40 | ppl    29.98
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  17 | time: 58.56s | valid loss  4.47 | valid ppl    87.39
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  18 |   200/ 1327 batches | lr 0.08 | ms/batch 45.08 | loss  3.58 | ppl    35.76
| prune-epoch  18 |   400/ 1327 batches | lr 0.08 | ms/batch 43.17 | loss  3.56 | ppl    35.11
| prune-epoch  18 |   600/ 1327 batches | lr 0.08 | ms/batch 43.16 | loss  3.55 | ppl    34.71
| prune-epoch  18 |   800/ 1327 batches | lr 0.08 | ms/batch 43.17 | loss  3.48 | ppl    32.47
| prune-epoch  18 |  1000/ 1327 batches | lr 0.08 | ms/batch 43.15 | loss  3.55 | ppl    34.88
| prune-epoch  18 |  1200/ 1327 batches | lr 0.08 | ms/batch 43.15 | loss  3.40 | ppl    29.96
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  18 | time: 59.26s | valid loss  4.47 | valid ppl    87.33
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  19 |   200/ 1327 batches | lr 0.08 | ms/batch 45.00 | loss  3.58 | ppl    35.91
| prune-epoch  19 |   400/ 1327 batches | lr 0.08 | ms/batch 43.12 | loss  3.55 | ppl    34.96
| prune-epoch  19 |   600/ 1327 batches | lr 0.08 | ms/batch 43.13 | loss  3.54 | ppl    34.50
| prune-epoch  19 |   800/ 1327 batches | lr 0.08 | ms/batch 43.13 | loss  3.48 | ppl    32.34
| prune-epoch  19 |  1000/ 1327 batches | lr 0.08 | ms/batch 43.11 | loss  3.55 | ppl    34.75
| prune-epoch  19 |  1200/ 1327 batches | lr 0.08 | ms/batch 43.11 | loss  3.40 | ppl    29.98
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  19 | time: 59.20s | valid loss  4.47 | valid ppl    87.28
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  20 |   200/ 1327 batches | lr 0.08 | ms/batch 45.05 | loss  3.58 | ppl    35.76
| prune-epoch  20 |   400/ 1327 batches | lr 0.08 | ms/batch 43.09 | loss  3.55 | ppl    34.79
| prune-epoch  20 |   600/ 1327 batches | lr 0.08 | ms/batch 43.10 | loss  3.54 | ppl    34.50
| prune-epoch  20 |   800/ 1327 batches | lr 0.08 | ms/batch 43.13 | loss  3.48 | ppl    32.39
| prune-epoch  20 |  1000/ 1327 batches | lr 0.08 | ms/batch 43.09 | loss  3.55 | ppl    34.70
| prune-epoch  20 |  1200/ 1327 batches | lr 0.08 | ms/batch 43.09 | loss  3.40 | ppl    30.10
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  20 | time: 59.19s | valid loss  4.47 | valid ppl    87.31
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  21 |   200/ 1327 batches | lr 0.08 | ms/batch 44.83 | loss  3.58 | ppl    35.78
| prune-epoch  21 |   400/ 1327 batches | lr 0.08 | ms/batch 42.87 | loss  3.56 | ppl    35.00
| prune-epoch  21 |   600/ 1327 batches | lr 0.08 | ms/batch 42.86 | loss  3.54 | ppl    34.35
| prune-epoch  21 |   800/ 1327 batches | lr 0.08 | ms/batch 42.88 | loss  3.48 | ppl    32.52
| prune-epoch  21 |  1000/ 1327 batches | lr 0.08 | ms/batch 42.88 | loss  3.55 | ppl    34.83
| prune-epoch  21 |  1200/ 1327 batches | lr 0.08 | ms/batch 42.87 | loss  3.40 | ppl    29.82
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  21 | time: 58.88s | valid loss  4.47 | valid ppl    87.28
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  22 |   200/ 1327 batches | lr 0.08 | ms/batch 45.01 | loss  3.57 | ppl    35.60
| prune-epoch  22 |   400/ 1327 batches | lr 0.08 | ms/batch 43.09 | loss  3.55 | ppl    34.83
| prune-epoch  22 |   600/ 1327 batches | lr 0.08 | ms/batch 43.08 | loss  3.53 | ppl    34.29
| prune-epoch  22 |   800/ 1327 batches | lr 0.08 | ms/batch 43.08 | loss  3.47 | ppl    32.18
| prune-epoch  22 |  1000/ 1327 batches | lr 0.08 | ms/batch 43.08 | loss  3.55 | ppl    34.77
| prune-epoch  22 |  1200/ 1327 batches | lr 0.08 | ms/batch 43.09 | loss  3.40 | ppl    29.92
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  22 | time: 59.16s | valid loss  4.47 | valid ppl    87.29
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  23 |   200/ 1327 batches | lr 0.02 | ms/batch 45.06 | loss  3.58 | ppl    35.70
| prune-epoch  23 |   400/ 1327 batches | lr 0.02 | ms/batch 43.19 | loss  3.55 | ppl    34.68
| prune-epoch  23 |   600/ 1327 batches | lr 0.02 | ms/batch 43.18 | loss  3.54 | ppl    34.30
| prune-epoch  23 |   800/ 1327 batches | lr 0.02 | ms/batch 43.17 | loss  3.47 | ppl    32.17
| prune-epoch  23 |  1000/ 1327 batches | lr 0.02 | ms/batch 43.18 | loss  3.55 | ppl    34.84
| prune-epoch  23 |  1200/ 1327 batches | lr 0.02 | ms/batch 43.17 | loss  3.40 | ppl    29.84
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  23 | time: 59.28s | valid loss  4.47 | valid ppl    87.27
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  24 |   200/ 1327 batches | lr 0.02 | ms/batch 44.51 | loss  3.57 | ppl    35.68
| prune-epoch  24 |   400/ 1327 batches | lr 0.02 | ms/batch 42.63 | loss  3.56 | ppl    35.02
| prune-epoch  24 |   600/ 1327 batches | lr 0.02 | ms/batch 42.62 | loss  3.53 | ppl    34.28
| prune-epoch  24 |   800/ 1327 batches | lr 0.02 | ms/batch 42.62 | loss  3.48 | ppl    32.49
| prune-epoch  24 |  1000/ 1327 batches | lr 0.02 | ms/batch 42.62 | loss  3.55 | ppl    34.86
| prune-epoch  24 |  1200/ 1327 batches | lr 0.02 | ms/batch 42.63 | loss  3.40 | ppl    29.88
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  24 | time: 58.54s | valid loss  4.47 | valid ppl    87.26
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  25 |   200/ 1327 batches | lr 0.02 | ms/batch 45.03 | loss  3.58 | ppl    35.76
| prune-epoch  25 |   400/ 1327 batches | lr 0.02 | ms/batch 43.14 | loss  3.55 | ppl    34.92
| prune-epoch  25 |   600/ 1327 batches | lr 0.02 | ms/batch 43.13 | loss  3.54 | ppl    34.37
| prune-epoch  25 |   800/ 1327 batches | lr 0.02 | ms/batch 43.15 | loss  3.47 | ppl    32.28
| prune-epoch  25 |  1000/ 1327 batches | lr 0.02 | ms/batch 43.14 | loss  3.55 | ppl    34.82
| prune-epoch  25 |  1200/ 1327 batches | lr 0.02 | ms/batch 43.13 | loss  3.40 | ppl    29.88
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  25 | time: 59.23s | valid loss  4.47 | valid ppl    87.25
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  26 |   200/ 1327 batches | lr 0.02 | ms/batch 44.98 | loss  3.57 | ppl    35.68
| prune-epoch  26 |   400/ 1327 batches | lr 0.02 | ms/batch 43.44 | loss  3.55 | ppl    34.88
| prune-epoch  26 |   600/ 1327 batches | lr 0.02 | ms/batch 43.49 | loss  3.54 | ppl    34.40
| prune-epoch  26 |   800/ 1327 batches | lr 0.02 | ms/batch 43.47 | loss  3.48 | ppl    32.39
| prune-epoch  26 |  1000/ 1327 batches | lr 0.02 | ms/batch 43.48 | loss  3.54 | ppl    34.59
| prune-epoch  26 |  1200/ 1327 batches | lr 0.02 | ms/batch 43.49 | loss  3.39 | ppl    29.75
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  26 | time: 59.60s | valid loss  4.47 | valid ppl    87.23
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  27 |   200/ 1327 batches | lr 0.02 | ms/batch 44.95 | loss  3.57 | ppl    35.52
| prune-epoch  27 |   400/ 1327 batches | lr 0.02 | ms/batch 43.07 | loss  3.55 | ppl    34.97
| prune-epoch  27 |   600/ 1327 batches | lr 0.02 | ms/batch 43.07 | loss  3.54 | ppl    34.44
| prune-epoch  27 |   800/ 1327 batches | lr 0.02 | ms/batch 43.07 | loss  3.48 | ppl    32.36
| prune-epoch  27 |  1000/ 1327 batches | lr 0.02 | ms/batch 43.10 | loss  3.55 | ppl    34.82
| prune-epoch  27 |  1200/ 1327 batches | lr 0.02 | ms/batch 43.10 | loss  3.39 | ppl    29.71
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  27 | time: 59.15s | valid loss  4.47 | valid ppl    87.25
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  28 |   200/ 1327 batches | lr 0.02 | ms/batch 44.71 | loss  3.58 | ppl    35.77
| prune-epoch  28 |   400/ 1327 batches | lr 0.02 | ms/batch 42.85 | loss  3.55 | ppl    34.82
| prune-epoch  28 |   600/ 1327 batches | lr 0.02 | ms/batch 42.84 | loss  3.54 | ppl    34.31
| prune-epoch  28 |   800/ 1327 batches | lr 0.02 | ms/batch 42.84 | loss  3.47 | ppl    32.15
| prune-epoch  28 |  1000/ 1327 batches | lr 0.02 | ms/batch 42.86 | loss  3.55 | ppl    34.91
| prune-epoch  28 |  1200/ 1327 batches | lr 0.02 | ms/batch 42.84 | loss  3.40 | ppl    29.89
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  28 | time: 58.84s | valid loss  4.47 | valid ppl    87.23
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  29 |   200/ 1327 batches | lr 0.02 | ms/batch 44.93 | loss  3.57 | ppl    35.62
| prune-epoch  29 |   400/ 1327 batches | lr 0.02 | ms/batch 43.06 | loss  3.55 | ppl    34.98
| prune-epoch  29 |   600/ 1327 batches | lr 0.02 | ms/batch 43.06 | loss  3.53 | ppl    34.22
| prune-epoch  29 |   800/ 1327 batches | lr 0.02 | ms/batch 43.06 | loss  3.47 | ppl    32.12
| prune-epoch  29 |  1000/ 1327 batches | lr 0.02 | ms/batch 43.06 | loss  3.55 | ppl    34.97
| prune-epoch  29 |  1200/ 1327 batches | lr 0.02 | ms/batch 43.05 | loss  3.40 | ppl    29.92
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  29 | time: 59.11s | valid loss  4.47 | valid ppl    87.22
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  30 |   200/ 1327 batches | lr 0.02 | ms/batch 45.04 | loss  3.57 | ppl    35.60
| prune-epoch  30 |   400/ 1327 batches | lr 0.02 | ms/batch 43.19 | loss  3.55 | ppl    34.85
| prune-epoch  30 |   600/ 1327 batches | lr 0.02 | ms/batch 43.15 | loss  3.54 | ppl    34.44
| prune-epoch  30 |   800/ 1327 batches | lr 0.02 | ms/batch 43.13 | loss  3.48 | ppl    32.32
| prune-epoch  30 |  1000/ 1327 batches | lr 0.02 | ms/batch 43.14 | loss  3.55 | ppl    34.69
| prune-epoch  30 |  1200/ 1327 batches | lr 0.02 | ms/batch 43.14 | loss  3.40 | ppl    29.93
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  30 | time: 59.24s | valid loss  4.47 | valid ppl    87.20
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  31 |   200/ 1327 batches | lr 0.02 | ms/batch 44.47 | loss  3.57 | ppl    35.46
| prune-epoch  31 |   400/ 1327 batches | lr 0.02 | ms/batch 42.60 | loss  3.55 | ppl    34.90
| prune-epoch  31 |   600/ 1327 batches | lr 0.02 | ms/batch 42.61 | loss  3.54 | ppl    34.39
| prune-epoch  31 |   800/ 1327 batches | lr 0.02 | ms/batch 42.60 | loss  3.48 | ppl    32.32
| prune-epoch  31 |  1000/ 1327 batches | lr 0.02 | ms/batch 42.60 | loss  3.55 | ppl    34.71
| prune-epoch  31 |  1200/ 1327 batches | lr 0.02 | ms/batch 42.61 | loss  3.40 | ppl    29.88
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  31 | time: 58.51s | valid loss  4.47 | valid ppl    87.19
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  32 |   200/ 1327 batches | lr 0.02 | ms/batch 45.01 | loss  3.57 | ppl    35.52
| prune-epoch  32 |   400/ 1327 batches | lr 0.02 | ms/batch 43.12 | loss  3.55 | ppl    34.69
| prune-epoch  32 |   600/ 1327 batches | lr 0.02 | ms/batch 43.13 | loss  3.54 | ppl    34.30
| prune-epoch  32 |   800/ 1327 batches | lr 0.02 | ms/batch 43.12 | loss  3.48 | ppl    32.52
| prune-epoch  32 |  1000/ 1327 batches | lr 0.02 | ms/batch 43.13 | loss  3.55 | ppl    34.72
| prune-epoch  32 |  1200/ 1327 batches | lr 0.02 | ms/batch 43.12 | loss  3.40 | ppl    29.89
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  32 | time: 59.21s | valid loss  4.47 | valid ppl    87.19
-----------------------------------------------------------------------------------------
required epochs  40 | actual epochs  64
pretrain epochs  17 | prune epochs  15 | retrain epochs  32
=========================================================================================
| End of training | test loss  4.42 | test ppl    83.29
=========================================================================================
python main.py --cuda --emsize 1500 --nhid 1500 --dropout 0.65 --epochs 40 --tied --save model/prune/model.pt --data ./data/ptb --prune --retrain --sparsity 0.9
<class 'torch.Tensor'> torch.Size([10000, 1500])
<class 'torch.Tensor'> torch.Size([6000, 1500])
<class 'torch.Tensor'> torch.Size([6000, 1500])
<class 'torch.Tensor'> torch.Size([6000])
<class 'torch.Tensor'> torch.Size([6000])
<class 'torch.Tensor'> torch.Size([6000, 1500])
<class 'torch.Tensor'> torch.Size([6000, 1500])
<class 'torch.Tensor'> torch.Size([6000])
<class 'torch.Tensor'> torch.Size([6000])
<class 'torch.Tensor'> torch.Size([10000])
RNNModel(
  (drop): Dropout(p=0.65)
  (encoder): Embedding(10000, 1500)
  (rnn): LSTM(1500, 1500, num_layers=2, dropout=0.65)
  (decoder): Linear(in_features=1500, out_features=10000, bias=True)
)
Dropout(p=0.65)
Embedding(10000, 1500)
LSTM(1500, 1500, num_layers=2, dropout=0.65)
Linear(in_features=1500, out_features=10000, bias=True)
| train-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 42.52 | loss  7.19 | ppl  1328.05
| train-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 42.19 | loss  6.25 | ppl   517.28
| train-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 42.21 | loss  5.96 | ppl   387.34
| train-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 42.21 | loss  5.73 | ppl   306.87
| train-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.21 | loss  5.63 | ppl   277.44
| train-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.23 | loss  5.49 | ppl   242.77
-----------------------------------------------------------------------------------------
| end of train epoch   1 | time: 57.70s | valid loss  5.36 | valid ppl   211.92
-----------------------------------------------------------------------------------------
| train-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 42.40 | loss  5.43 | ppl   227.55
| train-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 42.18 | loss  5.36 | ppl   213.65
| train-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 42.19 | loss  5.32 | ppl   204.31
| train-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 42.17 | loss  5.22 | ppl   184.70
| train-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.16 | loss  5.21 | ppl   183.33
| train-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.18 | loss  5.11 | ppl   166.17
-----------------------------------------------------------------------------------------
| end of train epoch   2 | time: 57.64s | valid loss  5.04 | valid ppl   154.87
-----------------------------------------------------------------------------------------
| train-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 42.42 | loss  5.12 | ppl   167.58
| train-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 42.19 | loss  5.10 | ppl   163.84
| train-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 42.19 | loss  5.07 | ppl   159.25
| train-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 42.20 | loss  4.99 | ppl   146.94
| train-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.19 | loss  5.01 | ppl   150.47
| train-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.20 | loss  4.90 | ppl   134.89
-----------------------------------------------------------------------------------------
| end of train epoch   3 | time: 57.67s | valid loss  4.87 | valid ppl   130.29
-----------------------------------------------------------------------------------------
| train-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 42.17 | loss  4.94 | ppl   139.21
| train-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 41.93 | loss  4.92 | ppl   137.59
| train-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 41.95 | loss  4.90 | ppl   134.21
| train-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 41.94 | loss  4.83 | ppl   125.44
| train-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 41.93 | loss  4.87 | ppl   130.62
| train-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 41.92 | loss  4.76 | ppl   117.14
-----------------------------------------------------------------------------------------
| end of train epoch   4 | time: 57.33s | valid loss  4.76 | valid ppl   117.21
-----------------------------------------------------------------------------------------
| train-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 42.34 | loss  4.80 | ppl   121.31
| train-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 42.10 | loss  4.79 | ppl   120.63
| train-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 42.09 | loss  4.78 | ppl   118.62
| train-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 42.11 | loss  4.71 | ppl   111.48
| train-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.13 | loss  4.76 | ppl   117.04
| train-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.13 | loss  4.65 | ppl   104.54
-----------------------------------------------------------------------------------------
| end of train epoch   5 | time: 57.58s | valid loss  4.69 | valid ppl   108.32
-----------------------------------------------------------------------------------------
| train-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 42.47 | loss  4.70 | ppl   109.61
| train-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 42.23 | loss  4.69 | ppl   109.19
| train-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 42.24 | loss  4.68 | ppl   107.54
| train-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 42.23 | loss  4.62 | ppl   101.30
| train-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.25 | loss  4.68 | ppl   107.32
| train-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.23 | loss  4.56 | ppl    95.57
-----------------------------------------------------------------------------------------
| end of train epoch   6 | time: 57.72s | valid loss  4.63 | valid ppl   102.10
-----------------------------------------------------------------------------------------
| train-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch 41.88 | loss  4.61 | ppl   100.96
| train-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch 41.67 | loss  4.61 | ppl   100.34
| train-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch 41.66 | loss  4.60 | ppl    99.67
| train-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch 41.68 | loss  4.54 | ppl    93.58
| train-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch 41.68 | loss  4.61 | ppl   100.10
| train-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch 41.68 | loss  4.49 | ppl    88.77
-----------------------------------------------------------------------------------------
| end of train epoch   7 | time: 56.97s | valid loss  4.58 | valid ppl    97.42
-----------------------------------------------------------------------------------------
| train-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch 42.41 | loss  4.54 | ppl    93.98
| train-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch 42.21 | loss  4.54 | ppl    94.08
| train-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch 42.22 | loss  4.53 | ppl    92.97
| train-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch 42.22 | loss  4.47 | ppl    87.34
| train-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.20 | loss  4.54 | ppl    93.65
| train-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.20 | loss  4.42 | ppl    83.12
-----------------------------------------------------------------------------------------
| end of train epoch   8 | time: 57.68s | valid loss  4.55 | valid ppl    94.29
-----------------------------------------------------------------------------------------
| train-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch 42.32 | loss  4.48 | ppl    88.37
| train-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch 42.10 | loss  4.48 | ppl    88.07
| train-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch 42.10 | loss  4.47 | ppl    87.21
| train-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch 42.12 | loss  4.41 | ppl    82.46
| train-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.11 | loss  4.48 | ppl    88.65
| train-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.12 | loss  4.36 | ppl    78.53
-----------------------------------------------------------------------------------------
| end of train epoch   9 | time: 57.56s | valid loss  4.51 | valid ppl    91.24
-----------------------------------------------------------------------------------------
| train-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch 42.40 | loss  4.43 | ppl    84.01
| train-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch 42.18 | loss  4.43 | ppl    83.61
| train-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch 42.16 | loss  4.42 | ppl    82.82
| train-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch 42.17 | loss  4.36 | ppl    78.27
| train-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.17 | loss  4.44 | ppl    84.46
| train-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.17 | loss  4.31 | ppl    74.68
-----------------------------------------------------------------------------------------
| end of train epoch  10 | time: 57.63s | valid loss  4.49 | valid ppl    88.89
-----------------------------------------------------------------------------------------
| train-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch 42.13 | loss  4.38 | ppl    79.69
| train-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch 41.90 | loss  4.38 | ppl    79.71
| train-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch 41.91 | loss  4.36 | ppl    78.42
| train-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch 41.91 | loss  4.32 | ppl    75.00
| train-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch 41.93 | loss  4.39 | ppl    80.60
| train-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch 41.94 | loss  4.26 | ppl    71.10
-----------------------------------------------------------------------------------------
| end of train epoch  11 | time: 57.30s | valid loss  4.47 | valid ppl    87.60
-----------------------------------------------------------------------------------------
| train-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch 42.36 | loss  4.33 | ppl    76.07
| train-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch 42.13 | loss  4.33 | ppl    76.02
| train-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch 42.15 | loss  4.32 | ppl    75.34
| train-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch 42.17 | loss  4.27 | ppl    71.56
| train-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.16 | loss  4.35 | ppl    77.29
| train-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.14 | loss  4.22 | ppl    68.18
-----------------------------------------------------------------------------------------
| end of train epoch  12 | time: 57.61s | valid loss  4.45 | valid ppl    85.57
-----------------------------------------------------------------------------------------
| train-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch 42.47 | loss  4.29 | ppl    73.10
| train-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch 42.27 | loss  4.29 | ppl    73.18
| train-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch 42.25 | loss  4.28 | ppl    71.94
| train-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch 42.27 | loss  4.23 | ppl    68.57
| train-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.27 | loss  4.31 | ppl    74.52
| train-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.27 | loss  4.18 | ppl    65.57
-----------------------------------------------------------------------------------------
| end of train epoch  13 | time: 57.76s | valid loss  4.44 | valid ppl    84.80
-----------------------------------------------------------------------------------------
| train-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch 41.89 | loss  4.26 | ppl    70.50
| train-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch 41.70 | loss  4.25 | ppl    70.34
| train-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch 41.69 | loss  4.24 | ppl    69.50
| train-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch 41.69 | loss  4.19 | ppl    65.97
| train-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch 41.69 | loss  4.28 | ppl    72.17
| train-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch 41.70 | loss  4.15 | ppl    63.19
-----------------------------------------------------------------------------------------
| end of train epoch  14 | time: 57.00s | valid loss  4.43 | valid ppl    83.58
-----------------------------------------------------------------------------------------
| train-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch 42.44 | loss  4.22 | ppl    67.93
| train-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch 42.23 | loss  4.22 | ppl    67.70
| train-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch 42.22 | loss  4.21 | ppl    67.08
| train-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch 42.23 | loss  4.15 | ppl    63.62
| train-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.23 | loss  4.25 | ppl    69.83
| train-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.22 | loss  4.11 | ppl    60.99
-----------------------------------------------------------------------------------------
| end of train epoch  15 | time: 57.71s | valid loss  4.42 | valid ppl    82.84
-----------------------------------------------------------------------------------------
| train-epoch  16 |   200/ 1327 batches | lr 20.00 | ms/batch 42.33 | loss  4.19 | ppl    65.74
| train-epoch  16 |   400/ 1327 batches | lr 20.00 | ms/batch 42.42 | loss  4.19 | ppl    65.77
| train-epoch  16 |   600/ 1327 batches | lr 20.00 | ms/batch 42.51 | loss  4.18 | ppl    65.09
| train-epoch  16 |   800/ 1327 batches | lr 20.00 | ms/batch 42.50 | loss  4.12 | ppl    61.74
| train-epoch  16 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.51 | loss  4.21 | ppl    67.54
| train-epoch  16 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.52 | loss  4.08 | ppl    58.97
-----------------------------------------------------------------------------------------
| end of train epoch  16 | time: 57.99s | valid loss  4.40 | valid ppl    81.50
-----------------------------------------------------------------------------------------
| train-epoch  17 |   200/ 1327 batches | lr 20.00 | ms/batch 42.74 | loss  4.16 | ppl    63.77
| train-epoch  17 |   400/ 1327 batches | lr 20.00 | ms/batch 42.53 | loss  4.15 | ppl    63.36
| train-epoch  17 |   600/ 1327 batches | lr 20.00 | ms/batch 42.53 | loss  4.14 | ppl    62.53
| train-epoch  17 |   800/ 1327 batches | lr 20.00 | ms/batch 42.53 | loss  4.10 | ppl    60.05
| train-epoch  17 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.54 | loss  4.18 | ppl    65.18
| train-epoch  17 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.53 | loss  4.05 | ppl    57.46
-----------------------------------------------------------------------------------------
| end of train epoch  17 | time: 58.11s | valid loss  4.39 | valid ppl    80.94
-----------------------------------------------------------------------------------------
| train-epoch  18 |   200/ 1327 batches | lr 20.00 | ms/batch 42.18 | loss  4.13 | ppl    62.02
| train-epoch  18 |   400/ 1327 batches | lr 20.00 | ms/batch 41.95 | loss  4.12 | ppl    61.76
| train-epoch  18 |   600/ 1327 batches | lr 20.00 | ms/batch 41.97 | loss  4.11 | ppl    60.84
| train-epoch  18 |   800/ 1327 batches | lr 20.00 | ms/batch 41.95 | loss  4.06 | ppl    58.19
| train-epoch  18 |  1000/ 1327 batches | lr 20.00 | ms/batch 41.93 | loss  4.16 | ppl    63.77
| train-epoch  18 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.12 | loss  4.02 | ppl    55.78
-----------------------------------------------------------------------------------------
| end of train epoch  18 | time: 57.43s | valid loss  4.39 | valid ppl    80.61
-----------------------------------------------------------------------------------------
| train-epoch  19 |   200/ 1327 batches | lr 20.00 | ms/batch 42.40 | loss  4.09 | ppl    59.97
| train-epoch  19 |   400/ 1327 batches | lr 20.00 | ms/batch 42.15 | loss  4.09 | ppl    59.56
| train-epoch  19 |   600/ 1327 batches | lr 20.00 | ms/batch 42.16 | loss  4.08 | ppl    59.19
| train-epoch  19 |   800/ 1327 batches | lr 20.00 | ms/batch 42.16 | loss  4.04 | ppl    56.71
| train-epoch  19 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.15 | loss  4.13 | ppl    62.12
| train-epoch  19 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.16 | loss  3.99 | ppl    54.28
-----------------------------------------------------------------------------------------
| end of train epoch  19 | time: 57.62s | valid loss  4.38 | valid ppl    80.22
-----------------------------------------------------------------------------------------
| train-epoch  20 |   200/ 1327 batches | lr 20.00 | ms/batch 42.50 | loss  4.06 | ppl    58.09
| train-epoch  20 |   400/ 1327 batches | lr 20.00 | ms/batch 42.29 | loss  4.06 | ppl    58.00
| train-epoch  20 |   600/ 1327 batches | lr 20.00 | ms/batch 42.30 | loss  4.05 | ppl    57.40
| train-epoch  20 |   800/ 1327 batches | lr 20.00 | ms/batch 42.30 | loss  4.01 | ppl    54.96
| train-epoch  20 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.29 | loss  4.10 | ppl    60.49
| train-epoch  20 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.29 | loss  3.96 | ppl    52.70
-----------------------------------------------------------------------------------------
| end of train epoch  20 | time: 57.79s | valid loss  4.38 | valid ppl    79.77
-----------------------------------------------------------------------------------------
| train-epoch  21 |   200/ 1327 batches | lr 20.00 | ms/batch 41.95 | loss  4.04 | ppl    56.71
| train-epoch  21 |   400/ 1327 batches | lr 20.00 | ms/batch 41.71 | loss  4.03 | ppl    56.30
| train-epoch  21 |   600/ 1327 batches | lr 20.00 | ms/batch 41.72 | loss  4.02 | ppl    55.97
| train-epoch  21 |   800/ 1327 batches | lr 20.00 | ms/batch 41.73 | loss  3.98 | ppl    53.61
| train-epoch  21 |  1000/ 1327 batches | lr 20.00 | ms/batch 41.74 | loss  4.07 | ppl    58.46
| train-epoch  21 |  1200/ 1327 batches | lr 20.00 | ms/batch 41.75 | loss  3.94 | ppl    51.20
-----------------------------------------------------------------------------------------
| end of train epoch  21 | time: 57.05s | valid loss  4.38 | valid ppl    79.78
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 45.41 | loss  4.02 | ppl    55.70
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 42.65 | loss  4.00 | ppl    54.84
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 42.64 | loss  3.99 | ppl    54.24
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 42.64 | loss  3.94 | ppl    51.67
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.64 | loss  4.03 | ppl    56.48
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.66 | loss  3.89 | ppl    48.99
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   1 | time: 58.76s | valid loss  4.37 | valid ppl    78.91
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 45.17 | loss  3.97 | ppl    53.18
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 42.58 | loss  3.97 | ppl    53.04
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 42.59 | loss  3.96 | ppl    52.35
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 42.58 | loss  3.91 | ppl    49.73
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.58 | loss  4.00 | ppl    54.84
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.57 | loss  3.86 | ppl    47.62
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.4  actual sp:  0.3993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   2 | time: 58.64s | valid loss  4.37 | valid ppl    79.09
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 45.35 | loss  3.96 | ppl    52.32
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 42.61 | loss  3.95 | ppl    51.91
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 42.62 | loss  3.94 | ppl    51.20
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 42.62 | loss  3.89 | ppl    48.83
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.63 | loss  3.98 | ppl    53.31
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.62 | loss  3.84 | ppl    46.30
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   3 | time: 58.72s | valid loss  4.37 | valid ppl    79.00
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 45.22 | loss  3.92 | ppl    50.60
| prune-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 42.79 | loss  3.92 | ppl    50.23
| prune-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 42.78 | loss  3.91 | ppl    49.70
| prune-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 42.78 | loss  3.86 | ppl    47.45
| prune-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.79 | loss  3.95 | ppl    51.89
| prune-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.78 | loss  3.81 | ppl    44.96
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   4 | time: 58.88s | valid loss  4.37 | valid ppl    78.71
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 45.14 | loss  3.89 | ppl    48.97
| prune-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 42.56 | loss  3.89 | ppl    48.85
| prune-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 42.56 | loss  3.87 | ppl    48.02
| prune-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 42.58 | loss  3.83 | ppl    45.95
| prune-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.58 | loss  3.93 | ppl    50.85
| prune-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.57 | loss  3.78 | ppl    44.00
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.5  actual sp:  0.4993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   5 | time: 58.62s | valid loss  4.37 | valid ppl    78.80
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 20.00 | ms/batch 45.39 | loss  3.89 | ppl    48.91
| prune-epoch   6 |   400/ 1327 batches | lr 20.00 | ms/batch 42.73 | loss  3.88 | ppl    48.58
| prune-epoch   6 |   600/ 1327 batches | lr 20.00 | ms/batch 42.73 | loss  3.86 | ppl    47.68
| prune-epoch   6 |   800/ 1327 batches | lr 20.00 | ms/batch 42.73 | loss  3.82 | ppl    45.48
| prune-epoch   6 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.74 | loss  3.92 | ppl    50.21
| prune-epoch   6 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.72 | loss  3.77 | ppl    43.44
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   6 | time: 58.84s | valid loss  4.37 | valid ppl    79.00
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 20.00 | ms/batch 44.70 | loss  3.85 | ppl    47.15
| prune-epoch   7 |   400/ 1327 batches | lr 20.00 | ms/batch 42.22 | loss  3.85 | ppl    47.03
| prune-epoch   7 |   600/ 1327 batches | lr 20.00 | ms/batch 42.21 | loss  3.84 | ppl    46.52
| prune-epoch   7 |   800/ 1327 batches | lr 20.00 | ms/batch 42.22 | loss  3.79 | ppl    44.23
| prune-epoch   7 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.21 | loss  3.88 | ppl    48.61
| prune-epoch   7 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.20 | loss  3.74 | ppl    42.25
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.6  actual sp:  0.5993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch   7 | time: 58.12s | valid loss  4.37 | valid ppl    79.08
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 20.00 | ms/batch 45.19 | loss  3.88 | ppl    48.23
| prune-epoch   8 |   400/ 1327 batches | lr 20.00 | ms/batch 42.65 | loss  3.87 | ppl    47.98
| prune-epoch   8 |   600/ 1327 batches | lr 20.00 | ms/batch 42.66 | loss  3.85 | ppl    47.04
| prune-epoch   8 |   800/ 1327 batches | lr 20.00 | ms/batch 42.67 | loss  3.80 | ppl    44.81
| prune-epoch   8 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.67 | loss  3.89 | ppl    49.08
| prune-epoch   8 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.69 | loss  3.75 | ppl    42.56
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
-----------------------------------------------------------------------------------------
| end of prune epoch   8 | time: 58.73s | valid loss  4.37 | valid ppl    78.89
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 20.00 | ms/batch 44.91 | loss  3.83 | ppl    46.27
| prune-epoch   9 |   400/ 1327 batches | lr 20.00 | ms/batch 42.61 | loss  3.83 | ppl    45.97
| prune-epoch   9 |   600/ 1327 batches | lr 20.00 | ms/batch 42.60 | loss  3.82 | ppl    45.55
| prune-epoch   9 |   800/ 1327 batches | lr 20.00 | ms/batch 42.61 | loss  3.77 | ppl    43.31
| prune-epoch   9 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.65 | loss  3.87 | ppl    47.89
| prune-epoch   9 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.61 | loss  3.72 | ppl    41.28
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7  actual sp:  0.6993333333333334
-----------------------------------------------------------------------------------------
| end of prune epoch   9 | time: 58.61s | valid loss  4.37 | valid ppl    79.07
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 20.00 | ms/batch 45.02 | loss  3.92 | ppl    50.52
| prune-epoch  10 |   400/ 1327 batches | lr 20.00 | ms/batch 42.65 | loss  3.91 | ppl    49.66
| prune-epoch  10 |   600/ 1327 batches | lr 20.00 | ms/batch 42.65 | loss  3.88 | ppl    48.49
| prune-epoch  10 |   800/ 1327 batches | lr 20.00 | ms/batch 42.65 | loss  3.83 | ppl    46.02
| prune-epoch  10 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.66 | loss  3.92 | ppl    50.43
| prune-epoch  10 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.67 | loss  3.78 | ppl    43.79
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch  10 | time: 58.67s | valid loss  4.38 | valid ppl    79.66
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 20.00 | ms/batch 44.60 | loss  3.86 | ppl    47.39
| prune-epoch  11 |   400/ 1327 batches | lr 20.00 | ms/batch 42.46 | loss  3.86 | ppl    47.57
| prune-epoch  11 |   600/ 1327 batches | lr 20.00 | ms/batch 42.46 | loss  3.84 | ppl    46.57
| prune-epoch  11 |   800/ 1327 batches | lr 20.00 | ms/batch 42.44 | loss  3.79 | ppl    44.28
| prune-epoch  11 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.47 | loss  3.88 | ppl    48.50
| prune-epoch  11 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.47 | loss  3.75 | ppl    42.54
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.7999999999999999  actual sp:  0.7993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch  11 | time: 58.37s | valid loss  4.38 | valid ppl    79.86
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 20.00 | ms/batch 44.78 | loss  3.92 | ppl    50.46
| prune-epoch  12 |   400/ 1327 batches | lr 20.00 | ms/batch 42.61 | loss  3.91 | ppl    50.09
| prune-epoch  12 |   600/ 1327 batches | lr 20.00 | ms/batch 42.63 | loss  3.89 | ppl    48.91
| prune-epoch  12 |   800/ 1327 batches | lr 20.00 | ms/batch 42.64 | loss  3.84 | ppl    46.48
| prune-epoch  12 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.63 | loss  3.93 | ppl    50.73
| prune-epoch  12 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.63 | loss  3.79 | ppl    44.04
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493332222222222
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch  12 | time: 58.60s | valid loss  4.39 | valid ppl    80.36
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 20.00 | ms/batch 44.74 | loss  3.87 | ppl    47.93
| prune-epoch  13 |   400/ 1327 batches | lr 20.00 | ms/batch 42.76 | loss  3.86 | ppl    47.65
| prune-epoch  13 |   600/ 1327 batches | lr 20.00 | ms/batch 42.77 | loss  3.85 | ppl    46.92
| prune-epoch  13 |   800/ 1327 batches | lr 20.00 | ms/batch 42.76 | loss  3.81 | ppl    44.98
| prune-epoch  13 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.75 | loss  3.90 | ppl    49.22
| prune-epoch  13 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.77 | loss  3.76 | ppl    42.83
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch  13 | time: 58.74s | valid loss  4.39 | valid ppl    80.25
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 20.00 | ms/batch 44.18 | loss  3.84 | ppl    46.53
| prune-epoch  14 |   400/ 1327 batches | lr 20.00 | ms/batch 42.19 | loss  3.84 | ppl    46.55
| prune-epoch  14 |   600/ 1327 batches | lr 20.00 | ms/batch 42.19 | loss  3.83 | ppl    45.95
| prune-epoch  14 |   800/ 1327 batches | lr 20.00 | ms/batch 42.19 | loss  3.78 | ppl    43.71
| prune-epoch  14 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.18 | loss  3.87 | ppl    47.95
| prune-epoch  14 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.17 | loss  3.73 | ppl    41.84
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.85  actual sp:  0.8493333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch  14 | time: 57.98s | valid loss  4.39 | valid ppl    80.42
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 20.00 | ms/batch 44.67 | loss  3.98 | ppl    53.57
| prune-epoch  15 |   400/ 1327 batches | lr 20.00 | ms/batch 42.67 | loss  3.96 | ppl    52.29
| prune-epoch  15 |   600/ 1327 batches | lr 20.00 | ms/batch 42.67 | loss  3.94 | ppl    51.28
| prune-epoch  15 |   800/ 1327 batches | lr 20.00 | ms/batch 42.67 | loss  3.89 | ppl    48.70
| prune-epoch  15 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.69 | loss  3.97 | ppl    52.86
| prune-epoch  15 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.68 | loss  3.83 | ppl    46.15
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993332222222222
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of prune epoch  15 | time: 58.64s | valid loss  4.40 | valid ppl    81.60
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   1 |   200/ 1327 batches | lr 20.00 | ms/batch 44.46 | loss  3.91 | ppl    49.96
| prune-epoch   1 |   400/ 1327 batches | lr 20.00 | ms/batch 42.63 | loss  3.91 | ppl    49.87
| prune-epoch   1 |   600/ 1327 batches | lr 20.00 | ms/batch 42.62 | loss  3.89 | ppl    48.94
| prune-epoch   1 |   800/ 1327 batches | lr 20.00 | ms/batch 42.61 | loss  3.85 | ppl    46.76
| prune-epoch   1 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.61 | loss  3.94 | ppl    51.21
| prune-epoch   1 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.60 | loss  3.80 | ppl    44.62
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   1 | time: 58.52s | valid loss  4.40 | valid ppl    81.41
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   2 |   200/ 1327 batches | lr 20.00 | ms/batch 44.53 | loss  3.88 | ppl    48.60
| prune-epoch   2 |   400/ 1327 batches | lr 20.00 | ms/batch 42.64 | loss  3.88 | ppl    48.27
| prune-epoch   2 |   600/ 1327 batches | lr 20.00 | ms/batch 42.66 | loss  3.87 | ppl    47.75
| prune-epoch   2 |   800/ 1327 batches | lr 20.00 | ms/batch 42.65 | loss  3.82 | ppl    45.81
| prune-epoch   2 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.66 | loss  3.91 | ppl    49.86
| prune-epoch   2 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.66 | loss  3.77 | ppl    43.52
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   2 | time: 58.58s | valid loss  4.40 | valid ppl    81.22
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   3 |   200/ 1327 batches | lr 20.00 | ms/batch 44.31 | loss  3.86 | ppl    47.47
| prune-epoch   3 |   400/ 1327 batches | lr 20.00 | ms/batch 42.42 | loss  3.85 | ppl    47.14
| prune-epoch   3 |   600/ 1327 batches | lr 20.00 | ms/batch 42.75 | loss  3.84 | ppl    46.54
| prune-epoch   3 |   800/ 1327 batches | lr 20.00 | ms/batch 42.77 | loss  3.80 | ppl    44.63
| prune-epoch   3 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.79 | loss  3.89 | ppl    48.88
| prune-epoch   3 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.78 | loss  3.75 | ppl    42.60
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   3 | time: 58.61s | valid loss  4.40 | valid ppl    81.77
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   4 |   200/ 1327 batches | lr 20.00 | ms/batch 44.43 | loss  3.84 | ppl    46.65
| prune-epoch   4 |   400/ 1327 batches | lr 20.00 | ms/batch 42.60 | loss  3.84 | ppl    46.35
| prune-epoch   4 |   600/ 1327 batches | lr 20.00 | ms/batch 42.59 | loss  3.83 | ppl    46.12
| prune-epoch   4 |   800/ 1327 batches | lr 20.00 | ms/batch 42.59 | loss  3.78 | ppl    43.78
| prune-epoch   4 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.61 | loss  3.87 | ppl    47.84
| prune-epoch   4 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.59 | loss  3.74 | ppl    41.93
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   4 | time: 58.50s | valid loss  4.40 | valid ppl    81.36
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   5 |   200/ 1327 batches | lr 20.00 | ms/batch 44.62 | loss  3.83 | ppl    45.86
| prune-epoch   5 |   400/ 1327 batches | lr 20.00 | ms/batch 42.73 | loss  3.82 | ppl    45.48
| prune-epoch   5 |   600/ 1327 batches | lr 20.00 | ms/batch 42.73 | loss  3.81 | ppl    45.04
| prune-epoch   5 |   800/ 1327 batches | lr 20.00 | ms/batch 42.74 | loss  3.77 | ppl    43.23
| prune-epoch   5 |  1000/ 1327 batches | lr 20.00 | ms/batch 42.75 | loss  3.85 | ppl    47.20
| prune-epoch   5 |  1200/ 1327 batches | lr 20.00 | ms/batch 42.72 | loss  3.73 | ppl    41.49
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   5 | time: 58.69s | valid loss  4.40 | valid ppl    81.57
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   6 |   200/ 1327 batches | lr 5.00 | ms/batch 44.02 | loss  3.80 | ppl    44.91
| prune-epoch   6 |   400/ 1327 batches | lr 5.00 | ms/batch 42.15 | loss  3.76 | ppl    43.11
| prune-epoch   6 |   600/ 1327 batches | lr 5.00 | ms/batch 42.15 | loss  3.73 | ppl    41.75
| prune-epoch   6 |   800/ 1327 batches | lr 5.00 | ms/batch 42.14 | loss  3.68 | ppl    39.62
| prune-epoch   6 |  1000/ 1327 batches | lr 5.00 | ms/batch 42.15 | loss  3.75 | ppl    42.69
| prune-epoch   6 |  1200/ 1327 batches | lr 5.00 | ms/batch 42.15 | loss  3.60 | ppl    36.51
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   6 | time: 57.91s | valid loss  4.39 | valid ppl    80.78
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   7 |   200/ 1327 batches | lr 5.00 | ms/batch 44.53 | loss  3.74 | ppl    42.26
| prune-epoch   7 |   400/ 1327 batches | lr 5.00 | ms/batch 42.68 | loss  3.72 | ppl    41.43
| prune-epoch   7 |   600/ 1327 batches | lr 5.00 | ms/batch 42.69 | loss  3.71 | ppl    40.68
| prune-epoch   7 |   800/ 1327 batches | lr 5.00 | ms/batch 42.68 | loss  3.65 | ppl    38.52
| prune-epoch   7 |  1000/ 1327 batches | lr 5.00 | ms/batch 42.70 | loss  3.73 | ppl    41.59
| prune-epoch   7 |  1200/ 1327 batches | lr 5.00 | ms/batch 42.69 | loss  3.58 | ppl    36.01
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   7 | time: 58.62s | valid loss  4.39 | valid ppl    81.04
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   8 |   200/ 1327 batches | lr 5.00 | ms/batch 44.44 | loss  3.72 | ppl    41.22
| prune-epoch   8 |   400/ 1327 batches | lr 5.00 | ms/batch 42.60 | loss  3.70 | ppl    40.53
| prune-epoch   8 |   600/ 1327 batches | lr 5.00 | ms/batch 42.61 | loss  3.69 | ppl    39.94
| prune-epoch   8 |   800/ 1327 batches | lr 5.00 | ms/batch 42.60 | loss  3.64 | ppl    37.96
| prune-epoch   8 |  1000/ 1327 batches | lr 5.00 | ms/batch 42.61 | loss  3.71 | ppl    41.05
| prune-epoch   8 |  1200/ 1327 batches | lr 5.00 | ms/batch 42.61 | loss  3.57 | ppl    35.60
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   8 | time: 58.51s | valid loss  4.40 | valid ppl    81.35
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch   9 |   200/ 1327 batches | lr 1.25 | ms/batch 44.52 | loss  3.72 | ppl    41.32
| prune-epoch   9 |   400/ 1327 batches | lr 1.25 | ms/batch 42.64 | loss  3.71 | ppl    41.00
| prune-epoch   9 |   600/ 1327 batches | lr 1.25 | ms/batch 42.66 | loss  3.69 | ppl    39.85
| prune-epoch   9 |   800/ 1327 batches | lr 1.25 | ms/batch 42.64 | loss  3.62 | ppl    37.29
| prune-epoch   9 |  1000/ 1327 batches | lr 1.25 | ms/batch 42.66 | loss  3.70 | ppl    40.61
| prune-epoch   9 |  1200/ 1327 batches | lr 1.25 | ms/batch 42.66 | loss  3.55 | ppl    34.73
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch   9 | time: 58.58s | valid loss  4.38 | valid ppl    80.21
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  10 |   200/ 1327 batches | lr 1.25 | ms/batch 44.28 | loss  3.70 | ppl    40.50
| prune-epoch  10 |   400/ 1327 batches | lr 1.25 | ms/batch 42.73 | loss  3.69 | ppl    39.94
| prune-epoch  10 |   600/ 1327 batches | lr 1.25 | ms/batch 42.82 | loss  3.67 | ppl    39.24
| prune-epoch  10 |   800/ 1327 batches | lr 1.25 | ms/batch 42.85 | loss  3.61 | ppl    36.96
| prune-epoch  10 |  1000/ 1327 batches | lr 1.25 | ms/batch 42.81 | loss  3.69 | ppl    40.15
| prune-epoch  10 |  1200/ 1327 batches | lr 1.25 | ms/batch 42.81 | loss  3.54 | ppl    34.61
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  10 | time: 58.71s | valid loss  4.39 | valid ppl    80.32
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  11 |   200/ 1327 batches | lr 1.25 | ms/batch 44.44 | loss  3.69 | ppl    40.19
| prune-epoch  11 |   400/ 1327 batches | lr 1.25 | ms/batch 42.59 | loss  3.68 | ppl    39.59
| prune-epoch  11 |   600/ 1327 batches | lr 1.25 | ms/batch 42.61 | loss  3.66 | ppl    38.81
| prune-epoch  11 |   800/ 1327 batches | lr 1.25 | ms/batch 42.60 | loss  3.60 | ppl    36.74
| prune-epoch  11 |  1000/ 1327 batches | lr 1.25 | ms/batch 42.60 | loss  3.68 | ppl    39.80
| prune-epoch  11 |  1200/ 1327 batches | lr 1.25 | ms/batch 42.60 | loss  3.54 | ppl    34.41
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  11 | time: 58.50s | valid loss  4.39 | valid ppl    80.29
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  12 |   200/ 1327 batches | lr 1.25 | ms/batch 44.62 | loss  3.68 | ppl    39.70
| prune-epoch  12 |   400/ 1327 batches | lr 1.25 | ms/batch 42.74 | loss  3.67 | ppl    39.42
| prune-epoch  12 |   600/ 1327 batches | lr 1.25 | ms/batch 42.74 | loss  3.65 | ppl    38.64
| prune-epoch  12 |   800/ 1327 batches | lr 1.25 | ms/batch 42.75 | loss  3.60 | ppl    36.63
| prune-epoch  12 |  1000/ 1327 batches | lr 1.25 | ms/batch 42.75 | loss  3.69 | ppl    40.14
| prune-epoch  12 |  1200/ 1327 batches | lr 1.25 | ms/batch 42.74 | loss  3.54 | ppl    34.40
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  12 | time: 58.70s | valid loss  4.39 | valid ppl    80.37
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  13 |   200/ 1327 batches | lr 0.31 | ms/batch 44.03 | loss  3.70 | ppl    40.25
| prune-epoch  13 |   400/ 1327 batches | lr 0.31 | ms/batch 42.18 | loss  3.69 | ppl    40.04
| prune-epoch  13 |   600/ 1327 batches | lr 0.31 | ms/batch 42.16 | loss  3.67 | ppl    39.42
| prune-epoch  13 |   800/ 1327 batches | lr 0.31 | ms/batch 42.16 | loss  3.61 | ppl    36.91
| prune-epoch  13 |  1000/ 1327 batches | lr 0.31 | ms/batch 42.15 | loss  3.68 | ppl    39.81
| prune-epoch  13 |  1200/ 1327 batches | lr 0.31 | ms/batch 42.15 | loss  3.54 | ppl    34.35
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  13 | time: 57.92s | valid loss  4.38 | valid ppl    79.65
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  14 |   200/ 1327 batches | lr 0.31 | ms/batch 44.56 | loss  3.69 | ppl    40.13
| prune-epoch  14 |   400/ 1327 batches | lr 0.31 | ms/batch 42.68 | loss  3.67 | ppl    39.40
| prune-epoch  14 |   600/ 1327 batches | lr 0.31 | ms/batch 42.67 | loss  3.67 | ppl    39.07
| prune-epoch  14 |   800/ 1327 batches | lr 0.31 | ms/batch 42.69 | loss  3.60 | ppl    36.65
| prune-epoch  14 |  1000/ 1327 batches | lr 0.31 | ms/batch 42.69 | loss  3.68 | ppl    39.64
| prune-epoch  14 |  1200/ 1327 batches | lr 0.31 | ms/batch 42.70 | loss  3.54 | ppl    34.47
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  14 | time: 58.62s | valid loss  4.38 | valid ppl    79.55
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  15 |   200/ 1327 batches | lr 0.31 | ms/batch 44.49 | loss  3.69 | ppl    40.21
| prune-epoch  15 |   400/ 1327 batches | lr 0.31 | ms/batch 42.62 | loss  3.68 | ppl    39.68
| prune-epoch  15 |   600/ 1327 batches | lr 0.31 | ms/batch 42.61 | loss  3.66 | ppl    38.88
| prune-epoch  15 |   800/ 1327 batches | lr 0.31 | ms/batch 42.61 | loss  3.60 | ppl    36.50
| prune-epoch  15 |  1000/ 1327 batches | lr 0.31 | ms/batch 42.62 | loss  3.68 | ppl    39.79
| prune-epoch  15 |  1200/ 1327 batches | lr 0.31 | ms/batch 42.61 | loss  3.54 | ppl    34.41
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  15 | time: 58.53s | valid loss  4.38 | valid ppl    79.56
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  16 |   200/ 1327 batches | lr 0.31 | ms/batch 44.49 | loss  3.69 | ppl    40.09
| prune-epoch  16 |   400/ 1327 batches | lr 0.31 | ms/batch 42.66 | loss  3.67 | ppl    39.15
| prune-epoch  16 |   600/ 1327 batches | lr 0.31 | ms/batch 42.65 | loss  3.66 | ppl    38.84
| prune-epoch  16 |   800/ 1327 batches | lr 0.31 | ms/batch 42.67 | loss  3.59 | ppl    36.30
| prune-epoch  16 |  1000/ 1327 batches | lr 0.31 | ms/batch 42.66 | loss  3.68 | ppl    39.80
| prune-epoch  16 |  1200/ 1327 batches | lr 0.31 | ms/batch 42.66 | loss  3.54 | ppl    34.48
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  16 | time: 58.58s | valid loss  4.38 | valid ppl    79.55
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  17 |   200/ 1327 batches | lr 0.31 | ms/batch 44.29 | loss  3.69 | ppl    39.94
| prune-epoch  17 |   400/ 1327 batches | lr 0.31 | ms/batch 42.44 | loss  3.67 | ppl    39.23
| prune-epoch  17 |   600/ 1327 batches | lr 0.31 | ms/batch 42.43 | loss  3.65 | ppl    38.56
| prune-epoch  17 |   800/ 1327 batches | lr 0.31 | ms/batch 42.43 | loss  3.60 | ppl    36.46
| prune-epoch  17 |  1000/ 1327 batches | lr 0.31 | ms/batch 42.44 | loss  3.68 | ppl    39.68
| prune-epoch  17 |  1200/ 1327 batches | lr 0.31 | ms/batch 42.45 | loss  3.54 | ppl    34.39
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  17 | time: 58.29s | valid loss  4.38 | valid ppl    79.58
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  18 |   200/ 1327 batches | lr 0.08 | ms/batch 44.46 | loss  3.69 | ppl    39.88
| prune-epoch  18 |   400/ 1327 batches | lr 0.08 | ms/batch 42.62 | loss  3.67 | ppl    39.31
| prune-epoch  18 |   600/ 1327 batches | lr 0.08 | ms/batch 42.62 | loss  3.66 | ppl    38.93
| prune-epoch  18 |   800/ 1327 batches | lr 0.08 | ms/batch 42.64 | loss  3.60 | ppl    36.42
| prune-epoch  18 |  1000/ 1327 batches | lr 0.08 | ms/batch 42.62 | loss  3.68 | ppl    39.73
| prune-epoch  18 |  1200/ 1327 batches | lr 0.08 | ms/batch 42.63 | loss  3.54 | ppl    34.31
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  18 | time: 58.53s | valid loss  4.37 | valid ppl    79.43
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  19 |   200/ 1327 batches | lr 0.08 | ms/batch 44.60 | loss  3.69 | ppl    40.05
| prune-epoch  19 |   400/ 1327 batches | lr 0.08 | ms/batch 42.75 | loss  3.67 | ppl    39.27
| prune-epoch  19 |   600/ 1327 batches | lr 0.08 | ms/batch 42.77 | loss  3.65 | ppl    38.62
| prune-epoch  19 |   800/ 1327 batches | lr 0.08 | ms/batch 42.76 | loss  3.59 | ppl    36.41
| prune-epoch  19 |  1000/ 1327 batches | lr 0.08 | ms/batch 42.76 | loss  3.68 | ppl    39.67
| prune-epoch  19 |  1200/ 1327 batches | lr 0.08 | ms/batch 42.76 | loss  3.53 | ppl    34.06
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  19 | time: 58.72s | valid loss  4.37 | valid ppl    79.38
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  20 |   200/ 1327 batches | lr 0.08 | ms/batch 44.03 | loss  3.69 | ppl    40.01
| prune-epoch  20 |   400/ 1327 batches | lr 0.08 | ms/batch 42.18 | loss  3.67 | ppl    39.21
| prune-epoch  20 |   600/ 1327 batches | lr 0.08 | ms/batch 42.18 | loss  3.65 | ppl    38.62
| prune-epoch  20 |   800/ 1327 batches | lr 0.08 | ms/batch 42.18 | loss  3.59 | ppl    36.33
| prune-epoch  20 |  1000/ 1327 batches | lr 0.08 | ms/batch 42.18 | loss  3.68 | ppl    39.57
| prune-epoch  20 |  1200/ 1327 batches | lr 0.08 | ms/batch 42.18 | loss  3.54 | ppl    34.34
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  20 | time: 57.95s | valid loss  4.37 | valid ppl    79.35
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  21 |   200/ 1327 batches | lr 0.08 | ms/batch 44.56 | loss  3.69 | ppl    39.89
| prune-epoch  21 |   400/ 1327 batches | lr 0.08 | ms/batch 42.71 | loss  3.67 | ppl    39.07
| prune-epoch  21 |   600/ 1327 batches | lr 0.08 | ms/batch 42.72 | loss  3.65 | ppl    38.65
| prune-epoch  21 |   800/ 1327 batches | lr 0.08 | ms/batch 42.73 | loss  3.59 | ppl    36.30
| prune-epoch  21 |  1000/ 1327 batches | lr 0.08 | ms/batch 42.71 | loss  3.68 | ppl    39.60
| prune-epoch  21 |  1200/ 1327 batches | lr 0.08 | ms/batch 42.71 | loss  3.53 | ppl    34.28
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  21 | time: 58.66s | valid loss  4.37 | valid ppl    79.35
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  22 |   200/ 1327 batches | lr 0.08 | ms/batch 44.47 | loss  3.68 | ppl    39.84
| prune-epoch  22 |   400/ 1327 batches | lr 0.08 | ms/batch 42.63 | loss  3.66 | ppl    39.00
| prune-epoch  22 |   600/ 1327 batches | lr 0.08 | ms/batch 42.62 | loss  3.65 | ppl    38.63
| prune-epoch  22 |   800/ 1327 batches | lr 0.08 | ms/batch 42.62 | loss  3.60 | ppl    36.45
| prune-epoch  22 |  1000/ 1327 batches | lr 0.08 | ms/batch 42.63 | loss  3.67 | ppl    39.42
| prune-epoch  22 |  1200/ 1327 batches | lr 0.08 | ms/batch 42.65 | loss  3.53 | ppl    34.13
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  22 | time: 58.55s | valid loss  4.37 | valid ppl    79.35
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  23 |   200/ 1327 batches | lr 0.08 | ms/batch 44.50 | loss  3.68 | ppl    39.82
| prune-epoch  23 |   400/ 1327 batches | lr 0.08 | ms/batch 42.66 | loss  3.67 | ppl    39.21
| prune-epoch  23 |   600/ 1327 batches | lr 0.08 | ms/batch 42.67 | loss  3.65 | ppl    38.56
| prune-epoch  23 |   800/ 1327 batches | lr 0.08 | ms/batch 42.68 | loss  3.59 | ppl    36.34
| prune-epoch  23 |  1000/ 1327 batches | lr 0.08 | ms/batch 42.66 | loss  3.68 | ppl    39.51
| prune-epoch  23 |  1200/ 1327 batches | lr 0.08 | ms/batch 42.66 | loss  3.54 | ppl    34.40
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  23 | time: 58.59s | valid loss  4.37 | valid ppl    79.33
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  24 |   200/ 1327 batches | lr 0.08 | ms/batch 44.28 | loss  3.69 | ppl    39.95
| prune-epoch  24 |   400/ 1327 batches | lr 0.08 | ms/batch 42.42 | loss  3.67 | ppl    39.25
| prune-epoch  24 |   600/ 1327 batches | lr 0.08 | ms/batch 42.43 | loss  3.66 | ppl    38.77
| prune-epoch  24 |   800/ 1327 batches | lr 0.08 | ms/batch 42.43 | loss  3.59 | ppl    36.33
| prune-epoch  24 |  1000/ 1327 batches | lr 0.08 | ms/batch 42.44 | loss  3.68 | ppl    39.72
| prune-epoch  24 |  1200/ 1327 batches | lr 0.08 | ms/batch 42.43 | loss  3.53 | ppl    34.11
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  24 | time: 58.28s | valid loss  4.37 | valid ppl    79.33
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  25 |   200/ 1327 batches | lr 0.02 | ms/batch 44.44 | loss  3.68 | ppl    39.80
| prune-epoch  25 |   400/ 1327 batches | lr 0.02 | ms/batch 42.63 | loss  3.67 | ppl    39.27
| prune-epoch  25 |   600/ 1327 batches | lr 0.02 | ms/batch 42.61 | loss  3.65 | ppl    38.63
| prune-epoch  25 |   800/ 1327 batches | lr 0.02 | ms/batch 42.62 | loss  3.60 | ppl    36.58
| prune-epoch  25 |  1000/ 1327 batches | lr 0.02 | ms/batch 42.60 | loss  3.68 | ppl    39.72
| prune-epoch  25 |  1200/ 1327 batches | lr 0.02 | ms/batch 42.63 | loss  3.53 | ppl    34.17
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  25 | time: 58.52s | valid loss  4.37 | valid ppl    79.31
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  26 |   200/ 1327 batches | lr 0.02 | ms/batch 44.65 | loss  3.69 | ppl    39.92
| prune-epoch  26 |   400/ 1327 batches | lr 0.02 | ms/batch 42.76 | loss  3.67 | ppl    39.24
| prune-epoch  26 |   600/ 1327 batches | lr 0.02 | ms/batch 42.75 | loss  3.66 | ppl    38.68
| prune-epoch  26 |   800/ 1327 batches | lr 0.02 | ms/batch 42.75 | loss  3.60 | ppl    36.54
| prune-epoch  26 |  1000/ 1327 batches | lr 0.02 | ms/batch 42.76 | loss  3.68 | ppl    39.76
| prune-epoch  26 |  1200/ 1327 batches | lr 0.02 | ms/batch 42.75 | loss  3.53 | ppl    34.26
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  26 | time: 58.72s | valid loss  4.37 | valid ppl    79.30
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  27 |   200/ 1327 batches | lr 0.02 | ms/batch 44.09 | loss  3.68 | ppl    39.80
| prune-epoch  27 |   400/ 1327 batches | lr 0.02 | ms/batch 42.18 | loss  3.67 | ppl    39.07
| prune-epoch  27 |   600/ 1327 batches | lr 0.02 | ms/batch 42.18 | loss  3.65 | ppl    38.63
| prune-epoch  27 |   800/ 1327 batches | lr 0.02 | ms/batch 42.18 | loss  3.59 | ppl    36.29
| prune-epoch  27 |  1000/ 1327 batches | lr 0.02 | ms/batch 42.18 | loss  3.68 | ppl    39.48
| prune-epoch  27 |  1200/ 1327 batches | lr 0.02 | ms/batch 42.18 | loss  3.54 | ppl    34.32
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  27 | time: 57.96s | valid loss  4.37 | valid ppl    79.31
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  28 |   200/ 1327 batches | lr 0.02 | ms/batch 44.52 | loss  3.68 | ppl    39.64
| prune-epoch  28 |   400/ 1327 batches | lr 0.02 | ms/batch 42.70 | loss  3.67 | ppl    39.13
| prune-epoch  28 |   600/ 1327 batches | lr 0.02 | ms/batch 42.72 | loss  3.66 | ppl    38.67
| prune-epoch  28 |   800/ 1327 batches | lr 0.02 | ms/batch 42.70 | loss  3.59 | ppl    36.33
| prune-epoch  28 |  1000/ 1327 batches | lr 0.02 | ms/batch 42.70 | loss  3.68 | ppl    39.61
| prune-epoch  28 |  1200/ 1327 batches | lr 0.02 | ms/batch 42.71 | loss  3.53 | ppl    34.14
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  28 | time: 58.64s | valid loss  4.37 | valid ppl    79.30
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  29 |   200/ 1327 batches | lr 0.02 | ms/batch 44.47 | loss  3.68 | ppl    39.72
| prune-epoch  29 |   400/ 1327 batches | lr 0.02 | ms/batch 42.63 | loss  3.67 | ppl    39.11
| prune-epoch  29 |   600/ 1327 batches | lr 0.02 | ms/batch 42.63 | loss  3.65 | ppl    38.56
| prune-epoch  29 |   800/ 1327 batches | lr 0.02 | ms/batch 42.65 | loss  3.60 | ppl    36.45
| prune-epoch  29 |  1000/ 1327 batches | lr 0.02 | ms/batch 42.65 | loss  3.68 | ppl    39.53
| prune-epoch  29 |  1200/ 1327 batches | lr 0.02 | ms/batch 42.63 | loss  3.54 | ppl    34.31
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  29 | time: 58.55s | valid loss  4.37 | valid ppl    79.30
-----------------------------------------------------------------------------------------
begin prun train
| prune-epoch  30 |   200/ 1327 batches | lr 0.00 | ms/batch 44.55 | loss  3.68 | ppl    39.78
| prune-epoch  30 |   400/ 1327 batches | lr 0.00 | ms/batch 42.66 | loss  3.66 | ppl    38.99
| prune-epoch  30 |   600/ 1327 batches | lr 0.00 | ms/batch 42.67 | loss  3.65 | ppl    38.41
| prune-epoch  30 |   800/ 1327 batches | lr 0.00 | ms/batch 42.67 | loss  3.59 | ppl    36.27
| prune-epoch  30 |  1000/ 1327 batches | lr 0.00 | ms/batch 42.67 | loss  3.68 | ppl    39.47
| prune-epoch  30 |  1200/ 1327 batches | lr 0.00 | ms/batch 42.67 | loss  3.54 | ppl    34.38
end prun train
weight_ih_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l0        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_ih_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
weight_hh_l1        shape torch.Size([6000, 1500])
       expected sp:  0.9  actual sp:  0.8993333333333333
-----------------------------------------------------------------------------------------
| end of retrain epoch  30 | time: 58.60s | valid loss  4.37 | valid ppl    79.30
-----------------------------------------------------------------------------------------
required epochs  40 | actual epochs  66
pretrain epochs  21 | prune epochs  15 | retrain epochs  30
=========================================================================================
| End of training | test loss  4.33 | test ppl    75.68
=========================================================================================
